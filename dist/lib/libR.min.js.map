{"version":3,"sources":["webpack://libR/webpack/universalModuleDefinition","webpack://libR/webpack/bootstrap","webpack://libR/./src/lib/common/_general.ts","webpack://libR/./node_modules/debug/src/index.js","webpack://libR/./src/lib/exp/expm1.ts","webpack://libR/./src/lib/r-func.ts","webpack://libR/./src/lib/gamma/lgammafn_sign.ts","webpack://libR/./src/lib/rng/mersenne-twister/index.ts","webpack://libR/./src/lib/rng/normal/index.ts","webpack://libR/./src/lib/normal/qnorm.ts","webpack://libR/./src/lib/common/toms708/index.ts","webpack://libR/./src/lib/rng/irng.ts","webpack://libR/./src/lib/rng/timeseed.ts","webpack://libR/./src/lib/beta/pbeta.ts","webpack://libR/./src/lib/chi-2/rchisq.ts","webpack://libR/./src/lib/rng/irng-type.ts","webpack://libR/./src/lib/rng/normal/inormal-rng.ts","webpack://libR/./src/lib/beta/lbeta.ts","webpack://libR/./src/lib/binomial/dbinom.ts","webpack://libR/./src/lib/rng/fixup.ts","webpack://libR/./src/lib/gamma/pgamma.ts","webpack://libR/./src/lib/normal/pnorm.ts","webpack://libR/./src/lib/rng/index.ts","webpack://libR/./src/lib/trigonometry/cospi.ts","webpack://libR/./src/lib/trigonometry/sinpi.ts","webpack://libR/./src/lib/poisson/dpois.ts","webpack://libR/./src/lib/gamma/dgamma.ts","webpack://libR/./src/lib/common/choose.ts","webpack://libR/./src/lib/gamma/gamma_fn.ts","webpack://libR/./src/lib/trigonometry/index.ts","webpack://libR/./src/lib/gamma/rgamma.ts","webpack://libR/./src/lib/exp/sexp.ts","webpack://libR/./src/lib/poisson/rpois.ts","webpack://libR/./src/lib/normal/dnorm.ts","webpack://libR/./src/lib/bessel/bessel-constants.ts","webpack://libR/./src/lib/chebyshev/chebyshev.ts","webpack://libR/./src/lib/stirling/index.ts","webpack://libR/./src/lib/gamma/lgammacor.ts","webpack://libR/./src/lib/beta/pnbeta.ts","webpack://libR/./src/lib/chi-2/rnchisq.ts","webpack://libR/./src/lib/binomial/rbinom.ts","webpack://libR/./src/lib/chi-2/pchisq.ts","webpack://libR/./src/lib/chi-2/pnchisq.ts","webpack://libR/./src/lib/chi-2/qchisq.ts","webpack://libR/./src/lib/gamma/index.ts","webpack://libR/./src/lib/normal/rnorm.ts","webpack://libR/./src/lib/student-t/dt.ts","webpack://libR/./src/lib/student-t/pnt.ts","webpack://libR/./src/lib/student-t/pt.ts","webpack://libR/./src/lib/wilcoxon/cwilcox.ts","webpack://libR/./src/lib/wilcoxon/WilcoxonCache.ts","webpack://libR/./src/lib/beta/index.ts","webpack://libR/./node_modules/debug/src/common.js","webpack://libR/./src/lib/stirling/stirlerror.ts","webpack://libR/./src/lib/trigonometry/tanpi.ts","webpack://libR/./src/lib/beta/dbeta.ts","webpack://libR/./src/lib/deviance/index.ts","webpack://libR/./src/lib/deviance/bd0.ts","webpack://libR/./src/lib/beta/dnbeta.ts","webpack://libR/./src/lib/common/toms708/NumberW.ts","webpack://libR/./src/lib/beta/qbeta.ts","webpack://libR/./src/lib/beta/qnbeta.ts","webpack://libR/./src/lib/rng/normal/inversion.ts","webpack://libR/./src/lib/binomial/pbinom.ts","webpack://libR/./src/lib/binomial/qbinom.ts","webpack://libR/./src/lib/binomial-negative/pnbinom.ts","webpack://libR/./src/lib/chebyshev/index.ts","webpack://libR/./src/lib/chi-2/dchisq.ts","webpack://libR/./src/lib/chi-2/dnchisq.ts","webpack://libR/./src/lib/gamma/qgamma.ts","webpack://libR/./src/lib/chi-2/qnchisq.ts","webpack://libR/./src/lib/hypergeometric/dhyper.ts","webpack://libR/./src/lib/hypergeometric/qhyper.ts","webpack://libR/./src/lib/poisson/ppois.ts","webpack://libR/./src/lib/signrank/signrank.ts","webpack://libR/./src/lib/student-t/qt.ts","webpack://libR/./src/lib/tukey/ptukey.ts","webpack://libR/./src/lib/bessel/besselK/index.ts","webpack://libR/./src/lib/gamma/gamma_cody.ts","webpack://libR/./src/lib/bessel/besselJ/index.ts","webpack://libR/./src/lib/bessel/besselY/index.ts","webpack://libR/./src/lib/index.ts","webpack://libR/./src/lib/beta/beta.ts","webpack://libR/./node_modules/debug/src/browser.js","webpack://libR/./node_modules/ms/index.js","webpack://libR/./node_modules/debug/src/node.js","webpack://libR/external \"tty\"","webpack://libR/external \"util\"","webpack://libR/external \"supports-color\"","webpack://libR/./src/lib/common/toms708/toms708.ts","webpack://libR/./src/lib/signrank/fsign.ts","webpack://libR/./src/lib/rng/normal/buggy-kinderman-ramage.ts","webpack://libR/./src/lib/rng/normal/box-muller.ts","webpack://libR/./src/lib/rng/normal/ahrens_dieter.ts","webpack://libR/./src/lib/rng/normal/kinderman-ramage.ts","webpack://libR/./src/lib/beta/rbeta.ts","webpack://libR/./src/lib/binomial/index.ts","webpack://libR/./src/lib/binomial-negative/index.ts","webpack://libR/./src/lib/binomial-negative/dnbinom.ts","webpack://libR/./src/lib/binomial-negative/qnbinom.ts","webpack://libR/./src/lib/binomial-negative/rnbinom.ts","webpack://libR/./src/lib/cauchy/index.ts","webpack://libR/./src/lib/cauchy/dcauchy.ts","webpack://libR/./src/lib/cauchy/pcauchy.ts","webpack://libR/./src/lib/cauchy/qcauchy.ts","webpack://libR/./src/lib/cauchy/rcauchy.ts","webpack://libR/./src/lib/chi-2/index.ts","webpack://libR/./src/lib/normal/pnorm_both.ts","webpack://libR/./src/lib/normal/do_del.ts","webpack://libR/./src/lib/gamma/logspace-add.ts","webpack://libR/./src/lib/exp/index.ts","webpack://libR/./src/lib/exp/dexp.ts","webpack://libR/./src/lib/exp/pexp.ts","webpack://libR/./src/lib/exp/qexp.ts","webpack://libR/./src/lib/exp/rexp.ts","webpack://libR/./src/lib/rng/knuth-taocp/index.ts","webpack://libR/./src/lib/rng/knuth-taocp/taocp-1997-init.ts","webpack://libR/./src/lib/rng/knuth-taocp-2002/index.ts","webpack://libR/./src/lib/rng/lecuyer-cmrg/index.ts","webpack://libR/./src/lib/rng/marsaglia-multicarry/index.ts","webpack://libR/./src/lib/rng/super-duper/index.ts","webpack://libR/./src/lib/rng/wichmann-hill/index.ts","webpack://libR/./src/lib/f-distro/index.ts","webpack://libR/./src/lib/f-distro/df.ts","webpack://libR/./src/lib/f-distro/dnf.ts","webpack://libR/./src/lib/f-distro/pf.ts","webpack://libR/./src/lib/f-distro/pnf.ts","webpack://libR/./src/lib/f-distro/qf.ts","webpack://libR/./src/lib/f-distro/qnf.ts","webpack://libR/./src/lib/f-distro/rf.ts","webpack://libR/./src/lib/gamma/polygamma.ts","webpack://libR/./src/lib/geometric/index.ts","webpack://libR/./src/lib/geometric/dgeom.ts","webpack://libR/./src/lib/geometric/pgeom.ts","webpack://libR/./src/lib/geometric/qgeom.ts","webpack://libR/./src/lib/geometric/rgeom.ts","webpack://libR/./src/lib/hypergeometric/index.ts","webpack://libR/./src/lib/hypergeometric/phyper.ts","webpack://libR/./src/lib/hypergeometric/rhyper.ts","webpack://libR/./src/lib/logis/index.ts","webpack://libR/./src/lib/logis/dlogis.ts","webpack://libR/./src/lib/logis/plogis.ts","webpack://libR/./src/lib/logis/qlogis.ts","webpack://libR/./src/lib/logis/rlogis.ts","webpack://libR/./src/lib/lognormal/index.ts","webpack://libR/./src/lib/lognormal/dlnorm.ts","webpack://libR/./src/lib/lognormal/plnorm.ts","webpack://libR/./src/lib/lognormal/qlnorm.ts","webpack://libR/./src/lib/lognormal/rlnorm.ts","webpack://libR/./src/lib/multinom/index.ts","webpack://libR/./src/lib/multinom/dmultinom.ts","webpack://libR/./src/lib/multinom/rmultinom.ts","webpack://libR/./src/lib/normal/index.ts","webpack://libR/./src/lib/poisson/index.ts","webpack://libR/./src/lib/poisson/qpois.ts","webpack://libR/./src/lib/signrank/index.ts","webpack://libR/./src/lib/signrank/dsign.ts","webpack://libR/./src/lib/signrank/csignrank.ts","webpack://libR/./src/lib/signrank/psign.ts","webpack://libR/./src/lib/signrank/qsign.ts","webpack://libR/./src/lib/signrank/rsign.ts","webpack://libR/./src/lib/student-t/index.ts","webpack://libR/./src/lib/student-t/dnt.ts","webpack://libR/./src/lib/student-t/qnt.ts","webpack://libR/./src/lib/student-t/rt.ts","webpack://libR/./src/lib/tukey/index.ts","webpack://libR/./src/lib/tukey/wprob.ts","webpack://libR/./src/lib/tukey/qtukey.ts","webpack://libR/./src/lib/uniform/index.ts","webpack://libR/./src/lib/uniform/dunif.ts","webpack://libR/./src/lib/uniform/punif.ts","webpack://libR/./src/lib/uniform/qunif.ts","webpack://libR/./src/lib/uniform/runif.ts","webpack://libR/./src/lib/weibull/index.ts","webpack://libR/./src/lib/weibull/dweibull.ts","webpack://libR/./src/lib/weibull/pweibull.ts","webpack://libR/./src/lib/weibull/qweibull.ts","webpack://libR/./src/lib/weibull/rweibull.ts","webpack://libR/./src/lib/wilcoxon/index.ts","webpack://libR/./src/lib/wilcoxon/dwilcox.ts","webpack://libR/./src/lib/wilcoxon/pwilcox.ts","webpack://libR/./src/lib/wilcoxon/qwilcox.ts","webpack://libR/./src/lib/wilcoxon/rwilcox.ts","webpack://libR/./src/lib/log/index.ts","webpack://libR/./src/lib/log/log1p.ts","webpack://libR/./src/lib/bessel/index.ts","webpack://libR/./src/lib/bessel/besselI/index.ts","webpack://libR/./src/lib/bessel/besselK/Kbessel.ts","webpack://libR/./src/lib/bessel/besselI/IBessel.ts","webpack://libR/./src/lib/bessel/besselY/Ybessel.ts","webpack://libR/./src/lib/bessel/besselJ/Jbessel.ts","webpack://libR/./src/lib/common/index.ts"],"names":["root","factory","exports","module","define","amd","global","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ME","debug","debug_R_Q_P01_boundaries","debug_R_Q_P01_check","R_D_Clog","log_p","Math","log1p","ML_ERR_return_NAN","printer","ML_ERROR","ME_DOMAIN","Number","NaN","epsilonNear","x","target","isNaN","isFinite","diff","EPSILON","R_nonint","isInteger","R_pow","y","POSITIVE_INFINITY","pow","floor","myfmod","x1","x2","q","M_SQRT2","frac","trunc","M_SQRT_32","DBL_MANT_DIG","M_LN2","M_1_SQRT_2PI","M_2PI","M_LN_2PI","M_1_PI","PI","M_PI_2","M_LN_SQRT_PI","M_LN_SQRT_2PI","M_LN_SQRT_PId2","M_SQRT_2dPI","M_LOG10_2","DBL_MAX_EXP","log2","MAX_VALUE","DBL_MIN_EXP","MIN_VALUE","R_D__1","logP","R_D__0","NEGATIVE_INFINITY","R_DT_0","lower_tail","R_DT_1","R_D_val","log","R_DT_val","imin2","min","R_D_Lval","lowerTail","R_D_Cval","R_P_bounds_Inf_01","R_D_half","R_P_bounds_01","x_min","x_max","R_D_exp","exp","mapErr","Map","ME_NONE","ME_RANGE","ME_NOCONV","ME_PRECISION","ME_UNDERFLOW","str","R_D_nonint_check","fmod","imax2","max","isOdd","k","isEpsilonNear","R_D_negInonint","R_D_fexp","give_log","f","sqrt","nsig_BESS","ensig_BESS","rtnsig_BESS","enmten_BESS","enten_BESS","exparg_BESS","xlrg_BESS_IJ","xlrg_BESS_Y","thresh_BESS_Y","xmax_BESS_K","sqxmin_BESS_K","M_eps_sinc","R_pow_di","R_finite","R_isnancpp","R_powV","ldexp","R_D_log","R_Q_P01_boundaries","_LEFT_","_RIGHT_","R_Q_P01_check","R_D_qIv","process","type","browser","__nwjs","_general_1","expm1","R_D_LExp","R_Log1_Exp","R_DT_qIv","R_DT_CIv","R_DT_Clog","R_DT_log","abs","sign","printer_seq","precision9","numberPrecision","seq_len","_a","length","_b","base","_c","sent","seq","adjust","adjustMin","start","end","step","e","cursor","rc","push","sequenceFactory","delta","Array","from","lazySeq","printer_lazy_seq","arguments","TypeError","adj","multiplexer","simplePush","v","analyzed","rest","_i","split","Error","select","arg","to","Function","selector","_max","apply","__spread","map","a","result","j","arr","idx","prec","convert","__values","entries","next","done","_d","__read","prop","isNumber","parseFloat","toPrecision","slicer","keys","flatten","rest_1","rest_1_1","itm","includes","_j","Set","_e","_f","undefined","itm_1","itm_1_1","iterator","_g","_h","chain","fn0","fns","args","lastArgs","fn","Rcycle","gen","gen_1","gen_1_1","sum","randomGenHelper","data","fx","each","forEach","array_flatten","trigonometry_1","gamma_fn_1","lgammacor_1","ISNAN","ML_POSINF","fabs","printer_sign","xmax","dxrel","lgammafn_sign","sgn","ans","sinpiy","gammafn","lgammacor","sinpi","N","M","fixup_1","irng_1","irng_type_1","timeseed_1","MersenneTwister","_super","_seed","timeseed","this","__extends","MT_sgenrand","seed","mt","mti","MT_genrand","Int32Array","mag01","dummy","m_seed","kk","Uint32Array","buffer","fixupSeeds","find","init","_setup","buf","ArrayBuffer","SEED_LEN","_kind","IRNGType","MERSENNE_TWISTER","_name","fill","internal_unif_rand","fixup","set","IRNG","buggy_kinderman_ramage_1","BuggyKindermanRamage","box_muller_1","BoxMuller","ahrens_dieter_1","AhrensDieter","inversion_1","Inversion","kinderman_ramage_1","KindermanRamage","inormal_rng_1","IRNGNormal","expm1_1","ML_NEGINF","Infinity","qnorm","mu","sigma","p_","val","toms708_1","Toms708","NumberW_1","NumberW","notify","emit","register","unif_rand","_this","event","handler","add","ceil","now","Date","nBits","lowBits","hi","lo","reverser","Uint8Array","uint32","reverse","R_FINITE","LN2","printer_pbeta_raw","pbeta_raw","b","w","wc","ierr","bratio","printer_pbeta","pbeta","rgamma_1","r_func_1","rchisqOne","df","rng","rgammaOne","rchisq","_rng","norm_rand","internal_norm_rand","norm_randOne","lgammafn_sign_1","lbeta","corr","deviance_1","stirling_1","R_forceint","round","dbinom_raw","lf","lc","lc_1","bd0","stirlerr","dbinom","logX","i2_32m1","dnorm_1","pnorm_1","dpois_1","fmax2","DBL_MIN","DBL_EPSILON","isArray","sqr","scalefactor","M_cutoff","logcf","eps","c1","c2","c4","a1","b1","b2","a2","c3","log1pmx","two","lgamma1p","lgam","coeffs","pr_dpois_wrap","dpois_wrap","x_plus_1","lambda","dpois_raw","pr_pgamma_smallx","pr_pd_lower_cf","pd_lower_cf","of","f0","pr_pd_lower_series","pr_ppois_asymp","ppois_asymp","elfb","elfb_term","res12","res1_term","res1_ig","res2_term","res2_ig","dfm","pt_","s2pt","np","coefs_a","coefs_b","pnorm5","n_d_over_p","lp","term","dnorm4","dpnorm","nd","pr_pgamma_raw","pgamma_raw","alph","res","f1","f2","lf2","f1m1","f2m1","pgamma_smallx","pd_upper_series","pd_lower_series","printer_pgamma","pgamma","shape","scale","ML_NAN","pnorm_both_1","cp","pnorm_both","knuth_taocp_1","knuth_taocp_2002_1","lecuyer_cmrg_1","marsaglia_multicarry_1","mersenne_twister_1","normal_1","super_duper_1","wichmann_hill_1","KnuthTAOCP","KnuthTAOCP2002","LecuyerCMRG","MarsagliaMultiCarry","normal","SuperDuper","WichmannHill","M_PI","printer_cospi","cospi","cos","printer_tanpi","tanpi","tan","atanpi","atan","printer_sinpi","sin","dpois","dgamma","aslog","pr","lbeta_1","lgammafn_sign_2","lfastchoose","lfastchoose2","sChoose","printer_lchoose","internal_lchoose","k0","k_small_max","printer_choose","internal_choose","schoose","chebyshev_1","gamcs","chebyshev_eval","_gammafn","cospi_1","sinpi_1","tanpi_1","sexp_1","printer_rgammaOne","ret_val","a4","a6","aa","aaa","s2","q0","si","u","exp_rand","ustar","umin","fsign_1","a0","a3","a5","a7","one_7","one_12","one_24","printer_rpois","rpoisOne","del","fy","g","px","py","big_mu","fact","pp","c0","p0","omega","big_l","muprev","muprev2","difmuk","E","fk","pois","kflag","new_big_mu","gotoStepF","once","fsign","rpois","DBL_MAX","chebyshev_init","dos","nos","eta","err","retCode","ii","b0","twox","stirlerror_1","algmcs","nalgm","xbig","tmp","printer_pnbeta2","pnbeta2","o_x","ncp","errbd","x0","gx","sumq","temp","tmp_c","pnbeta_raw","pnbeta","rpois_1","rchisq_1","rnchisqOne","rnchisq","qbinom_1","fmin2","INT_MAX","MAX_SAFE_INTEGER","printer_rbinom","rbinomOne","nin","w2","z","z2","al","alv","amaxp","ffm","ynorm","fm","npq","p1","p2","p3","p4","qn","xl","xll","xlr","xm","xr","psave","nsave","ix","qbinom","gotoL_np_small","gotoFinis","rbinom","pgamma_1","pchisq","logspace_add_1","pchisq_1","M_LN10","LN10","_dbl_min_exp","pnchisq_raw","theta","errmax","reltol","itrmax","lam","bound","f_x_2n","f_2n","lamSml","tSml","is_r","is_b","is_it","lt","l_lam","l_x","lu","_L","ans_1","sum2","logspace_add","pnchisq","qgamma_1","qchisq","qgamma","dgamma_1","polygamma_1","default","digamma","gamma","lgamma","pentagamma","psigamma","tetragamma","trigamma","Gamma","norm","printer_n","gammaNormalizeParams","rate","printer_d","printer_p","printer_q","printer_rgamma","_scale","freeze","asLog","rgamma","rnormOne","rnorm","bd0_1","printer_dt","dt","giveLog","l_x2n","x2n","ax","lrg_x2n","I_sqrt_","pbeta_1","pt_1","printer_pnt","pnt","_t","rxb","geven","godd","xeven","xodd","tnc","pt","negdel","tt","_s","albeta","it_1","nx","lval","cwilcox","WilcoxonCache","_map2","jstruct","kstruct","beta_1","dbeta_1","dnbeta_1","pnbeta_1","qbeta_1","qnbeta_1","rnchisq_1","rbeta_1","beta","Beta","dbeta","shape1","shape2","dnbeta","qbeta","qnbeta","rbeta","ar","br_1","env","selectColor","namespace","hash","charCodeAt","createDebug","colors","prevTime","enabled","_len","_key","self","curr","ms","prev","coerce","unshift","index","replace","match","format","formatter","formatters","splice","formatArgs","useColors","color","destroy","extend","instances","indexOf","delimiter","stack","message","disable","enable","namespaces","save","names","skips","len","RegExp","substr","instance","test","humanize","load","sferr_halves","S0","S1","S2","S3","S4","nn","dbinom_1","__export","ej","s1","ln","kMax","ncp2","dx2","D","p_k","_val","USE_LOG_X_CUTOFF","n_NEWTON_FREE","MLOGICAL_NA","printer_qbeta","qbet","qbeta_raw","DBL_very_MIN","DBL_log_v_MIN","DBL_1__eps","fpu","acu_min","p_lo","p_hi","const1","const2","const3","const4","return_q_0","give_log_q","qb","return_q_1","return_q_half","printer_qbeta_raw","R_ifDEBUG_printf","alpha","swap_01","log_q_cut","n_N","swap_tail","log_","i_pb","i_inn","la","logbeta","h","qq","swap_choose","use_log_x","warned","add_N_step","xinbta","u_n","acu","tx","u0","log_eps_c","goto_L_Newton","goto_L_return","goto_L_converged","l1ma","xx","bad_u","bad_init","wprev","r_1","printer_qnbeta","ux","lx","qnorm_1","u1","pbinom","pbinom_1","printer_do_search","do_search","incr","newz","printer_qbinom","size","oldincr","console","pnbinom","prob","printer_pnbinom_mu","pnbinom_mu","dchisq","dchisq_1","printer_dnchisq","dnchisq","mid","dfmid","imax","nl","ic","pgamma_2","pgamma_3","printer_qchisq_appr","qchisq_appr","nu","tol","ch","lgam1pa","_qgamma","printer_qgamma","ch0","s6","max_it_Newton","goto_END","qchisq_1","pnchisq_1","qnchisq","ux0","racc","Eps","ff","dhyper","choose_1","printer_qhyper","qhyper","nr","nb","xstart","xend","xb","small_N","NR","NB","ppois","printer_dsignrank","printer_psignrank","printer_qsignrank","printer_rsignrank","csignrank","rsignrankOne","nRound","dsignrank","rn","psignrank","roundN","qsignrank","rsignrank","dt_1","SQRT2","printer_qt","qt","ndf","P","iter","neg","is_neg_lower","log_P2","P_ok1","P_ok","wprob_1","_general_2","printer_ptukey","ptukey","rr","cc","f21","f2lf","ff4","otsum","qsqz","twa1","ulen","xlegq","alegq","wprob","jj","t1","Kbessel_1","bessel_k","expo","ize","K_bessel","ncalc","Rf_gamma_cody","parity","xden","xnum","yi","ysq","besselY_1","Jbessel_1","bessel_j","na","bessel_y","J_bessel","besselJ_1","Ybessel_1","Y_bessel","binomial_1","Binomial","binomial_negative_1","NegativeBinomial","cauchy_1","Cauchy","chi_2_1","ChiSquared","exp_1","Exponential","f_distro_1","FDist","gamma_1","geometric_1","Geometric","hypergeometric_1","HyperGeometric","logis_1","Logistic","lognormal_1","LogNormal","multinom_1","Multinomial","Normal","poisson_1","Poisson","rng_1","signrank_1","SignRank","student_t_1","StudentT","tukey_1","Tukey","uniform_1","Uniform","weibull_1","Weibull","wilcoxon_1","Wilcoxon","log_1","hypot","log1pR","bessel_1","beta_2","common_1","gamma_2","special","__assign","utils","seq1","seq0","combine","lnsml","printer_beta","_typeof","obj","constructor","_console","lastC","storage","setItem","removeItem","error","getItem","DEBUG","window","navigator","userAgent","toLowerCase","document","documentElement","style","WebkitAppearance","firebug","exception","table","parseInt","$1","localStorage","localstorage","JSON","stringify","plural","msAbs","isPlural","options","String","exec","parse","long","fmtLong","fmtShort","tty","util","inspectOpts","stderr","write","colorCode","prefix","concat","join","hideDate","toISOString","getDate","Boolean","isatty","fd","supportsColor","level","filter","reduce","substring","_","toUpperCase","inspect","O","require","printer_bratio","alnrel","t2","algdiv","s3","s5","s7","s9","apser","bx","aj","psi","basym","r0","r1","w0","e0","e1","rlog1","z0","j0","erfc1","j1","h2","hn","znm1","zn","np1","bsum","mm1","mmj","dsum","im1","t0","bcorr","c5","beta_cdf_values","nData","betaln","gamln","gsumln","bfrac","yp1","anp1","bnp1","an","bn","dResult","brcomp","bgrat","bm1","lnx","n2","nm1","bp2n","coef","dj","cn","gam1","q1","grat1","lny","y0","z_1","u_2","gamln1","apb","u_1","u_3","brcmp1","z_2","esum","bpser","w1","ind","spmpar","fpser","bup","ierr1_1","ierr1_2","ierr1","ap1","exparg","erf","bot","top","erf_values","lnb","ipmpar","am0","an0","a2n","b2n","cma","a2nm1","b2nm1","rexp","gamma_inc_values","gamma_log_values","q2","nq","xmax1","den","aug","upper","psi_values","r4_epsilon","rTest","emin","emax","binv","ibeta","one","signal","u2","u3","A","u2_1","BM_norm_keep","reset","R","jump","rbetaOne","bb","qsame","k1","k2","olda","oldb","v_w_from__u1_bet","AA","expmax","rbinom_1","dnbinom_1","pnbinom_1","qnbinom_1","rnbinom_1","errText","fs","dnbinom_mu","qnbinom_mu","rnbinom_mu","dnbinom","qnbinom","rnbinom","printer_dnbinom_mu","llogx","printer_qnbinom","Q","printer_rnbinom","rnbinomOne","printer_rnbinom_mu","_rnbinom_mu","dcauchy_1","pcauchy_1","qcauchy_1","rcauchy_1","rcauchy","location","dcauchy","pcauchy","qcauchy","my_INF","rcauchyOne","dnchisq_1","qnchisq_1","do_del_1","cum","ccum","i_tail","xsq","lower","do_del","SIXTEN","X","logx","logy","dexp_1","pexp_1","qexp_1","rexp_1","dexp","pexp","qexp","rexpOne","taocp_1997_init_1","qualityBuffer","QUALITY","ran_arr_buf","mod_diff","KT_pos","slice","KT_next","ran_arr_cycle","RNG_Init_R_KT","TAOCP1997init","ran_array","ran_x","KNUTH_TAOCP","KK","MM","MMF","ss","T","_k","KKL","_l","_m","_o","_p","_q","LL","is_odd","ran_start","se","TT","RNG_Init_KT2","KNUTH_TAOCP2002","m2","m1","LECUYER_CMRG","II","MARSAGLIA_MULTICARRY","un","SUPER_DUPER","WICHMANN_HILL","df_1","dnf_1","pf_1","pnf_1","qf_1","qnf_1","rf_1","rfOne","df1","df2","dnf","pf","pnf","qf","qnf","rf","n1","printer_df","dens","ML_VALID","printer_pf","printer_pnf","n_max","dpsifn","kode","nz","mm","elim","fln","rln","rxsq","r1m4","r1m5","ta","tk","tols","tss","tst","wdtol","xmin","xq","bvalues","xinc","xdmln","xdmy","xln","trm","trmr","lrg","L10","L20","L30","print_psigamma","deriv","dgeom_1","pgeom_1","qgeom_1","rgeom_1","dgeom","pgeom","qgeom","rgeom","rgeomOne","dhyper_1","phyper_1","qhyper_1","rhyper_1","phyper","rhyper","nn1in","nn2in","kkin","printer_phyper","pd","oldNB","pdhyper","printer_afc","afc","di","i2","nn1","nn2","setup1","setup2","ks","n1s","n2s","minjx","maxjx","tn","kl","kr","lamdl","lamdr","printer_rhyper","lw","goto_L10","n_uv","reject","de","dg","dr","ds","gl","gu","nk","nm","ub","xk","xn","y1","ym","yn","yk","rhyperOne","dlogis_1","plogis_1","qlogis_1","rlogis_1","dlogis","plogis","qlogis","rlogis","printer_dlogis","Rf_log1pexp","printer_plogis","printer_qlogis","printer_rlogis","rlogisOne","dlnorm_1","plnorm_1","qlnorm_1","rlnorm_1","dlnorm","plnorm","qlnorm","rlnorm","meanlog","sdlog","rnorm_1","rlnormOne","dmultinom_1","rmultinom_1","rmultinom","dmultinom","badProb","i0","_v","errMsg","printer_rmultinom","rmultinomOne","rN","K","_size","p_tot","prng","dnorm","pnorm","ppois_1","qpois_1","qpois","nearbyint","printer_qpois","dsign_1","psign_1","qsign_1","rsign_1","csignrank_1","lowerT","dnt_1","pnt_1","qnt_1","qt_1","rt_1","dnt","qnt","rt","chisq_1","printer_dnt","rtOne","ptukey_1","qtukey_1","nmeans","nranges","qtukey","C2","wlar","wincr1","wincr2","nleg","ihalf","xleg","aleg","C3","C1","ac","pr_w","binc","cc1","qexpo","rinsum","wi","wincr","blb","bub","einsum","elsum","valx0","valx1","ps","qinv","dunif_1","punif_1","qunif_1","runif_1","dunif","punif","qunif","runif","runifOne","dweibull_1","pweibull_1","qweibull_1","rweibull_1","dweibull","pweibull","qweibull","rweibull","tmp1","tmp2","rweibullOne","dwilcox_1","pwilcox_1","qwilcox_1","rwilcox_1","dwilcox","pwilcox","qwilcox","rwilcox","cwilcox_1","WilcoxonCache_1","printer_dwilcox","printer_pwilcox","printer_qwilcox","printer_rwilcox","rwilcoxOne","index_1","besselI_1","besselK_1","besselJ","besselY","besselK","besselI","bessel_i","IBessel_1","I_bessel","bessel_constants_1","sinh","iend","mplus1","x2by4","blpha","ratio","wminf","d1","d2","d3","twonu","dm","ex","bk1","bk2","estm","estf","bk","cnt","gamma_cody_1","fmax","nend","intx","nbmx","nstart","pold","em","en","empal","emp2al","halfx","plast","tover","psavel","bi2","gotoL120","gotoL230","pow05_to_900","rc_1","alfa","div","ddiv","even","cosmu","sinmu","pa","pa1","qa","qa1","ya","ya1","twobyx","odd","aye","dmu","xna","en1","by","i_nend","i_m","capp","capq","vcos","vsin","alpem","alp2em","xc","gnu","xin","pi2","gotoL190","intxj","gotoL240","gotoL250","choose","lchoose"],"mappings":"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A,GACA,GACA,GACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,EACA,EACA,GACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GAuGa4yB,EAAM5yB,IAAM,GACzBlS,EAAEkS,IAxDS,CACX,IACA,GACA,EACA,EACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAca4yB,EAAM5yB,IAAM,GACzB/E,EAAG+E,IAtGS,CACZ,mBACA,kBACA,EACA,EACA,oBACA,kBACA,kBACA,GACA,KACA,KACA,KACA,KACA,GACA,KACA,KACA,KACA,KACA,kBACA,kBACA,gBACA,EACA,GACA,kBACA,kBACA,kBACA,GACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,IACA,KACA,MACA,OACA,KACA,MACA,OACA,SA4De4yB,EAAM5yB,IAAM,KAIjBE,EAAA2yB,OAAd,SAAqBjmB,EAAYyC,GAiB/B,IAQI9C,EACApV,EATEf,EAAI,iBAEN8B,EAAI,EACJ0J,EAAI,EAEJme,EAAI,EACJh1B,EAAI,EACJyB,EAAI,EAGJqV,EAAI,EACJuP,EAAI,EAKR,GAHAlZ,EAAI7K,KAAK2D,IAAI4b,EAAIyC,GACjBzN,EAAIvU,KAAKiF,IAAIsa,EAAIyC,GAEbnX,EAAI,EAIN,OAAI0J,EAAI,EAAY1B,EAAQ4yB,MAAM56B,GAAKgI,EAAQwwB,OAAOx4B,EAAG0J,GAC7C1B,EAAQ4yB,MAAM56B,GAAKgI,EAAQ4yB,MAAMlxB,GAAK1B,EAAQ4yB,MAAM56B,EAAI0J,GAC/D,GAAI1J,GAAK,GAAKA,EAAI,EAAG,CAI1B,GAAIA,EAAI,GAAK0J,EAAI,EACf,OAAO1B,EAA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","file":"libR.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"libR\"] = factory();\n\telse\n\t\troot[\"libR\"] = factory();\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 79);\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nconst debug_R_Q_P01_boundaries = debug('R_Q_P01_boundaries');\nconst debug_R_Q_P01_check = debug('R_Q_P01_check');\n\nexport const M_SQRT2 = 1.41421356237309504880168872421; /* sqrt(2) */\nexport const frac = (x: number) => x - Math.trunc(x);\n//export const DBL_MAX_10_EXP = Math.log10(Number.MAX_VALUE);\n//export const MAX_DIGITS = DBL_MAX_10_EXP;\n//export const INT_MAX = Number.MAX_SAFE_INTEGER;\n//export const INT_MIN = Number.MIN_SAFE_INTEGER;\nexport const M_SQRT_32 = 5.656854249492380195206754896838; /* sqrt(32) */\nexport const DBL_MANT_DIG = 18;\n//export const FLT_MANT_DIG = DBL_MANT_DIG;\nexport const M_LN2 = 0.693147180559945309417232121458; /* ln(2) */\nexport const M_1_SQRT_2PI = 0.398942280401432677939946059934;\n//export const nearbyint = rround;\n//export const R_forceint = nearbyint;\n//export const R_rint = nearbyint;\nexport const M_2PI = 6.283185307179586476925286766559;\nexport const M_LN_2PI = 1.837877066409345483560659472811; /* \n   6.0E-17, we used the comments in the nmath lib to find epsilon that fullfills x == x-epsilon\n   this does not cover the internal accurace of build in functions in Math.cos, Math.sin etc\n*/\n/*export const sqrt = Math.sqrt;\nexport const asin = Math.asin;\nexport const acos = Math.acos;\nexport const atan = Math.atan;\nexport const atan2 = Math.atan2;\n*/ /*export const DBL_EPSILON = Number.EPSILON;\nexport const sinh = Math.sinh;\nexport const DBL_MAX = Number.MAX_VALUE;\nexport const exp = Math.exp;\nexport const isInteger = Number.isInteger;\nexport const sin = Math.sin;\nexport const cos = Math.cos;\nexport const tan = Math.tan;\n*/ export const M_1_PI =\n  1.0 / Math.PI;\n/*export const R_FINITE = (x: number) => Number.isFinite(x);\nexport const NaN = Number.NaN;\nexport const FLT_MIN = 2.22507e-308; //10^24  larger then Number.MIN_VALUE\nexport const DBL_MIN = FLT_MIN;\nexport const log = Math.log;\nexport const ISNAN = Number.isNaN;\nexport const ML_NAN = NaN;\nexport const round = Math.round;\nexport const ML_POSINF = Number.POSITIVE_INFINITY;\nexport const ML_NEGINF = Number.NEGATIVE_INFINITY;\nexport const M_PI = 3.14159265358979323846264338327950288;\n*/ export const M_PI_2 =\n  Math.PI / 2;\nexport const M_LN_SQRT_PI = 0.57236494292470008; // log(sqrt(pi))\nexport const M_LN_SQRT_2PI = 0.918938533204672741780329736406; // log(sqrt(2*pi))\nexport const M_LN_SQRT_PId2 = 0.225791352644727432363097614947; // log(sqrt(pi/2))\n//export const M_LN10 = 2.30258509299404568402; /* log_e 10 */\n//export const ML_VALID = (x: number) => !ISNAN(x);\n//export const floor = Math.floor;\nexport const M_SQRT_2dPI = 0.797884560802865355879892119869; // sqrt(2/pi)\nexport const M_LOG10_2 = 0.301029995663981195213738894724; //Math.log10(2);\n//export const FLT_RADIX = 2;\n//export const CHAR_BIT = 8;\nexport const DBL_MAX_EXP = Math.log2(Number.MAX_VALUE);\nexport const DBL_MIN_EXP = Math.log2(Number.MIN_VALUE);\n//export const FLT_MAX_EXP = DBL_MAX_EXP;\n//export const FLT_MIN_EXP = DBL_MIN_EXP;\n//export const sizeofInt =\n//  4 * Math.ceil(Math.log(Number.MAX_SAFE_INTEGER) / Math.log(2) / 4 / CHAR_BIT);\n\nexport const R_D__1 = (logP: boolean) => {\n  return logP ? 0 : 1.0;\n};\n\nexport const R_D__0 = (logP: boolean): number => {\n  return logP ? Number.NEGATIVE_INFINITY : 0.0;\n};\n\nexport const R_DT_0 = (lower_tail: boolean, log_p: boolean): number => {\n  return lower_tail ? R_D__0(log_p) : R_D__1(log_p);\n};\nexport const R_DT_1 = (lower_tail: boolean, log_p: boolean): number => {\n  return lower_tail ? R_D__1(log_p) : R_D__0(log_p);\n};\nexport const R_D_val = (log_p: boolean, x: number) => {\n  return log_p ? Math.log(x) : x;\n};\n\nexport function R_D_Clog(log_p: boolean, p: number): number {\n  return log_p ? Math.log1p(-p) : 0.5 - p + 0.5; /* [log](1-p) */\n}\n\nexport function R_DT_val(lower_tail: boolean, log_p: boolean, x: number) {\n  return lower_tail ? R_D_val(log_p, x) : R_D_Clog(log_p, x);\n}\n\n/*\nexport function rround(x: number) {\n  if (x < 0) {\n    return trunc(x - 0.5);\n  }\n  return trunc(x + 0.5);\n}\n*/\nexport function imin2(x: number, y: number): number {\n  return Math.trunc(Math.min(x, y));\n}\n\n/* Use 0.5 - p + 0.5 to perhaps gain 1 bit of accuracy */\nexport function R_D_Lval(lowerTail: boolean, p: number): number {\n  return lowerTail ? p : 1 - p; /*  p  */\n}\n\nexport function R_D_Cval(lowerTail: boolean, p: number): number {\n  return lowerTail ? 1 - p : p; /*  1 - p */\n}\n\nexport function R_P_bounds_Inf_01(\n  lowerTail: boolean,\n  log_p: boolean,\n  x: number\n): number | undefined {\n  if (!Number.isFinite(x)) {\n    if (x > 0) {\n      return R_DT_1(lowerTail, log_p);\n    }\n    return R_DT_0(lowerTail, log_p);\n  }\n  return undefined;\n}\n\nexport function R_D_half(log_p: boolean) {\n  return log_p ? -M_LN2 : 0.5; // 1/2 (lower- or upper tail)\n}\n\nexport function R_P_bounds_01(\n  lower_tail: boolean,\n  log_p: boolean,\n  x: number,\n  x_min: number,\n  x_max: number\n): number | undefined {\n  if (x <= x_min) return R_DT_0(lower_tail, log_p);\n  if (x >= x_max) return R_DT_1(lower_tail, log_p);\n  return undefined;\n}\n\nexport const R_D_exp = (log_p: boolean, x: number): number => {\n  return log_p ? x : Math.exp(x);\n  /* exp(x) */\n};\n\nexport enum ME {\n  ME_NONE = 0, // no error\n  ME_DOMAIN = 1, // argument out of domain\n  ME_RANGE = 2, //  value out of range\n  ME_NOCONV = 4, //process did not converge\n  ME_PRECISION = 8, //does not have \"full\" precision\n  ME_UNDERFLOW = 16 // and underflow occured (important for IEEE)\n}\n/*\nexport const min0 = (x: number, y: number): number => {\n  return x <= y ? x : y;\n};\nexport const max0 = (x: number, y: number): number => {\n  return x <= y ? y : x;\n};\n*/\nexport const mapErr = new Map([\n  [ME.ME_NONE, 'No error'],\n  [ME.ME_DOMAIN, \"argument out of domain in '%s'\"],\n  [ME.ME_RANGE, \"argument out of domain in '%s'\"],\n  [ME.ME_NOCONV, \"convergence failed in '%s'\"],\n  [ME.ME_PRECISION, \"full precision may not have been achieved in '%s'\"],\n  [ME.ME_UNDERFLOW, \"underflow occurred in '%s'\"]\n]);\n\nexport const ML_ERROR = (x: ME, s: any, printer: debug.IDebugger) => {\n  const str = mapErr.get(x);\n  if (str) {\n    printer(str, s);\n  }\n};\n\nexport function ML_ERR_return_NAN(printer: debug.IDebugger) {\n  ML_ERROR(ME.ME_DOMAIN, '', printer);\n  return Number.NaN;\n}\n\nexport function R_D_nonint_check(\n  log: boolean,\n  x: number,\n  printer: debug.IDebugger\n) {\n  if (R_nonint(x)) {\n    printer('non-integer x = %d', x);\n    return R_D__0(log);\n  }\n  return undefined;\n}\n\nexport function fmod(x: number, y: number): number {\n  // 4.2 % 0.1 gives 0.099999999\n  // this is wong so...\n  return x - Math.trunc(x / y) * y;\n}\n\nexport function imax2(x: number, y: number): number {\n  return Math.trunc(Math.max(x, y));\n}\n\nexport function isOdd(k: number) {\n  return Math.floor(k) % 2 === 1;\n}\n\nexport function epsilonNear(x: number, target: number): number {\n  if (Number.isNaN(x)) return x;\n  if (!isFinite(x)) return x;\n  if (Number.isNaN(target)) return x;\n  if (!isFinite(target)) return x;\n\n  let diff = x - target;\n  if (diff > Number.EPSILON || diff < -Number.EPSILON) {\n    return x;\n  }\n  return target;\n}\n\nexport function isEpsilonNear(x: number, target: number): boolean {\n  if (isFinite(x) && isFinite(target)) return epsilonNear(x, target) === target;\n  return false;\n}\n\n/*\nexport function Rf_d1mach(i: number): number {\n  switch (i) {\n    case 1:\n      return Number.MIN_VALUE;\n    case 2:\n      return Number.MAX_VALUE;\n\n    case 3:\n      // = FLT_RADIX  ^ - DBL_MANT_DIG\n      //  for IEEE:  = 2^-53 = 1.110223e-16 = .5*DBL_EPSILON \n      return 0.5 * Number.EPSILON;\n\n    case 4:\n      // = FLT_RADIX  ^ (1- DBL_MANT_DIG) =\n      //     for IEEE:  = 2^-52 = DBL_EPSILON \n      return Number.EPSILON;\n\n    case 5:\n      return M_LOG10_2;\n\n    default:\n      return 0.0;\n  }\n}\n*/\nexport function R_D_negInonint(x: number) {\n  return x < 0.0 || R_nonint(x);\n}\n\nexport function R_nonint(x: number) {\n  return !Number.isInteger(x); //Math.abs(x - Math.round(x)) > 1e-7 * Math.max(1, Math.abs(x));\n}\n\nexport function R_D_fexp(give_log: boolean, f: number, x: number): number {\n  return give_log ? -0.5 * Math.log(f) + x : Math.exp(x) / Math.sqrt(f);\n}\n\n/** bessel section */\n/** bessel section */\n/** bessel section */\n\nexport const nsig_BESS = 16;\nexport const ensig_BESS = 1e16;\nexport const rtnsig_BESS = 1e-4;\nexport const enmten_BESS = 8.9e-308;\nexport const enten_BESS = 1e308;\n\nexport const exparg_BESS = 709;\nexport const xlrg_BESS_IJ = 1e5;\nexport const xlrg_BESS_Y = 1e8;\nexport const thresh_BESS_Y = 16;\n\nexport const xmax_BESS_K = 705.342; /* maximal x for UNscaled answer */\n\n/* sqrt(DBL_MIN) =\t1.491668e-154 */\nexport const sqxmin_BESS_K = 1.49e-154;\n\n/* x < eps_sinc\t <==>  sin(x)/x == 1 (particularly \"==>\");\n  Linux (around 2001-02) gives 2.14946906753213e-08\n  Solaris 2.5.1\t\t gives 2.14911933289084e-08\n*/\nexport const M_eps_sinc = 2.149e-8;\n\nexport function R_pow_di(x: number, n: number) {\n  let pow: number = 1.0;\n\n  if (Number.isNaN(x)) return x;\n  if (n !== 0) {\n    if (!Number.isFinite(x)) return R_pow(x, n);\n    if (n < 0) {\n      n = -n;\n      x = 1 / x;\n    }\n    while (true) {\n      if (n & 1) pow *= x;\n      if ((n >>= 1)) x *= x;\n      else break;\n    }\n  }\n  return pow;\n}\n\n//export const NA_REAL = ML_NAN;\n//export const R_PosInf = ML_POSINF;\n//export const R_NegInf = ML_NEGINF;\n\nexport function R_pow(x: number, y: number): number {\n  /* = x ^ y */\n\n  /* squaring is the most common of the specially handled cases so\n       check for it first. */\n  if (y === 2.0) return x * x;\n  if (x === 1 || y === 0) return 1;\n  if (x === 0) {\n    if (y > 0) return 0;\n    else if (y < 0) return Number.POSITIVE_INFINITY;\n    else return y; /* NA or NaN, we assert */\n  }\n  if (Number.isFinite(x) && Number.isFinite(y)) {\n    /* There was a special case for y == 0.5 here, but\n           gcc 4.3.0 -g -O2 mis-compiled it.  Showed up with\n           100^0.5 as 3.162278, example(pbirthday) failed. */\n    return Math.pow(x, y);\n  }\n  if (Number.isNaN(x) || Number.isNaN(y)) return x + y;\n  if (!Number.isFinite(x)) {\n    if (x > 0)\n      /* Inf ^ y */\n      return y < 0 ? 0 : Number.POSITIVE_INFINITY;\n    else {\n      /* (-Inf) ^ y */\n      if (Number.isFinite(y) && y === Math.floor(y))\n        /* (-Inf) ^ n */\n        return y < 0 ? 0 : myfmod(y, 2) ? x : -x;\n    }\n  }\n  if (!Number.isFinite(y)) {\n    if (x >= 0) {\n      if (y > 0)\n        /* y == +Inf */\n        return x >= 1 ? Number.POSITIVE_INFINITY : 0; /* y == -Inf */\n      else return x < 1 ? Number.POSITIVE_INFINITY : 0;\n    }\n  }\n  return NaN; // all other cases: (-Inf)^{+-Inf, non-int}; (neg)^{+-Inf}\n}\n\nexport const R_finite = (x: number) => !Number.isFinite(x);\n\n/* C++ math header undefines any isnan macro. This file\n   doesn't get C++ headers and so is safe. */\nexport const R_isnancpp = (x: number) => Number.isNaN(x);\n\nexport function myfmod(x1: number, x2: number) {\n  let q = x1 / x2;\n  return x1 - Math.floor(q) * x2;\n}\n\nexport function R_powV(x: number, y: number): number /* = x ^ y */ {\n  if (x === 1 || y === 0) return 1;\n  if (x === 0) {\n    if (y > 0) return 0;\n    /* y < 0 */ return Number.POSITIVE_INFINITY;\n  }\n  if (Number.isFinite(x) && Number.isFinite(y)) return Math.pow(x, y);\n  if (Number.isNaN(x) || Number.isNaN(y)) {\n    return x + y;\n  }\n  if (!Number.isFinite(x)) {\n    if (x > 0)\n      /* Inf ^ y */\n      return y < 0 ? 0 : Number.POSITIVE_INFINITY;\n    else {\n      /* (-Inf) ^ y */\n      if (Number.isFinite(y) && y === Math.floor(y))\n        /* (-Inf) ^ n */\n        return y < 0 ? 0 : myfmod(y, 2) ? x : -x;\n    }\n  }\n  if (!Number.isFinite(y)) {\n    if (x >= 0) {\n      if (y > 0)\n        /* y == +Inf */\n        return x >= 1 ? Number.POSITIVE_INFINITY : 0; /* y == -Inf */\n      else return x < 1 ? Number.POSITIVE_INFINITY : 0;\n    }\n  }\n  return NaN; /* all other cases: (-Inf)^{+-Inf,\n                   non-int}; (neg)^{+-Inf} */\n}\n\n//  return x * Math.pow(2,y)\nexport function ldexp(x: number, y: number): number {\n  if (Number.isNaN(x) || Number.isNaN(y)) {\n    return x + y;\n  }\n  if (!Number.isFinite(x) || !Number.isFinite(y)) {\n    return Number.POSITIVE_INFINITY;\n  }\n  return x * Math.pow(2, y);\n}\n\n/*\nexport function Rf_i1mach(i: number): number {\n  switch (i) {\n    case 1:\n      return 5;\n    case 2:\n      return 6;\n    case 3:\n      return 0;\n    case 4:\n      return 0;\n\n    case 5:\n      return CHAR_BIT * sizeofInt;\n    case 6:\n      return sizeofInt;\n\n    case 7:\n      return 2;\n    case 8:\n      return CHAR_BIT * sizeofInt - 1;\n    case 9:\n      return INT_MAX;\n\n    case 10:\n      return FLT_RADIX;\n\n    case 11:\n      return FLT_MANT_DIG;\n    case 12:\n      return FLT_MIN_EXP;\n    case 13:\n      return FLT_MAX_EXP;\n\n    case 14:\n      return DBL_MANT_DIG;\n    case 15:\n      return DBL_MIN_EXP;\n    case 16:\n      return DBL_MAX_EXP;\n\n    default:\n      return 0;\n  }\n}\n*/\n\n/*\nexport function iF77_NAME(i: number) {\n  return Rf_i1mach(i);\n}\n*/\n\nexport function R_D_log(log_p: boolean, p: number) {\n  return log_p ? p : Math.log(p); /* log(p) */\n}\n\nexport function R_Q_P01_boundaries(\n  lower_tail: boolean,\n  log_p: boolean,\n  p: number,\n  _LEFT_: number,\n  _RIGHT_: number\n): number | undefined {\n  if (log_p) {\n    if (p > 0) {\n      return ML_ERR_return_NAN(debug_R_Q_P01_boundaries);\n    }\n    if (p === 0)\n      /* upper bound*/\n      return lower_tail ? _RIGHT_ : _LEFT_;\n    if (p === Number.NEGATIVE_INFINITY) return lower_tail ? _LEFT_ : _RIGHT_;\n  } else {\n    /* !log_p */\n    if (p < 0 || p > 1) {\n      return ML_ERR_return_NAN(debug_R_Q_P01_boundaries);\n    }\n    if (p === 0) return lower_tail ? _LEFT_ : _RIGHT_;\n    if (p === 1) return lower_tail ? _RIGHT_ : _LEFT_;\n  }\n  return undefined;\n}\n\nexport function R_Q_P01_check(logP: boolean, p: number): number | undefined {\n  if ((logP && p > 0) || (!logP && (p < 0 || p > 1))) {\n    return ML_ERR_return_NAN(debug_R_Q_P01_check);\n  }\n  return undefined;\n}\n\n//#define R_D_qIv(p)\t(log_p\t? exp(p) : (p))\t\t/*  p  in qF(p,..) */\nexport function R_D_qIv(logP: boolean, p: number) {\n  return logP ? Math.exp(p) : p;\n}\n","\"use strict\";\n\n/**\n * Detect Electron renderer / nwjs process, which is node, but we should\n * treat as a browser.\n */\nif (typeof process === 'undefined' || process.type === 'renderer' || process.browser === true || process.__nwjs) {\n  module.exports = require('./browser.js');\n} else {\n  module.exports = require('./node.js');\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport {\n  M_LN2,\n  R_D_Cval,\n  R_D_log,\n  R_D_Lval\n} from '../common/_general';\n\n//import { log1p } from '../exp/expm1'log';\n\nconst { exp, expm1, log, log1p } = Math;\n\nfunction R_DT_qIv(lower_tail: boolean, log_p: boolean, p: number) {\n  return log_p ? (lower_tail ? exp(p) : -expm1(p)) : R_D_Lval(lower_tail, p);\n}\n\nfunction R_DT_CIv(lower_tail: boolean, log_p: boolean, p: number) {\n  return log_p ? (lower_tail ? -expm1(p) : exp(p)) : R_D_Cval(lower_tail, p);\n}\n\n/*\nexport function expm1(x: number) {\n\n    let y: number;\n    let a = fabs(x);\n\n    if (a < DBL_EPSILON) return x;\n    if (a > 0.697) return exp(x) - 1;  // negligible cancellation \n\n    if (a > 1e-8)\n        y = exp(x) - 1;\n    else // Taylor expansion, more accurate in this range \n        y = (x / 2 + 1) * x;\n\n    // Newton step for solving   log(1 + y) = x   for y : \n    // WARNING: does not work for y ~ -1: bug in 1.5.0 \n    y -= (1 + y) * (log1p(y) - x);\n    return y;\n}\n*/\n\nfunction R_D_LExp(log_p: boolean, x: number): number {\n  return log_p ? R_Log1_Exp(x) : log1p(-x);\n}\n\n// log(1 - exp(x))  in more stable form than log1p(- R_D_qIv(x)) :\nfunction R_Log1_Exp(x: number) {\n  if (x > -M_LN2) {\n    return log(-expm1(x));\n  }\n  return log1p(-exp(x));\n}\n\nfunction R_DT_Clog(lower_tail: boolean, log_p: boolean, p: number): number {\n  return lower_tail\n    ? R_D_LExp(log_p, p)\n    : R_D_log(log_p, p); /* log(1-p) in qF*/\n}\n\nfunction R_DT_log(lower_tail: boolean, log_p: boolean, p: number): number {\n  /* log(p) in qF */\n  return lower_tail ? R_D_log(log_p, p) : R_D_LExp(log_p, p);\n}\n\nexport { R_DT_qIv, R_DT_CIv, R_DT_log, R_DT_Clog, R_Log1_Exp, R_D_LExp };\n","/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nconst { max, abs, sign } = Math;\n\nimport * as debug from 'debug';\n\nconst printer_seq = debug('seq');\nconst precision9 = numberPrecision(9);\n\nexport function* seq_len({ length, base = 1 }: { length: number, base: number }): IterableIterator<number> {\n  for (let i = 0; i < length; i++) {\n    yield base + i;\n  };\n}\n\n\nexport const seq = (adjust = 0) => (adjustMin = adjust) => (\n  start: number,\n  end: number = 1,\n  step: number = 1\n): number[] => {\n  let s = start + adjust;\n  let e = end + adjust;\n  let cursor = s;\n\n  if (end < start) {\n    e = start + adjustMin;\n    s = end + adjustMin;\n    cursor = e;\n  }\n  // wow: Chrome and FireFox give\n  // 0.4+0.2 = 0.6000000000000001\n  // so we use precision to have it make sense\n  // sometimes rounding effects try something diff\n  step = abs(step) * sign(end - start);\n  printer_seq('step:%d', step);\n\n  const rc: number[] = [];\n\n  do {\n    rc.push(cursor);\n    cursor += step;\n  } while (precision9(cursor) >= s && precision9(cursor) <= e && step !== 0);\n\n  return precision9(rc) as any;\n};\n\nexport const sequenceFactory = (adjust = 0, adjustMin = adjust) => (start: number, end: number, delta = 1) => Array.from(lazySeq(start, end, delta, adjust, adjustMin))\n\nconst printer_lazy_seq = debug('lazySeq');\nexport function* lazySeq(start: number, end = 1, step = 1, adjust = -1, adjustMin = adjust) {\n  printer_lazy_seq(arguments);\n  if (step === 0) {\n    throw new TypeError(`argument 'delta' cannot be zero`)\n  }\n  if (end > start && step < 0) {\n    throw new TypeError(`'end' > 'start' so delta must be positive`);\n  }\n  if (end < start && step > 0) {\n    throw new TypeError(`'end' < 'start' so delta must be negative`);\n  }\n  const adj = step > 0 ? adjust : adjustMin;\n  do {\n    yield start + adj;\n    start = start + step;\n  } while ((step > 0 && start <= end) || (step < 0 && start >= end));\n}\n\n\nexport type strTypes = 'boolean' | 'number' | 'undefined' | 'string' | 'null' | 'symbol' | 'array' | 'function' | 'object';\nexport type system = boolean | number | undefined | string | null | symbol\n\nfunction _typeOf(v: any): strTypes {\n  if (v === null) return 'null';\n  if (v instanceof Array) return 'array';\n  if (v instanceof Function) return 'function';\n  const k = typeof v;\n  // @ts-ignore TS2322: Type '\"string\" | \"number\" | \"bigint\" | \"boolean\" | \"symbol\" | \"undefined\" | \"object\" | \"function\"' is not assignable to type 'strTypes'.\n  return k;\n}\n\nexport function* multiplexer(...rest: any[]): IterableIterator<any[]> {\n  //\n  // Analyze\n  //\n  const analyzed: _t[] = [];\n  type _t = boolean[] | number[] | undefined[] | string[] | null[] | symbol[] | Array<any>;\n\n  function simplePush<T extends _t>(v: T) { analyzed.push(v) };\n\n  const select = {\n    ['undefined'](v: null) { simplePush([v]); },\n    ['null'](v: null) { simplePush([v]); },\n    ['number'](v: null) { simplePush([v]); },\n    ['string'](v: string) { simplePush(v.split('')) },\n    ['boolean'](v: boolean) { simplePush([v]) },\n    ['array'](v: _t) { simplePush(v) },\n    ['object'](v: _t) { throw new Error('M001, Looping over properties not yet supported'); },\n    ['function'](v: _t) { throw new Error('M002, arguments of type \"function\" are not yet supported'); }\n  };\n\n  for (let k = 0; k < rest.length; k++) {\n    const arg = rest[k];\n    const to = _typeOf(arg);\n    const selector = select[to];\n    selector(arg);\n  }//for\n  // find the longest array\n  const _max = max(...analyzed.map(a => a.length));\n  for (let k = 0; k < _max; k++) {\n    const result: any[] = [];\n    for (let j = 0; j < analyzed.length; j++) {\n      const arr: any[] = analyzed[j];\n      const idx = k % arr.length;\n      result.push(arr[idx]);\n    }\n    yield result;\n  }\n}\n\nexport const c = chain(Array.from, flatten)\n\nexport function Rcycle(fn: Function) {\n  return function(...args: any[]) {\n    const gen = multiplexer(...args);\n    let rc: any[] = [];\n    for (const arg of gen) {\n      rc[rc.length] = fn(...arg);\n    }\n    return rc;\n  }\n}\n\nfunction isNumber(x: any): x is number {\n  return typeof x === 'number'\n}\n\nexport function numberPrecision(prec: number = 6) {\n  return function convert<T>(x: T): T {\n    // try to loop over the object\n    if (typeof x === 'object' && x !== null) {\n      for (const [prop, value] of Object.entries(x)) {\n        //recursion\n        x[prop] = convert(value);\n      }\n      return x;\n    }\n    // this is a number!!\n    if (isNumber(x)) {\n      x = Number.parseFloat(x.toPrecision(prec)) as any;\n    }\n    return x;\n  }\n}\n\nexport function sum(x: number[]) {\n  let sum = 0;\n  const gen = flatten(x);\n  for (let v = gen.next(); !v.done; v = gen.next()) {\n    sum += v.value;\n  }\n  return sum;\n}\n\nexport interface ISummary {\n  N: number; // number of samples in \"data\"\n  mu: number; // mean of \"data\"\n  population: {\n    variance: number, // population variance (data is seen as finite population)\n    sd: number // square root of the population variance\n  };\n  sample: {\n    variance: number, // sample variance (data is seen as a small sample from an very large population)\n    sd: number // square root of \"sample variance\"\n  };\n  relX; // = x-E(x)\n  relX2; // = ( x-E(x) )^2\n  stats: {\n    min: number, // minimal value from \"data\"\n    '1st Qu.': number, // 1st quantile from \"data\"\n    median: number, // median value from \"data\n    '3rd Qu.': number, // 3rd quantile from \"data\"\n    max: number // maximum value in data\n  };\n}\n/*\nexport function summary(x: number[]): ISummary {\n  if (!Array.isArray(x)) {\n    throw new Error(`Illigal argument, not an array`);\n  }\n  if (x.length === 0) {\n    throw new Error(`argument Array is empty`);\n  }\n  if (x.includes(NaN)) {\n    throw new Error(`argument Array has NaNs`);\n  }\n\n  const N = x.length;\n  const mu = sum(x) / N;\n  const relX = x.map(v => v - mu);\n  const relX2 = relX.map(v => v * v);\n  const sampleVariance = sum(relX2) / (N - 1);\n  const populationVariance = sampleVariance * (N - 1) / N;\n  const sampleSD = Math.sqrt(sampleVariance);\n  const populationSD = Math.sqrt(populationVariance);\n  // quantiles\n  const o = x.sort((a, b) => a - b);\n  const min = o[0];\n  const max = o[N - 1];\n  //isOdd?\n  const { q1, median, q3 } = (function () {\n    const i = [4, 2, 4 / 3].map(v => (N - 1) / v);\n    const q = i.map(index => {\n      const f1 = 1 - (index - floor(index));\n      const f2 = 1 - f1;\n      return o[trunc(index)] * f1 + o[trunc(index) + 1] * f2;\n    });\n    return {\n      q1: q[0],\n      median: q[1],\n      q3: q[2]\n    };\n  })();\n  return {\n    N,\n    mu,\n    population: {\n      variance: populationVariance,\n      sd: populationSD\n    },\n    sample: {\n      variance: sampleVariance,\n      sd: sampleSD\n    },\n    relX,\n    relX2,\n    stats: {\n      min,\n      '1st Qu.': q1,\n      median,\n      '3rd Qu.': q3,\n      max\n    }\n  };\n}\n\n// https://en.wikipedia.org/wiki/Welch%E2%80%93Satterthwaite_equation\n\nexport function Welch_Satterthwaite(s: number[], n: number[]): number {\n\n  const elts = s.map((_s, i) => _s * _s / n[i as number])\n  const dom = elts.map((e, i) => e * e / (n[i as number] - 1));\n\n  return Math.pow(sum(elts), 2) / sum(dom);\n}\n*/\n\nexport function randomGenHelper<T extends Function>(n: number | number[], fn: T, ...arg: any[]) {\n\n  let result: number[]\n\n  if (n === 0) {\n    return []\n  }\n  else if (n > 0) {\n    result = Array.from({ length: <number>n })\n  }\n  else if (n instanceof Array) {\n    result = n\n  }\n  else {\n    throw new TypeError(`n argument is not a number or a number array`)\n  }\n  for (let i = 0; i < result.length; i++) {\n    result[i] = fn(...arg)\n  }\n  return result\n}\n\nexport type Slicee<T> = {\n  [P in keyof T]: T[P]\n}\n\nexport type Sliced<T> = {\n  key: keyof T;\n  value: T[keyof T]\n}\n\nfunction slicer<T>(x: Slicee<T>): Sliced<T>[] {\n  const keys: (keyof T)[] = Object.keys(x) as any;\n  const map = keys.map(key => ({ key, value: x[key] }));\n  return map;\n}\n\nexport function map<T, S>(data: Slicee<T>): { (fn: (value: T[keyof T], idx: keyof T) => S): S[] } {\n  const fx = slicer(data);\n  return function k(fn) {\n    return fx.map(o => fn(o.value, o.key))\n  };\n}\n\nexport function each<T>(data: Slicee<T>): { (fn: (value: T[keyof T], idx: keyof T) => void): void } {\n  const fx = slicer(data);\n  return function k(fn) {\n    fx.forEach(o => fn(o.value, o.key));\n  };\n}\n\nexport function array_flatten<T = unknown>(...rest: (T | IterableIterator<T> | T[])[]) {\n  return Array.from(flatten(...rest));\n}\n\nexport function* flatten<T = unknown>(...rest: (T | IterableIterator<T> | T[])[]): IterableIterator<T> {\n\n  for (const itm of rest) {\n    if (itm === null || ['undefined', 'string', 'symbol', 'number', 'boolean'].includes(typeof itm)) {\n      // @ts-ignore\n      yield itm;\n      continue;\n    }\n    if (itm instanceof Map || itm instanceof Set) {\n      for (const v of <any>itm) {\n        yield* flatten.call(undefined, v);\n      }\n      continue;\n    }\n    if (itm instanceof Array) {\n      for (const v of itm) {\n        yield* flatten.call(undefined, v);\n      }\n      continue;\n    }\n    if (typeof itm[Symbol.iterator] === 'function') {\n      for (const v of <any>itm) {\n        yield* flatten.call(undefined, v);\n      }\n      continue;\n    }\n  }\n}\n\nexport function chain<F0 extends (...argv) => any, F extends (...argv) => any>(fn0: F0, ...fns: F[]) {\n  // @ts-ignore\n  fns.push(fn0);\n  if (fns.length === 0) {\n    throw new TypeError(`specifiy functions to chain`)\n  }\n  for (let i = 0; i < fns.length; i++) {\n    if (typeof fns[i] !== 'function') {\n      throw new TypeError(`argument ${i + 1} is not a function`)\n    }\n  }\n\n  return function(...args: Parameters<F>): ReturnType<F0> {\n    let lastArgs: unknown[] = args;\n    if (args)\n      for (let i = fns.length - 1; i >= 0; i--) {\n        const fn = fns[i]\n        lastArgs = [fn.apply(fn, lastArgs)]\n        //console.log(lastArgs);\n    }\n    return lastArgs[0] as ReturnType<F0>\n\n  }\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  fmod,\n  M_LN_SQRT_2PI, // no math alias for this\n  M_LN_SQRT_PId2,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR\n} from '../common/_general';\n\nimport { sinpi } from '../trigonometry';\nimport { gammafn } from './gamma_fn';\nimport { lgammacor } from './lgammacor';\n\nconst { isNaN: ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\nconst { log, abs: fabs, floor, trunc } = Math;\n\n\nconst printer_sign = debug('lgammafn_sign');\n\nconst xmax = 2.5327372760800758e305;\nconst dxrel = 1.490116119384765625e-8;\n\nexport function lgammafn_sign(x: number, sgn?: number[]): number {\n  let ans: number;\n  let y: number;\n  let sinpiy: number;\n\n  /*\n  #ifdef NOMORE_FOR_THREADS\n    static double xmax = 0.;\n    static double dxrel = 0.;\n \n    if (xmax == 0) {// initialize machine dependent constants _ONCE_ \n        xmax = d1mach(2) / log(d1mach(2));// = 2.533 e305\t for IEEE double \n        dxrel = sqrt(d1mach(4));// sqrt(Eps) ~ 1.49 e-8  for IEEE double \n    }\n    #else*/\n  // For IEEE double precision DBL_EPSILON = 2^-52 = 2.220446049250313e-16 :\n  //   xmax  = DBL_MAX / log(DBL_MAX) = 2^1024 / (1024 * log(2)) = 2^1014 / log(2)\n  //   dxrel = sqrt(DBL_EPSILON) = 2^-26 = 5^26 * 1e-26 (is *exact* below !)\n  //\n\n  if (sgn) sgn[0] = 1;\n\n  //#ifdef IEEE_754\n  if (ISNAN(x)) return x;\n  //#endif\n\n  if (sgn && x < 0 && fmod(floor(-x), 2) === 0) {\n    sgn[0] = -1;\n  }\n\n  if (x <= 0 && x === trunc(x)) {\n    /// Negative integer argument\n    ML_ERROR(ME.ME_RANGE, 'lgamma', printer_sign);\n    return ML_POSINF; // +Inf, since lgamma(x) = log|gamma(x)|\n  }\n\n  y = fabs(x);\n\n  if (y < 1e-306) return -log(y); // denormalized range, R change\n  if (y <= 10) return log(fabs(gammafn(x) as number));\n\n  //  ELSE  y = |x| > 10 ----------------------\n\n  if (y > xmax) {\n    ML_ERROR(ME.ME_RANGE, 'lgamma', printer_sign);\n    return ML_POSINF;\n  }\n\n  if (x > 0) {\n    // i.e. y = x > 10\n    //#ifdef IEEE_754\n    if (x > 1e17) return x * (log(x) - 1);\n    else if (x > 4934720) return M_LN_SQRT_2PI + (x - 0.5) * log(x) - x;\n    else return M_LN_SQRT_2PI + (x - 0.5) * log(x) - x + lgammacor(x);\n  }\n  // else: x < -10; y = -x\n  sinpiy = fabs(sinpi(y));\n\n  if (sinpiy === 0) {\n    // Negative integer argument ===\n    //Now UNNECESSARY: caught above\n    printer_sign(' ** should NEVER happen! *** [lgamma.c: Neg.int, y=%d]', y);\n    return ML_ERR_return_NAN(printer_sign);\n  }\n\n  ans = M_LN_SQRT_PId2 + (x - 0.5) * log(y) - x - log(sinpiy) - lgammacor(y);\n\n  if (fabs((x - Math.trunc(x - 0.5)) * ans / x) < dxrel) {\n    // The answer is less than half precision because\n    // the argument is too near a negative integer.\n\n    ML_ERROR(ME.ME_PRECISION, 'lgamma', printer_sign);\n  }\n\n  return ans;\n}\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nconst N = 624;\nconst M = 397;\n\nconst MATRIX_A = 0x9908b0df; /* constant vector a */\nconst UPPER_MASK = 0x80000000; /* most significant w-r bits */\nconst LOWER_MASK = 0x7fffffff; /* least significant r bits */\n\n/* Tempering parameters */\nconst TEMPERING_MASK_B = 0x9d2c5680;\nconst TEMPERING_MASK_C = 0xefc60000;\n//const TEMPERING_SHIFT_U = (y: number) => y >>> 11;\n//const TEMPERING_SHIFT_S = (y: number) => y << 7;\n//const TEMPERING_SHIFT_T = (y: number) => y << 15;\n//const TEMPERING_SHIFT_L = (y: number) => y >>> 18;\n\n\n\nimport { fixup } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst SEED_LEN = 625;\n\nexport class MersenneTwister extends IRNG {\n\n  private m_seed: Int32Array;\n  private mt: Int32Array;\n  private mti: number;\n\n  \n  private MT_sgenrand(seed: number) {\n\n    for (let i = 0; i < N; i++) {\n      this.mt[i] = seed & 0xffff0000;\n      seed = 69069 * seed + 1;\n      this.mt[i] |= (seed & 0xffff0000) >>> 16;\n      seed = 69069 * seed + 1;\n    }\n    this.mti = N;\n  }\n\n  private MT_genrand() {\n    let y = new Int32Array(1);\n    let mag01 = new Int32Array([0x0, MATRIX_A]);\n    /* mag01[x] = x * MATRIX_A  for x=0,1 */\n    // ran_x points to the common buffer\n    const dummy = this.m_seed;\n\n    this.mti = dummy[0];\n\n    if (this.mti >= N) {\n      /* generate N words at one time */\n      let kk;\n\n      if (this.mti === N + 1)\n        /* if sgenrand() has not been called, */\n        this.MT_sgenrand(4357); /* a default initial seed is used   */\n\n      for (kk = 0; kk < N - M; kk++) {\n        y[0] = (this.mt[kk] & UPPER_MASK) | (this.mt[kk + 1] & LOWER_MASK);\n        this.mt[kk] = this.mt[kk + M] ^ (y[0] >>> 1) ^ mag01[y[0] & 0x1];\n      }\n      for (; kk < N - 1; kk++) {\n        y[0] = (this.mt[kk] & UPPER_MASK) | (this.mt[kk + 1] & LOWER_MASK);\n        this.mt[kk] = this.mt[kk + (M - N)] ^ (y[0] >>> 1) ^ mag01[y[0] & 0x1];\n      }\n      y[0] = (this.mt[N - 1] & UPPER_MASK) | (this.mt[0] & LOWER_MASK);\n      this.mt[N - 1] = this.mt[M - 1] ^ (y[0] >>> 1) ^ mag01[y[0] & 0x1];\n\n      this.mti = 0;\n    }\n\n    y[0] = this.mt[this.mti++];\n    y[0] ^= y[0] >>> 11;\n    y[0] ^= (y[0] << 7) & TEMPERING_MASK_B;\n    y[0] ^= (y[0] << 15) & TEMPERING_MASK_C;\n    y[0] ^= y[0] >>> 18;\n    dummy[0] = this.mti;\n\n    return (\n      new Uint32Array(y.buffer)[0] * 2.3283064365386963e-10\n    ); /* reals: [0,1)-interval */\n  }\n\n  private fixupSeeds(): void {\n    const s = this.m_seed;\n    s[0] = 624;\n    /* No action unless user has corrupted .Random.seed */\n    if (s[0] <= 0) s[0] = 624;\n    /* check for all zeroes */\n    // note mt is equal to s.slice(1)\n    if (this.mt.find(v => !!v) === undefined) {\n      this.init(timeseed());\n    }\n    return;\n  }\n\n  constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n  public _setup() {\n    const buf = new ArrayBuffer(SEED_LEN * 4);\n    this._kind = IRNGType.MERSENNE_TWISTER;\n    this._name = 'Mersenne-Twister';\n    this.m_seed = new Int32Array(buf).fill(0);\n    this.mt = new Int32Array(buf, 4);\n    this.mti = N + 1;\n  }\n\n  public init(_seed: number =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Uint32Array([0]);\n    s[0] = _seed;\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    for (let j = 0; j < this.m_seed.length; j++) {\n      s[0] = 69069 * s[0] + 1;\n      this.m_seed[j] = s[0];\n    }\n    this.fixupSeeds();\n    super.init(_seed);\n  }\n\n  public internal_unif_rand(): number {\n     \n    let rc = this.MT_genrand();\n    return fixup(rc);\n    \n  }\n\n  public set seed(_seed: number[]) {\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport { BuggyKindermanRamage } from './buggy-kinderman-ramage';\nexport { BoxMuller } from './box-muller';\nexport { AhrensDieter} from './ahrens_dieter';\nexport { Inversion } from './inversion';\nexport { KindermanRamage }  from './kinderman-ramage';\nexport { IRNGNormal } from './inormal-rng';\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\nimport { R_DT_CIv, R_DT_qIv } from '../exp/expm1';\n\nconst printer = debug('qnorm');\n\nconst { isNaN: ISNAN } = Number;\nconst { log, sqrt, abs: fabs } = Math;\nconst ML_NEGINF = -Infinity;\nconst ML_POSINF = Infinity;\n\nexport function qnorm(\n  p: number,\n  mu: number = 0,\n  sigma: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n  let q;\n  let p_;\n\n  let r;\n  let val;\n\n  \n    if (ISNAN(p) || ISNAN(mu) || ISNAN(sigma)) return p + mu + sigma;\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, ML_NEGINF, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n    if (sigma < 0) return ML_ERR_return_NAN(printer);\n    if (sigma === 0) return mu;\n\n    p_ = R_DT_qIv(lower_tail, log_p, p); /* real lower_tail prob. p */\n    q = p_ - 0.5;\n\n    printer(\n      'qnorm(p=%d, m=%d, s=%d, l.t.= %s, log= %s): q = %d',\n      p,\n      mu,\n      sigma,\n      lower_tail,\n      log_p,\n      q\n    );\n\n    /*-- use AS 241 --- */\n    /* double ppnd16_(double *p, long *ifault)*/\n    /*      ALGORITHM AS241  APPL. STATIST. (1988) VOL. 37, NO. 3\n    \n            Produces the normal deviate Z corresponding to a given lower\n            tail area of P; Z is accurate to about 1 part in 10**16.\n    \n            (original fortran code used PARAMETER(..) for the coefficients\n             and provided hash codes for checking them...)\n    */\n    if (fabs(q) <= 0.425) {\n      /* 0.075 <= p <= 0.925 */\n      r = 0.180625 - q * q;\n      val =\n        q *\n        (((((((r * 2509.0809287301226727 + 33430.575583588128105) * r +\n          67265.770927008700853) *\n          r +\n          45921.953931549871457) *\n          r +\n          13731.693765509461125) *\n          r +\n          1971.5909503065514427) *\n          r +\n          133.14166789178437745) *\n          r +\n          3.387132872796366608) /\n        (((((((r * 5226.495278852854561 + 28729.085735721942674) * r +\n          39307.89580009271061) *\n          r +\n          21213.794301586595867) *\n          r +\n          5394.1960214247511077) *\n          r +\n          687.1870074920579083) *\n          r +\n          42.313330701600911252) *\n          r +\n          1);\n    } else {\n      /* closer than 0.075 from {0,1} boundary */\n\n      /* r = min(p, 1-p) < 0.075 */\n      if (q > 0) r = R_DT_CIv(lower_tail, log_p, p); /* 1-p */\n      else r = p_; /* = R_DT_Iv(p) ^=  p */\n\n      r = sqrt(\n        -(log_p && ((lower_tail && q <= 0) || (!lower_tail && q > 0))\n          ? p\n          : /* else */ log(r))\n      );\n      /* r = sqrt(-log(r))  <==>  min(p, 1-p) = exp( - r^2 ) */\n\n      printer('close to 0 or 1: r = %7d', r);\n\n      if (r <= 5) {\n        /* <==> min(p,1-p) >= exp(-25) ~= 1.3888e-11 */\n        r += -1.6;\n        val =\n          (((((((r * 7.7454501427834140764e-4 + 0.0227238449892691845833) * r +\n            0.24178072517745061177) *\n            r +\n            1.27045825245236838258) *\n            r +\n            3.64784832476320460504) *\n            r +\n            5.7694972214606914055) *\n            r +\n            4.6303378461565452959) *\n            r +\n            1.42343711074968357734) /\n          (((((((r * 1.05075007164441684324e-9 + 5.475938084995344946e-4) * r +\n            0.0151986665636164571966) *\n            r +\n            0.14810397642748007459) *\n            r +\n            0.68976733498510000455) *\n            r +\n            1.6763848301838038494) *\n            r +\n            2.05319162663775882187) *\n            r +\n            1);\n      } else {\n        /* very close to  0 or 1 */\n        r += -5;\n        val =\n          (((((((r * 2.01033439929228813265e-7 + 2.71155556874348757815e-5) *\n            r +\n            0.0012426609473880784386) *\n            r +\n            0.026532189526576123093) *\n            r +\n            0.29656057182850489123) *\n            r +\n            1.7848265399172913358) *\n            r +\n            5.4637849111641143699) *\n            r +\n            6.6579046435011037772) /\n          (((((((r * 2.04426310338993978564e-15 + 1.4215117583164458887e-7) *\n            r +\n            1.8463183175100546818e-5) *\n            r +\n            7.868691311456132591e-4) *\n            r +\n            0.0148753612908506148525) *\n            r +\n            0.13692988092273580531) *\n            r +\n            0.59983220655588793769) *\n            r +\n            1);\n      }\n\n      if (q < 0.0) val = -val;\n      /* return (q >= 0.)? r : -r ;*/\n    }\n    return mu + sigma * val;\n  \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport { Toms708 } from './toms708';\nexport { NumberW } from './NumberW';\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNGType } from './irng-type';\n\nexport type MessageType = 'INIT';\n\n// make sure sub-class is follow this\n// tslint:disable-next-line: class-name\nexport interface IRNG_CORE {\n  unif_rand(n?: number): number[];\n  internal_unif_rand(): number;\n}\n\nexport interface IRNG extends IRNG_CORE {\n\n}\n\nexport abstract class IRNG {\n  protected _name: string;\n  protected _kind: IRNGType;\n\n  private notify: Set<{ event: MessageType, handler: () => void }>;\n\n  constructor(_seed: number) {\n    this.notify = new Set();\n    this.emit = this.emit.bind(this);\n    this.register = this.register.bind(this);\n    this.unif_rand = this.unif_rand.bind(this);\n    this.internal_unif_rand = this.internal_unif_rand.bind(this);\n    this.init = this.init.bind(this);\n    this._setup();\n    this.init(_seed);\n  }\n\n  public get name() {\n    return this._name;\n  }\n\n  public get kind() {\n    return this._kind;\n  }\n\n  public abstract _setup(): void;\n\n  public init(_seed: number): void {\n    this.emit('INIT');\n  }\n\n  public abstract set seed(_seed: number[]);\n  public unif_rand(n: number = 1): number[] {\n    n = (!n || n < 0) ? 1 : n;\n    return Array.from({length:n}).map(() => this.internal_unif_rand());\n  }\n\n  // @ts-ignore\n  abstract internal_unif_rand(): number;\n\n  public abstract get seed(): number[];\n  // event stuff\n  public register(event: MessageType, handler: () => void) {\n    this.notify.add({ event, handler });\n  }\n\n  public emit(event: MessageType) {\n    this.notify.forEach(r => {\n      if (r.event === event) {\n        r.handler();\n      }\n    });\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nconst { trunc, ceil, min, log2, pow } = Math;\nconst { now } = Date;\n\nexport function timeseed() {\n  const n = now();\n  //delay 0.5 sec\n  do {\n    now(); // consume cpu, do something silly\n  } while (now() - n < 500);\n\n  // how many bits?\n  const nBits = min(32, ceil(log2(n)));\n  const lowBits = trunc(nBits / 2);\n  const hi = trunc(n / pow(2, lowBits));\n  const lo = n - hi * pow(2, lowBits);\n  //\n  // create 32 bit array\n  const buf = new ArrayBuffer(4);\n  const reverser = new Uint8Array(buf);\n  const uint32 = new Uint32Array(buf);\n  uint32[0] = lo ^ hi; // little endian, highest order bytes has lowest indexes so\n  // reverse order of bytes, milliseconds changes the fastest in a time\n  reverser.reverse();\n  return uint32[0];\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1 } from '../common/_general';\nimport { NumberW, Toms708 } from '../common/toms708';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { LN2: M_LN2, log } = Math;\n\nconst printer_pbeta_raw = debug('pbeta_raw');\n\nexport function pbeta_raw(\n  x: number,\n  a: number,\n  b: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  // treat limit cases correctly here:\n  if (a === 0 || b === 0 || !R_FINITE(a) || !R_FINITE(b)) {\n    // NB:  0 < x < 1 :\n    if (a === 0 && b === 0)\n      // point mass 1/2 at each of {0,1} :\n      return log_p ? -M_LN2 : 0.5;\n    if (a === 0 || a / b === 0)\n      // point mass 1 at 0 ==> P(X <= x) = 1, all x > 0\n      return R_DT_1(lower_tail, log_p);\n    if (b === 0 || b / a === 0)\n      // point mass 1 at 1 ==> P(X <= x) = 0, all x < 1\n      return R_DT_0(lower_tail, log_p);\n    // else, remaining case:  a = b = Inf : point mass 1 at 1/2\n    if (x < 0.5) return R_DT_0(lower_tail, log_p);\n    else return R_DT_1(lower_tail, log_p);\n  }\n  // Now:  0 < a < Inf;  0 < b < Inf\n  let x1 = 0.5 - x + 0.5;\n  let w: NumberW = new NumberW(0);\n  let wc: NumberW = new NumberW(0);\n  let ierr: NumberW = new NumberW(0);\n  //====\n  //Toms708.bratio(a, b, x, x1, &w, &wc, &ierr, log_p); /* -> ./toms708.c */\n  printer_pbeta_raw(\n    'before Toms708.bratio, a=%d, b=%d, x=%d, w=%d,wc=%d, ierr=%d',\n    a,\n    b,\n    x,\n    w.val,\n    wc.val,\n    ierr.val\n  );\n  Toms708.bratio(a, b, x, x1, w, wc, ierr); /* -> ./toms708.c */\n  printer_pbeta_raw(\n    'after Toms708.bratio, a=%d, b=%d, x=%d, w=%d,wc=%d, ierr=%d',\n    a,\n    b,\n    x,\n    w.val,\n    wc.val,\n    ierr.val\n  );\n  //====\n  // ierr in {10,14} <==> bgrat() error code ierr-10 in 1:4; for 1 and 4, warned *there*\n  if (ierr.val && ierr.val !== 11 && ierr.val !== 14)\n    printer_pbeta_raw(\n      'pbeta_raw(%d, a=%d, b=%d, ..) -> bratio() gave error code %d',\n      x,\n      a,\n      b,\n      ierr\n    );\n  if (log_p) {\n    w.val = log(w.val);\n    wc.val = log(wc.val);\n  }\n  return lower_tail ? w.val : wc.val;\n} /* pbeta_raw() */\n\nconst printer_pbeta = debug('pbeta');\n\nexport function pbeta(\n  q: number,\n  a: number,\n  b: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  \n    printer_pbeta(\n      'pbeta(q=%d, a=%d, b=%d, l.t=%s, ln=%s)',\n      q,\n      a,\n      b,\n      lowerTail,\n      logP\n    );\n    if (ISNAN(q) || ISNAN(a) || ISNAN(b)) return NaN;\n\n    if (a < 0 || b < 0) return ML_ERR_return_NAN(printer_pbeta);\n    // allowing a==0 and b==0  <==> treat as one- or two-point mass\n\n    if (q <= 0) return R_DT_0(lowerTail, logP);\n    if (q >= 1) return R_DT_1(lowerTail, logP);\n\n    return pbeta_raw(q, a, b, lowerTail, logP);\n \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { rgammaOne } from '../gamma/rgamma';\nimport { randomGenHelper } from '../r-func'\nimport { IRNGNormal } from '../rng/normal/inormal-rng';\n\nconst { isFinite: R_FINITE } = Number;\nconst printer = debug('rchisq');\n\nexport function rchisq(\n  n: number | number[],\n  df: number,\n  rng: IRNGNormal\n): number[] {\n  return randomGenHelper(n, rchisqOne, df, rng);\n}\n\nexport function rchisqOne(\n  df: number,\n  rng: IRNGNormal\n): number {\n  if (!R_FINITE(df) || df < 0.0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  return rgammaOne(df / 2.0, 2.0, rng);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport enum IRNGType {\n    WICHMANN_HILL = 0,\n    MARSAGLIA_MULTICARRY,\n    SUPER_DUPER,\n    MERSENNE_TWISTER,\n    KNUTH_TAOCP,\n    KNUTH_TAOCP2002,\n    LECUYER_CMRG\n}\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../';\nimport { randomGenHelper } from '../../r-func';\nimport { IRNG_CORE } from '../irng';\n\n// make sure sub-class is follow this\nexport interface IRNGNormal extends IRNG_CORE {\n  norm_rand(n: number): number[];\n}\n\nexport abstract class IRNGNormal {\n  protected rng: IRNG;\n  constructor(_rng: IRNG) {\n    this.rng = _rng;\n    this.unif_rand = this.unif_rand.bind(this);\n    this.norm_rand = this.norm_rand.bind(this);\n    this.internal_norm_rand = this.internal_norm_rand.bind(this);\n    this.internal_unif_rand = this.internal_unif_rand.bind(this);\n  }\n\n  public norm_randOne() {\n    return this.internal_norm_rand()\n  }\n\n  public norm_rand(n: number): number[]{\n    n = !n || n < 0 ? 1 : n;\n    return randomGenHelper(n, this.internal_norm_rand)//; : map(seq()()(n))(() => this.internal_norm_rand());\n  }\n\n  protected abstract internal_norm_rand(): number;\n\n  public unif_rand(n: number = 1): number[] {\n     return this.rng.unif_rand(n);\n  }\n\n  public internal_unif_rand() {\n    return this.rng.internal_unif_rand();\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { M_LN_SQRT_2PI, ML_ERR_return_NAN } from '../common/_general';\n\nimport { gammafn } from '../gamma/gamma_fn';\nimport { lgammacor } from '../gamma/lgammacor';\nimport { lgammafn_sign } from '../gamma/lgammafn_sign';\n\n\nconst { log, log1p } = Math;\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF\n} = Number;\n\nconst printer = debug('lbeta');\n\nexport function lbeta(a: number, b: number): number {\n  let corr: number;\n  let p: number;\n  let q: number;\n\n  if (ISNAN(a) || ISNAN(b)) return a + b;\n  p = q = a;\n  if (b < p) p = b; // := min(a,b)\n  if (b > q) q = b; // := max(a,b)\n\n  // both arguments must be >= 0\n  if (p < 0) return ML_ERR_return_NAN(printer);\n  else if (p === 0) {\n    return ML_POSINF;\n  } else if (!R_FINITE(q)) {\n    // q == +Inf\n    return ML_NEGINF;\n  }\n\n  if (p >= 10) {\n    // p and q are big.\n    corr = lgammacor(p) + lgammacor(q) - lgammacor(p + q);\n    return (\n      log(q) * -0.5 +\n      M_LN_SQRT_2PI +\n      corr +\n      (p - 0.5) * log(p / (p + q)) +\n      q * log1p(-p / (p + q))\n    );\n  } else if (q >= 10) {\n    // p is small, but q is big.\n    corr = lgammacor(q) - lgammacor(p + q);\n    return (\n      lgammafn_sign(p) +\n      corr +\n      p -\n      p * log(p + q) +\n      (q - 0.5) * log1p(-p / (p + q))\n    );\n  } else {\n    // p and q are small: p <= q < 10.\n    // R change for very small args\n\n    //NOTE FROM JACOB, funny how only p is tested and not q?? doesnt make sense\n    //  since the beta function is \"symetric\" for p and q aka beta(p,q) = beta (q,p)\n\n    // removed  if (p < 1e-306) return lgamma(p) + (lgamma(q) - lgamma(p+q));\n    //else\n    return log(gammafn(p) * (gammafn(q) / gammafn(p + q)));\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  M_LN_2PI,\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D__1,\n  R_D_exp,\n  R_D_negInonint,\n  R_D_nonint_check\n} from '../common/_general';\nimport { bd0 } from '../deviance';\n\nimport { stirlerr } from '../stirling';\n\nconst { log, log1p, round: R_forceint } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('dbinom');\n\nexport function dbinom_raw(\n  x: number,\n  n: number,\n  p: number,\n  q: number,\n  give_log: boolean\n): number {\n  let lf: number;\n  let lc: number;\n\n  if (p === 0) return x === 0 ? R_D__1(give_log) : R_D__0(give_log);\n  if (q === 0) return x === n ? R_D__1(give_log) : R_D__0(give_log);\n\n  if (x === 0) {\n    if (n === 0) return R_D__1(give_log);\n    let lc = p < 0.1 ? -bd0(n, n * q) - n * p : n * log(q);\n    return R_D_exp(give_log, lc);\n  }\n\n  if (x === n) {\n    lc = q < 0.1 ? -bd0(n, n * p) - n * q : n * log(p);\n    return R_D_exp(give_log, lc);\n  }\n\n  if (x < 0 || x > n) return R_D__0(give_log);\n\n  /* n*p or n*q can underflow to zero if n and p or q are small.  This\n       used to occur in dbeta, and gives NaN as from R 2.3.0.  */\n  lc =\n    stirlerr(n) -\n    stirlerr(x) -\n    stirlerr(n - x) -\n    bd0(x, n * p) -\n    bd0(n - x, n * q);\n\n  /* f = (M_2PI*x*(n-x))/n; could overflow or underflow */\n  /* Upto R 2.7.1:\n     * lf = log(M_2PI) + log(x) + log(n-x) - log(n);\n     * -- following is much better for  x << n : */\n  lf = M_LN_2PI + log(x) + log1p(-x / n);\n\n  return R_D_exp(give_log, lc - 0.5 * lf);\n}\n\nexport function dbinom(\n  x: number,\n  n: number,\n  p: number,\n  logX: boolean = false\n): number {\n     /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(n) || ISNAN(p)) return x + n + p;\n\n    if (p < 0 || p > 1 || R_D_negInonint(n)) return ML_ERR_return_NAN(printer);\n    R_D_nonint_check(logX, x, printer);\n    if (x < 0 || !R_FINITE(x)) return R_D__0(logX);\n\n    n = R_forceint(n);\n    x = R_forceint(x);\n\n    return dbinom_raw(x, n, p, 1 - p, logX);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nexport const i2_32m1 = 2.328306437080797e-10;\n\nexport function fixup(x: number) {\n  /* ensure 0 and 1 are never returned */\n  if (x <= 0.0) return 0.5 * i2_32m1;\n  if (1.0 - x <= 0.0) return 1.0 - 0.5 * i2_32m1;\n  return x;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  DBL_MAX_EXP,\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D__1,\n  R_D_exp,\n  R_DT_0,\n  R_DT_1,\n  R_P_bounds_01\n} from '../common/_general';\n\nimport { R_Log1_Exp } from '../exp/expm1';\nimport { dnorm4 as dnorm } from '../normal/dnorm';\nimport { pnorm5 as pnorm } from '../normal/pnorm';\nimport { dpois_raw } from '../poisson/dpois';\nimport { lgammafn_sign as lgammafn } from './lgammafn_sign';\n//import { logspace_add } from './logspace-add';\n\nconst {\n  LN2: M_LN2,\n  log1p,\n  expm1,\n  sqrt,\n  floor,\n  pow,\n  log,\n  exp,\n  max: fmax2,\n  abs: fabs\n} = Math;\nconst {\n  isNaN: ISNAN,\n  MIN_VALUE: DBL_MIN,\n  EPSILON: DBL_EPSILON,\n  isFinite: R_FINITE,\n  // NEGATIVE_INFINITY: ML_NEGINF,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst { isArray } = Array;\nconst sqr = (x: number) => x * x;\nconst scalefactor = sqr(sqr(sqr(4294967296.0)));\n\n/* If |x| > |k| * M_cutoff,  then  log[ exp(-x) * k^x ]\t =~=  -x */\nconst M_cutoff = M_LN2 * DBL_MAX_EXP / DBL_EPSILON; /*=3.196577e18*/\n\n/* Continued fraction for calculation of\n *    1/i + x/(i+d) + x^2/(i+2*d) + x^3/(i+3*d) + ... = sum_{k=0}^Inf x^k/(i+k*d)\n *\n * auxilary in log1pmx() and lgamma1p()\n */\nfunction logcf(\n  x: number,\n  i: number,\n  d: number,\n  eps: number /* ~ relative tolerance */\n) {\n  let c1 = 2 * d;\n  let c2 = i + d;\n  let c4 = c2 + d;\n  let a1 = c2;\n  let b1 = i * (c2 - i * x);\n  let b2 = d * d * x;\n  let a2 = c4 * c2 - b2;\n  /*\n  #if 0\n      assert (i > 0);\n      assert (d >= 0);\n  #endif\n  */\n  b2 = c4 * b1 - i * b2;\n\n  while (fabs(a2 * b1 - a1 * b2) > fabs(eps * b1 * b2)) {\n    let c3 = c2 * c2 * x;\n    c2 += d;\n    c4 += d;\n    a1 = c4 * a2 - c3 * a1;\n    b1 = c4 * b2 - c3 * b1;\n\n    c3 = c1 * c1 * x;\n    c1 += d;\n    c4 += d;\n    a2 = c4 * a1 - c3 * a2;\n    b2 = c4 * b1 - c3 * b2;\n\n    if (fabs(b2) > scalefactor) {\n      a1 /= scalefactor;\n      b1 /= scalefactor;\n      a2 /= scalefactor;\n      b2 /= scalefactor;\n    } else if (fabs(b2) < 1 / scalefactor) {\n      a1 *= scalefactor;\n      b1 *= scalefactor;\n      a2 *= scalefactor;\n      b2 *= scalefactor;\n    }\n  }\n\n  return a2 / b2;\n}\n\n/* Accurate calculation of log(1+x)-x, particularly for small x.  */\nfunction log1pmx(x: number) {\n  const minLog1Value = -0.79149064;\n\n  if (x > 1 || x < minLog1Value) return log1p(x) - x;\n  else {\n    /* -.791 <=  x <= 1  -- expand in  [x/(2+x)]^2 =: y :\n      * log(1+x) - x =  x/(2+x) * [ 2 * y * S(y) - x],  with\n      * ---------------------------------------------\n      * S(y) = 1/3 + y/5 + y^2/7 + ... = \\sum_{k=0}^\\infty  y^k / (2k + 3)\n     */\n    let r = x / (2 + x);\n    let y = r * r;\n    if (fabs(x) < 1e-2) {\n      let two = 2;\n      return (\n        r * ((((two / 9 * y + two / 7) * y + two / 5) * y + two / 3) * y - x)\n      );\n    } else {\n      let tol_logcf = 1e-14;\n      return r * (2 * y * logcf(y, 3, 2, tol_logcf) - x);\n    }\n  }\n}\n\n/* Compute  log(gamma(a+1))  accurately also for small a (0 < a < 0.5). */\nexport function lgamma1p(a: number) {\n  const eulers_const = 0.5772156649015328606065120900824024;\n\n  /* coeffs[i] holds (zeta(i+2)-1)/(i+2) , i = 0:(N-1), N = 40 : */\n  const N = 40;\n  const coeffs = [\n    0.3224670334241132182362075833230126 /* = (zeta(2)-1)/2 */,\n    0.6735230105319809513324605383715e-1 /* = (zeta(3)-1)/3 */,\n    0.2058080842778454787900092413529198e-1,\n    0.7385551028673985266273097291406834e-2,\n    0.2890510330741523285752988298486755e-2,\n    0.1192753911703260977113935692828109e-2,\n    0.5096695247430424223356548135815582e-3,\n    0.2231547584535793797614188036013401e-3,\n    0.994575127818085337145958900319017e-4,\n    0.4492623673813314170020750240635786e-4,\n    0.2050721277567069155316650397830591e-4,\n    0.9439488275268395903987425104415055e-5,\n    0.4374866789907487804181793223952411e-5,\n    0.2039215753801366236781900709670839e-5,\n    0.9551412130407419832857179772951265e-6,\n    0.4492469198764566043294290331193655e-6,\n    0.2120718480555466586923135901077628e-6,\n    0.1004322482396809960872083050053344e-6,\n    0.476981016936398056576019341724673e-7,\n    0.2271109460894316491031998116062124e-7,\n    0.1083865921489695409107491757968159e-7,\n    0.5183475041970046655121248647057669e-8,\n    0.2483674543802478317185008663991718e-8,\n    0.119214014058609120744254820277464e-8,\n    0.5731367241678862013330194857961011e-9,\n    0.2759522885124233145178149692816341e-9,\n    0.1330476437424448948149715720858008e-9,\n    0.6422964563838100022082448087644648e-10,\n    0.3104424774732227276239215783404066e-10,\n    0.1502138408075414217093301048780668e-10,\n    0.7275974480239079662504549924814047e-11,\n    0.3527742476575915083615072228655483e-11,\n    0.1711991790559617908601084114443031e-11,\n    0.8315385841420284819798357793954418e-12,\n    0.4042200525289440065536008957032895e-12,\n    0.1966475631096616490411045679010286e-12,\n    0.9573630387838555763782200936508615e-13,\n    0.4664076026428374224576492565974577e-13,\n    0.2273736960065972320633279596737272e-13,\n    0.1109139947083452201658320007192334e-13 /* = (zeta(40+1)-1)/(40+1) */\n  ];\n\n  const c = 0.2273736845824652515226821577978691e-12; /* zeta(N+2)-1 */\n  const tol_logcf = 1e-14;\n  let lgam;\n  let i;\n\n  if (fabs(a) >= 0.5) return lgammafn(a + 1);\n\n  /* Abramowitz & Stegun 6.1.33 : for |x| < 2,\n   * <==> log(gamma(1+x)) = -(log(1+x) - x) - gamma*x + x^2 * \\sum_{n=0}^\\infty c_n (-x)^n\n   * where c_n := (Zeta(n+2) - 1)/(n+2)  = coeffs[n]\n   *\n   * Here, another convergence acceleration trick is used to compute\n   * lgam(x) :=  sum_{n=0..Inf} c_n (-x)^n\n   */\n  lgam = c * logcf(-a / 2, N + 2, 1, tol_logcf);\n  for (i = N - 1; i >= 0; i--) lgam = coeffs[i] - a * lgam;\n\n  return (a * lgam - eulers_const) * a - log1pmx(a);\n} /* lgamma1p */\n\n/*\n * Compute the; log of a sum from logs of terms, i.e.,\n *\n *     log (sum_i  exp (logx[i]) ) =\n *     log (e ^M * sum_i  e ^ (logx[i] - M) ) =\n *     M + log( sum_i  e ^ (logx[i] - M)\n *\n * without causing overflows or throwing much accuracy.\n * /\n\nfunction logspace_sum(logx: number[], n: number): number {\n  if (n === 0) return ML_NEGINF; // = log( sum(<empty>) )\n  if (n === 1) return logx[0];\n  if (n === 2) return logspace_add(logx[0], logx[1]);\n  // else (n >= 3) :\n  let i;\n  // Mx := max_i log(x_i)\n  let Mx = logx[0];\n  for (i = 1; i < n; i++) if (Mx < logx[i]) Mx = logx[i];\n  let s = 0;\n  for (i = 0; i < n; i++) s += exp(logx[i] - Mx);\n  return Mx + log(s);\n};\n\n// log(1 - exp(x))  in more stable form than log1p(- R_D_qIv(x)) :\n/*export function R_Log1_Exp(x: number): number {\n  return (\n    x > -M_LN2 ? log(-expm1(x)) : log1p(-exp(x)));\n}*/\n/* dpois_wrap (x__1, lambda) := dpois(x__1 - 1, lambda);  where\n * dpois(k, L) := exp(-L) L^k / gamma(k+1)  {the usual Poisson probabilities}\n *\n * and  dpois*(.., give_log = TRUE) :=  log( dpois*(..) )\n*/\nconst pr_dpois_wrap = debug('dpois_wrap');\n\nfunction dpois_wrap(\n  x_plus_1: number,\n  lambda: number,\n  give_log: boolean\n): number {\n  pr_dpois_wrap(\n    'dpois_wrap(x+1=%d, lambda=%d, log=%s)',\n    x_plus_1,\n    lambda,\n    give_log\n  );\n\n  if (!R_FINITE(lambda)) {\n    return R_D__0(give_log);\n  }\n  if (x_plus_1 > 1) return dpois_raw(x_plus_1 - 1, lambda, give_log);\n  if (lambda > fabs(x_plus_1 - 1) * M_cutoff)\n    return R_D_exp(give_log, -lambda - lgammafn(x_plus_1));\n  else {\n    let d = dpois_raw(x_plus_1, lambda, give_log);\n    pr_dpois_wrap('  -> d=dpois_raw(..)=%d', d);\n    return give_log ? d + log(x_plus_1 / lambda) : d * (x_plus_1 / lambda);\n  }\n}\n\n/*\n * Abramowitz and Stegun 6.5.29 [right]\n */\nconst pr_pgamma_smallx = debug('pgamma_smallx');\n\nfunction pgamma_smallx(\n  x: number,\n  alph: number,\n  lowerTail: boolean,\n  logP: boolean\n): number {\n  let sum = 0;\n  let c = alph;\n  let n = 0;\n  let term;\n\n  pr_pgamma_smallx(' pg_smallx(x=%d, alph=%d): ', x, alph);\n\n  /*\n   * Relative to 6.5.29 all terms have been multiplied by alph\n   * and the first, thus being 1, is omitted.\n   */\n\n  do {\n    n++;\n    c *= -x / n;\n    term = c / (alph + n);\n    sum += term;\n  } while (fabs(term) > DBL_EPSILON * fabs(sum));\n\n  pr_pgamma_smallx('%d terms --> conv.sum=%d;', n, sum);\n  if (lowerTail) {\n    let f1 = logP ? log1p(sum) : 1 + sum;\n    let f2;\n    if (alph > 1) {\n      f2 = dpois_raw(alph, x, logP);\n      f2 = logP ? f2 + x : f2 * exp(x);\n    } else if (logP) f2 = alph * log(x) - lgamma1p(alph);\n    else f2 = pow(x, alph) / exp(lgamma1p(alph));\n\n    pr_pgamma_smallx(' (f1,f2)= (%d,%d)', f1, f2);\n    return logP ? f1 + f2 : f1 * f2;\n  } else {\n    let lf2 = alph * log(x) - lgamma1p(alph);\n    pr_pgamma_smallx(' 1:%d  2:%d', alph * log(x), lgamma1p(alph));\n    pr_pgamma_smallx(' sum=%d  log(1+sum)=%d\t lf2=%d', sum, log1p(sum), lf2);\n\n    if (logP) return R_Log1_Exp(log1p(sum) + lf2);\n    else {\n      let f1m1 = sum;\n      let f2m1 = expm1(lf2);\n      return -(f1m1 + f2m1 + f1m1 * f2m1);\n    }\n  }\n} /* pgamma_smallx() */\n\nfunction pd_upper_series(x: number, y: number, logP: boolean): number {\n  let term = x / y;\n  let sum = term;\n\n  do {\n    y++;\n    term *= x / y;\n    sum += term;\n  } while (term > sum * DBL_EPSILON);\n\n  /* sum =  \\sum_{n=1}^ oo  x^n     / (y*(y+1)*...*(y+n-1))\n   *\t   =  \\sum_{n=0}^ oo  x^(n+1) / (y*(y+1)*...*(y+n))\n   *\t   =  x/y * (1 + \\sum_{n=1}^oo\tx^n / ((y+1)*...*(y+n)))\n   *\t   ~  x/y +  o(x/y)   {which happens when alph -> Inf}\n   */\n  return logP ? log(sum) : sum;\n}\n\n/* Continued fraction for calculation of\n *    scaled upper-tail F_{gamma}\n *  ~=  (y / d) * [1 +  (1-y)/d +  O( ((1-y)/d)^2 ) ]\n */\nconst pr_pd_lower_cf = debug('pd_lower_cf');\n\nfunction pd_lower_cf(y: number, d: number): number {\n  let f = 0.0; /* -Wall */\n  let of;\n  let f0;\n  let i;\n  let c2;\n  let c3;\n  let c4;\n  let a1;\n  let b1;\n  let a2;\n  let b2;\n\n  const max_it = 200000;\n\n  pr_pd_lower_cf('pd_lower_cf(y=%d, d=%d)', y, d);\n\n  if (y === 0) return 0;\n\n  f0 = y / d;\n  /* Needed, e.g. for  pgamma(10^c(100,295), shape= 1.1, log=TRUE): */\n  if (fabs(y - 1) < fabs(d) * DBL_EPSILON) {\n    /* includes y < d = Inf */\n    pr_pd_lower_cf(' very small \"y\" -> returning (y/d)');\n    return f0;\n  }\n\n  if (f0 > 1) f0 = 1;\n  c2 = y;\n  c4 = d; /* original (y,d), *not* potentially scaled ones!*/\n\n  a1 = 0;\n  b1 = 1;\n  a2 = y;\n  b2 = d;\n\n  while (b2 > scalefactor) {\n    a1 /= scalefactor;\n    b1 /= scalefactor;\n    a2 /= scalefactor;\n    b2 /= scalefactor;\n  }\n\n  i = 0;\n  of = -1; /* far away */\n  while (i < max_it) {\n    i++;\n    c2--;\n    c3 = i * c2;\n    c4 += 2;\n    /* c2 = y - i,  c3 = i(y - i),  c4 = d + 2i,  for i odd */\n    a1 = c4 * a2 + c3 * a1;\n    b1 = c4 * b2 + c3 * b1;\n\n    i++;\n    c2--;\n    c3 = i * c2;\n    c4 += 2;\n    /* c2 = y - i,  c3 = i(y - i),  c4 = d + 2i,  for i even */\n    a2 = c4 * a1 + c3 * a2;\n    b2 = c4 * b1 + c3 * b2;\n\n    if (b2 !== 0) {\n      f = a2 / b2;\n      /* convergence check: relative; \"absolute\" for very small f : */\n      if (fabs(f - of) <= DBL_EPSILON * fmax2(f0, fabs(f))) {\n        pr_pd_lower_cf(' %d iter.\\n', i);\n        return f;\n      }\n      of = f;\n    }\n  }\n\n  pr_pd_lower_cf(\" ** NON-convergence in pgamma()'s pd_lower_cf() f= %d.\", f);\n  return f; /* should not happen ... */\n} /* pd_lower_cf() */\n\nconst pr_pd_lower_series = debug('pd_lower_series');\n\nfunction pd_lower_series(lambda: number, y: number): number {\n  let term = 1;\n  let sum = 0;\n\n  pr_pd_lower_series('pd_lower_series(lam=%d, y=%d) ...', lambda, y);\n\n  while (y >= 1 && term > sum * DBL_EPSILON) {\n    term *= y / lambda;\n    sum += term;\n    y--;\n  }\n  /* sum =  \\sum_{n=0}^ oo  y*(y-1)*...*(y - n) / lambda^(n+1)\n   *\t   =  y/lambda * (1 + \\sum_{n=1}^Inf  (y-1)*...*(y-n) / lambda^n)\n   *\t   ~  y/lambda + o(y/lambda)\n   */\n\n  pr_pd_lower_series(' done: term=%d, sum=%d, y= %d', term, sum, y);\n\n  if (y !== floor(y)) {\n    /*\n     * The series does not converge as the terms start getting\n     * bigger (besides flipping sign) for y < -lambda.\n     */\n    let f;\n\n    pr_pd_lower_series(' y not int: add another term ');\n\n    /* FIXME: in quite few cases, adding  term*f  has no effect (f too small)\n     *\t  and is unnecessary e.g. for pgamma(4e12, 121.1) */\n    f = pd_lower_cf(y, lambda + 1 - y);\n    pr_pd_lower_series('  (= %d) * term = %d to sum %d', f, term * f, sum);\n\n    sum += term * f;\n  }\n\n  return sum;\n} /* pd_lower_series() */\n\n/*\n * Compute the following ratio with higher accuracy that would be had\n * from doing it directly.\n *\n *\t\t dnorm (x, 0, 1, FALSE)\n *\t   ----------------------------------\n *\t   pnorm (x, 0, 1, lowerTail, FALSE)\n *\n * Abramowitz & Stegun 26.2.12\n */\nfunction dpnorm(\n  x: number,\n  lowerTail: boolean,\n  lp: number\n): number {\n  /*\n   * So as not to repeat a pnorm call, we expect\n   *\n   *\t lp == pnorm (x, 0, 1, lowerTail, TRUE)\n   *\n   * but use it only in the non-critical case where either x is small\n   * or p==exp(lp) is close to 1.\n   */\n\n  if (x < 0) {\n    x = -x;\n    lowerTail = !lowerTail;\n  }\n\n  if (x > 10 && !lowerTail) {\n    let term = 1 / x;\n    let sum = term;\n    let x2 = x * x;\n    let i = 1;\n    do {\n      term *= -i / x2;\n      sum += term;\n      i += 2;\n    } while (fabs(term) > DBL_EPSILON * sum);\n\n    return 1 / sum;\n  } else {\n    let d = dnorm(x, 0, 1, false);\n    return d / exp(lp);\n  }\n}\n\n/*\n * Asymptotic expansion to calculate the probability that Poisson variate\n * has value <= x.\n * Various assertions about this are made (without proof) at\n * http://members.aol.com/iandjmsmith/PoissonApprox.htm\n */\n\nconst pr_ppois_asymp = debug('ppois_asymp');\n\nfunction ppois_asymp(\n  x: number,\n  lambda: number,\n  lowerTail: boolean,\n  logP: boolean\n): number {\n  const coefs_a = [\n    -1e99 /* placeholder used for 1-indexing */,\n    2 / 3,\n    -4 / 135,\n    8 / 2835,\n    16 / 8505,\n    -8992 / 12629925,\n    -334144 / 492567075,\n    698752 / 1477701225\n  ];\n\n  const coefs_b = [\n    -1e99 /* placeholder */,\n    1 / 12,\n    1 / 288,\n    -139 / 51840,\n    -571 / 2488320,\n    163879 / 209018880,\n    5246819 / 75246796800,\n    -534703531 / 902961561600\n  ];\n\n  let elfb: number;\n  let elfb_term: number;\n  let res12: number;\n  let res1_term: number;\n  let res1_ig: number;\n  let res2_term: number;\n  let res2_ig: number;\n  let dfm: number;\n  let pt_: number;\n  let s2pt: number;\n  let f: number;\n  let np: number;\n  let i: number;\n\n  dfm = lambda - x;\n  /* If lambda is large, the distribution is highly concentrated\n     about lambda.  So representation error in x or lambda can lead\n     to arbitrarily large values of pt_ and hence divergence of the\n     coefficients of this approximation.\n  */\n  pt_ = -log1pmx(dfm / x);\n  s2pt = sqrt(2 * x * pt_);\n  if (dfm < 0) s2pt = -s2pt;\n\n  res12 = 0;\n  res1_ig = res1_term = sqrt(x);\n  res2_ig = res2_term = s2pt;\n  for (i = 1; i < 8; i++) {\n    res12 += res1_ig * coefs_a[i];\n    res12 += res2_ig * coefs_b[i];\n    res1_term *= pt_ / i;\n    res2_term *= 2 * pt_ / (2 * i + 1);\n    res1_ig = res1_ig / x + res1_term;\n    res2_ig = res2_ig / x + res2_term;\n  }\n\n  elfb = x;\n  elfb_term = 1;\n  for (i = 1; i < 8; i++) {\n    elfb += elfb_term * coefs_b[i];\n    elfb_term /= x;\n  }\n  if (!lowerTail) elfb = -elfb;\n\n  pr_ppois_asymp('res12 = %d   elfb=%d', elfb, res12);\n\n  f = res12 / elfb;\n\n  np = pnorm(s2pt, 0.0, 1.0, !lowerTail, logP);\n\n  if (logP) {\n    let n_d_over_p = dpnorm(s2pt, !lowerTail, np);\n    pr_ppois_asymp(\n      'pp*_asymp(): f=%d\t np=e^%d  nd/np=%d  f*nd/np=%d',\n      f,\n      np,\n      n_d_over_p,\n      f * n_d_over_p\n    );\n    return np + log1p(f * n_d_over_p);\n  } else {\n    let nd = dnorm(s2pt, 0, 1, logP);\n\n    pr_ppois_asymp(\n      'pp*_asymp(): f=%d\t np=%d  nd=%d  f*nd=%d',\n      f,\n      np,\n      nd,\n      f * nd\n    );\n    return np + f * nd;\n  }\n} /* ppois_asymp() */\n\nconst pr_pgamma_raw = debug('pgamma_raw');\n\nexport function pgamma_raw(\n  x: number,\n  alph: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  /* Here, assume that  (x,alph) are not NA  &  alph > 0 . */\n\n  let res;\n\n  pr_pgamma_raw(\n    'pgamma_raw(x=%d, alph=%d, low=%s, log=%s)',\n    x,\n    alph,\n    lowerTail,\n    logP\n  );\n\n  let rc = R_P_bounds_01(lowerTail, logP, x, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  if (x < 1) {\n    res = pgamma_smallx(x, alph, lowerTail, logP);\n  } else if (x <= alph - 1 && x < 0.8 * (alph + 50)) {\n    /* incl. large alph compared to x */\n    let sum = pd_upper_series(x, alph, logP); /* = x/alph + o(x/alph) */\n    let d = dpois_wrap(alph, x, logP);\n    pr_pgamma_raw(\n      ' alph \"large\": sum=pd_upper*()= %d, d=dpois_w(*)= %d',\n      sum,\n      d\n    );\n    if (!lowerTail) res = logP ? R_Log1_Exp(d + sum) : 1 - d * sum;\n    else res = logP ? sum + d : sum * d;\n  } else if (alph - 1 < x && alph < 0.8 * (x + 50)) {\n    /* incl. large x compared to alph */\n    let sum;\n    let d = dpois_wrap(alph, x, logP);\n    pr_pgamma_raw('  x \"large\": d=dpois_w(*)= %d ', d);\n\n    if (alph < 1) {\n      if (x * DBL_EPSILON > 1 - alph) sum = R_D__1(logP);\n      else {\n        let f = pd_lower_cf(alph, x - (alph - 1)) * x / alph;\n        /* = [alph/(x - alph+1) + o(alph/(x-alph+1))] * x/alph = 1 + o(1) */\n        sum = logP ? log(f) : f;\n      }\n    } else {\n      sum = pd_lower_series(x, alph - 1); /* = (alph-1)/x + o((alph-1)/x) */\n      sum = logP ? log1p(sum) : 1 + sum;\n    }\n\n    pr_pgamma_raw(', sum= %d', sum);\n    if (!lowerTail) res = logP ? sum + d : sum * d;\n    else res = logP ? R_Log1_Exp(d + sum) : 1 - d * sum;\n  } else {\n    /* x >= 1 and x fairly near alph. */\n\n    pr_pgamma_raw(' using ppois_asymp()');\n    res = ppois_asymp(alph - 1, x, !lowerTail, logP);\n  }\n\n  /*\n   * We lose a fair amount of accuracy to underflow in the cases\n   * where the final result is very close to DBL_MIN.\t In those\n   * cases, simply redo via log space.\n   */\n  if (!logP && res < DBL_MIN / DBL_EPSILON) {\n    /* with(.Machine, double.xmin / double.eps) #|-> 1.002084e-292 */\n\n    pr_pgamma_raw(' very small res=%.14g; -> recompute via log\\n', res);\n    return exp(pgamma_raw(x, alph, lowerTail, true));\n  } else return res;\n}\n\nconst printer_pgamma = debug('pgamma');\nexport function pgamma<T>(\n  q: T,\n  shape: number,\n  scale: number,\n  lowerTail: boolean,\n  logP: boolean\n): T {\n  const fa: number[] = isArray(q) ? q : ([q] as any);\n\n  const result = fa.map(x => {\n    if (ISNAN(x) || ISNAN(shape) || ISNAN(scale)) {\n      return x + shape + scale;\n    }\n    if (shape < 0 || scale <= 0) return ML_ERR_return_NAN(printer_pgamma);\n    x /= scale;\n\n    if (ISNAN(x))\n      /* eg. original x = scale = +Inf */\n      return x;\n    if (shape === 0)\n      /* limit case; useful e.g. in pnchisq() */\n      return x <= 0\n        ? R_DT_0(lowerTail, logP)\n        : R_DT_1(lowerTail, logP); /* <= assert  pgamma(0,0) ==> 0 */\n    return pgamma_raw(x, shape, lowerTail, logP);\n  });\n  return result.length === 1 ? result[0] : (result as any);\n}\n/* From: terra@gnome.org (Morten Welinder)\n * To: R-bugs@biostat.ku.dk\n * Cc: maechler@stat.math.ethz.ch\n * Subject: Re: [Rd] pgamma discontinuity (PR#7307)\n * Date: Tue, 11 Jan 2005 13:57:26 -0500 (EST)\n\n * this version of pgamma appears to be quite good and certainly a vast\n * improvement over current R code.  (I last looked at 2.0.1)  Apart from\n * type naming, this is what I have been using for Gnumeric 1.4.1.\n\n * This could be included into R as-is, but you might want to benefit from\n * making logcf, log1pmx, lgamma1p, and possibly logspace_add/logspace_sub\n * available to other parts of R.\n\n * MM: I've not (yet?) taken  logcf(), but the other four\n */\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug'\n\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1\n} from '../common/_general';\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  NaN: ML_NAN\n} = Number;\n\nimport { pnorm_both } from './pnorm_both'\n\nconst printer = debug('pnorm5');\nimport { NumberW } from '../common/toms708';\n\nexport function pnorm5(\n  q: number,\n  mu: number = 0,\n  sigma: number = 1,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n\n\n  let p = new NumberW(0);\n  let cp = new NumberW(0);\n\n  /* Note: The structure of these checks has been carefully thought through.\n   * For example, if x == mu and sigma == 0, we get the correct answer 1.\n   */\n\n  if (ISNAN(q) || ISNAN(mu) || ISNAN(sigma)) return q + mu + sigma;\n\n  if (!R_FINITE(q) && mu === q) return ML_NAN; /* x-mu is NaN */\n  if (sigma <= 0) {\n    if (sigma < 0) return ML_ERR_return_NAN(printer);\n    /* sigma = 0 : */\n    return q < mu ? R_DT_0(lowerTail, logP) : R_DT_1(lowerTail, logP);\n  }\n  p.val = (q - mu) / sigma;\n  if (!R_FINITE(p.val))\n    return q < mu ? R_DT_0(lowerTail, logP) : R_DT_1(lowerTail, logP);\n  q = p.val;\n\n  pnorm_both(q, p, cp, !lowerTail, logP);\n\n  return lowerTail ? p.val : cp.val;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from './irng';\nimport { KnuthTAOCP } from './knuth-taocp';\nimport { KnuthTAOCP2002 } from './knuth-taocp-2002';\nimport { LecuyerCMRG } from './lecuyer-cmrg';\nimport { MarsagliaMultiCarry } from './marsaglia-multicarry';\nimport { MersenneTwister } from './mersenne-twister';\nimport { \n    AhrensDieter, \n    BoxMuller, \n    BuggyKindermanRamage, \n    Inversion,\n    KindermanRamage\n} from './normal';\nimport { IRNGNormal } from './normal/inormal-rng';\nimport { SuperDuper } from './super-duper';\nimport { timeseed } from './timeseed';\nimport { WichmannHill } from './wichmann-hill';\n\nexport const rng = {\n  KnuthTAOCP,\n  KnuthTAOCP2002,\n  LecuyerCMRG,\n  MarsagliaMultiCarry,\n  MersenneTwister,\n  normal: {\n    AhrensDieter,\n    BoxMuller,\n    BuggyKindermanRamage, \n    Inversion,\n    KindermanRamage\n  },\n  SuperDuper,\n  timeseed,\n  WichmannHill,\n};\n\nexport { IRNG, IRNGNormal };\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  fmod,\n  ME,\n  ML_ERROR\n} from '../common/_general';\n\nconst  { \n    abs: fabs, \n    PI: M_PI\n} = Math;\n\nconst { \n    NaN: ML_NAN,\n    isNaN: ISNAN,  \n    isFinite: R_FINITE  \n} = Number;\n\n/* HAVE_COSPI etc will not be defined in standalone-use: the\n   intention is to make the versions here available in that case.\n\n   The __cospi etc variants are from OS X (and perhaps other BSD-based systems).\n*/\n\n// cos(pi * x)  -- exact when x = k/2  for all integer k\nconst printer_cospi = debug('cospi');\n\nexport function cospi(x: number): number {\n  // NaNs propagated correctly\n  if (ISNAN(x)) return x;\n  if (!R_FINITE(x)) {\n    ML_ERROR(ME.ME_DOMAIN, '', printer_cospi);\n    return ML_NAN;\n  }\n\n  x = fmod(fabs(x), 2); // cos() symmetric; cos(pi(x + 2k)) == cos(pi x) for all integer k\n  if (fmod(x, 1) === 0.5) return 0;\n  if (x === 1) return -1;\n  if (x === 0) return 1;\n  // otherwise\n  return Math.cos(M_PI * x);\n}\n\n// tan(pi * x)  -- exact when x = k/2  for all integer k\nconst printer_tanpi = debug('tanpi');\nexport function tanpi(x: number): number {\n  if (ISNAN(x)) return x;\n  if (!R_FINITE(x)) {\n    ML_ERROR(ME.ME_DOMAIN, '', printer_tanpi);\n    return ML_NAN;\n  }\n  x = fmod(x, 1); // tan(pi(x + k)) == tan(pi x)  for all integer k\n  // map (-1,1) --> (-1/2, 1/2] :\n  if (x <= -0.5) {\n    x++;\n  } else if (x > 0.5) {\n    x--;\n  }\n  return x === 0 ? 0 : x === 0.5 ? ML_NAN : Math.tan(M_PI * x);\n}\n\nexport function atanpi(x: number) {\n  return Math.atan(x) / Math.PI;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { fmod, ME, ML_ERROR } from '../common/_general';\n\nconst { PI: M_PI } = Math;\n\nconst { NaN: ML_NAN, isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\n// sin(pi * x)  -- exact when x = k/2  for all integer k\nconst printer_sinpi = debug('sinpi');\nexport function sinpi(x: number): number {\n  if (ISNAN(x)) return x;\n  if (!R_FINITE(x)) {\n    ML_ERROR(ME.ME_DOMAIN, 'sinpi not finite', printer_sinpi);\n    return ML_NAN;\n  }\n  x = fmod(x, 2); // sin(pi(x + 2k)) == sin(pi x)  for all integer k\n  // map (-2,2) --> (-1,1] :\n  if (x <= -1) x += 2;\n  else if (x > 1) x -= 2;\n  if (x === 0 || x === 1) return 0;\n  if (x === 0.5) return 1;\n  if (x === -0.5) return -1;\n  // otherwise\n  return Math.sin(M_PI * x);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D__1,\n  R_D_exp,\n  R_D_fexp,\n  R_D_nonint_check\n} from '../common/_general';\n\nimport { bd0 } from '../deviance';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { stirlerr } from '../stirling';\n\nconst { round: R_forceint, log, PI } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE, MIN_VALUE: DBL_MIN } = Number;\nconst M_2PI = 2 * PI;\nconst printer = debug('dpois');\n\nexport function dpois_raw(\n  x: number,\n  lambda: number,\n  give_log: boolean\n): number {\n  /*       x >= 0 ; integer for dpois(), but not e.g. for pgamma()!\n        lambda >= 0\n    */\n  if (lambda === 0) return x === 0 ? R_D__1(give_log) : R_D__0(give_log);\n  if (!R_FINITE(lambda)) return R_D__0(give_log);\n  if (x < 0) return R_D__0(give_log);\n  if (x <= lambda * DBL_MIN) return R_D_exp(give_log, -lambda);\n  if (lambda < x * DBL_MIN)\n    return R_D_exp(give_log, -lambda + x * log(lambda) - lgammafn(x + 1));\n\n  return R_D_fexp(give_log, M_2PI * x, -stirlerr(x) - bd0(x, lambda));\n}\n\nexport function dpois(\n  x: number,\n  lambda: number,\n  give_log: boolean = false\n): number {\n\n\n  if (ISNAN(x) || ISNAN(lambda)) {\n    return x + lambda;\n  }\n\n  if (lambda < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  let rc = R_D_nonint_check(give_log, x, printer);\n  if (rc !== undefined) {\n    return rc;\n  }\n  if (x < 0 || !R_FINITE(x)) {\n    return R_D__0(give_log);\n  }\n  x = R_forceint(x);\n  return dpois_raw(x, lambda, give_log);\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_D__0 } from '../common/_general';\nimport { dpois_raw } from '../poisson/dpois';\n\n\nconst { log } = Math;\nconst { isNaN: ISNAN } = Number;\nconst ML_POSINF = Infinity;\n\nconst printer = debug('dgamma');\n\nexport function dgamma(\n  x: number,\n  shape: number,\n  scale: number,\n  aslog: boolean = false\n): number {\n\n    let pr: number;\n\n    if (ISNAN(x) || ISNAN(shape) || ISNAN(scale)) return x + shape + scale;\n    if (shape < 0 || scale <= 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n    if (x < 0) {\n      return R_D__0(aslog);\n    }\n    if (shape === 0) {\n      /* point mass at 0 */\n      return x === 0 ? ML_POSINF : R_D__0(aslog);\n    }\n    if (x === 0) {\n      if (shape < 1) return ML_POSINF;\n      if (shape > 1) {\n        return R_D__0(aslog);\n      }\n      /* else */\n      return aslog ? -log(scale) : 1 / scale;\n    }\n\n    if (shape < 1) {\n      pr = dpois_raw(shape, x / scale, aslog);\n      return aslog ? pr + log(shape / x) : pr * shape / x;\n    }\n    /* else  shape >= 1 */\n    pr = dpois_raw(shape - 1, x / scale, aslog);\n    return aslog ? pr - log(scale) : pr / scale;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { isOdd } from '../common/_general';\n\nconst { abs: fabs, log, exp, round } = Math;\nconst { isInteger, NEGATIVE_INFINITY: ML_NEGINF, isNaN: ISNAN } = Number;\n\nimport { lbeta as internal_lbeta } from '../beta/lbeta';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { lgammafn_sign } from '../gamma/lgammafn_sign';\n\n\n// used by \"qhyper\"\nexport function lfastchoose(n: number, k: number) {\n  return -log(n + 1) - internal_lbeta(n - k + 1, k + 1);\n}\n/* mathematically the same:\n   less stable typically, but useful if n-k+1 < 0 : */\n\nexport function lfastchoose2(n: number, k: number, sChoose?: number[]) {\n  let r: number;\n  r = lgammafn_sign(n - k + 1, sChoose);\n  return lgammafn(n + 1) - lgammafn(k + 1) - r;\n}\n\n\nconst printer_lchoose = debug('lchoose');\n\nexport function internal_lchoose(n: number, k: number): number {\n  let k0 = k;\n  k = Math.round(k);\n  /* NaNs propagated correctly */\n  if (ISNAN(n) || ISNAN(k)) return n + k;\n  if (fabs(k - k0) > 1e-7)\n    printer_lchoose('\"k\" (%d) must be integer, rounded to %d', k0, k);\n  if (k < 2) {\n    if (k < 0) return ML_NEGINF;\n    if (k === 0) return 0;\n    /* else: k == 1 */\n    return log(fabs(n));\n  }\n  /* else: k >= 2 */\n  if (n < 0) {\n    return internal_lchoose(-n + k - 1, k);\n  } else if (isInteger(n)) {\n    n = round(n);\n    if (n < k) return ML_NEGINF;\n    /* k <= n :*/\n    if (n - k < 2) return internal_lchoose(n, n - k); /* <- Symmetry */\n    /* else: n >= k+2 */\n    return lfastchoose(n, k);\n  }\n  /* else non-integer n >= 0 : */\n  if (n < k - 1) {\n    return lfastchoose2(n, k);\n  }\n  return lfastchoose(n, k);\n}\n\nconst k_small_max = 30;\n\n/* 30 is somewhat arbitrary: it is on the *safe* side:\n * both speed and precision are clearly improved for k < 30.\n*/\nconst printer_choose = debug('choose');\n\nexport function internal_choose(n: number, k: number): number {\n  let r: number;\n  let k0 = k;\n  k = round(k);\n  /* NaNs propagated correctly */\n  if (ISNAN(n) || ISNAN(k)) return n + k;\n  if (fabs(k - k0) > 1e-7)\n    printer_choose('k (%d) must be integer, rounded to %d', k0, k);\n  if (k < k_small_max) {\n    let j: number;\n    if (n - k < k && n >= 0 && isInteger(n)) k = n - k; /* <- Symmetry */\n    if (k < 0) return 0;\n    if (k === 0) return 1;\n    /* else: k >= 1 */\n    r = n;\n    for (j = 2; j <= k; j++) r *= (n - j + 1) / j;\n    return isInteger(n) ? round(r) : r;\n    /* might have got rounding errors */\n  }\n  /* else: k >= k_small_max */\n  if (n < 0) {\n    r = internal_choose(-n + k - 1, k);\n    if (isOdd(k)) r = -r;\n    return r;\n  } else if (isInteger(n)) {\n    n = round(n);\n    if (n < k) return 0;\n    if (n - k < k_small_max) return internal_choose(n, n - k); /* <- Symmetry */\n    return round(exp(lfastchoose(n, k)));\n  }\n  /* else non-integer n >= 0 : */\n  if (n < k - 1) {\n    let schoose: number[] = [0];\n    r = lfastchoose2(n, k, /* -> */ schoose);\n    return schoose[0] * exp(r);\n  }\n  return exp(lfastchoose(n, k));\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { chebyshev_eval } from '../chebyshev/chebyshev';\nimport { ME, ML_ERROR } from '../common/_general';\nimport { stirlerr } from '../stirling';\nimport { sinpi } from '../trigonometry';\nimport { lgammacor } from './lgammacor';\n\nimport * as debug from 'debug';\n\nconst printer = debug('gammafn');\n\nconst {\n  isNaN: ISNAN,\n  NaN: ML_NAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF\n} = Number;\n\nconst { PI: M_PI, abs: fabs, round, trunc, exp, log } = Math;\n\nconst M_LN_SQRT_2PI = Math.log(Math.sqrt(2 * Math.PI));\n\nconst gamcs: number[] = [\n  +0.8571195590989331421920062399942e-2,\n  +0.4415381324841006757191315771652e-2,\n  +0.5685043681599363378632664588789e-1,\n  -0.4219835396418560501012500186624e-2,\n  +0.1326808181212460220584006796352e-2,\n  -0.1893024529798880432523947023886e-3,\n  +0.3606925327441245256578082217225e-4,\n  -0.6056761904460864218485548290365e-5,\n  +0.1055829546302283344731823509093e-5,\n  -0.1811967365542384048291855891166e-6,\n  +0.3117724964715322277790254593169e-7,\n  -0.5354219639019687140874081024347e-8,\n  +0.919327551985958894688778682594e-9,\n  -0.1577941280288339761767423273953e-9,\n  +0.2707980622934954543266540433089e-10,\n  -0.4646818653825730144081661058933e-11,\n  +0.7973350192007419656460767175359e-12,\n  -0.1368078209830916025799499172309e-12,\n  +0.2347319486563800657233471771688e-13,\n  -0.4027432614949066932766570534699e-14,\n  +0.6910051747372100912138336975257e-15,\n  -0.1185584500221992907052387126192e-15,\n  +0.2034148542496373955201026051932e-16,\n  -0.3490054341717405849274012949108e-17,\n  +0.5987993856485305567135051066026e-18,\n  -0.1027378057872228074490069778431e-18,\n  +0.1762702816060529824942759660748e-19,\n  -0.3024320653735306260958772112042e-20,\n  +0.5188914660218397839717833550506e-21,\n  -0.8902770842456576692449251601066e-22,\n  +0.1527474068493342602274596891306e-22,\n  -0.2620731256187362900257328332799e-23,\n  +0.4496464047830538670331046570666e-24,\n  -0.7714712731336877911703901525333e-25,\n  +0.1323635453126044036486572714666e-25,\n  -0.2270999412942928816702313813333e-26,\n  +0.3896418998003991449320816639999e-27,\n  -0.6685198115125953327792127999999e-28,\n  +0.1146998663140024384347613866666e-28,\n  -0.1967938586345134677295103999999e-29,\n  +0.3376448816585338090334890666666e-30,\n  -0.5793070335782135784625493333333e-31\n];\n\nconst { isArray } = Array;\n\nexport function gammafn<T>(x: T): T {\n  const fx: number[] = isArray(x) ? x : [x] as any;\n\n  const result = fx.map(fx => {\n    return _gammafn(fx);\n  });\n\n  return result.length === 1 ? result[0] : result as any;\n}\n\nfunction _gammafn(x: number): number {\n  let i: number;\n  let n: number;\n  let y: number;\n  let sinpiy: number;\n  let value: number;\n\n  /* #ifdef NOMORE_FOR_THREADS\n     static int ngam = 0;\n     static double xmin = 0, xmax = 0., xsml = 0., dxrel = 0.;\n \n     // Initialize machine dependent constants, the first time gamma() is called.\n     //FIXME for threads ! \n     if (ngam == 0) {\n         ngam = chebyshev_init(gamcs, 42, DBL_EPSILON / 20);//was .1*d1mach(3)\n         gammalims(&xmin, &xmax);//-> ./gammalims.c \n         xsml = exp(fmax2(log(DBL_MIN), -log(DBL_MAX)) + 0.01);\n         //   = exp(.01)*DBL_MIN = 2.247e-308 for IEEE \n         dxrel = sqrt(DBL_EPSILON);//was sqrt(d1mach(4)) \n     }\n     #else\n     */\n  // For IEEE double precision DBL_EPSILON = 2^-52 = 2.220446049250313e-16 :\n  // (xmin, xmax) are non-trivial, see ./gammalims.c\n  // xsml = exp(.01)*DBL_MIN\n  // dxrel = sqrt(DBL_EPSILON) = 2 ^ -26\n  //\n  const ngam = 22;\n  const xmin = -170.5674972726612;\n  const xmax = 171.61447887182298;\n  const xsml = 2.2474362225598545e-308;\n  const dxrel = 1.490116119384765696e-8;\n\n  if (ISNAN(x)) return x;\n\n  //If the argument is exactly zero or a negative integer\n  //then return NaN.\n  if (x === 0 || (x < 0 && x === round(x))) {\n    ML_ERROR(ME.ME_DOMAIN, 'gammafn', printer);\n    return ML_NAN;\n  }\n\n  y = fabs(x);\n\n  if (y <= 10) {\n    // Compute gamma(x) for -10 <= x <= 10\n    // Reduce the interval and find gamma(1 + y) for 0 <= y < 1\n    // first of all.\n\n    n = x >> 0; // make int32\n    if (x < 0)--n;\n    y = x - n; // n = floor(x)  ==>\ty in [ 0, 1 )\n    --n;\n    value = chebyshev_eval(y * 2 - 1, gamcs, ngam) + 0.9375;\n    if (n === 0) return value; // x = 1.dddd = 1+y\n\n    if (n < 0) {\n      // compute gamma(x) for -10 <= x < 1\n      // exact 0 or \"-n\" checked already above\n      // The answer is less than half precision\n      // because x too near a negative integer.\n      if (x < -0.5 && fabs(x - trunc(x - 0.5) / x) < dxrel) {\n        ML_ERROR(ME.ME_PRECISION, 'gammafn', printer);\n      }\n      // The argument is so close to 0 that the result would overflow.\n      if (y < xsml) {\n        ML_ERROR(ME.ME_RANGE, 'gammafn', printer);\n        if (x > 0) return ML_POSINF;\n        else return ML_NEGINF;\n      }\n\n      n = -n;\n\n      for (i = 0; i < n; i++) {\n        value /= x + i;\n      }\n      return value;\n    } else {\n      // gamma(x) for 2 <= x <= 10\n\n      for (i = 1; i <= n; i++) {\n        value *= y + i;\n      }\n      return value;\n    }\n  } else {\n    // gamma(x) for\t y = |x| > 10.\n\n    if (x > xmax) {\n      // Overflow\n      ML_ERROR(ME.ME_RANGE, 'gammafn', printer);\n      return ML_POSINF;\n    }\n\n    if (x < xmin) {\n      // Underflow\n      ML_ERROR(ME.ME_UNDERFLOW, 'gammafn', printer);\n      return 0;\n    }\n\n    if (y <= 50 && y === trunc(y)) {\n      // compute (n - 1)!\n      value = 1;\n      for (i = 2; i < y; i++) value *= i;\n    } else {\n      // normal case\n      value = exp(\n        (y - 0.5) * log(y) -\n        y +\n        M_LN_SQRT_2PI +\n        (2 * y === trunc(2) * y ? stirlerr(y) : lgammacor(y))\n      );\n    }\n    if (x > 0) return value;\n\n    if (fabs((x - trunc(x - 0.5)) / x) < dxrel) {\n      // The answer is less than half precision because\n      // the argument is too near a negative integer.\n\n      ML_ERROR(ME.ME_PRECISION, 'gammafn', printer);\n    }\n\n    sinpiy = sinpi(y);\n    if (sinpiy === 0) {\n      // Negative integer arg - overflow\n      ML_ERROR(ME.ME_RANGE, 'gammafn', printer);\n      return ML_POSINF;\n    }\n    return -M_PI / (y * sinpiy * value);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport { cospi } from './cospi';\nexport { sinpi } from './sinpi';\nexport { tanpi, atanpi } from './tanpi';\n\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { exp_rand } from '../exp/sexp';\nimport { IRNGNormal } from '../rng/normal/inormal-rng';\n\nconst { expm1, abs: fabs, sqrt, log, exp } = Math;\nconst { isFinite: R_FINITE } = Number;\n\n\nconst printer_rgammaOne = debug('rgammaOne');\n\nexport function rgammaOne(\n  a: number = 1,\n  scale: number = 1,\n  rng: IRNGNormal\n): number {\n  /* Constants : */\n  const sqrt32 = 5.656854;\n  const exp_m1 = 0.36787944117144232159; /* exp(-1) = 1/e */\n\n  /* Coefficients q[k] - for q0 = sum(q[k]*a^(-k))\n     * Coefficients a[k] - for q = q0+(t*t/2)*sum(a[k]*v^k)\n     * Coefficients e[k] - for exp(q)-1 = sum(e[k]*q^k)\n     */\n  const q1 = 0.04166669;\n  const q2 = 0.02083148;\n  const q3 = 0.00801191;\n  const q4 = 0.00144121;\n  const q5 = -7.388e-5;\n  const q6 = 2.4511e-4;\n  const q7 = 2.424e-4;\n\n  const a1 = 0.3333333;\n  const a2 = -0.250003;\n  const a3 = 0.2000062;\n  const a4 = -0.1662921;\n  const a5 = 0.1423657;\n  const a6 = -0.1367177;\n  const a7 = 0.1233795;\n\n  /* State variables [FIXME for threading!] :*/\n\n  let aa = 0;\n  let aaa = 0;\n  let s = 0;\n  let s2 = 0;\n  let d = 0; /* no. 1 (step 1) */\n  let q0 = 0;\n  let b = 0;\n  let si = 0;\n  let c = 0; /* no. 2 (step 4) */\n\n  let e = 0;\n  let p = 0;\n  let q = 0;\n  let r = 0;\n  let t = 0;\n  let u = 0;\n  let v = 0;\n  let w = 0;\n  let x = 0;\n  let ret_val = 0;\n\n  if (!R_FINITE(a) || !R_FINITE(scale) || a < 0.0 || scale <= 0.0) {\n    if (scale === 0) return 0;\n    return ML_ERR_return_NAN(printer_rgammaOne);\n  }\n\n  if (a < 1) {\n    /* GS algorithm for parameters a < 1 */\n    if (a === 0) return 0;\n    e = 1.0 + exp_m1 * a;\n    while (true) {\n      p = e * (rng.internal_unif_rand());\n      if (p >= 1.0) {\n        x = -log((e - p) / a);\n        if (exp_rand(rng.internal_unif_rand) >= (1.0 - a) * log(x)) break;\n      } else {\n        x = exp(log(p) / a);\n        if (exp_rand(rng.internal_unif_rand) >= x) break;\n      }\n    }\n    return scale * x;\n  }\n\n  /* --- a >= 1 : GD algorithm --- */\n\n  /* Step 1: Recalculations of s2, s, d if a has changed */\n  if (a !== aa) {\n    aa = a;\n    s2 = a - 0.5;\n    s = sqrt(s2);\n    d = sqrt32 - s * 12.0;\n  }\n  /* Step 2: t = standard normal deviate,\n               x = (s,1/2) -normal deviate. */\n\n  /* immediate acceptance (i) */\n  t = rng.norm_randOne() as number;\n  x = s + 0.5 * t;\n  ret_val = x * x;\n  if (t >= 0.0) return scale * ret_val;\n\n  /* Step 3: u = 0,1 - uniform sample. squeeze acceptance (s) */\n  u = rng.internal_unif_rand();\n  if (d * u <= t * t * t) return scale * ret_val;\n\n  /* Step 4: recalculations of q0, b, si, c if necessary */\n\n  if (a !== aaa) {\n    aaa = a;\n    r = 1.0 / a;\n    q0 =\n      ((((((q7 * r + q6) * r + q5) * r + q4) * r + q3) * r + q2) * r + q1) * r;\n\n    /* Approximation depending on size of parameter a */\n    /* The constants in the expressions for b, si and c */\n    /* were established by numerical experiments */\n\n    if (a <= 3.686) {\n      b = 0.463 + s + 0.178 * s2;\n      si = 1.235;\n      c = 0.195 / s - 0.079 + 0.16 * s;\n    } else if (a <= 13.022) {\n      b = 1.654 + 0.0076 * s2;\n      si = 1.68 / s + 0.275;\n      c = 0.062 / s + 0.024;\n    } else {\n      b = 1.77;\n      si = 0.75;\n      c = 0.1515 / s;\n    }\n  }\n  /* Step 5: no quotient test if x not positive */\n\n  if (x > 0.0) {\n    /* Step 6: calculation of v and quotient q */\n    v = t / (s + s);\n    if (fabs(v) <= 0.25)\n      q =\n        q0 +\n        0.5 *\n        t *\n        t *\n        ((((((a7 * v + a6) * v + a5) * v + a4) * v + a3) * v + a2) * v + a1) *\n        v;\n    else q = q0 - s * t + 0.25 * t * t + (s2 + s2) * log(1.0 + v);\n\n    /* Step 7: quotient acceptance (q) */\n    if (log(1.0 - u) <= q) return scale * ret_val;\n  }\n\n  while (true) {\n    /* Step 8: e = standard exponential deviate\n         *\tu =  0,1 -uniform deviate\n         *\tt = (b,si)-double exponential (laplace) sample */\n    e = exp_rand(rng.internal_unif_rand);\n    u = rng.internal_unif_rand();\n    u = u + u - 1.0;\n    if (u < 0.0) t = b - si * e;\n    else t = b + si * e;\n    /* Step\t 9:  rejection if t < tau(1) = -0.71874483771719 */\n    if (t >= -0.71874483771719) {\n      /* Step 10:\t calculation of v and quotient q */\n      v = t / (s + s);\n      if (fabs(v) <= 0.25)\n        q =\n          q0 +\n          0.5 *\n          t *\n          t *\n          ((((((a7 * v + a6) * v + a5) * v + a4) * v + a3) * v + a2) * v +\n            a1) *\n          v;\n      else q = q0 - s * t + 0.25 * t * t + (s2 + s2) * log(1.0 + v);\n      /* Step 11:\t hat acceptance (h) */\n      /* (if q not positive go to step 8) */\n      if (q > 0.0) {\n        w = expm1(q);\n        /*  ^^^^^ original code had approximation with rel.err < 2e-7 */\n        /* if t is rejected sample again at step 8 */\n        if (c * fabs(u) <= w * exp(e - 0.5 * t * t)) break;\n      }\n    }\n  } /* repeat .. until  `t' is accepted */\n  x = s + 0.5 * t;\n  return scale * x * x;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\n\nimport { IRNG_CORE } from '../rng/irng';\n\nexport function exp_rand(unif_rand: IRNG_CORE['internal_unif_rand']): number {\n\n  const q: number[] = [\n    0.6931471805599453,\n    0.9333736875190459,\n    0.9888777961838675,\n    0.9984959252914960,\n    0.9998292811061389,\n    0.9999833164100727,\n    0.9999985691438767,\n    0.9999998906925558,\n    0.9999999924734159,\n    0.9999999995283275,\n    0.9999999999728814,\n    0.9999999999985598,\n    0.9999999999999289,\n    0.9999999999999968,\n    0.9999999999999999,\n    1.0000000000000000\n  ];\n\n  let a = 0.;\n  let u = unif_rand();    // precaution if u = 0 is ever returned\n  while (u <= 0. || u >= 1.) u = unif_rand();\n  while (true) {\n    u += u;\n    if (u > 1.)\n      break;\n    a += q[0];\n  }\n  u -= 1.;\n\n  if (u <= q[0])\n    return a + u;\n\n  let i = 0;\n  let ustar = unif_rand();\n  let umin = ustar;\n  do {\n    ustar = unif_rand();\n    if (umin > ustar)\n      umin = ustar;\n    i++;\n  } while (u > q[i]);\n  return a + umin * q[0];\n}\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  imax2,\n  imin2,\n  M_1_SQRT_2PI,\n  ML_ERR_return_NAN\n} from '../common/_general';\n\nimport { exp_rand } from '../exp/sexp';\nimport { randomGenHelper } from '../r-func';\nimport { IRNGNormal } from '../rng/normal';\nimport { fsign } from '../signrank/fsign';\n\nconst { trunc, log, abs: fabs, pow, exp, floor, sqrt } = Math;\nconst { isFinite: R_FINITE } = Number;\n\n\nconst a0 = -0.5;\nconst a1 = 0.3333333;\nconst a2 = -0.2500068;\nconst a3 = 0.2000118;\nconst a4 = -0.1661269;\nconst a5 = 0.1421878;\nconst a6 = -0.1384794;\nconst a7 = 0.125006;\n\nconst one_7 = 0.1428571428571428571;\nconst one_12 = 0.0833333333333333333;\nconst one_24 = 0.0416666666666666667;\n\nconst printer_rpois = debug('rpois');\n\nexport function rpois(\n  n: number,\n  mu: number,\n  rng: IRNGNormal\n): number[] {\n  return randomGenHelper(n, rpoisOne, mu, rng);\n}\n\n\nexport function rpoisOne(mu: number, rng: IRNGNormal): number {\n  /* Factorial Table (0:9)! */\n  const fact = [1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880];\n\n  /* These are static --- persistent between calls for same mu : */\n  let l = 0;\n  let m = 0;\n  let pp = new Array(36);\n  let b1 = 0;\n  let b2 = 0;\n  let c = 0;\n  let c0 = 0;\n  let c1 = 0;\n  let c2 = 0;\n  let c3 = 0;\n  let p0 = 0;\n  let p = 0;\n  let q = 0;\n  let s = 0;\n  let d = 0;\n  let omega = 0;\n  let big_l = 0; /* integer \"w/o overflow\" */\n  let muprev = 0;\n  let muprev2 = 0; /*, muold\t = 0.*/\n\n  /* Local Vars  [initialize some for -Wall]: */\n  let del;\n  let difmuk = 0;\n  let E = 0;\n  let fk = 0;\n  let fx;\n  let fy;\n  let g;\n  let px;\n  let py;\n  let t = 0;\n  let u = 0;\n  let v;\n  let x;\n  let pois = -1;\n  let k;\n  let kflag = 0;\n  let big_mu;\n  let new_big_mu = false;\n\n  if (!R_FINITE(mu) || mu < 0) {\n    return ML_ERR_return_NAN(printer_rpois);\n  }\n  if (mu <= 0) return 0;\n\n  big_mu = mu >= 10;\n  if (big_mu) {\n    new_big_mu = false;\n  }\n\n  if (!(big_mu && mu === muprev)) {\n    /* maybe compute new persistent par.s */\n\n    if (big_mu) {\n      new_big_mu = true;\n      /* Case A. (recalculation of s,d,l\tbecause mu has changed):\n             * The poisson probabilities pk exceed the discrete normal\n             * probabilities fk whenever k >= m(mu).\n             */\n      muprev = mu;\n      s = sqrt(mu);\n      d = 6 * mu * mu;\n      big_l = floor(mu - 1.1484);\n      /* = an upper bound to m(mu) for all mu >= 10.*/\n    } else {\n      /* Small mu ( < 10) -- not using normal approx. */\n\n      /* Case B. (start new table and calculate p0 if necessary) */\n\n      /*muprev = 0.;-* such that next time, mu != muprev ..*/\n      if (mu !== muprev) {\n        muprev = mu;\n        m = imax2(1, trunc(mu));\n        l = 0; /* pp[] is already ok up to pp[l] */\n        q = p0 = p = exp(-mu);\n      }\n\n      while (true) {\n        /* Step U. uniform sample for inversion method */\n        u = rng.internal_unif_rand();\n        if (u <= p0) return 0;\n\n        /* Step T. table comparison until the end pp[l] of the\n                   pp-table of cumulative poisson probabilities\n                   (0.458 > ~= pp[9](= 0.45792971447) for mu=10 ) */\n        if (l !== 0) {\n          for (k = u <= 0.458 ? 1 : imin2(l, m); k <= l; k++)\n            if (u <= pp[k]) return k;\n          if (l === 35)\n            /* u > pp[35] */\n            continue;\n        }\n        /* Step C. creation of new poisson\n                   probabilities p[l..] and their cumulatives q =: pp[k] */\n        l++;\n        for (k = l; k <= 35; k++) {\n          p *= mu / k;\n          q += p;\n          pp[k] = q;\n          if (u <= q) {\n            l = k;\n            return k;\n          }\n        }\n        l = 35;\n      } /* end(repeat) */\n    } /* mu < 10 */\n  } /* end {initialize persistent vars} */\n\n  /* Only if mu >= 10 : ----------------------- */\n\n  /* Step N. normal sample */\n  g =\n    mu + s * (rng.norm_randOne() as number); /* norm_rand() ~ N(0,1), standard normal */\n\n  if (g >= 0) {\n    pois = floor(g);\n    /* Step I. immediate acceptance if pois is large enough */\n    if (pois >= big_l) return pois;\n    /* Step S. squeeze acceptance */\n    fk = pois;\n    difmuk = mu - fk;\n    u = rng.internal_unif_rand(); /* ~ U(0,1) - sample */\n    if (d * u >= difmuk * difmuk * difmuk) return pois;\n  }\n\n  /* Step P. preparations for steps Q and H.\n       (recalculations of parameters if necessary) */\n\n  if (new_big_mu || mu !== muprev2) {\n    /* Careful! muprev2 is not always == muprev\n           because one might have exited in step I or S\n           */\n    muprev2 = mu;\n    omega = M_1_SQRT_2PI / s;\n    /* The quantities b1, b2, c3, c2, c1, c0 are for the Hermite\n         * approximations to the discrete normal probabilities fk. */\n\n    b1 = one_24 / mu;\n    b2 = 0.3 * b1 * b1;\n    c3 = one_7 * b1 * b2;\n    c2 = b2 - 15 * c3;\n    c1 = b1 - 6 * b2 + 45 * c3;\n    c0 = 1 - b1 + 3 * b2 - 15 * c3;\n    c = 0.1069 / mu; /* guarantees majorization by the 'hat'-function. */\n  }\n\n  let gotoStepF = false;\n  let once = true;\n  while (true) {\n    if (once) {\n      once = false;\n      if (g >= 0) {\n        /* 'Subroutine' F is called (kflag=0 for correct return) */\n        kflag = 0;\n        //goto Step_F;\n        gotoStepF = true;\n      }\n    }\n    if (!gotoStepF) {\n      /* Step E. Exponential Sample */\n\n      E = exp_rand(rng.internal_unif_rand); /* ~ Exp(1) (standard exponential) */\n\n      /*  sample t from the laplace 'hat'\n                (if t <= -0.6744 then pk < fk for all mu >= 10.) */\n      u = 2 * (rng.internal_unif_rand()) - 1;\n      t = 1.8 + fsign(E, u >= 0);\n    }\n    if (t > -0.6744 || gotoStepF) {\n      if (!gotoStepF) {\n        pois = floor(mu + s * t);\n        fk = pois;\n        difmuk = mu - fk;\n\n        /* 'subroutine' F is called (kflag=1 for correct return) */\n        kflag = 1;\n      }\n      gotoStepF = false;\n      //Step_F: /* 'subroutine' F : calculation of px,py,fx,fy. */\n\n      if (pois < 10) {\n        /* use factorials from table fact[] */\n        px = -mu;\n        py = pow(mu, pois) / fact[trunc(pois)];\n      } else {\n        /* Case pois >= 10 uses polynomial approximation\n                   a0-a7 for accuracy when advisable */\n        del = one_12 / fk;\n        del = del * (1 - 4.8 * del * del);\n        v = difmuk / fk;\n        if (fabs(v) <= 0.25)\n          px =\n            fk *\n              v *\n              v *\n              (((((((a7 * v + a6) * v + a5) * v + a4) * v + a3) * v + a2) * v +\n                a1) *\n                v +\n                a0) -\n            del; /* |v| > 1/4 */\n        else px = fk * log(1 + v) - difmuk - del;\n        py = M_1_SQRT_2PI / sqrt(fk);\n      }\n      x = (0.5 - difmuk) / s;\n      x *= x; /* x^2 */\n      fx = -0.5 * x;\n      fy = omega * (((c3 * x + c2) * x + c1) * x + c0);\n      if (kflag > 0) {\n        /* Step H. Hat acceptance (E is repeated on rejection) */\n        if (c * fabs(u) <= py * exp(px + E) - fy * exp(fx + E)) {\n          break;\n        }\n      } else if (fy - u * fy <= py * exp(px - fx)) {\n        /* Step Q. Quotient acceptance (rare case) */\n        break;\n      }\n    } /* t > -.67.. */\n  }\n  return pois;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport {\n  DBL_MANT_DIG,\n  DBL_MIN_EXP,\n  ldexp,\n  M_1_SQRT_2PI,\n  M_LN2,\n  M_LN_SQRT_2PI,\n  ML_ERR_return_NAN,\n  R_D__0\n} from '../common/_general';\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  MAX_VALUE: DBL_MAX,\n  POSITIVE_INFINITY: ML_POSINF,\n  NaN: ML_NAN\n} = Number;\nconst { sqrt, exp, abs: fabs, round: R_forceint, log } = Math;\nconst printer = debug('dnorm4');\n\nexport function dnorm4(\n  x: number,\n  mu = 0,\n  sigma = 1,\n  give_log = false\n): number {\n     \n    if (ISNAN(x) || ISNAN(mu) || ISNAN(sigma)) {\n      return x + mu + sigma;\n    }\n\n    if (!R_FINITE(sigma)) {\n      return R_D__0(give_log);\n    }\n\n    if (!R_FINITE(x) && mu === x) {\n      return ML_NAN; /* x-mu is NaN */\n    }\n\n    if (sigma <= 0) {\n      if (sigma < 0) {\n        return ML_ERR_return_NAN(printer);\n      }\n      /* sigma == 0 */\n      return x === mu ? ML_POSINF : R_D__0(give_log);\n    }\n    x = (x - mu) / sigma;\n\n    if (!R_FINITE(x)) return R_D__0(give_log);\n\n    x = fabs(x);\n    if (x >= 2 * sqrt(DBL_MAX)) return R_D__0(give_log);\n    if (give_log) {\n      return -(M_LN_SQRT_2PI + 0.5 * x * x + log(sigma));\n    }\n\n    if (x < 5) return M_1_SQRT_2PI * exp(-0.5 * x * x) / sigma;\n\n    /* ELSE:\n\n     * x*x  may lose upto about two digits accuracy for \"large\" x\n     * Morten Welinder's proposal for PR#15620\n     * https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15620\n\n     * -- 1 --  No hoop jumping when we underflow to zero anyway:\n\n     *  -x^2/2 <         log(2)*.Machine$double.min.exp  <==>\n     *     x   > sqrt(-2*log(2)*.Machine$double.min.exp) =IEEE= 37.64031\n     * but \"thanks\" to denormalized numbers, underflow happens a bit later,\n     *  effective.D.MIN.EXP <- with(.Machine, double.min.exp + double.ulp.digits)\n     * for IEEE, DBL_MIN_EXP is -1022 but \"effective\" is -1074\n     * ==> boundary = sqrt(-2*log(2)*(.Machine$double.min.exp + .Machine$double.ulp.digits))\n     *              =IEEE=  38.58601\n     * [on one x86_64 platform, effective boundary a bit lower: 38.56804]\n     */\n    if (x > sqrt(-2 * M_LN2 * (DBL_MIN_EXP + 1 - DBL_MANT_DIG))) {\n      return 0;\n    }\n\n    /* Now, to get full accurary, split x into two parts,\n   /* Now, to get full accurary, split x into two parts,\n     *  x = x1+x2, such that |x2| <= 2^-16.\n     * Assuming that we are using IEEE doubles, that means that\n     * x1*x1 is error free for x<1024 (but we have x < 38.6 anyway).\n\n     * If we do not have IEEE this is still an improvement over the naive formula.\n     */\n    let x1 = ldexp(R_forceint(ldexp(x, 16)), -16); //  R_forceint(x * 65536) / 65536 =\n    let x2 = x - x1;\n    return (\n      M_1_SQRT_2PI / sigma * (exp(-0.5 * x1 * x1) * exp((-0.5 * x2 - x1) * x2))\n    );\n  \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nexport const  nsig_BESS = 16;\nexport const  ensig_BESS = 1e16;\nexport const  rtnsig_BESS = 1e-4;\nexport const  enmten_BESS = 8.9e-308;\nexport const  enten_BESS = 1e308;\n\nexport const  exparg_BESS = 709.;\nexport const  xlrg_BESS_IJ = 1e5;\nexport const  xlrg_BESS_Y = 1e8;\nexport const  thresh_BESS_Y = 16.;\n\nexport const  xmax_BESS_K = 705.342; /* maximal x for UNscaled answer */\n\n\n/* sqrt(DBL_MIN) =\t1.491668e-154 */\nexport const  sqxmin_BESS_K = 1.49e-154;\n\n/* x < eps_sinc\t <==>  sin(x)/x == 1 (particularly \"==>\");\n  Linux (around 2001-02) gives 2.14946906753213e-08\n  Solaris 2.5.1\t\t gives 2.14911933289084e-08\n  Javascript (V8) around 2018 gives 2.1491194e-8 => 0.9999999999999999,  \n*/\nexport const  M_eps_sinc = 2.149e-8;\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\n\nconst { abs: fabs } = Math;\n\nconst printer = debug('chebyshev_eval');\n\nexport function chebyshev_init(\n  dos: number[],\n  nos: number,\n  eta: number\n): number {\n  let retCode: number = 0;\n  //let ii: number;\n  let err: number;\n\n  if (nos < 1) return 0;\n\n  err = 0.0;\n\n  for (let ii = 1; ii <= nos; ii++) {\n    retCode = nos - ii;\n    err += fabs(dos[retCode]);\n    if (err > eta) {\n      return retCode;\n    }\n  }\n  return retCode;\n}\n\nexport function chebyshev_eval(x: number, a: number[], n: number): number {\n  let b0: number;\n  let b1: number;\n  let b2: number;\n  let twox: number;\n  let i: number;\n\n  if (n < 1 || n > 1000) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (x < -1.1 || x > 1.1) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  twox = x * 2;\n  b2 = b1 = 0;\n  b0 = 0;\n  for (i = 1; i <= n; i++) {\n    b2 = b1;\n    b1 = b0;\n    b0 = twox * b1 - b2 + a[n - i];\n  }\n  return (b0 - b2) * 0.5;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport { stirlerr } from './stirlerror';\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { chebyshev_eval } from '../chebyshev/chebyshev';\nimport { ME, ML_ERR_return_NAN, ML_ERROR } from '../common/_general';\n\nconst printer = debug('lgammacor');\n\nconst algmcs: number[] = [\n    +.1666389480451863247205729650822e+0,\n    -.1384948176067563840732986059135e-4,\n    +.9810825646924729426157171547487e-8,\n    -.1809129475572494194263306266719e-10,\n    +.6221098041892605227126015543416e-13,\n    -.3399615005417721944303330599666e-15,\n    +.2683181998482698748957538846666e-17,\n    -.2868042435334643284144622399999e-19,\n    +.3962837061046434803679306666666e-21,\n    -.6831888753985766870111999999999e-23,\n    +.1429227355942498147573333333333e-24,\n    -.3547598158101070547199999999999e-26,\n    +.1025680058010470912000000000000e-27,\n    -.3401102254316748799999999999999e-29,\n    +.1276642195630062933333333333333e-30\n];\n\nconst nalgm = 5;\nconst xbig = 94906265.62425156;\nconst xmax = 3.745194030963158e306;\n\nexport function lgammacor(x: number) {\n\n    let tmp: number;\n\n    // For IEEE double precision DBL_EPSILON = 2^-52 = 2.220446049250313e-16 :\n    //   xbig = 2 ^ 26.5\n    //   xmax = DBL_MAX / 48 =  2^1020 / 3 \n\n    if (x < 10)\n        return ML_ERR_return_NAN(printer);\n    else if (x >= xmax) {\n        ML_ERROR(ME.ME_UNDERFLOW, 'lgammacor', printer);\n        // allow to underflow below \n    }\n    else if (x < xbig) {\n        tmp = 10 / x;\n        return chebyshev_eval(tmp * tmp * 2 - 1, algmcs, nalgm) / x;\n    }\n    return 1 / (x * 12);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ME, ML_ERR_return_NAN, ML_ERROR, R_P_bounds_01 } from '../common/_general';\n\nimport { lgammafn_sign } from '../gamma/lgammafn_sign';\n\nimport { NumberW, Toms708 } from '../common/toms708';\n\nconst { log1p, floor, max: fmax2, sqrt, log, exp } = Math;\nconst { isNaN: ISNAN } = Number;\n\nconst printer = debug('pnbeta_raw');\n\nfunction pnbeta_raw(\n  x: number,\n  o_x: number,\n  a: number,\n  b: number,\n  ncp: number\n): number {\n  /* o_x  == 1 - x  but maybe more accurate */\n\n  /* change errmax and itrmax if desired;\n     * original (AS 226, R84) had  (errmax; itrmax) = (1e-6; 100) */\n  const errmax = 1.0e-9;\n  const itrmax = 10000; /* 100 is not enough for pf(ncp=200)\n                     see PR#11277 */\n  // double\n  let a0;\n  let lbeta;\n  let c;\n  let errbd;\n  let x0;\n  let temp = new NumberW(0);\n  let tmp_c = new NumberW(0);\n  // int\n  let ierr = new NumberW(0);\n\n  // long double\n  let ans;\n  let ax;\n  let gx;\n  let q;\n  let sumq;\n\n  if (ncp < 0 || a <= 0 || b <= 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (x < 0 || o_x > 1 || (x === 0 && o_x === 1)) return 0;\n  if (x > 1 || o_x < 0 || (x === 1 && o_x === 0)) return 1;\n\n  c = ncp / 2;\n\n  /* initialize the series */\n\n  x0 = floor(fmax2(c - 7 * sqrt(c), 0));\n  a0 = a + x0;\n  lbeta = lgammafn_sign(a0) + lgammafn_sign(b) - lgammafn_sign(a0 + b);\n  /* temp = pbeta_raw(x, a0, b, TRUE, FALSE), but using (x, o_x): */\n  Toms708.bratio(a0, b, x, o_x, temp, tmp_c, ierr);\n\n  gx = exp(\n    a0 * log(x) + b * (x < 0.5 ? log1p(-x) : log(o_x)) - lbeta - log(a0)\n  );\n  if (a0 > a) q = exp(-c + x0 * log(c) - lgammafn_sign(x0 + 1));\n  else q = exp(-c);\n\n  sumq = 1 - q;\n  ans = ax = q * temp.val;\n\n  /* recurse over subsequent terms until convergence is achieved */\n  let j = floor(x0); // x0 could be billions, and is in package EnvStats\n  do {\n    j++;\n    temp.val -= gx;\n    gx *= x * (a + b + j - 1) / (a + j);\n    q *= c / j;\n    sumq -= q;\n    ax = temp.val * q;\n    ans += ax;\n    errbd = (temp.val - gx) * sumq;\n  } while (errbd > errmax && j < itrmax + x0);\n\n  if (errbd > errmax) ML_ERROR(ME.ME_PRECISION, 'pnbeta', printer);\n  if (j >= itrmax + x0) ML_ERROR(ME.ME_NOCONV, 'pnbeta', printer);\n\n  return ans;\n}\n\nconst printer_pnbeta2 = debug('pnbeta2');\nexport function pnbeta2(\n  x: number,\n  o_x: number,\n  a: number,\n  b: number,\n  ncp: number /* o_x  == 1 - x  but maybe more accurate */,\n  lower_tail: boolean,\n  log_p: boolean\n) {\n  let ans = pnbeta_raw(x, o_x, a, b, ncp);\n\n  /* return R_DT_val(ans), but we want to warn about cancellation here */\n  if (lower_tail) {\n    return log_p ? log(ans) : ans;\n  } else {\n    if (ans > 1 - 1e-10) ML_ERROR(ME.ME_PRECISION, 'pnbeta', printer_pnbeta2);\n    if (ans > 1.0) ans = 1.0; /* Precaution */\n    /* include standalone case */\n    return log_p ? log1p(-ans) : 1 - ans;\n  }\n}\n\nexport function pnbeta(\n  x: number,\n  a: number,\n  b: number,\n  ncp: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n\n  if (ISNAN(x) || ISNAN(a) || ISNAN(b) || ISNAN(ncp)) return x + a + b + ncp;\n\n  let rc = R_P_bounds_01(lower_tail, log_p, x, 0, 1);\n  if (rc !== undefined) {\n    return rc;\n  }\n  return pnbeta2(x, 1 - x, a, b, ncp, lower_tail, log_p);\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { rgammaOne } from '../gamma/rgamma';\nimport { rpoisOne } from '../poisson/rpois';\nimport { randomGenHelper } from '../r-func'\nimport { IRNGNormal } from '../rng/normal/inormal-rng';\nimport { rchisqOne } from './rchisq';\n\nconst printer = debug('rnchisq');\nconst { isFinite: R_FINITE } = Number;\n\nexport function rnchisq(\n  n: number| number[],\n  df: number,\n  lambda: number,\n  rng: IRNGNormal\n): number[] {\n  return randomGenHelper(n, rnchisqOne, df, lambda, rng);\n}\n\nexport function rnchisqOne(\n  df: number,\n  lambda: number,\n  rng: IRNGNormal\n): number {\n\n  if (!R_FINITE(df) || !R_FINITE(lambda) || df < 0 || lambda < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  if (lambda === 0) {\n    return df === 0 ? 0 : (rgammaOne(df / 2, 2, rng) as number);\n  } else {\n    let r = rpoisOne(lambda / 2, rng)\n    if (r > 0) r = rchisqOne(2 * r, rng)\n    if (df > 0) r +=  rgammaOne(df / 2, 2, rng)\n    return r;\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_pow_di } from '../common/_general';\n\nimport { randomGenHelper } from '../r-func';\nimport { IRNG } from '../rng/irng';\nimport { qbinom } from './qbinom';\n\nconst { log, abs: fabs, abs, sqrt, min: fmin2, trunc, round } = Math;\nconst { MAX_SAFE_INTEGER: INT_MAX, isFinite: R_FINITE } = Number;\n\nconst printer_rbinom = debug('_rbinom');\n\nexport function rbinom(n: number|number[], nin: number, pp: number, rng: IRNG): number[] {\n  return randomGenHelper(n, rbinomOne, nin, pp, rng)\n}\n\nexport function rbinomOne(nin: number, pp: number, rng: IRNG): number {\n\n // double\n  let c = 0;\n  let fm = 0;\n  let npq = 0;\n  let p1 = 0;\n  let p2 = 0;\n  let p3 = 0;\n  let p4 = 0;\n  let qn = 0;\n  let xl = 0;\n  let xll = 0;\n  let xlr = 0;\n  let xm = 0;\n  let xr = 0;\n  let psave = -1.0;\n\n  //int\n  let nsave = -1;\n  let m = 0;\n\n//double\n  let f: number;\n  let f1: number;\n  let f2: number;\n  let u: number;\n  let v: number;\n  let w: number;\n  let w2: number;\n  let x: number;\n  let x1: number;\n  let x2: number;\n  let z: number;\n  let z2: number;\n  let p: number;\n  let q: number;\n  let np: number;\n  let g: number;\n  let r: number;\n  let al: number;\n  let alv: number;\n  let amaxp: number;\n  let ffm: number;\n  let ynorm: number;\n\n  //int\n  let i;\n  let ix = 0;\n  let k;\n  let n;\n\n  if (!R_FINITE(nin)) return ML_ERR_return_NAN(printer_rbinom);\n  r = round(nin);\n  if (r !== nin) return ML_ERR_return_NAN(printer_rbinom);\n  if (\n    !R_FINITE(pp) ||\n    /* n=0, p=0, p=1 are not errors <TSL>*/\n    r < 0 ||\n    pp < 0 ||\n    pp > 1\n  ) {\n    return ML_ERR_return_NAN(printer_rbinom);\n  }\n  if (r === 0 || pp === 0) return 0;\n  if (pp === 1) return r;\n\n  if (r >= INT_MAX) {\n    /* evade integer overflow,\n            and r == INT_MAX gave only even values */\n    printer_rbinom('Evade overflow:%d > MAX_SAFE_INTEGER', r);\n    return qbinom(\n      rng.internal_unif_rand(), //between 0 and 1\n      r,\n      pp,\n      /*lower_tail*/ false,\n      /*log_p*/ false\n    );\n  }\n  /* else */\n  n = trunc(r);\n\n  p = fmin2(pp, 1 - pp);\n  q = 1 - p;\n  np = n * p;\n  r = p / q;\n  g = r * (n + 1);\n\n  /* Setup, perform only when parameters change [using static (globals): */\n\n  /* FIXING: Want this thread safe\n       -- use as little (thread globals) as possible\n    */\n  let gotoL_np_small = false;\n  if (pp !== psave || n !== nsave) {\n    psave = pp;\n    nsave = n;\n    if (np < 30.0) {\n      /* inverse cdf logic for mean less than 30 */\n      qn = R_pow_di(q, n);\n      gotoL_np_small = true;\n      //goto L_np_small;\n    } else {\n      ffm = np + p;\n      m = trunc(ffm);\n      fm = m;\n      npq = np * q;\n      p1 = trunc(2.195 * sqrt(npq) - 4.6 * q) + 0.5;\n      xm = fm + 0.5;\n      xl = xm - p1;\n      xr = xm + p1;\n      c = 0.134 + 20.5 / (15.3 + fm);\n      al = (ffm - xl) / (ffm - xl * p);\n      xll = al * (1.0 + 0.5 * al);\n      al = (xr - ffm) / (xr * q);\n      xlr = al * (1.0 + 0.5 * al);\n      p2 = p1 * (1.0 + c + c);\n      p3 = p2 + c / xll;\n      p4 = p3 + c / xlr;\n    }\n  } else if (n === nsave) {\n    if (np < 30.0) gotoL_np_small = true;\n    //goto L_np_small;\n  }\n\n  /*-------------------------- np = n*p >= 30 : ------------------- */\n  let gotoFinis = false;\n  while (true && !gotoL_np_small) {\n    u = (rng.internal_unif_rand()) * p4;\n    v = (rng.internal_unif_rand());\n    /* triangular region */\n    if (u <= p1) {\n      ix = trunc(xm - p1 * v + u);\n      gotoFinis = true;\n      break;\n      //goto finis;\n    }\n    /* parallelogram region */\n    if (u <= p2) {\n      x = xl + (u - p1) / c;\n      v = v * c + 1.0 - fabs(xm - x) / p1;\n      if (v > 1.0 || v <= 0) continue;\n      ix = trunc(x);\n    } else {\n      if (u > p3) {\n        /* right tail */\n        ix = trunc(xr - log(v) / xlr);\n        if (ix > n) continue;\n        v = v * (u - p3) * xlr;\n      } else {\n        /* left tail */\n        ix = trunc(xl + log(v) / xll);\n        if (ix < 0) continue;\n        v = v * (u - p2) * xll;\n      }\n    }\n    /* determine appropriate way to perform accept/reject test */\n    k = abs(ix - m);\n    if (k <= 20 || k >= npq / 2 - 1) {\n      /* explicit evaluation */\n      f = 1.0;\n      if (m < ix) {\n        for (i = m + 1; i <= ix; i++) f *= g / i - r;\n      } else if (m !== ix) {\n        for (i = ix + 1; i <= m; i++) f /= g / i - r;\n      }\n      if (v <= f) {\n        gotoFinis = true;\n        break;\n        //goto finis;\n      }\n    } else {\n      /* squeezing using upper and lower bounds on log(f(x)) */\n      amaxp = k / npq * ((k * (k / 3 + 0.625) + 0.1666666666666) / npq + 0.5);\n      ynorm = -k * k / (2.0 * npq);\n      alv = log(v);\n      if (alv < ynorm - amaxp) {\n        gotoFinis = true;\n        break;\n        //goto finis;\n      }\n      if (alv <= ynorm + amaxp) {\n        /* stirling's formula to machine accuracy */\n        /* for the final acceptance/rejection test */\n        x1 = ix + 1;\n        f1 = fm + 1.0;\n        z = n + 1 - fm;\n        w = n - ix + 1.0;\n        z2 = z * z;\n        x2 = x1 * x1;\n        f2 = f1 * f1;\n        w2 = w * w;\n        if (\n          alv <=\n          xm * log(f1 / x1) +\n            (n - m + 0.5) * log(z / w) +\n            (ix - m) * log(w * p / (x1 * q)) +\n            (13860.0 - (462.0 - (132.0 - (99.0 - 140.0 / f2) / f2) / f2) / f2) /\n              f1 /\n              166320.0 +\n            (13860.0 - (462.0 - (132.0 - (99.0 - 140.0 / z2) / z2) / z2) / z2) /\n              z /\n              166320.0 +\n            (13860.0 - (462.0 - (132.0 - (99.0 - 140.0 / x2) / x2) / x2) / x2) /\n              x1 /\n              166320.0 +\n            (13860.0 - (462.0 - (132.0 - (99.0 - 140.0 / w2) / w2) / w2) / w2) /\n              w /\n              166320\n        ) {\n          gotoFinis = true; // finis;\n          break;\n        }\n      }\n    }\n  }\n  if (!gotoFinis) {\n    //L_np_small:\n    /*---------------------- np = n*p < 30 : ------------------------- */\n\n    while (true) {\n      ix = 0;\n      f = qn;\n      u = rng.internal_unif_rand();\n      while (true) {\n        if (u < f) {\n          //goto finis;\n          gotoFinis = true;\n          break;\n        }\n        if (ix > 110) break;\n        u -= f;\n        ix++;\n        f *= g / ix - r;\n      }\n      if (gotoFinis) {\n        break;\n      }\n    }\n  }\n  //finis:\n  if (psave > 0.5) {\n    ix = n - ix;\n  }\n  return ix;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport {\n    pgamma\n} from '../gamma/pgamma';\n\nexport function pchisq(x: number, df: number, lowerTail: boolean= true, logP: boolean= false) {\n    return pgamma(x, df / 2., 2., lowerTail, logP);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  M_LN_SQRT_2PI,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_D__1,\n  R_D_exp,\n  R_DT_0,\n  R_DT_1,\n  R_DT_val\n} from '../common/_general';\n\nimport { R_Log1_Exp } from '../exp/expm1';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { logspace_add } from '../gamma/logspace-add';\nimport { pchisq } from './pchisq';\n\nconst {\n  sqrt,\n  abs: fabs,\n  exp,\n  log,\n  min: fmin2,\n  max: fmax2,\n  LN2: M_LN2,\n  LN10: M_LN10\n} = Math;\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  EPSILON: DBL_EPSILON,\n  NEGATIVE_INFINITY: ML_NEGINF\n} = Number;\n\nexport const DBL_MAX_EXP = Math.log2(Number.MAX_VALUE);\nexport const DBL_MIN_EXP = Math.log2(Number.MIN_VALUE);\n\nconst _dbl_min_exp = M_LN2 * DBL_MIN_EXP;\n/*= -708.3964 for IEEE double precision */\nconst { expm1, log1p } = Math;\nconst printer = debug('pnchisq');\n\nexport function pnchisq(\n  x: number,\n  df: number,\n  ncp = 0,\n  lower_tail = true,\n  log_p = false\n): number {\n    let ans;\n\n    if (ISNAN(x) || ISNAN(df) || ISNAN(ncp)) {\n      return NaN;\n    }\n    if (!R_FINITE(df) || !R_FINITE(ncp)) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (df < 0 || ncp < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    ans = pnchisq_raw(\n      x,\n      df,\n      ncp,\n      1e-12,\n      8 * DBL_EPSILON,\n      1000000,\n      lower_tail,\n      log_p\n    );\n    if (ncp >= 80) {\n      if (lower_tail) {\n        ans = fmin2(ans, R_D__1(log_p)); /* e.g., pchisq(555, 1.01, ncp = 80) */\n      } else {\n        /* !lower_tail */\n        /* since we computed the other tail cancellation is likely */\n        if (ans < (log_p ? -10 * M_LN10 : 1e-10))\n          ML_ERROR(ME.ME_PRECISION, 'pnchisq', printer);\n        if (!log_p) ans = fmax2(ans, 0.0); /* Precaution PR#7099 */\n      }\n    }\n    if (!log_p || ans < -1e-8) {\n      return ans;\n    }\n\n    // log_p  &&  ans > -1e-8\n    // prob. = exp(ans) is near one: we can do better using the other tail\n    printer('   pnchisq_raw(*, log_p): ans=%d => 2nd call, other tail', ans);\n\n    // FIXME: (sum,sum2) will be the same (=> return them as well and reuse here ?)\n    ans = pnchisq_raw(\n      x,\n      df,\n      ncp,\n      1e-12,\n      8 * DBL_EPSILON,\n      1000000,\n      !lower_tail,\n      false\n    );\n    return log1p(-ans);\n  \n}\n\nexport function pnchisq_raw(\n  x: number,\n  f: number,\n  theta: number /* = ncp */,\n  errmax: number,\n  reltol: number,\n  itrmax: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  //double\n  let lam;\n  let x2;\n  let f2;\n  let term;\n  let bound;\n  let f_x_2n;\n  let f_2n;\n  let l_lam = -1;\n  let l_x = -1; /* initialized for -Wall */\n  //Rboolean\n  let lamSml: boolean;\n  let tSml: boolean;\n  let is_r: boolean;\n  let is_b: boolean;\n  let is_it: boolean;\n  \n  //LDOUBLE\n  let ans: number;\n  let u: number;\n  let v: number;\n  let t: number;\n  let lt: number;\n  let lu = -1;\n\n  if (x <= 0) {\n    if (x === 0 && f === 0) {\n      const _L = -0.5 * theta;\n      const result =\n         lower_tail ?\n         R_D_exp(log_p, _L)\n        : (log_p ? R_Log1_Exp(_L) \n            : -expm1(_L)\n          )\n        ;\n      printer('result1:%d', result);\n      return result;  \n    }\n    /* x < 0  or {x==0, f > 0} */\n    return R_DT_0(lower_tail, log_p);\n  }\n  if (!R_FINITE(x)) return R_DT_1(lower_tail, log_p);\n\n  /* This is principally for use from qnchisq */\n\n  if (theta < 80) {\n    /* use 110 for Inf, as ppois(110, 80/2, lower.tail=FALSE) is 2e-20 */\n    //double\n    let ans;\n    //int\n    let i;\n    // Have  pgamma(x,s) < x^s / Gamma(s+1) (< and ~= for small x)\n    // === = > pchisq(x, f) = pgamma(x, f/2, 2) = pgamma(x/2, f/2)\n    //                  <  (x/2)^(f/2) / Gamma(f/2+1) < eps\n    // <==>  f/2 * log(x/2) - log(Gamma(f/2+1)) < log(eps) ( ~= -708.3964 )\n    // <==>        log(x/2) < 2/f*(log(Gamma(f/2+1)) + log(eps))\n    // <==> log(x) < log(2) + 2/f*(log(Gamma(f/2+1)) + log(eps))\n    if (\n      lower_tail &&\n      f > 0 &&\n      log(x) < M_LN2 + 2 / f * (lgammafn(f / 2 + 1) + _dbl_min_exp)\n    ) {\n      // all  pchisq(x, f+2*i, lower_tail, FALSE), i=0,...,110 would underflow to 0.\n      // === = > work in log scale\n      let lambda = 0.5 * theta;\n      let sum = ML_NEGINF;\n      let sum2 = ML_NEGINF;\n      let pr = -lambda;\n      /* we need to renormalize here: the result could be very close to 1 */\n      for (i = 0; i < 110; pr += log(lambda) - log(++i)) {\n        sum2 = logspace_add(sum2, pr);\n        sum = logspace_add(sum, pr + pchisq(x, f + 2 * i, lower_tail, true));\n        if (sum2 >= -1e-15) {/*<=> EXP(sum2) >= 1-1e-15 */ \n          break;\n        }\n      }\n      ans = sum - sum2;\n      printer(\n        'pnchisq(x=%d, f=%d, th.=%d); th. < 80, logspace: i=%d, ans=(sum=%d)-(sum2=%d)',\n        x,\n        f,\n        theta,\n        i,\n        sum,\n        sum2\n      );\n\n      return log_p ? ans : exp(ans);\n    } else {\n      let lambda = 0.5 * theta;\n      let sum = 0;\n      let sum2 = 0;\n      let pr = exp(-lambda); // does this need a feature test?\n      /* we need to renormalize here: the result could be very close to 1 */\n      for (i = 0; i < 110; pr *= lambda / ++i) {\n        // pr === =  exp(-lambda) lambda^i / i!  ===   dpois(i, lambda)\n        sum2 += pr;\n        // pchisq(*, i, *) is  strictly decreasing to 0 for lower_tail=TRUE\n        //                 and strictly increasing to 1 for lower_tail=FALSE\n        sum += pr * pchisq(x, f + 2 * i, lower_tail, false);\n        if (sum2 >= 1 - 1e-15) break;\n      }\n      ans = sum / sum2;\n\n      printer(\n        'pnchisq(x=%d, f=%d, theta=%d); theta < 80: i=%d, sum=%d, sum2=%d',\n        x,\n        f,\n        theta,\n        i,\n        sum,\n        sum2\n      );\n\n      return log_p ? log(ans) : ans;\n    }\n  } // if(theta < 80)\n\n  // else: theta ===  ncp >= 80 --------------------------------------------\n\n  printer('pnchisq(x=%d, f=%d, theta=%d >= 80): ', x, f, theta);\n\n  // Series expansion ------- FIXME: log_p=TRUE, lower_tail=FALSE only applied at end\n\n  lam = 0.5 * theta;\n  lamSml = -lam < _dbl_min_exp;\n  if (lamSml) {\n    /* MATHLIB_ERROR(\n           \"non centrality parameter (= %g) too large for current algorithm\",\n           theta) */\n    u = 0;\n    lu = -lam; /* ===  ln(u) */\n    l_lam = log(lam);\n  } else {\n    u = exp(-lam);\n  }\n\n  /* evaluate the first term */\n  v = u;\n  x2 = 0.5 * x;\n  f2 = 0.5 * f;\n  f_x_2n = f - x;\n\n  printer('-- v=exp(-th/2)=%d, x/2= %d, f/2= %d', v, x2, f2);\n\n  if (\n    f2 * DBL_EPSILON > 0.125 && /* very large f and x ~= f: probably needs */\n    fabs((t = x2 - f2))  < /* another algorithm anyway */\n     sqrt(DBL_EPSILON) * f2\n  ) {\n    /* evade cancellation error */\n    /* t = exp((1 - t)*(2 - t/(f2 + 1))) / sqrt(2*M_PI*(f2 + 1));*/\n    lt = (1 - t) * (2 - t / (f2 + 1)) - M_LN_SQRT_2PI - 0.5 * log(f2 + 1);\n\n    printer(' (case I) === > ');\n  } else {\n    /* Usual case 2: careful not to overflow .. : */\n    lt = f2 * log(x2) - x2 - lgammafn(f2 + 1);\n  }\n\n  printer(' lt= %d', lt);\n\n  tSml = lt < _dbl_min_exp;\n  if (tSml) {\n    printer(' is very small');\n\n    if (x > f + theta + 5 * sqrt(2 * (f + 2 * theta))) {\n      /* x > E[X] + 5* sigma(X) */\n      return R_DT_1(\n        lower_tail,\n        log_p\n      ); /* FIXME: could be more accurate than 0. */\n    } /* else */\n    l_x = log(x);\n    ans = term = 0;\n    t = 0;\n  } else {\n    t = exp(lt);\n    printer(', t=exp(lt)= %d', t);\n    term = v * t;\n    ans = term;\n  }\n\n  let n; //cant put it inside the for below((\n  for (n = 1, f_2n = f + 2, f_x_2n += 2 ;; n++, f_2n += 2, f_x_2n += 2 ) {\n    printer(' _OL_: n=%d', n);\n    /* f_2n    === = f + 2*n\n         * f_x_2n  === = f - x + 2*n   > 0  <==> (f+2n)  >   x */\n    if (f_x_2n > 0) {\n      /* find the error bound and check for convergence */\n\n      bound = t * x / f_x_2n;\n\n      printer(' L10: n=%d; term= %d; bound= %d', n, term, bound);\n\n      is_r = is_it = false;\n      /* convergence only if BOTH absolute and relative error < 'bnd' */\n      if (\n        ((is_b = bound <= errmax) && (is_r = term <= reltol * ans)) ||\n        (is_it = n > itrmax)\n      ) {\n        printer(\n          'BREAK n=%d %s; bound= %d %s, rel.err= %d %s',\n          n,\n          is_it ? '> itrmax' : '',\n          bound,\n          is_b ? '<= errmax' : '',\n          term / ans,\n          is_r ? '<= reltol' : ''\n        );\n        break; /* out completely */\n      }\n    }\n\n    /* evaluate the next term of the */\n    /* expansion and then the partial sum */\n\n    if (lamSml) {\n      lu += l_lam - log(n); /* u = u* lam / n */\n      if (lu >= _dbl_min_exp) {\n        /* no underflow anymore === > change regime */\n\n        printer(' n=%d; nomore underflow in u = exp(lu) === > change', n);\n\n        v = u = exp(lu); /* the first non-0 'u' */\n        lamSml = false;\n      }\n    } else {\n      u *= lam / n;\n      v += u;\n    }\n    if (tSml) {\n      lt += l_x - log(f_2n); /* t <- t * (x / f2n) */\n      if (lt >= _dbl_min_exp) {\n        /* no underflow anymore === > change regime */\n\n        printer('  n=%d; nomore underflow in t = exp(lt) === > change', n);\n\n        t = exp(lt); /* the first non-0 't' */\n        tSml = false;\n      }\n    } else {\n      t *= x / f_2n;\n    }\n    if (!lamSml && !tSml) {\n      term = v * t;\n      ans += term;\n    }\n  } /* for(n ...) */\n\n  if (is_it) {\n    printer('pnchisq(x=%d, ..): not converged in %d iter.', x, itrmax);\n  }\n\n  printer(' ===  L_End: n=%d; term= %d; bound=%d', n, term, bound);\n\n  return R_DT_val(lower_tail, log_p, ans);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { qgamma } from '../gamma/qgamma';\n\n\nexport function qchisq(\n  p: number,\n  df: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  return qgamma(p, 0.5 * df, 2.0, lowerTail, logP);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { dgamma as _dgamma } from './dgamma';\nimport { pgamma as _pgamma } from './pgamma';\nimport { qgamma as _qgamma } from './qgamma';\nimport { rgammaOne as _rgammaOne } from './rgamma';\n\n//aux\nimport { Inversion, IRNGNormal } from '../rng/normal';\n\n//special\nimport { gammafn } from './gamma_fn';\nimport { lgammafn_sign as lgammafn } from './lgammafn_sign';\nimport {\n  digamma,\n  pentagamma,\n  psigamma,\n  tetragamma,\n  trigamma\n} from './polygamma';\n\nexport default {\n  digamma,\n  gamma: gammafn,\n  lgamma: lgammafn,\n  pentagamma,\n  psigamma,\n  tetragamma,\n  trigamma\n};\n\nimport { randomGenHelper } from '../r-func'\n\nconst { abs } = Math;\n\nexport function Gamma(norm: IRNGNormal = new Inversion()) {\n  const printer_n = debug('gamma_normalize_params');\n\n  function gammaNormalizeParams(\n    rate?: number,\n    scale?: number\n  ): number | undefined {\n    //B: if scale and rate are undefined then _scale = 1\n    //C: if scale and rate are both defined and scale != 1/rate, return undefined\n    //D: if scale is defined and rate is not , use scale\n    //E: if rate is defined and scale is not then use 1/rate\n\n    //B\n    if (scale === undefined && rate === undefined) {\n      return 1;\n    }\n\n    //C\n    if (scale !== undefined && rate !== undefined) {\n      if (abs(scale * rate - 1) >= 1e-16) {\n        printer_n('Both scale:%d and rate:%d are defined but scale <> 1/rate');\n        return undefined;\n      }\n      return scale;\n    }\n\n    //D\n    if (scale !== undefined && rate === undefined) {\n      return scale;\n    }\n\n    //E\n    if (scale === undefined && rate !== undefined) {\n      return 1 / rate;\n    }\n\n    throw new Error('unreachable code, you cant be here!');\n  }\n\n  const printer_d = debug('dgamma');\n\n  function dgamma(\n    x: number,\n    shape: number,\n    rate?: number,\n    scale?: number,\n    asLog = false\n  ) {\n    // scenarios\n    let _scale = gammaNormalizeParams(rate, scale);\n    if (_scale !== undefined) {\n      return _dgamma(x, shape, _scale, asLog);\n    }\n    printer_d('Cannot normalize to [scale]');\n    return NaN;\n  }\n\n  const printer_p = debug('pgamma');\n  function pgamma(\n    q: number,\n    shape: number,\n    rate?: number,\n    scale?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    // scenarios\n    let _scale = gammaNormalizeParams(rate, scale);\n    if (_scale !== undefined) {\n      return _pgamma(q, shape, _scale, lowerTail, logP);\n    }\n    printer_p('Cannot normalize to [scale]');\n    return NaN\n  }\n\n  const printer_q = debug('qgamma');\n\n  function qgamma(\n    q: number,\n    shape: number,\n    rate?: number,\n    scale?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    // scenarios\n    let _scale = gammaNormalizeParams(rate, scale);\n    if (_scale !== undefined) {\n      return _qgamma(q, shape, _scale, lowerTail, logP);\n    }\n    printer_q('Cannot normalize to [scale]');\n    return NaN\n  }\n\n  const printer_rgamma = debug('rgammaOne');\n  \n  function rgamma(n: number|number[], shape: number, rate?: number, scale?: number): number[]{\n    return randomGenHelper(n, rgammaOne, shape, rate, scale);\n  }\n\n\n  function rgammaOne(shape: number, rate?: number, scale?: number): number {\n    let _scale = gammaNormalizeParams(rate, scale);\n    if (_scale !== undefined) {\n      return _rgammaOne(shape, _scale, norm);\n    }\n    printer_rgamma('Cannot normalize to [scale]');\n    return NaN\n  } \n\n  return Object.freeze({\n    dgamma,\n    pgamma,\n    qgamma,\n    rgamma\n  });\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func'\nimport { IRNGNormal } from '../rng/normal';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('rnorm');\n\n\n\nexport function rnorm(n: number, mu= 0, sigma = 1, rng: IRNGNormal ): number[]{\n  return randomGenHelper(n, rnormOne, mu, sigma, rng);\n}\n\n\n\nexport function rnormOne(\n  mu: number = 0,\n  sigma: number = 1,\n  rng: IRNGNormal\n): number {\n    if (ISNAN(mu) || !R_FINITE(sigma) || sigma < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n    if (sigma === 0 || !R_FINITE(mu)) {\n      return mu; /* includes mu = +/- Inf with finite sigma */\n    }\n    return mu + sigma * (rng.norm_randOne() as number);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  M_1_SQRT_2PI,\n  M_LN_SQRT_2PI,\n  ML_ERR_return_NAN,\n  R_D__0\n} from '../common/_general';\n\nimport { bd0 } from '../deviance/bd0';\nimport { dnorm4 as dnorm } from '../normal/dnorm';\nimport { stirlerr } from '../stirling/stirlerror';\n\nconst { log1p, abs: fabs, exp, log, sqrt } = Math;\nconst { isNaN: ISNAN, EPSILON: DBL_EPSILON, isFinite: R_FINITE } = Number;\n\nconst printer_dt = debug('dt');\nexport function dt(\n  x: number,\n  n: number,\n  giveLog: boolean = false\n): number {\n  if (ISNAN(x) || ISNAN(n)) {\n    return x + n;\n  }\n  if (n <= 0) {\n    return ML_ERR_return_NAN(printer_dt);\n  }\n  if (!R_FINITE(x)) {\n    return R_D__0(giveLog);\n  }\n  if (!R_FINITE(n)) {\n    return dnorm(x, 0, 1, giveLog);\n  }\n\n  let u: number;\n  let t = -bd0(n / 2, (n + 1) / 2) + stirlerr((n + 1) / 2) - stirlerr(n / 2);\n  let x2n = x * x / n;\n  // in  [0, Inf]\n  let ax = 0; // <- -Wpedantic\n  let l_x2n; // := log(sqrt(1 + x2n)) = log(1 + x2n)/2\n  let lrg_x2n: boolean = x2n > 1 / DBL_EPSILON;\n  if (lrg_x2n) {\n    // large x^2/n :\n    ax = fabs(x);\n    l_x2n = log(ax) - log(n) / 2; // = log(x2n)/2 = 1/2 * log(x^2 / n)\n    u = //  log(1 + x2n) * n/2 =  n * log(1 + x2n)/2 =\n      n * l_x2n;\n  } else if (x2n > 0.2) {\n    l_x2n = log(1 + x2n) / 2;\n    u = n * l_x2n;\n  } else {\n    l_x2n = log1p(x2n) / 2;\n    u = -bd0(n / 2, (n + x * x) / 2) + x * x / 2;\n  }\n\n  //old: return  R_D_fexp(M_2PI*(1+x2n), t-u);\n\n  // R_D_fexp(f,x) :=  (give_log ? -0.5*log(f)+(x) : exp(x)/sqrt(f))\n  // f = 2pi*(1+x2n)\n  //  ==> 0.5*log(f) = log(2pi)/2 + log(1+x2n)/2 = log(2pi)/2 + l_x2n\n  //\t     1/sqrt(f) = 1/sqrt(2pi * (1+ x^2 / n))\n  //\t\t       = 1/sqrt(2pi)/(|x|/sqrt(n)*sqrt(1+1/x2n))\n  //\t\t       = M_1_SQRT_2PI * sqrt(n)/ (|x|*sqrt(1+1/x2n))\n  if (giveLog) return t - u - (M_LN_SQRT_2PI + l_x2n);\n\n  // else :  if(lrg_x2n) : sqrt(1 + 1/x2n) ='= sqrt(1) = 1\n  let I_sqrt_ = lrg_x2n ? sqrt(n) / ax : exp(-l_x2n);\n  return exp(t - u) * M_1_SQRT_2PI * I_sqrt_;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { pbeta } from '../beta/pbeta';\nimport {\n  //DBL_MIN_EXP,\n  M_LN_SQRT_PI,\n  M_SQRT_2dPI,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_DT_0,\n  R_DT_1,\n  R_DT_val\n} from '../common/_general';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { pnorm5 as pnorm } from '../normal/pnorm';\nimport { pt } from './pt';\n\nconst { isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\nconst { sqrt, exp, pow, log, expm1, abs: fabs, min: fmin2 } = Math;\nconst printer_pnt = debug('pnt');\nconst DBL_MIN_EXP = -1021;\nconst M_LN2 = 0.693147180559945309417;\n\nexport function pnt(\n  _t: number,\n  df: number,\n  ncp: number,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n  //double\n  let errbd: number;\n  let rxb: number;\n  let x: number;\n\n  // long double\n  let geven: number;\n  let godd: number;\n  let p: number;\n  let q: number;\n\n  let s: number;\n\n  let tnc: number = 0;\n  let xeven: number;\n  let xodd: number;\n  // int\n\n  /* note - itrmax and errmax may be changed to suit one's needs. */\n\n  const itrmax = 1000;\n  const errmax = 1e-12;\n\n  if (df <= 0.0) {\n    return ML_ERR_return_NAN(printer_pnt);\n  }\n\n  if (ncp === 0.0) {\n    return pt(_t, df, lower_tail, log_p);\n  }\n\n  if (!R_FINITE(_t)) {\n    return _t < 0 ? R_DT_0(lower_tail, log_p) : R_DT_1(lower_tail, log_p);\n  }\n\n  const negdel = _t < 0;\n  const tt = fabs(_t);\n  const del = _t >= 0 ? ncp : -ncp;\n\n  /* \n      We deal quickly with left tail if extreme,\n        since pt(q, df, ncp) <= pt(0, df, ncp) = \\Phi(-ncp) \n    */\n  if (_t < 0 && ncp > 40 && (!log_p || !lower_tail)) {\n    printer_pnt('if x <=0 and solution for edge ncp > 40');\n    return R_DT_0(lower_tail, log_p);\n  }\n\n  if (df > 4e5 || del * del > 2 * M_LN2 * -DBL_MIN_EXP) {\n    printer_pnt(\n      'Abramowitz & Stegun 26.7.10 ncp:%d, del:%d, ncp2:%d, del2:%d, D:%d',\n      ncp,\n      del,\n      ncp * ncp,\n      del * del,\n      2 * M_LN2 * -DBL_MIN_EXP\n    );\n\n    // in JS its del >= 38.604  then 0.5*exp(-0.5(del*del)) === 0\n    // use Number.MIN_VALUE = 5e-324 to calculate\n    /*\n       -- 2nd part: if del > 37.62, then p=0 below\n          FIXME: test should depend on `df', `tt' AND `del' ! \n    */\n    /* \n      Approx. from\t Abramowitz & Stegun 26.7.10 (p.949) \n    */\n    const _s = 1 / (4 * df);\n\n    return pnorm(\n      tt * (1 - _s),\n      del,\n      sqrt(1 + tt * tt * 2 * _s),\n      lower_tail !== negdel,\n      log_p\n    );\n  }\n\n  /* initialize twin series */\n  /* Guenther, J. (1978). Statist. Computn. Simuln. vol.6, 199. */\n\n  x = _t * _t; // always positive?\n  rxb = df / (x + df); /* := (1 - x) {x below} -- but more accurately */\n  x = x / (x + df); /* in [0,1) */\n\n  printer_pnt(\n    'pnt(t=%d, df=%d, ncp=%d, rxb=%d) ==> x= %d',\n    _t,\n    df,\n    ncp,\n    rxb,\n    x\n  );\n\n  // x will be always >= 0\n  // because df >0\n  // edge case is x==0, then we skip this\n  if (x > 0) {\n    printer_pnt('x > 0 branch');\n    /* <==>  t != 0 */\n    const lambda = del * del;\n    p = 0.5 * exp(-0.5 * lambda);\n\n    printer_pnt('p=%d', p);\n\n    if (p === 0) {\n      /* underflow! */\n      printer_pnt('p=%d, underflow protection', p);\n      /*========== really use an other algorithm for this case !!! */\n      ML_ERROR(ME.ME_UNDERFLOW, 'pnt', printer_pnt);\n      ML_ERROR(ME.ME_RANGE, 'pnt', printer_pnt); /* |ncp| too large */\n      return R_DT_0(lower_tail, log_p);\n    }\n\n    printer_pnt(\n      'it  1e5*(godd,   geven)|          p           q           s' +\n        /* 1.3 1..4..7.9 1..4..7.9|1..4..7.901 1..4..7.901 1..4..7.901 */\n        '        pnt(*)     errbd'\n    );\n    /* 1..4..7..0..34 1..4..7.9*/\n\n    q = M_SQRT_2dPI * p * del;\n    s = 0.5 - p;\n    /* s = 0.5 - p = 0.5*(1 - exp(-.5 L)) =  -0.5*expm1(-.5 L)) */\n    if (s < 1e-7) s = -0.5 * expm1(-0.5 * lambda);\n    let a = 0.5;\n    let b = 0.5 * df;\n    /* rxb = (1 - x) ^ b   [ ~= 1 - b*x for tiny x --> see 'xeven' below]\n         *       where '(1 - x)' =: rxb {accurately!} above */\n    rxb = pow(rxb, b);\n    const albeta = M_LN_SQRT_PI + lgammafn(b) - lgammafn(0.5 + b);\n    xodd = pbeta(x, a, b, /*lower*/ true, /*log_p*/ false);\n    printer_pnt('return from pbeta:%d', xodd);\n    godd = 2 * rxb * exp(a * log(x) - albeta);\n    tnc = b * x;\n    xeven = tnc < DBL_EPSILON ? tnc : 1 - rxb;\n    geven = tnc * rxb;\n    tnc = p * xodd + q * xeven;\n\n    let gotoFinis = false;\n\n    /* repeat until convergence or iteration limit */\n    for (let it = 1; it <= itrmax; it++) {\n      a += 1;\n      xodd -= godd;\n      xeven -= geven;\n      godd *= x * (a + b - 1) / a;\n      geven *= x * (a + b - 0.5) / (a + 0.5);\n      p *= lambda / (2 * it);\n      q *= lambda / (2 * it + 1);\n      tnc += p * xodd + q * xeven;\n      s -= p;\n      /* R 2.4.0 added test for rounding error here. */\n\n      if (s < -1e-10) {\n        /* happens e.g. for (t,df,ncp)=(40,10,38.5), after 799 it.*/\n        ML_ERROR(ME.ME_PRECISION, 'pnt', printer_pnt);\n        printer_pnt('goto:true, s = %d < 0 !!! ---> non-convergence!!', s);\n        gotoFinis = true;\n        break;\n      }\n      if (s <= 0) {\n        printer_pnt('goto:true, s:%d < 0 && it:%d>1', s, it);\n        gotoFinis = true;\n        break;\n      }\n      errbd = 2 * s * (xodd - godd);\n\n      printer_pnt(\n        '%d %d %d|%d %d %d %d %d',\n        it,\n        1e5 * godd,\n        1e5 * geven,\n        p,\n        q,\n        s,\n        tnc,\n        errbd\n      );\n\n      if (fabs(errbd) < errmax) {\n        printer_pnt('goto:true, errbd:%d < errmax:%d', errbd, errmax);\n        gotoFinis = true; /*convergence*/\n        break;\n      }\n      gotoFinis = false;\n    } //for (it = 1; it <= itrmax; it++)\n    /* non-convergence:*/\n    if (!gotoFinis) {\n      ML_ERROR(ME.ME_NOCONV, 'pnt', printer_pnt);\n    }\n  }\n  //finis: goto label\n  tnc += pnorm(-del, 0, 1, /*lower*/ true, /*log_p*/ false);\n\n  lower_tail = lower_tail !== negdel; /* xor */\n  /*\n    negdel = (t < 0)\n    lt nd  | nlt\n    T  T   |  F\n    T  F   |  T\n    F  T   |  T\n    T  T      F\n\n  */\n  if (tnc > 1 - 1e-10 && lower_tail) {\n    ML_ERROR(ME.ME_PRECISION, 'pnt{final}', printer_pnt);\n  }\n  const rc = R_DT_val(lower_tail, log_p, fmin2(tnc, 1) /* Precaution */);\n  printer_pnt(\n    'rc:%d, tnc:%d, log_p:%s, lower_tail:%s',\n    rc,\n    tnc,\n    log_p,\n    lower_tail\n  );\n\n  return rc;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { lbeta } from '../beta/lbeta';\nimport { pbeta } from '../beta/pbeta';\nimport {\n  M_LN2,\n  ML_ERR_return_NAN,\n  R_D_Cval,\n  R_DT_0,\n  R_DT_1\n} from '../common/_general';\nimport { pnorm5 as pnorm } from '../normal/pnorm';\n\nconst { log1p, sqrt, log, abs: fabs, exp } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst printer = debug('pt');\n\nexport function pt(\n  x: number,\n  n: number,\n  lowerTail: boolean = true,\n  log_p: boolean = false\n): number {\n  /* return  P[ T <= x ]\twhere\n     * T ~ t_{n}  (t distrib. with n degrees of freedom).\n    \n     *\t--> ./pnt.c for NON-central\n     */\n    let val;\n    let nx;\n\n    let lower_tail = lowerTail;\n\n    if (ISNAN(x) || ISNAN(n)) return x + n;\n\n    if (n <= 0.0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (!R_FINITE(x)) {\n      return x < 0 ? R_DT_0(lower_tail, log_p) : R_DT_1(lower_tail, log_p);\n    }\n\n    if (!R_FINITE(n)) {\n      return pnorm(x, 0.0, 1.0, lower_tail, log_p);\n    }\n\n    if (n > 4e5) {\n      /*-- Fixme(?): test should depend on `n' AND `x' ! */\n      /* Approx. from\t Abramowitz & Stegun 26.7.8 (p.949) */\n      val = 1 / (4 * n);\n      return pnorm(\n        x * (1 - val) / sqrt(1 + x * x * 2 * val),\n        0.0,\n        1.0,\n        lower_tail,\n        log_p\n      );\n    }\n\n    nx = 1 + x / n * x;\n    /* FIXME: This test is probably losing rather than gaining precision,\n     * now that pbeta(*, log_p = TRUE) is much better.\n     * Note however that a version of this test *is* needed for x*x > D_MAX */\n    if (nx > 1e100) {\n      /* <==>  x*x > 1e100 * n  */\n      /* Danger of underflow. So use Abramowitz & Stegun 26.5.4\n           pbeta(z, a, b) ~ z^a(1-z)^b / aB(a,b) ~ z^a / aB(a,b),\n           with z = 1/nx,  a = n/2,  b= 1/2 :\n        */\n      let lval;\n      lval =\n        -0.5 * n * (2 * log(fabs(x)) - log(n)) -\n        lbeta(0.5 * n, 0.5) -\n        log(0.5 * n);\n      val = log_p ? lval : exp(lval);\n    } else {\n      val =\n        n > x * x\n          ? pbeta(x * x / (n + x * x), 0.5, n / 2, /*lower_tail*/ false, log_p)\n          : pbeta(1 / nx, n / 2, 0.5, /*lower_tail*/ true, log_p);\n    }\n\n    /* Use \"1 - v\"  if\tlower_tail  and\t x > 0 (but not both):*/\n    if (x <= 0) {\n      lower_tail = !lower_tail;\n    }\n\n    if (log_p) {\n      if (lower_tail) {\n        return log1p(-0.5 * exp(val));\n      } else {\n        return val - M_LN2; /* = log(.5* pbeta(....)) */\n      }\n    } else {\n      val /= 2;\n      return R_D_Cval(lower_tail, val);\n    }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nconst { trunc } = Math;\n\nimport { WilcoxonCache } from './WilcoxonCache';\n\nexport function cwilcox(\n  k: number,\n  m: number,\n  n: number,\n  w: WilcoxonCache\n): number {\n  let i;\n  let j;\n\n  const u = m * n;\n  const c = trunc(u / 2);\n\n  if (k < 0 || k > u) {\n    return 0;\n  }\n\n  if (k > c) {\n    k = u - k; /* hence  k <= floor(u / 2) */\n  }\n\n  if (m < n) {\n    i = m;\n    j = n;\n  } else {\n    i = n;\n    j = m;\n  } /* hence  i <= j */\n\n  /*if (j === 0) {\n    // and hence i == 0 \n    console.log(`5. cwilcox: exit with k:${k}`);\n    return k === 0 ? 1 : 0;\n  }*/\n\n  /*\n     We can simplify things if k is small.  Consider the Mann-Whitney \n         definition, and sort y.  Then if the statistic is k, no more \n         than k of the y's can be <= any x[i], and since they are sorted \n         these can only be in the first k.  So the count is the same as\n         if there were just k y's. \n  */\n\n  if (j > 0 && k < j) {\n    return cwilcox(k, i, k, w);\n  }\n\n  /*if (w[i][j] === undefined) {\n      w[i][j] = new Array<number>(c + 1).fill(-1); //  (double *) calloc((size_t) c + 1, sizeof(double));\n      //#ifdef MATHLIB_STANDALONE\n      //if (!w[i][j]) MATHLIB_ERROR(_(\"wilcox allocation error %d\"), 3);\n      //#endif\n      //NOTE: replaced by \"fill\" for (l = 0; l <= c; l++) w[i][j][l] = -1;\n    }*/\n\n  if (w.get(i, j, k) === undefined) {\n    if (j === 0) {\n      w.set(i, j, k, k === 0 ? 1 : 0);\n    } else {\n      const c1 = cwilcox(k - j, i - 1, j, w);\n      const c2 =  cwilcox(k, i, j - 1, w);\n      w.set(i, j, k, c1 + c2);\n    }\n  }\n  const result = w.get(i, j, k);\n  if (result === undefined){\n    throw new Error ('WilcoxonCache not set');\n  }\n  return result;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport class WilcoxonCache {\n  \n  //private _map = new Map<number, Map<number, Map<number, number>>>();\n  private _map2 = {};\n  constructor() {\n\n  }\n\n  public get(i: number, j: number, k: number): number | undefined {\n    /*const jMap = this._map.get(i);\n    if (jMap) {\n      const kMap = jMap.get(j);\n      if (kMap) {\n        return kMap.get(k);\n      }\n    }\n    return undefined;*/\n    const jstruct = this._map2[i];\n    if (jstruct !== undefined){\n      const kstruct = jstruct[j];\n      if (kstruct !==  undefined ){\n        return kstruct[k];\n      }\n    }\n    return undefined;\n  }\n\n  public set(i: number, j: number, k: number, value: number ){\n    /*\n    USING old fashioned way of simple objects to mimic key-value mapping\n    DONT USE: new Map(), it will cause performance problems\n    \n    let jMap = this._map.get(i);\n    if (!jMap) {\n      jMap = new Map();  \n      this._map.set(i, jMap);\n    }\n    let kMap = jMap.get(j);\n    if (!kMap) {\n        kMap = new Map();\n        jMap.set(j, kMap);\n    }\n    kMap.set(k, value);*/\n    let jstruct = this._map2[i];\n    if (jstruct === undefined){\n      jstruct = {};\n      this._map2[i] = jstruct;\n    }\n    let kstruct = jstruct[j];\n    if (kstruct === undefined){\n      kstruct = {};\n      jstruct[j] = kstruct;\n    }\n    kstruct[k] = value;\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n//special\nimport { beta } from './beta';\nimport { lbeta } from './lbeta';\n\n//distros\n//dbeta\nimport { dbeta as _dbeta } from './dbeta';\nimport { dnbeta as _dnbeta } from './dnbeta';\n\n//pbeta\nimport { pbeta as _pbeta } from './pbeta';\nimport { pnbeta as _pnbeta } from './pnbeta';\n\n//qbeta\nimport { qbeta as _qbeta } from './qbeta';\nimport { qnbeta as _qnbeta } from './qnbeta';\n\n//rbeta\nimport { rchisq } from '../chi-2/rchisq';\nimport { rnchisq } from '../chi-2/rnchisq';\nimport { Inversion, IRNGNormal } from '../rng/normal';\n\nimport { rbeta as _rbeta } from './rbeta';\n\nexport default {\n  beta,\n  lbeta\n};\n\nexport function Beta(rng: IRNGNormal = new Inversion()) {\n  function dbeta(\n    x: number,\n    shape1: number,\n    shape2: number,\n    ncp?: number,\n    log?: boolean\n  ): number {\n    // I added the === 0 here, because dnbeta will go back to dbeta if 0 (c source code)\n    if (ncp === undefined || ncp === 0) {\n      return _dbeta(x, shape1, shape2, log || false);\n    } else {\n      return _dnbeta(x, shape1, shape2, ncp || 0, log || false);\n    }\n  }\n\n  function pbeta(\n    q: number,\n    shape1: number,\n    shape2: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ): number {\n    if (ncp === undefined || ncp === 0) {\n      return _pbeta(q, shape1, shape2, lowerTail, logP);\n    } else {\n      return _pnbeta(q, shape1, shape2, ncp, lowerTail, logP);\n    }\n  }\n\n  function qbeta(\n    p: number,\n    shape1: number,\n    shape2: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ): number {\n    if (ncp === undefined) {\n      return _qbeta(p, shape1, shape2, lowerTail, logP);\n    } else {\n      return _qnbeta(p, shape1, shape2, ncp, lowerTail, logP);\n    }\n  }\n\n  function rbeta(\n    n: number|number[],\n    shape1: number,\n    shape2: number,\n    ncp = 0 // NOTE: normally the default is undefined, here it is '0'.\n  ): number[] {\n    if (ncp === 0) {\n      return _rbeta(n, shape1, shape2, rng);\n    } else {\n      let ar = rnchisq(n, 2 * shape1, ncp, rng);\n      let br = rchisq(n, 2 * shape2, rng);\n      let result = ar.map((a, i) => ({ a, b: br[i] })).map(({ a, b }) => a / (a + b));\n      return result;\n    }\n  }\n\n  return Object.freeze({\n    dbeta,\n    pbeta,\n    qbeta,\n    rbeta\n  });\n}\n","\"use strict\";\n\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\nfunction setup(env) {\n  createDebug.debug = createDebug;\n  createDebug.default = createDebug;\n  createDebug.coerce = coerce;\n  createDebug.disable = disable;\n  createDebug.enable = enable;\n  createDebug.enabled = enabled;\n  createDebug.humanize = require('ms');\n  Object.keys(env).forEach(function (key) {\n    createDebug[key] = env[key];\n  });\n  /**\n  * Active `debug` instances.\n  */\n\n  createDebug.instances = [];\n  /**\n  * The currently active debug mode names, and names to skip.\n  */\n\n  createDebug.names = [];\n  createDebug.skips = [];\n  /**\n  * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n  *\n  * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n  */\n\n  createDebug.formatters = {};\n  /**\n  * Selects a color for a debug namespace\n  * @param {String} namespace The namespace string for the for the debug instance to be colored\n  * @return {Number|String} An ANSI color code for the given namespace\n  * @api private\n  */\n\n  function selectColor(namespace) {\n    var hash = 0;\n\n    for (var i = 0; i < namespace.length; i++) {\n      hash = (hash << 5) - hash + namespace.charCodeAt(i);\n      hash |= 0; // Convert to 32bit integer\n    }\n\n    return createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n  }\n\n  createDebug.selectColor = selectColor;\n  /**\n  * Create a debugger with the given `namespace`.\n  *\n  * @param {String} namespace\n  * @return {Function}\n  * @api public\n  */\n\n  function createDebug(namespace) {\n    var prevTime;\n\n    function debug() {\n      // Disabled?\n      if (!debug.enabled) {\n        return;\n      }\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var self = debug; // Set `diff` timestamp\n\n      var curr = Number(new Date());\n      var ms = curr - (prevTime || curr);\n      self.diff = ms;\n      self.prev = prevTime;\n      self.curr = curr;\n      prevTime = curr;\n      args[0] = createDebug.coerce(args[0]);\n\n      if (typeof args[0] !== 'string') {\n        // Anything else let's inspect with %O\n        args.unshift('%O');\n      } // Apply any `formatters` transformations\n\n\n      var index = 0;\n      args[0] = args[0].replace(/%([a-zA-Z%])/g, function (match, format) {\n        // If we encounter an escaped % then don't increase the array index\n        if (match === '%%') {\n          return match;\n        }\n\n        index++;\n        var formatter = createDebug.formatters[format];\n\n        if (typeof formatter === 'function') {\n          var val = args[index];\n          match = formatter.call(self, val); // Now we need to remove `args[index]` since it's inlined in the `format`\n\n          args.splice(index, 1);\n          index--;\n        }\n\n        return match;\n      }); // Apply env-specific formatting (colors, etc.)\n\n      createDebug.formatArgs.call(self, args);\n      var logFn = self.log || createDebug.log;\n      logFn.apply(self, args);\n    }\n\n    debug.namespace = namespace;\n    debug.enabled = createDebug.enabled(namespace);\n    debug.useColors = createDebug.useColors();\n    debug.color = selectColor(namespace);\n    debug.destroy = destroy;\n    debug.extend = extend; // Debug.formatArgs = formatArgs;\n    // debug.rawLog = rawLog;\n    // env-specific initialization logic for debug instances\n\n    if (typeof createDebug.init === 'function') {\n      createDebug.init(debug);\n    }\n\n    createDebug.instances.push(debug);\n    return debug;\n  }\n\n  function destroy() {\n    var index = createDebug.instances.indexOf(this);\n\n    if (index !== -1) {\n      createDebug.instances.splice(index, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  function extend(namespace, delimiter) {\n    return createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n  }\n  /**\n  * Enables a debug mode by namespaces. This can include modes\n  * separated by a colon and wildcards.\n  *\n  * @param {String} namespaces\n  * @api public\n  */\n\n\n  function enable(namespaces) {\n    createDebug.save(namespaces);\n    createDebug.names = [];\n    createDebug.skips = [];\n    var i;\n    var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n    var len = split.length;\n\n    for (i = 0; i < len; i++) {\n      if (!split[i]) {\n        // ignore empty strings\n        continue;\n      }\n\n      namespaces = split[i].replace(/\\*/g, '.*?');\n\n      if (namespaces[0] === '-') {\n        createDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n      } else {\n        createDebug.names.push(new RegExp('^' + namespaces + '$'));\n      }\n    }\n\n    for (i = 0; i < createDebug.instances.length; i++) {\n      var instance = createDebug.instances[i];\n      instance.enabled = createDebug.enabled(instance.namespace);\n    }\n  }\n  /**\n  * Disable debug output.\n  *\n  * @api public\n  */\n\n\n  function disable() {\n    createDebug.enable('');\n  }\n  /**\n  * Returns true if the given mode name is enabled, false otherwise.\n  *\n  * @param {String} name\n  * @return {Boolean}\n  * @api public\n  */\n\n\n  function enabled(name) {\n    if (name[name.length - 1] === '*') {\n      return true;\n    }\n\n    var i;\n    var len;\n\n    for (i = 0, len = createDebug.skips.length; i < len; i++) {\n      if (createDebug.skips[i].test(name)) {\n        return false;\n      }\n    }\n\n    for (i = 0, len = createDebug.names.length; i < len; i++) {\n      if (createDebug.names[i].test(name)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n  /**\n  * Coerce `val`.\n  *\n  * @param {Mixed} val\n  * @return {Mixed}\n  * @api private\n  */\n\n\n  function coerce(val) {\n    if (val instanceof Error) {\n      return val.stack || val.message;\n    }\n\n    return val;\n  }\n\n  createDebug.enable(createDebug.load());\n  return createDebug;\n}\n\nmodule.exports = setup;\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { M_LN_SQRT_2PI } from '../common/_general';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\n\nconst { trunc , log } = Math;\n\nconst sferr_halves: number[] = [\n    0.0, // n=0 - wrong, place holder only \n    0.1534264097200273452913848,  // 0.5 \n    0.0810614667953272582196702,  // 1.0 \n    0.0548141210519176538961390,  // 1.5 \n    0.0413406959554092940938221,  // 2.0  \n    0.03316287351993628748511048, // 2.5  \n    0.02767792568499833914878929, // 3.0  \n    0.02374616365629749597132920, // 3.5  \n    0.02079067210376509311152277, // 4.0  \n    0.01848845053267318523077934, // 4.5  \n    0.01664469118982119216319487, // 5.0  \n    0.01513497322191737887351255, // 5.5  \n    0.01387612882307074799874573, // 6.0  \n    0.01281046524292022692424986, // 6.5  \n    0.01189670994589177009505572, // 7.0  \n    0.01110455975820691732662991, // 7.5  \n    0.010411265261972096497478567, // 8.0  \n    0.009799416126158803298389475, // 8.5  \n    0.009255462182712732917728637, // 9.0  \n    0.008768700134139385462952823, // 9.5  \n    0.008330563433362871256469318, // 10.0  \n    0.007934114564314020547248100, // 10.5  \n    0.007573675487951840794972024, // 11.0  \n    0.007244554301320383179543912, // 11.5  \n    0.006942840107209529865664152, // 12.0  \n    0.006665247032707682442354394, // 12.5  \n    0.006408994188004207068439631, // 13.0  \n    0.006171712263039457647532867, // 13.5  \n    0.005951370112758847735624416, // 14.0  \n    0.005746216513010115682023589, // 14.5  \n    0.005554733551962801371038690  // 15.0  \n];\n\nconst S0 = 0.083333333333333333333;       // 1/12 \nconst S1 = 0.00277777777777777777778;     // 1/360 \nconst S2 = 0.00079365079365079365079365;  // 1/1260 \nconst S3 = 0.000595238095238095238095238; // 1/1680 \nconst S4 = 0.0008417508417508417508417508; // 1/1188 \n\n\n// stirlerr(n) = log(n!) - log( sqrt(2*pi*n)*(n/e)^n )\n//              = log Gamma(n+1) - 1/2 * [log(2*pi) + log(n)] - n*[log(n) - 1]\n//             = log Gamma(n+1) - (n + 1/2) * log(n) + n - log(2*pi)/2\n//\n// see also lgammacor() in ./lgammacor.c  which computes almost the same!\n//\n\n export function stirlerr(n: number): number {\n\n    //  error for 0, 0.5, 1.0, 1.5, ..., 14.5, 15.0.\n    let nn: number;\n\n    if (n <= 15.0) {\n        nn = n + n;\n        if (nn === trunc(nn)) return (sferr_halves[trunc(nn)]);\n        return (lgammafn(n + 1.) - (n + 0.5) * log(n) + n - M_LN_SQRT_2PI);\n    }\n\n    nn = n * n;\n    if (n > 500) return ((S0 - S1 / nn) / n);\n    if (n > 80) return ((S0 - (S1 - S2 / nn) / nn) / n);\n    if (n > 35) return ((S0 - (S1 - (S2 - S3 / nn) / nn) / nn) / n);\n    // 15 < n <= 35 :\n    return ((S0 - (S1 - (S2 - (S3 - S4 / nn) / nn) / nn) / nn) / n);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { fmod, ME, ML_ERROR } from '../common/_general';\nconst { NaN: ML_NAN, isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst {  PI: M_PI } = Math;\n\n// tan(pi * x)  -- exact when x = k/2  for all integer k\nconst printer_tanpi = debug('tanpi');\nexport function tanpi(x: number): number {\n  if (ISNAN(x)) return x;\n  if (!R_FINITE(x)) {\n    ML_ERROR(ME.ME_DOMAIN, '', printer_tanpi);\n    return ML_NAN;\n  }\n  x = fmod(x, 1); // tan(pi(x + k)) == tan(pi x)  for all integer k\n  // map (-1,1) --> (-1/2, 1/2] :\n  if (x <= -0.5) {\n    x++;\n  } else if (x > 0.5) {\n    x--;\n  }\n  return x === 0 ? 0 : x === 0.5 ? ML_NAN : Math.tan(M_PI * x);\n}\n\nexport function atanpi(x: number) {\n  return Math.atan(x) / Math.PI;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D_exp,\n  R_D_val\n} from '../common/_general';\n\n\nimport { dbinom_raw } from '../binomial/dbinom';\n\nimport { lbeta  } from './lbeta';\n\nconst { log, log1p } = Math;\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer = debug('dbeta');\n\nexport function dbeta(x: number, a: number, b: number, asLog: boolean): number {\n\n  if (ISNAN(x) || ISNAN(a) || ISNAN(b)) return x + a + b;\n\n  if (a < 0 || b < 0) return ML_ERR_return_NAN(printer);\n  if (x < 0 || x > 1) return R_D__0(asLog);\n\n  // limit cases for (a,b), leading to point masses\n\n  if (a === 0 || b === 0 || !R_FINITE(a) || !R_FINITE(b)) {\n    if (a === 0 && b === 0) {\n      // point mass 1/2 at each of {0,1} :\n      if (x === 0 || x === 1) return ML_POSINF;\n      else return R_D__0(asLog);\n    }\n    if (a === 0 || a / b === 0) {\n      // point mass 1 at 0\n      if (x === 0) return ML_POSINF;\n      else return R_D__0(asLog);\n    }\n    if (b === 0 || b / a === 0) {\n      // point mass 1 at 1\n      if (x === 1) return ML_POSINF;\n      else return R_D__0(asLog);\n    }\n    // else, remaining case:  a = b = Inf : point mass 1 at 1/2\n    if (x === 0.5) return ML_POSINF;\n    else return R_D__0(asLog);\n  }\n\n  if (x === 0) {\n    if (a > 1) return R_D__0(asLog);\n    if (a < 1) return ML_POSINF;\n      /* a == 1 : */ return R_D_val(asLog, b);\n  }\n  if (x === 1) {\n    if (b > 1) return R_D__0(asLog);\n    if (b < 1) return ML_POSINF;\n      /* b == 1 : */ return R_D_val(asLog, a);\n  }\n\n  let lval: number;\n  if (a <= 2 || b <= 2)\n    lval = (a - 1) * log(x) + (b - 1) * log1p(-x) - lbeta(a, b);\n  else {\n    lval = log(a + b - 1) + dbinom_raw(a - 1, a + b - 2, x, 1 - x, true);\n  }\n  return R_D_exp(asLog, lval);\n\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport * from './bd0';\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst { isFinite: R_FINITE, MIN_VALUE: DBL_MIN, NaN } = Number;\nconst { abs: fabs, log } = Math;\n\n\nexport function bd0(x: number, np: number): number {\n  let ej: number;\n\n  let s: number;\n\n  let s1: number;\n\n  let v: number;\n\n  let j: number;\n\n  if (!R_FINITE(x) || !R_FINITE(np) || np === 0.0) {\n    return NaN;\n  }\n\n  if (fabs(x - np) < 0.1 * (x + np)) {\n    v = (x - np) / (x + np); // might underflow to 0\n\n    s = (x - np) * v; // s using v -- change by MM\n\n    if (fabs(s) < DBL_MIN) return s;\n\n    ej = 2 * x * v;\n\n    v = v * v;\n\n    for (j = 1; j < 1000; j++) {\n      // Taylor series; 1000: no infinite loop\n\n      //\t\t\t\tas |v| < .1,  v^2000 is \"zero\"\n\n      ej *= v; // = v^(2j+1)\n\n      s1 = s + ej / ((j << 1) + 1);\n\n      if (s1 === s)\n        //* last term was effectively 0\n\n        return s1;\n\n      s = s1;\n    }\n  }\n\n  // else:  | x - np |  is not too small\n\n  return x * log(x / np) + np - x;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport {\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D_exp\n} from '../common/_general';\nimport { dpois_raw } from '../poisson/dpois';\nimport { dbeta } from './dbeta';\n\n\nconst { log:ln, sqrt, ceil } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('dnbeta');\n\n//also used by f-distriution\n\n\nexport function dnbeta(\n  x: number,\n  a: number,\n  b: number,\n  ncp: number,\n  give_log: boolean\n): number {\n  const eps = 1e-15;\n  //int\n  let kMax;\n  //double\n  let k;\n  let ncp2;\n  let dx2;\n  let d;\n  let D;\n  let term;\n  //long double\n  let sum;\n  let p_k;\n  let q;\n\n  if (ISNAN(x) || ISNAN(a) || ISNAN(b) || ISNAN(ncp)) return x + a + b + ncp;\n  if (ncp < 0 || a <= 0 || b <= 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (!R_FINITE(a) || !R_FINITE(b) || !R_FINITE(ncp)) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (x < 0 || x > 1) {\n    return R_D__0(give_log);\n  }\n  if (ncp === 0) {\n    return dbeta(x, a, b, give_log) as number;\n  }\n  /* New algorithm, starting with *largest* term : */\n  ncp2 = 0.5 * ncp;\n  dx2 = ncp2 * x;\n  d = (dx2 - a - 1) / 2;\n  D = d * d + dx2 * (a + b) - a;\n  if (D <= 0) {\n    kMax = 0;\n  } else {\n    D = ceil(d + sqrt(D));\n    kMax = D > 0 ? D : 0;\n  }\n\n  /* The starting \"middle term\" --- first look at it's log scale: */\n  term = dbeta(x, a + kMax, b, /* log = */ true);\n  p_k = dpois_raw(kMax, ncp2, true);\n  if (x === 0 || !R_FINITE(term) || !R_FINITE(p_k)) {\n    /* if term = +Inf */\n    return R_D_exp(give_log, p_k + term);\n  }\n\n  /* Now if s_k := p_k * t_k  {here = exp(p_k + term)} would underflow,\n     * we should rather scale everything and re-scale at the end:*/\n\n  p_k += term; /* = log(p_k) + log(t_k) == log(s_k) -- used at end to rescale */\n  /* mid = 1 = the rescaled value, instead of  mid = exp(p_k); */\n\n  /* Now sum from the inside out */\n  sum = term = 1 /* = mid term */;\n  /* middle to the left */\n  k = kMax;\n  while (k > 0 && term > sum * eps) {\n    k--;\n    q = /* 1 / r_k = */ (k + 1) * (k + a) / (k + a + b) / dx2;\n    term *= q;\n    sum += term;\n  }\n  /* middle to the right */\n  term = 1;\n  k = kMax;\n  do {\n    q = /* r_{old k} = */ dx2 * (k + a + b) / (k + a) / (k + 1);\n    k++;\n    term *= q;\n    sum += term;\n  } while (term > sum * eps);\n\n  return R_D_exp(give_log, p_k + ln(sum));\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport class NumberW {\n  private _val: number;\n  constructor(v: number = 0) {\n    this._val = v;\n  }\n  get val() {\n    return this._val;\n  }\n  set val(a: number) {\n    if (Number.isNaN(a)) {\n      throw new Error(`trying to set NaN, old value:${this._val}`);\n    }\n    this._val = a;\n\n  }\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  DBL_MANT_DIG,\n  DBL_MIN_EXP,\n  M_LN2,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_D_half,\n  R_DT_0,\n  R_DT_1,\n  R_pow_di\n} from '../common/_general';\n\nimport {\n  R_DT_CIv,\n  R_DT_Clog,\n  R_DT_log,\n  R_DT_qIv,\n  R_Log1_Exp\n} from '../exp/expm1';\n\nimport { lbeta } from '../beta/lbeta';\nimport { pbeta_raw } from '../beta/pbeta';\n\nconst {\n  expm1,\n  log1p,\n  sqrt,\n  min: fmin2,\n  exp,\n  abs: fabs,\n  log,\n  pow,\n  max: fmax2\n} = Math;\n\nconst {\n  isNaN: ISNAN,\n  MIN_VALUE: DBL_MIN,\n  EPSILON: DBL_EPSILON,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF,\n  isFinite: R_FINITE,\n  NaN: ML_NAN\n} = Number;\n\n\n\n\n\n\nconst USE_LOG_X_CUTOFF = -5;\n//                       --- based on some testing; had = -10\n\nconst n_NEWTON_FREE = 4;\n//                   --- based on some testing; had = 10\n\nconst MLOGICAL_NA = -1;\n// an \"NA_LOGICAL\" substitute for Mathlib {only used here, for now}\n\n//attribute_hidden\n/*export function qbeta_raw(alpha: number, double p, double q, int lower_tail, int log_p,\n        int swap_01, double log_q_cut, int n_N, double * qb): number { return 0 };\n*/\n\nconst printer_qbeta = debug('qbeta');\nexport function qbeta<T>(\n  pp: T,\n  shape1: number,\n  shape2: number,\n  lower_tail: boolean,\n  log_p: boolean\n): T {\n  /* test for admissibility of parameters */\n\n  const fa: number[] = Array.isArray(pp) ? pp : ([pp] as any);\n\n  const result = fa.map(p => {\n    if (ISNAN(shape1) || ISNAN(shape2) || ISNAN(p)) return shape1 + shape2 + p;\n\n    if (shape1 < 0 || shape2 < 0) {\n      return ML_ERR_return_NAN(printer_qbeta);\n    }\n    // allowing p==0 and q==0  <==> treat as one- or two-point mass\n\n    let qbet = [0, 0]; // = { qbeta(), 1 - qbeta() }\n\n    qbeta_raw(\n      p,\n      shape1,\n      shape2,\n      lower_tail,\n      log_p,\n      MLOGICAL_NA,\n      USE_LOG_X_CUTOFF,\n      n_NEWTON_FREE,\n      qbet\n    );\n    return qbet[0];\n  });\n  return result.length === 1 ? result[0] : (result as any);\n}\n\n// CARE: assumes subnormal numbers, i.e., no underflow at DBL_MIN:\nconst DBL_very_MIN = DBL_MIN / 4;\nconst DBL_log_v_MIN = M_LN2 * (DBL_MIN_EXP - 2);\n// Too extreme: inaccuracy in pbeta(); e.g for  qbeta(0.95, 1e-9, 20):\n// -> in pbeta() --> bgrat(..... b*z === 0 underflow, hence inaccurate pbeta()\n/* DBL_very_MIN  = 0x0.0000001p-1022, // = 2^-1050 = 2^(-1022 - 28) */\n/* DBL_log_v_MIN = -1050. * M_LN2, // = log(DBL_very_MIN) */\n// the most extreme -- not ok, as pbeta() then behaves strangely,\n// e.g., for  qbeta(0.95, 1e-8, 20):\n/* DBL_very_MIN  = 0x0.0000000000001p-1022, // = 2^-1074 = 2^(-1022 -52) */\n/* DBL_log_v_MIN = -1074. * M_LN2, // = log(DBL_very_MIN) */\n\nconst DBL_1__eps = 1 - DBL_EPSILON; // or rather (1 - DBL_EPSILON/2) (??)\n\n/* set the exponent of acu to -2r-2 for r digits of accuracy */\n/*---- NEW ---- -- still fails for p = 1e11, q=.5*/\n\nconst fpu = 3e-308;\n/* acu_min:  Minimal value for accuracy 'acu' which will depend on (a,p);\n         acu_min >= fpu ! */\nconst acu_min = 1e-300;\nconst p_lo = fpu;\nconst p_hi = 1 - 2.22e-16;\n\nconst const1 = 2.30753;\nconst const2 = 0.27061;\nconst const3 = 0.99229;\nconst const4 = 0.04481;\n\nfunction return_q_0(give_log_q: boolean, qb: number[]): void {\n  if (give_log_q) {\n    qb[0] = ML_NEGINF;\n    qb[1] = 0;\n  } else {\n    qb[0] = 0;\n    qb[1] = 1;\n  }\n  return;\n}\n\nfunction return_q_1(give_log_q: boolean, qb: number[]): void {\n  if (give_log_q) {\n    qb[0] = 0;\n    qb[1] = ML_NEGINF;\n  } else {\n    qb[0] = 1;\n    qb[1] = 0;\n  }\n  return;\n}\n\nfunction return_q_half(give_log_q: boolean, qb: number[]): void {\n  if (give_log_q) {\n    qb[0] = qb[1] = -M_LN2;\n  } else {\n    qb[0] = qb[1] = 0.5;\n  }\n  return;\n}\n\n\nconst printer_qbeta_raw = debug('qbeta_raw');\nconst R_ifDEBUG_printf = printer_qbeta_raw;\n// Returns both qbeta() and its \"mirror\" 1-qbeta(). Useful notably when qbeta() ~= 1\nexport function qbeta_raw(\n  alpha: number,\n  p: number,\n  q: number,\n  lower_tail: boolean,\n  log_p: boolean,\n  swap_01: number, // {TRUE, NA, FALSE}: if NA, algorithm decides swap_tail\n  log_q_cut: number /* if === Inf: return log(qbeta(..));\n                   otherwise, if finite: the bound for\n                   switching to log(x)-scale; see use_log_x */,\n  n_N: number, // number of \"unconstrained\" Newton steps before switching to constrained\n  qb: number[] // = qb[0:1] = { qbeta(), 1 - qbeta() }\n): void {\n  let swap_choose = swap_01 === MLOGICAL_NA;\n  let swap_tail;\n  let log_;\n  let give_log_q = log_q_cut === ML_POSINF;\n  let use_log_x = give_log_q; // or u < log_q_cut  below\n  let warned = false;\n  let add_N_step = true;\n  let i_pb;\n  let i_inn;\n  let a;\n  let la;\n  let logbeta;\n  let g;\n  let h;\n  let pp;\n  let p_;\n  let qq;\n  let r;\n  let s;\n  let t;\n  let w;\n  let y = -1;\n  let u: number = 0;\n  let xinbta: number = 0;\n  let u_n: number = 0;\n\n  // Assuming p >= 0, q >= 0  here ...\n\n  // Deal with boundary cases here:\n  if (alpha === R_DT_0(lower_tail, log_p)) {\n    return return_q_0(give_log_q, qb);\n  }\n  if (alpha === R_DT_1(lower_tail, log_p)) {\n    return return_q_1(give_log_q, qb);\n  }\n\n  // check alpha {*before* transformation which may all accuracy}:\n  if ((log_p && alpha > 0) || (!log_p && (alpha < 0 || alpha > 1))) {\n    // alpha is outside\n    printer_qbeta_raw(\n      'qbeta(alpha=%d, %d, %d, .., log_p=%d): %s%s',\n      alpha,\n      p,\n      q,\n      log_p,\n      'alpha not in ',\n      log_p ? '[-Inf, 0]' : '[0,1]'\n    );\n    // ML_ERR_return_NAN :\n    ML_ERROR(ME.ME_DOMAIN, '', printer_qbeta_raw);\n    qb[0] = qb[1] = ML_NAN;\n    return;\n  }\n\n  //  p==0, q==0, p = Inf, q = Inf  <==> treat as one- or two-point mass\n  if (p === 0 || q === 0 || !R_FINITE(p) || !R_FINITE(q)) {\n    // We know 0 < T(alpha) < 1 : pbeta() is constant and trivial in {0, 1/2, 1}\n    printer_qbeta_raw(\n      'qbeta(%d, %d, %d, lower_t=%d, log_p=%d): (p,q)-boundary: trivial',\n      alpha,\n      p,\n      q,\n      lower_tail,\n      log_p\n    );\n    if (p === 0 && q === 0) {\n      // point mass 1/2 at each of {0,1} :\n      if (alpha < R_D_half(log_p)) {\n        return_q_0(give_log_q, qb);\n      }\n      if (alpha > R_D_half(log_p)) {\n        return_q_1(give_log_q, qb);\n      }\n      // else:  alpha === \"1/2\"\n      return_q_half(give_log_q, qb);\n    } else if (p === 0 || p / q === 0) {\n      // point mass 1 at 0 - \"flipped around\"\n      return_q_0;\n    } else if (q === 0 || q / p === 0) {\n      // point mass 1 at 0 - \"flipped around\"\n      return_q_1;\n    }\n    // else:  p = q = Inf : point mass 1 at 1/2\n    return_q_half;\n  }\n\n  /* initialize */\n  p_ = R_DT_qIv(lower_tail, log_p, alpha); /* lower_tail prob (in any case) */\n  // Conceptually,  0 < p_ < 1  (but can be 0 or 1 because of cancellation!)\n  logbeta = lbeta(p, q);\n\n  swap_tail = swap_choose ? p_ > 0.5 : swap_01;\n  // change tail; default (swap_01 = NA): afterwards 0 < a <= 1/2\n  if (swap_tail) {\n    /* change tail, swap  p <-> q :*/\n    a = R_DT_CIv(lower_tail, log_p, alpha); // = 1 - p_ < 1/2\n    /* la := log(a), but without numerical cancellation: */\n    la = R_DT_Clog(lower_tail, log_p, alpha);\n    pp = q;\n    qq = p;\n  } else {\n    a = p_;\n    la = R_DT_log(lower_tail, log_p, alpha);\n    pp = p;\n    qq = q;\n  }\n\n  /* calculate the initial approximation */\n\n  /* Desired accuracy for Newton iterations (below) should depend on  (a,p)\n     * This is from Remark .. on AS 109, adapted.\n     * However, it's not clear if this is \"optimal\" for IEEE double prec.\n\n     * acu = fmax2(acu_min, pow(10., -25. - 5./(pp * pp) - 1./(a * a)));\n\n     * NEW: 'acu' accuracy NOT for squared adjustment, but simple;\n     * ---- i.e.,  \"new acu\" = sqrt(old acu)\n    */\n  let acu = fmax2(acu_min, pow(10, -13 - 2.5 / (pp * pp) - 0.5 / (a * a)));\n  // try to catch  \"extreme left tail\" early\n  let tx = 0;\n  let u0 = (la + log(pp) + logbeta) / pp; // = log(x_0)\n  let log_eps_c = M_LN2 * (1 - DBL_MANT_DIG); // = log(DBL_EPSILON) = -36.04..\n  r = pp * (1 - qq) / (pp + 1);\n\n  t = 0.2;\n  // FIXME: Factor 0.2 is a bit arbitrary;  '1' is clearly much too much.\n\n  printer_qbeta_raw(\n    'qbeta(%d, %d, %d, lower_t=%d, log_p=%d):%s   swap_tail=%d, la=%d, u0=%d (bnd: %d (%d)) ',\n    alpha,\n    p,\n    q,\n    lower_tail,\n    log_p,\n    log_p && (p_ === 0 || p_ === 1) ? (p_ === 0 ? ' p_=0' : ' p_=1') : '',\n    swap_tail,\n    la,\n    u0,\n    (t * log_eps_c - log(fabs(pp * (1 - qq) * (2 - qq) / (2 * (pp + 2))))) / 2,\n    t * log_eps_c - log(fabs(r))\n  );\n\n  let goto_L_Newton = false;\n  let goto_L_return = false;\n  let goto_L_converged = false;\n\n  if (\n    M_LN2 * DBL_MIN_EXP < u0 && // cannot allow exp(u0) = 0 ==> exp(u1) = exp(u0) = 0\n    u0 < -0.01 && // (must: u0 < 0, but too close to 0 <==> x = exp(u0) = 0.99..)\n    // qq <= 2 && // <--- \"arbitrary\"\n    // u0 <  t*log_eps_c - log(fabs(r)) &&\n    u0 <\n      (t * log_eps_c - log(fabs(pp * (1 - qq) * (2 - qq) / (2 * (pp + 2))))) / 2\n  ) {\n    // TODO: maybe jump here from below, when initial u \"fails\" ?\n    // L_tail_u:\n    // MM's one-step correction (cheaper than 1 Newton!)\n    r = r * exp(u0); // = r*x0\n    if (r > -1) {\n      u = u0 - log1p(r) / pp;\n      printer_qbeta_raw('u1-u0=%d --> choosing u = u1', u - u0);\n    } else {\n      u = u0;\n      printer_qbeta_raw('cannot cheaply improve u0');\n    }\n    tx = xinbta = exp(u);\n    use_log_x = true; // or (u < log_q_cut)  ??\n    //goto L_Newton;\n    goto_L_Newton = true;\n  }\n\n  if (!goto_L_Newton) {\n    // y := y_\\alpha in AS 64 := Hastings(1955) approximation of qnorm(1 - a) :\n    r = sqrt(-2 * la);\n    y = r - (const1 + const2 * r) / (1 + (const3 + const4 * r) * r);\n\n    if (pp > 1 && qq > 1) {\n      // use  Carter(1947), see AS 109, remark '5.'\n      r = (y * y - 3) / 6;\n      s = 1 / (pp + pp - 1);\n      t = 1 / (qq + qq - 1);\n      h = 2 / (s + t);\n      w = y * sqrt(h + r) / h - (t - s) * (r + 5.0 / 6.0 - 2.0 / (3 * h));\n      printer_qbeta_raw('p,q > 1 => w=%d', w);\n      if (w > 300) {\n        // exp(w+w) is huge or overflows\n        t = w + w + log(qq) - log(pp); // = argument of log1pexp(.)\n        u = // log(xinbta) = - log1p(qq/pp * exp(w+w)) = -log(1 + exp(t))\n          t <= 18 ? -log1p(exp(t)) : -t - exp(-t);\n        xinbta = exp(u);\n      } else {\n        xinbta = pp / (pp + qq * exp(w + w));\n        u = -log1p(qq / pp * exp(w + w)); // log(xinbta)\n      }\n    } else {\n      // use the original AS 64 proposal, Scheff-Tukey (1944) and Wilson-Hilferty\n      r = qq + qq;\n      /* A slightly more stable version of  t := \\chi^2_{alpha} of AS 64\n             * t = 1. / (9. * qq); t = r * R_pow_di(1. - t + y * sqrt(t), 3);  */\n      t = 1 / (3 * sqrt(qq));\n      t = r * R_pow_di(1 + t * (-t + y), 3); // = \\chi^2_{alpha} of AS 64\n      s = 4 * pp + r - 2; // 4p + 2q - 2 = numerator of new t = (...) / chi^2\n      R_ifDEBUG_printf('min(p,q) <= 1: t=%g', t);\n      if (t === 0 || (t < 0 && s >= t)) {\n        // cannot use chisq approx\n        // x0 = 1 - { (1-a)*q*B(p,q) } ^{1/q}    {AS 65}\n        // xinbta = 1. - exp((log(1-a)+ log(qq) + logbeta) / qq);\n        let l1ma; /* := log(1-a), directly from alpha (as 'la' above):\n             * FIXME: not worth it? log1p(-a) always the same ?? */\n        if (swap_tail) l1ma = R_DT_log(lower_tail, log_p, alpha);\n        else l1ma = R_DT_Clog(lower_tail, log_p, alpha);\n        R_ifDEBUG_printf(\n          ' t <= 0 : log1p(-a)=%.15g, better l1ma=%.15g\\n',\n          log1p(-a),\n          l1ma\n        );\n        let xx = (l1ma + log(qq) + logbeta) / qq;\n        if (xx <= 0) {\n          xinbta = -expm1(xx);\n          u = R_Log1_Exp(xx); // =  log(xinbta) = log(1 - exp(...A...))\n        } else {\n          // xx > 0 ==> 1 - e^xx < 0 .. is nonsense\n          R_ifDEBUG_printf(' xx=%g > 0: xinbta:= 1-e^xx < 0\\n', xx);\n          xinbta = 0;\n          u = ML_NEGINF; /// FIXME can do better?\n        }\n      } else {\n        t = s / t;\n        R_ifDEBUG_printf(' t > 0 or s < t < 0:  new t = %g ( > 1 ?)\\n', t);\n        if (t <= 1) {\n          // cannot use chisq, either\n          u = (la + log(pp) + logbeta) / pp;\n          xinbta = exp(u);\n        } else {\n          // (1+x0)/(1-x0) = t,  solved for x0 :\n          xinbta = 1 - 2 / (t + 1);\n          u = log1p(-2 / (t + 1));\n        }\n      }\n    }\n\n    // Problem: If initial u is completely wrong, we make a wrong decision here\n    if (\n      swap_choose &&\n      ((swap_tail && u >= -exp(log_q_cut)) || // ==> \"swap back\"\n        (!swap_tail && u >= -exp(4 * log_q_cut) && pp / qq < 1000))\n    ) {\n      // ==> \"swap now\" (much less easily)\n      // \"revert swap\" -- and use_log_x\n      swap_tail = !swap_tail;\n      R_ifDEBUG_printf(' u = %g (e^u = xinbta = %.16g) ==> ', u, xinbta);\n      if (swap_tail) {\n        a = R_DT_CIv(lower_tail, log_p, alpha); // needed ?\n        la = R_DT_Clog(lower_tail, log_p, alpha);\n        pp = q;\n        qq = p;\n      } else {\n        a = p_;\n        la = R_DT_log(lower_tail, log_p, alpha);\n        pp = p;\n        qq = q;\n      }\n      R_ifDEBUG_printf(\n        '\"%s\\'; la = %g\\n',\n        swap_tail ? 'swap now' : 'swap back',\n        la\n      );\n      // we could redo computations above, but this should be stable\n      u = R_Log1_Exp(u);\n      xinbta = exp(u);\n\n      /* Careful: \"swap now\"  should not fail if\n               1) the above initial xinbta is \"completely wrong\"\n               2) The correction step can go outside (u_n > 0 ==>  e^u > 1 is illegal)\n               e.g., for\n                qbeta(0.2066, 0.143891, 0.05)\n            */\n    }\n\n    if (!use_log_x) use_log_x = u < log_q_cut; //(per default) <==> xinbta = e^u < 4.54e-5\n    let bad_u = !R_FINITE(u);\n    let bad_init = bad_u || xinbta > p_hi;\n\n    R_ifDEBUG_printf(\n      ' -> u = %g, e^u = xinbta = %.16g, (Newton acu=%g%s)\\n',\n      u,\n      xinbta,\n      acu,\n      bad_u ? ', ** bad u **' : use_log_x ? ', on u = log(x) scale' : ''\n    );\n\n    u_n = 1; // -Wall\n    tx = xinbta; // keeping \"original initial x\" (for now)\n\n    if (bad_u || u < log_q_cut) {\n      /* e.g.\n            qbeta(0.21, .001, 0.05)\n            try \"left border\" quickly, i.e.,\n            try at smallest positive number: */\n      w = pbeta_raw(DBL_very_MIN, pp, qq, true, log_p);\n      if (w > (log_p ? la : a)) {\n        R_ifDEBUG_printf(\n          ' quantile is left of smallest positive number; \"convergence\"\\n'\n        );\n        if (log_p || fabs(w - a) < fabs(0 - a)) {\n          // DBL_very_MIN is better than 0\n          tx = DBL_very_MIN;\n          u_n = DBL_log_v_MIN; // = log(DBL_very_MIN)\n        } else {\n          tx = 0;\n          u_n = ML_NEGINF;\n        }\n        use_log_x = log_p;\n        add_N_step = false;\n        goto_L_return = true;\n        //goto L_return;\n      } else {\n        R_ifDEBUG_printf(\n          ' pbeta(smallest pos.) = %g <= %g  --> continuing\\n',\n          w,\n          log_p ? la : a\n        );\n        if (u < DBL_log_v_MIN) {\n          u = DBL_log_v_MIN; // = log(DBL_very_MIN)\n          xinbta = DBL_very_MIN;\n        }\n      }\n    }\n\n    /* Sometimes the approximation is negative (and === 0 is also not \"ok\") */\n    if (bad_init && !(use_log_x && tx > 0)) {\n      if (u === ML_NEGINF) {\n        R_ifDEBUG_printf('  u = -Inf;');\n        u = M_LN2 * DBL_MIN_EXP;\n        xinbta = DBL_MIN;\n      } else {\n        R_ifDEBUG_printf(' bad_init: u=%g, xinbta=%g;', u, xinbta);\n        xinbta =\n          xinbta > 1.1 // i.e. \"way off\"\n            ? 0.5 // otherwise, keep the respective boundary:\n            : xinbta < p_lo ? exp(u) : p_hi;\n        if (bad_u) u = log(xinbta);\n        // otherwise: not changing \"potentially better\" u than the above\n      }\n      R_ifDEBUG_printf(' -> (partly)new u=%g, xinbta=%g\\n', u, xinbta);\n    }\n  }\n  //L_Newton:\n  /* --------------------------------------------------------------------\n\n     * Solve for x by a modified Newton-Raphson method, using pbeta_raw()\n     */\n  if (!goto_L_return) {\n    r = 1 - pp;\n    t = 1 - qq;\n    let wprev = 0;\n    let prev = 1;\n    let adj = 1; // -Wall\n\n    if (use_log_x) {\n      // find  log(xinbta) -- work in  u := log(x) scale\n      // if(bad_init && tx > 0) xinbta = tx;// may have been better\n\n      for (i_pb = 0; i_pb < 1000; i_pb++) {\n        // using log_p === TRUE  unconditionally here\n        // FIXME: if exp(u) = xinbta underflows to 0, like different formula pbeta_log(u, *)\n        y = pbeta_raw(xinbta, pp, qq, /*lower_tail = */ true, true);\n\n        /* w := Newton step size for   L(u) = log F(e^u)  =!= 0;   u := log(x)\n                 *   =  (L(.) - la) / L'(.);  L'(u)= (F'(e^u) * e^u ) / F(e^u)\n                 *   =  (L(.) - la)*F(.) / {F'(e^u) * e^u } =\n                 *   =  (L(.) - la) * e^L(.) * e^{-log F'(e^u) - u}\n                 *   =  ( y   - la) * e^{ y - u -log F'(e^u)}\n                and  -log F'(x)= -log f(x) =  + logbeta + (1-p) log(x) + (1-q) log(1-x)\n                           = logbeta + (1-p) u + (1-q) log(1-e^u)\n                 */\n        w =\n          y === ML_NEGINF // y = -Inf  well possible: we are on log scale!\n            ? 0\n            : (y - la) * exp(y - u + logbeta + r * u + t * R_Log1_Exp(u));\n        if (!R_FINITE(w)) break;\n        if (i_pb >= n_N && w * wprev <= 0) prev = fmax2(fabs(adj), fpu);\n        R_ifDEBUG_printf(\n          'N(i=%2d): u=%#20.16g, pb(e^u)=%#12.6g, w=%#15.9g, %s prev=%11g,',\n          i_pb,\n          u,\n          y,\n          w,\n          w * wprev <= 0 ? 'new' : 'old',\n          prev\n        );\n        g = 1;\n        for (i_inn = 0; i_inn < 1000; i_inn++) {\n          adj = g * w;\n          // take full Newton steps at the beginning; only then safe guard:\n          if (i_pb < n_N || fabs(adj) < prev) {\n            u_n = u - adj; // u_{n+1} = u_n - g*w\n            if (u_n <= 0) {\n              // <==> 0 <  xinbta := e^u  <= 1\n              if (prev <= acu || fabs(w) <= acu) {\n                /* R_ifDEBUG_printf(\" -adj=%g, %s <= acu  ==> convergence\\n\", */\n                /*\t -adj, (prev <= acu) ? \"prev\" : \"|w|\"); */\n                R_ifDEBUG_printf(\n                  ' it{in}=%d, -adj=%g, %s <= acu  ==> convergence\\n',\n                  i_inn,\n                  -adj,\n                  prev <= acu ? 'prev' : '|w|'\n                );\n                goto_L_converged = true;\n                break;\n                //goto L_converged;\n              }\n              // if (u_n != ML_NEGINF && u_n != 1)\n              break;\n            }\n          }\n          g /= 3;\n        } //for(i_inn)\n        if (goto_L_converged) {\n          break;\n        }\n        // (cancellation in (u_n -u) => may differ from adj:\n        let D = fmin2(fabs(adj), fabs(u_n - u));\n        /* R_ifDEBUG_printf(\" delta(u)=%g\\n\", u_n - u); */\n        R_ifDEBUG_printf(\n          ' it{in}=%d, delta(u)=%9.3g, D/|.|=%.3g\\n',\n          i_inn,\n          u_n - u,\n          D / fabs(u_n + u)\n        );\n        if (D <= 4e-16 * fabs(u_n + u)) {\n          goto_L_converged = true;\n          break;\n        }\n        u = u_n;\n        xinbta = exp(u);\n        wprev = w;\n      } // for(i )\n    } else {\n      for (i_pb = 0; i_pb < 1000; i_pb++) {\n        y = pbeta_raw(xinbta, pp, qq, /*lower_tail = */ true, log_p);\n        // delta{y} :   d_y = y - (log_p ? la : a);\n\n        if (!R_FINITE(y) && !(log_p && y === ML_NEGINF)) {\n          // y = -Inf  is ok if(log_p)\n          // ML_ERR_return_NAN :\n          ML_ERROR(ME.ME_DOMAIN, '', printer_qbeta_raw);\n          qb[0] = qb[1] = ML_NAN;\n          return;\n        }\n\n        /* w := Newton step size  (F(.) - a) / F'(.)  or,\n                 * --   log: (lF - la) / (F' / F) = exp(lF) * (lF - la) / F'\n                 */\n        w = log_p\n          ? (y - la) * exp(y + logbeta + r * log(xinbta) + t * log1p(-xinbta))\n          : (y - a) * exp(logbeta + r * log(xinbta) + t * log1p(-xinbta));\n        if (i_pb >= n_N && w * wprev <= 0) prev = fmax2(fabs(adj), fpu);\n        R_ifDEBUG_printf(\n          'N(i=%2d): x0=%d, pb(x0)=%d, w=%d, %s prev=%d,',\n          i_pb,\n          xinbta,\n          y,\n          w,\n          w * wprev <= 0 ? 'new' : 'old',\n          prev\n        );\n        g = 1;\n        for (i_inn = 0; i_inn < 1000; i_inn++) {\n          adj = g * w;\n          // take full Newton steps at the beginning; only then safe guard:\n          if (i_pb < n_N || fabs(adj) < prev) {\n            tx = xinbta - adj; // x_{n+1} = x_n - g*w\n            if (0 <= tx && tx <= 1) {\n              if (prev <= acu || fabs(w) <= acu) {\n                R_ifDEBUG_printf(\n                  ' it{in}=%d, delta(x)=%g, %s <= acu  ==> convergence\\n',\n                  i_inn,\n                  -adj,\n                  prev <= acu ? 'prev' : '|w|'\n                );\n                goto_L_converged = true;\n                break;\n              }\n              if (tx !== 0 && tx !== 1) break;\n            }\n          }\n          g /= 3;\n        } //for(i_inn)\n        if (goto_L_converged) {\n          break;\n        }\n        R_ifDEBUG_printf(' it{in}=%d, delta(x)=%g\\n', i_inn, tx - xinbta);\n        if (fabs(tx - xinbta) <= 4e-16 * (tx + xinbta)) {\n          // \"<=\" : (.) === 0\n          goto_L_converged = true;\n          break;\n        }\n        xinbta = tx;\n        if (tx === 0)\n          // \"we have lost\"\n          break;\n        wprev = w;\n      } //for\n    } //if\n\n    /*-- NOT converged: Iteration count --*/\n    if (!goto_L_converged) {\n      warned = true;\n      ML_ERROR(ME.ME_PRECISION, 'qbeta', printer_qbeta_raw);\n    }\n\n    //L_converged:\n    log_ = log_p || use_log_x; // only for printing\n    R_ifDEBUG_printf(\n      ' %s: Final delta(y) = %g%s\\n',\n      warned ? '_NO_ convergence' : 'converged',\n      y - (log_ ? la : a),\n      log_ ? ' (log_)' : ''\n    );\n    if ((log_ && y === ML_NEGINF) || (!log_ && y === 0)) {\n      // stuck at left, try if smallest positive number is \"better\"\n      w = pbeta_raw(DBL_very_MIN, pp, qq, true, log_);\n      if (log_ || fabs(w - a) <= fabs(y - a)) {\n        tx = DBL_very_MIN;\n        u_n = DBL_log_v_MIN; // = log(DBL_very_MIN)\n      }\n      add_N_step = false; // not trying to do better anymore\n    } else if (!warned && (log_ ? fabs(y - la) > 3 : fabs(y - a) > 1e-4)) {\n      if (\n        !(\n          log_ &&\n          y === ML_NEGINF &&\n          // e.g. qbeta(-1e-10, .2, .03, log=TRUE) cannot get accurate ==> do NOT warn\n          pbeta_raw(\n            DBL_1__eps, // = 1 - eps\n            pp,\n            qq,\n            true,\n            true\n          ) >\n            la + 2\n        )\n      )\n        printer_qbeta_raw(\n          // low accuracy for more platform independent output:\n          'qbeta(a, *) =: x0 with |pbeta(x0,* %s) - alpha| = %d is not accurate',\n          log_ ? ', log_' : '',\n          fabs(y - (log_ ? la : a))\n        );\n    }\n  }\n  //L_return:\n  if (give_log_q) {\n    // ==> use_log_x , too\n    if (!use_log_x)\n      // (see if claim above is true)\n      printer_qbeta_raw(\n        'qbeta() L_return, u_n=%d;  give_log_q=TRUE but use_log_x=FALSE -- please report!',\n        u_n\n      );\n    let r = R_Log1_Exp(u_n);\n    if (swap_tail) {\n      qb[0] = r;\n      qb[1] = u_n;\n    } else {\n      qb[0] = u_n;\n      qb[1] = r;\n    }\n  } else {\n    if (use_log_x) {\n      if (add_N_step) {\n        /* add one last Newton step on original x scale, e.g., for\n                   qbeta(2^-98, 0.125, 2^-96) */\n        xinbta = exp(u_n);\n        y = pbeta_raw(xinbta, pp, qq, /*lower_tail = */ true, log_p);\n        w = log_p\n          ? (y - la) * exp(y + logbeta + r * log(xinbta) + t * log1p(-xinbta))\n          : (y - a) * exp(logbeta + r * log(xinbta) + t * log1p(-xinbta));\n        tx = xinbta - w;\n        R_ifDEBUG_printf(\n          'Final Newton correction(non-log scale): xinbta=%.16g, y=%g, w=%g. => new tx=%.16g\\n',\n          xinbta,\n          y,\n          w,\n          tx\n        );\n      } else {\n        if (swap_tail) {\n          qb[0] = -expm1(u_n);\n          qb[1] = exp(u_n);\n        } else {\n          qb[0] = exp(u_n);\n          qb[1] = -expm1(u_n);\n        }\n        return;\n      }\n    }\n    if (swap_tail) {\n      qb[0] = 1 - tx;\n      qb[1] = tx;\n    } else {\n      qb[0] = tx;\n      qb[1] = 1 - tx;\n    }\n  }\n  return;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { R_DT_qIv } from '../exp/expm1';\n\nimport { pnbeta } from './pnbeta';\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  MIN_VALUE: DBL_MIN,\n  EPSILON: DBL_EPSILON\n} = Number;\n\nconst { min: fmin2 } = Math;\n\nconst printer_qnbeta = debug('qnbeta');\n\nexport function qnbeta(\n  p: number,\n  a: number,\n  b: number,\n  ncp: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  const accu = 1e-15;\n  const Eps = 1e-14; /* must be > accu */\n\n    let ux;\n    let lx;\n    let nx;\n    let pp;\n\n    if (ISNAN(p) || ISNAN(a) || ISNAN(b) || ISNAN(ncp)) return p + a + b + ncp;\n\n    if (!R_FINITE(a)) return ML_ERR_return_NAN(printer_qnbeta);\n\n    if (ncp < 0 || a <= 0 || b <= 0) return ML_ERR_return_NAN(printer_qnbeta);\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, 1);\n    if (rc !== undefined) {\n      return rc;\n    }\n    p = R_DT_qIv(lower_tail, log_p, p);\n\n    /* Invert pnbeta(.) :\n     * 1. finding an upper and lower bound */\n    if (p > 1 - DBL_EPSILON) return 1.0;\n    pp = fmin2(1 - DBL_EPSILON, p * (1 + Eps));\n    for (\n      ux = 0.5;\n      ux < 1 - DBL_EPSILON && pnbeta(ux, a, b, ncp, true, false) < pp;\n      ux = 0.5 * (1 + ux)\n    );\n    pp = p * (1 - Eps);\n    for (\n      lx = 0.5;\n      lx > DBL_MIN && pnbeta(lx, a, b, ncp, true, false) > pp;\n      lx *= 0.5\n    );\n\n    /* 2. interval (lx,ux)  halving : */\n    do {\n      nx = 0.5 * (lx + ux);\n      if (pnbeta(nx, a, b, ncp, true, false) > p) ux = nx;\n      else lx = nx;\n    } while ((ux - lx) / nx > accu);\n\n    return 0.5 * (ux + lx);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../';\nimport { qnorm } from '../../normal/qnorm';\nimport { MersenneTwister } from '../mersenne-twister';\nimport { IRNGNormal } from './inormal-rng';\n\nconst BIG = 134217728; /* 2^27 */\n\nconst { isArray } = Array;\nexport class Inversion extends IRNGNormal {\n  constructor(_rng: IRNG  = new MersenneTwister(0) ) {\n    super(_rng);\n  }\n\n  protected internal_norm_rand(): number {\n    /* unif_rand() alone is not of high enough precision */\n    let u1 = this.rng.internal_unif_rand();\n    let t =  this.rng.internal_unif_rand();\n    u1 = new Int32Array([BIG * u1])[0] + t;\n    const result = qnorm(u1 / BIG, 0.0, 1.0, !!1, !!0);\n    return isArray(result) ? result[0] : result;\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { pbeta } from '../beta/pbeta';\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1,\n  R_nonint\n} from '../common/_general';\n\nconst printer = debug('pbinom');\nconst { floor, round: R_forceint } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nexport function pbinom(\n  x: number,\n  n: number,\n  p: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  \n    if (ISNAN(x) || ISNAN(n) || ISNAN(p)) return NaN;\n    if (!R_FINITE(n) || !R_FINITE(p)) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    let lower_tail = lowerTail;\n    let log_p = logP;\n\n    if (R_nonint(n)) {\n      printer('non-integer n = %d', n);\n      return ML_ERR_return_NAN(printer);\n    }\n    n = R_forceint(n);\n    /* \n     PR#8560: n=0 is a valid value \n  */\n    if (n < 0 || p < 0 || p > 1) return ML_ERR_return_NAN(printer);\n\n    if (x < 0) return R_DT_0(lower_tail, log_p);\n    x = floor(x + 1e-7);\n    if (n <= x) return R_DT_1(lower_tail, log_p);\n    printer('calling pbeta:(q=%d,a=%d,b=%d, l.t=%s, log=%s', p, x + 1, n - x, !lower_tail, log_p);\n    return pbeta(p, x + 1, n - x, !lower_tail, log_p);\n \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nconst { max: fmax2, min: fmin2, floor, sqrt } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\n\nimport { NumberW } from '../common/toms708';\nimport { R_DT_qIv } from '../exp/expm1';\nimport { qnorm } from '../normal/qnorm';\nimport { pbinom } from './pbinom';\n\nconst printer_do_search = debug('do_search');\n\nfunction do_search(\n  y: number,\n  z: NumberW,\n  p: number,\n  n: number,\n  pr: number,\n  incr: number\n): number {\n  if (z.val >= p) {\n    /* search to the left */\n\n    printer_do_search(\n      'new z=%o >= p = %d  --> search to left (y--) ..',\n      z,\n      p\n    );\n\n    while (true) {\n      let newz: number;\n      if (\n        y === 0 ||\n        (newz = pbinom(y - incr, n, pr, /*l._t.*/ true, /*log_p*/ false)) < p\n      )\n        return y;\n      y = fmax2(0, y - incr);\n      z.val = newz;\n    }\n  } else {\n    /* search to the right */\n\n    printer_do_search(\n      'new z=%d < p = %d  --> search to right (y++) ..',\n      z.val,\n      p\n    );\n\n    while (true) {\n      y = fmin2(y + incr, n);\n      if (\n        y === n ||\n        (z.val = pbinom(y, n, pr, /*l._t.*/ true, /*log_p*/ false)) >= p\n      )\n        return y;\n    }\n  }\n}\n\n\nconst printer_qbinom = debug('_qbinom');\n\nexport function qbinom(\n  p: number,\n  size: number,\n  pr: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  let q: number;\n  let mu: number;\n  let sigma: number;\n  let gamma: number;\n  const z = new NumberW(0);\n  let y: number;\n\n  if (ISNAN(p) || ISNAN(size) || ISNAN(pr)) return NaN;\n\n  if (!R_FINITE(size) || !R_FINITE(pr)) {\n    return ML_ERR_return_NAN(printer_qbinom);\n  }\n  /* if log_p is true, p = -Inf is a legitimate value */\n  if (!R_FINITE(p) && !log_p) {\n    return ML_ERR_return_NAN(printer_qbinom);\n  }\n\n  if (!Number.isInteger(size)) {\n    return ML_ERR_return_NAN(printer_qbinom);\n  }\n\n  if (pr < 0 || pr > 1 || size < 0) {\n    return ML_ERR_return_NAN(printer_qbinom);\n  }\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, size);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  //edge cases\n\n  if (pr === 0 || size === 0) return 0;\n\n  q = 1 - pr;\n  if (q === 0) return size; /* covers the full range of the distribution */\n\n  mu = size * pr; //mean\n  sigma = sqrt(size * pr * q); //standard deviation\n\n  gamma = (q - pr) / sigma; // = (  (1 - pr)-pr )/sd = (1 - 2pr)/sd\n\n  printer_qbinom(\n    'qbinom(p=%d, n=%d, pr=%d, l.t.=%s, log=%s): sigm=%d, gam=%d',\n    p,\n    size,\n    pr,\n    lower_tail,\n    log_p,\n    sigma,\n    gamma\n  );\n\n  /* Note : \"same\" code in qpois.c, qbinom.c, qnbinom.c --\n     * FIXME: This is far from optimal [cancellation for p ~= 1, etc]: */\n  if (!lower_tail || log_p) {\n    p = R_DT_qIv(lower_tail, log_p, p); /* need check again (cancellation!): */\n    if (p === 0) return 0;\n    if (p === 1) return size;\n  }\n  /* temporary hack --- FIXME --- */\n  //if (p + 1.01 * DBL_EPSILON >= 1.) return size;\n  if (Math.abs(p - 1) < DBL_EPSILON) {\n    return size;\n  }\n\n  /* y := approx.value (Cornish-Fisher expansion) :  */\n  z.val = qnorm(p, 0, 1, /*lower_tail*/ true, /*log_p*/ false);\n  y = floor(mu + sigma * (z.val + gamma * (z.val * z.val - 1) / 6) + 0.5);\n\n  if (y > size) {\n    /* way off */ y = size;\n  }\n\n  printer_qbinom(\n    '  new (p,1-p)=(%d,%d), z=qnorm(..)=%d, y=%d, size=%d',\n    p,\n    1 - p,\n    z.val,\n    y,\n    size\n  );\n\n  z.val = pbinom(y, size, pr, /*lower_tail*/ true, /*log_p*/ false);\n\n  /* fuzz to ensure left continuity: */\n  p *= 1 - 64 * DBL_EPSILON;\n\n  if (size < 1e5) {\n    return do_search(y, z, p, size, pr, 1);\n  }\n  /* Otherwise be a bit cleverer in the search */\n\n  let incr = floor(size * 0.001);\n  let oldincr;\n  do {\n    console.log('loopdieloop');\n    oldincr = incr;\n    y = do_search(y, z, p, size, pr, incr);\n    incr = fmax2(1, floor(incr / 100));\n  } while (oldincr > 1 && incr > size * 1e-15);\n  return y;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1 } from '../common/_general';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { floor, log } = Math;\n\nimport { pbeta } from '../beta/pbeta';\nimport { NumberW, Toms708 } from '../common/toms708';\n\nconst printer = debug('pnbinom');\n\nexport function pnbinom<T>(\n  xx: T,\n  size: number,\n  prob: number,\n  lowerTail: boolean,\n  logP: boolean\n): T {\n  const fx: number[] = Array.isArray(xx) ? xx : ([xx] as any);\n\n  const result = fx.map(x => {\n    if (ISNAN(x) || ISNAN(size) || ISNAN(prob)) return x + size + prob;\n    if (!R_FINITE(size) || !R_FINITE(prob)) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (size < 0 || prob <= 0 || prob > 1) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    /* limiting case: point mass at zero */\n    if (size === 0)\n      return x >= 0 ? R_DT_1(lowerTail, logP) : R_DT_0(lowerTail, logP);\n\n    if (x < 0) return R_DT_0(lowerTail, logP);\n    if (!R_FINITE(x)) return R_DT_1(lowerTail, logP);\n    x = floor(x + 1e-7);\n    return pbeta(prob, size, x + 1, lowerTail, logP);\n  });\n\n  return result.length === 1 ? result[0] : (result as any);\n}\n\nconst printer_pnbinom_mu = debug('printer_pnbinom_mu');\n\nexport function pnbinom_mu<T>(\n  xx: T,\n  size: number,\n  mu: number,\n  lowerTail: boolean,\n  logP: boolean\n): T {\n  const fx: number[] = Array.isArray(xx) ? xx : ([xx] as any);\n  const result = fx.map(x => {\n    if (ISNAN(x) || ISNAN(size) || ISNAN(mu)) return x + size + mu;\n    if (!R_FINITE(size) || !R_FINITE(mu)) return ML_ERR_return_NAN(printer_pnbinom_mu);\n\n    if (size < 0 || mu < 0) return ML_ERR_return_NAN(printer_pnbinom_mu);\n\n    /* limiting case: point mass at zero */\n    if (size === 0)\n      return x >= 0 ? R_DT_1(lowerTail, logP) : R_DT_0(lowerTail, logP);\n\n    if (x < 0) return R_DT_0(lowerTail, logP);\n    if (!R_FINITE(x)) return R_DT_1(lowerTail, logP);\n    x = floor(x + 1e-7);\n    /* return\n     * pbeta(pr, size, x + 1, lowerTail, logP);  pr = size/(size + mu), 1-pr = mu/(size+mu)\n     *\n     *= pbeta_raw(pr, size, x + 1, lowerTail, logP)\n     *            x.  pin   qin\n     *=  bratio (pin,  qin, x., 1-x., &w, &wc, &ierr, logP),  and return w or wc ..\n     *=  bratio (size, x+1, pr, 1-pr, &w, &wc, &ierr, logP) */\n    {\n      let ierr = new NumberW(0);\n      let w = new NumberW(0);\n      let wc = new NumberW(0);\n      Toms708.bratio(\n        size,\n        x + 1,\n        size / (size + mu),\n        mu / (size + mu),\n        w,\n        wc,\n        ierr\n      );\n      if (ierr)\n        printer('pnbinom_mu() -> bratio() gave error code %d', ierr.val);\n      if (logP) {\n        w.val = log(w.val);\n        wc.val = log(wc.val);\n      }\n      return lowerTail ? w.val : wc.val;\n    }\n  });\n  return result.length === 1 ? result[0] : (result as any);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { chebyshev_eval, chebyshev_init } from './chebyshev';\n\nexport {\n    chebyshev_eval,\n    chebyshev_init\n};\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { dgamma } from '../gamma/dgamma';\n\nexport function dchisq(x: number, df: number, log: boolean = false) {\n  return dgamma(x, df / 2, 2, log);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D__0, R_D_val } from '../common/_general';\n\nimport { dchisq } from '../chi-2/dchisq';\nimport { dpois_raw } from '../poisson/dpois';\n\nconst { ceil, sqrt } = Math;\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer_dnchisq = debug('dnchisq');\n\nexport function dnchisq(\n  x: number,\n  df: number,\n  ncp: number,\n  give_log: boolean\n): number {\n  const eps = 5e-15;\n\n  \n\n\n    let i: number;\n    let ncp2: number;\n    let q: number;\n    let mid: number;\n    let dfmid: number;\n    let imax: number;\n    let sum: number;\n    let term: number;\n\n    if (ISNAN(x) || ISNAN(df) || ISNAN(ncp)) {\n      return x + df + ncp;\n    }\n\n    if (!R_FINITE(df) || !R_FINITE(ncp) || ncp < 0 || df < 0) {\n      return ML_ERR_return_NAN(printer_dnchisq);\n    }\n\n    if (x < 0) {\n      return R_D__0(give_log);\n    }\n    if (x === 0 && df < 2) return ML_POSINF;\n    if (ncp === 0) return df > 0 ? dchisq(x, df, give_log) : R_D__0(give_log);\n    if (x === ML_POSINF) return R_D__0(give_log);\n\n    ncp2 = 0.5 * ncp;\n\n    /* find max element of sum */\n    imax = ceil((-(2 + df) + sqrt((2 - df) * (2 - df) + 4 * ncp * x)) / 4);\n    if (imax < 0) imax = 0;\n    if (R_FINITE(imax)) {\n      dfmid = df + 2 * imax;\n      mid = dpois_raw(imax, ncp2, false) * dchisq(x, dfmid, false);\n    } else {\n      /* imax = Inf */\n      // mid = 0;\n      // }\n\n      // if (mid === 0) {\n      /* underflow to 0 -- maybe numerically correct; maybe can be more accurate,\n\t * particularly when  give_log = TRUE */\n      /* Use  central-chisq approximation formula when appropriate;\n\t * ((FIXME: the optimal cutoff also depends on (x,df);  use always here? )) */\n      if (give_log || ncp > 1000) {\n        let nl = df + ncp;\n        let ic = nl / (nl + ncp); /* = \"1/(1+b)\" Abramowitz & St.*/\n        return dchisq(x * ic, nl * ic, give_log);\n      } else return R_D__0(give_log);\n    }\n\n    sum = mid;\n\n    /* errorbound := term * q / (1-q)  now subsumed in while() / if() below: */\n\n    /* upper tail */\n    term = mid;\n    df = dfmid;\n    i = imax;\n    let x2 = x * ncp2;\n    do {\n      i++;\n      q = x2 / i / df;\n      df += 2;\n      term *= q;\n      sum += term;\n    } while (q >= 1 || term * q > (1 - q) * eps || term > 1e-10 * sum);\n    /* lower tail */\n    term = mid;\n    df = dfmid;\n    i = imax;\n    while (i !== 0) {\n      df -= 2;\n      q = i * df / x2;\n      i--;\n      term *= q;\n      sum += term;\n      if (q < 1 && term * q <= (1 - q) * eps) break;\n    }\n    return R_D_val(give_log, sum);\n \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  M_LN2,\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_Q_P01_boundaries,\n  R_Q_P01_check\n} from '../common/_general';\n\nimport { R_DT_Clog, R_DT_log, R_DT_qIv } from '../exp/expm1';\n\nimport { dgamma } from '../gamma/dgamma';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { pgamma } from '../gamma/pgamma';\n\nimport { pgamma_raw } from './pgamma';\n\nimport { lgamma1p } from './pgamma';\n\nimport { qnorm } from '../normal/qnorm';\nconst { isArray } = Array;\n\nconst { abs: fabs, sqrt, pow, exp, log } = Math;\nconst {\n  isNaN: ISNAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF,\n  MIN_VALUE: DBL_MIN,\n  isFinite: R_FINITE\n} = Number;\n\nconst printer_qchisq_appr = debug('qchisq_appr');\n\nexport function qchisq_appr(\n  p: number,\n  nu: number,\n  g: number /* = log Gamma(nu/2) */,\n  lower_tail: boolean,\n  log_p: boolean,\n  tol: number /* EPS1 */,\n  //normal: INormal\n): number {\n  const C7 = 4.67;\n  const C8 = 6.66;\n  const C9 = 6.73;\n  const C10 = 13.32;\n\n  let alpha;\n  let a;\n  let c;\n  let ch;\n  let p1;\n  let p2;\n  let q;\n  let t;\n  let x;\n\n  /* test arguments and initialise */\n\n  if (ISNAN(p) || ISNAN(nu)) return p + nu;\n\n  let rc = R_Q_P01_check(log_p, p);\n  if (rc !== undefined) {\n    return rc;\n  }\n  if (nu <= 0) {\n    return ML_ERR_return_NAN(printer_qchisq_appr);\n  }\n\n  alpha = 0.5 * nu; /* = [pq]gamma() shape */\n  c = alpha - 1;\n\n  if (nu < -1.24 * (p1 = R_DT_log(lower_tail, log_p, p))) {\n    /* for small chi-squared */\n    /* log(alpha) + g = log(alpha) + log(gamma(alpha)) =\n         *        = log(alpha*gamma(alpha)) = lgamma(alpha+1) suffers from\n         *  catastrophic cancellation when alpha << 1\n         */\n    let lgam1pa = alpha < 0.5 ? lgamma1p(alpha) : log(alpha) + g;\n    ch = exp((lgam1pa + p1) / alpha + M_LN2);\n\n    printer_qchisq_appr(' small chi-sq., ch0 = %d', ch);\n  } else if (nu > 0.32) {\n    /*  using Wilson and Hilferty estimate */\n\n    x = qnorm(p, 0, 1, lower_tail, log_p);\n    p1 = 2 / (9 * nu);\n    ch = nu * pow(x * sqrt(p1) + 1 - p1, 3);\n\n    printer_qchisq_appr(' nu > .32: Wilson-Hilferty; x = %d', x);\n\n    /* approximation for p tending to 1: */\n    if (ch > 2.2 * nu + 6)\n      ch = -2 * (R_DT_Clog(lower_tail, log_p, p) - c * log(0.5 * ch) + g);\n  } else {\n    /* \"small nu\" : 1.24*(-log(p)) <= nu <= 0.32 */\n\n    ch = 0.4;\n    a = R_DT_Clog(lower_tail, log_p, p) + g + c * M_LN2;\n\n    printer_qchisq_appr(' nu <= .32: a = %d', a);\n\n    do {\n      q = ch;\n      p1 = 1 / (1 + ch * (C7 + ch));\n      p2 = ch * (C9 + ch * (C8 + ch));\n      t = -0.5 + (C7 + 2 * ch) * p1 - (C9 + ch * (C10 + 3 * ch)) / p2;\n      ch -= (1 - exp(a + 0.5 * ch) * p2 * p1) / t;\n    } while (fabs(q - ch) > tol * fabs(ch));\n  }\n\n  return ch;\n}\n\nexport function qgamma<T>(\n  p: T,\n  alpha: number = 1, //named shape\n  scale: number = 1, //not the \"rate\"\n  lowerTail: boolean = true,\n  logP: boolean = false\n): T {\n  const fa: number[] = isArray(p) ? p : ([p] as any);\n  const result = fa.map(pp =>\n    _qgamma(pp, alpha, scale, lowerTail, logP)\n  );\n\n  return result.length === 1 ? result[0] : (result as any);\n}\n\nconst printer_qgamma = debug('_qgamma');\n\nexport function _qgamma(\n  p: number,\n  alpha: number = 1,\n  scale: number = 1 / alpha,\n  lower_tail: boolean = true,\n  log_p: boolean = false,\n  //normal: INormal\n): number {\n  /*\t\t\tshape = alpha */\n  const EPS1 = 1e-2;\n  const EPS2 = 5e-7; /* final precision of AS 91 */\n  const EPS_N = 1e-15; /* precision of Newton step / iterations */\n\n  // LN_EPS unused\n  //const LN_EPS = -36.043653389117156; /* = log(.Machine$double.eps) iff IEEE_754 */\n\n  const MAXIT = 1000; /* was 20 */\n\n  const pMIN = 1e-100; /* was 0.000002 = 2e-6 */\n  const pMAX = 1 - 1e-14; /* was (1-1e-12) and 0.999998 = 1 - 2e-6 */\n\n  const i420 = 1 / 420;\n  const i2520 = 1 / 2520;\n  const i5040 = 1 / 5040;\n\n  let p_;\n  let a;\n  let b;\n  let c;\n  let g;\n  let ch;\n  let ch0;\n  let p1;\n  let p2;\n  let s1;\n  let s2;\n  let s3;\n  let s4;\n  let s5;\n  let s6;\n  let t;\n  let x;\n  let i;\n  let max_it_Newton = 1;\n\n  let q: number = 0;\n\n  /* test arguments and initialise */\n\n  let goto_END = false;\n\n  if (ISNAN(p) || ISNAN(alpha) || ISNAN(scale)) return p + alpha + scale;\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n  if (alpha < 0 || scale <= 0) return ML_ERR_return_NAN(printer_qgamma);\n\n  if (alpha === 0) /* all mass at 0 : */ return 0;\n\n  if (alpha < 1e-10) {\n    /* Warning seems unnecessary now: */\n\n    printer_qgamma(\n      'value of shape (%d) is extremely small: results may be unreliable',\n      alpha\n    );\n\n    max_it_Newton = 7; /* may still be increased below */\n  }\n\n  p_ = R_DT_qIv(lower_tail, log_p, p); /* lower_tail prob (in any case) */\n\n  printer_qgamma(\n    'qgamma(p=%d, alpha=%d, scale=%d, l.t.=%s, log_p=%s): ',\n    p,\n    alpha,\n    scale,\n    lower_tail,\n    log_p\n  );\n\n  g = lgammafn(alpha); /* log Gamma(v/2) */\n\n  /*----- Phase I : Starting Approximation */\n  ch = qchisq_appr(\n    p,\n    /* nu= 'df' =  */ 2 * alpha,\n    /* lgamma(nu/2)= */ g,\n    lower_tail,\n    log_p,\n    /* tol= */ EPS1\n  );\n  if (!R_FINITE(ch)) {\n    /* forget about all iterations! */\n    max_it_Newton = 0;\n    goto_END = true;\n    //  goto END;\n  }\n  if (goto_END === false) {\n    if (ch < EPS2) {\n      /* Corrected according to AS 91; MM, May 25, 1999 */\n      max_it_Newton = 20;\n      // goto END;/* and do Newton steps */\n      goto_END = true;\n    }\n  }\n\n  /* FIXME: This (cutoff to {0, +Inf}) is far from optimal\n     * -----  when log_p or !lower_tail, but NOT doing it can be even worse */\n  if (goto_END === false) {\n    if (p_ > pMAX || p_ < pMIN) {\n      /* did return ML_POSINF or 0.;\tmuch better: */\n      max_it_Newton = 20;\n      goto_END = true;\n      //goto END;/* and do Newton steps */\n    }\n  }\n\n  if (goto_END === false) {\n    printer_qgamma('\\t==> ch = %d:', ch);\n\n    /*----- Phase II: Iteration\n         *\tCall pgamma() [AS 239]\tand calculate seven term taylor series\n         */\n    c = alpha - 1;\n    s6 = (120 + c * (346 + 127 * c)) * i5040; /* used below, is \"const\" */\n\n    ch0 = ch; /* save initial approx. */\n    for (i = 1; i <= MAXIT; i++) {\n      q = ch;\n      p1 = 0.5 * ch;\n      p2 =\n        p_ -\n        pgamma_raw(p1, alpha, /*lower_tail*/ true, /*log_p*/ false);\n\n      if (i === 1) printer_qgamma(' Ph.II iter; ch=%d, p2=%d', ch, p2);\n      if (i >= 2) printer_qgamma('     it=%d,  ch=%d, p2=%d', i, ch, p2);\n\n      if (!R_FINITE(p2) || ch <= 0) {\n        ch = ch0;\n        max_it_Newton = 27;\n        goto_END = true;\n        break;\n        //goto END;\n      } /*was  return ML_NAN;*/\n\n      t = p2 * exp(alpha * M_LN2 + g + p1 - c * log(ch));\n      b = t / ch;\n      a = 0.5 * t - b * c;\n      s1 = (210 + a * (140 + a * (105 + a * (84 + a * (70 + 60 * a))))) * i420;\n      s2 = (420 + a * (735 + a * (966 + a * (1141 + 1278 * a)))) * i2520;\n      s3 = (210 + a * (462 + a * (707 + 932 * a))) * i2520;\n      s4 =\n        (252 + a * (672 + 1182 * a) + c * (294 + a * (889 + 1740 * a))) * i5040;\n      s5 = (84 + 2264 * a + c * (1175 + 606 * a)) * i2520;\n\n      ch +=\n        t *\n        (1 +\n          0.5 * t * s1 -\n          b * c * (s1 - b * (s2 - b * (s3 - b * (s4 - b * (s5 - b * s6))))));\n      if (fabs(q - ch) < EPS2 * ch) {\n        //   goto END;\n        goto_END = true;\n        break;\n      }\n      if (fabs(q - ch) > 0.1 * ch) {\n        /* diverging? -- also forces ch > 0 */\n        if (ch < q) ch = 0.9 * q;\n        else ch = 1.1 * q;\n      }\n    }\n    /* no convergence in MAXIT iterations -- but we add Newton now... */\n\n    printer_qgamma(\n      'qgamma(%d) not converged in %d iterations; rel.ch=%d',\n      p,\n      MAXIT,\n      ch / fabs(q - ch)\n    );\n\n    /* was\n         *    ML_ERROR(ME_PRECISION, \"qgamma\");\n         * does nothing in R !*/\n  }\n  //END:\n  /* PR# 2214 :\t From: Morten Welinder <terra@diku.dk>, Fri, 25 Oct 2002 16:50\n       --------\t To: R-bugs@biostat.ku.dk     Subject: qgamma precision\n    \n       * With a final Newton step, double accuracy, e.g. for (p= 7e-4; nu= 0.9)\n       *\n       * Improved (MM): - only if rel.Err > EPS_N (= 1e-15);\n       *\t\t    - also for lower_tail = FALSE\t or log_p = TRUE\n       *\t\t    - optionally *iterate* Newton\n       */\n  x = 0.5 * scale * ch;\n  if (max_it_Newton) {\n    /* always use log scale */\n    if (!log_p) {\n      p = log(p);\n      log_p = true;\n    }\n    if (x === 0) {\n      const _1_p = 1 + 1e-7;\n      const _1_m = 1 - 1e-7;\n      x = DBL_MIN;\n      p_ = pgamma(x, alpha, scale, lower_tail, log_p);\n      if ((lower_tail && p_ > p * _1_p) || (!lower_tail && p_ < p * _1_m))\n        return 0;\n      /* else:  continue, using x = DBL_MIN instead of  0  */\n    } else p_ = pgamma(x, alpha, scale, lower_tail, log_p);\n    if (p_ === ML_NEGINF) return 0; /* PR#14710 */\n    for (i = 1; i <= max_it_Newton; i++) {\n      p1 = p_ - p;\n\n      if (i === 1)\n        printer_qgamma(\n          ' it=%d: p=%d, x = %d, p.=%d; p1=d{p}=%d',\n          i,\n          p,\n          x,\n          p_,\n          p1\n        );\n      if (i >= 2)\n        printer_qgamma(\n          '          x{it= %d} = %d, p.=%d, p1=d{p}=%d',\n          i,\n          x,\n          p_,\n          p1\n        );\n\n      if (fabs(p1) < fabs(EPS_N * p)) break;\n      /* else */\n      g = dgamma(x, alpha, scale, log_p);\n      if (g === R_D__0(log_p)) {\n        if (i === 1)\n          printer_qgamma('no final Newton step because dgamma(*)== 0!');\n        break;\n      }\n      /* else :\n             * delta x = f(x)/f'(x);\n             * if(log_p) f(x) := log P(x) - p; f'(x) = d/dx log P(x) = P' / P\n             * ==> f(x)/f'(x) = f*P / P' = f*exp(p_) / P' (since p_ = log P(x))\n             */\n      t = log_p ? p1 * exp(p_ - g) : p1 / g; /* = \"delta x\" */\n      t = lower_tail ? x - t : x + t;\n      p_ = pgamma(t, alpha, scale, lower_tail, log_p);\n      if (\n        fabs(p_ - p) > fabs(p1) ||\n        (i > 1 && fabs(p_ - p) === fabs(p1)) /* <- against flip-flop */\n      ) {\n        /* no improvement */\n\n        if (i === 1 && max_it_Newton > 1)\n          printer_qgamma('no Newton step done since delta{p} >= last delta');\n\n        break;\n      } /* else : */\n\n      /* control step length: this could have started at\n               the initial approximation */\n      if (t > 1.1 * x) t = 1.1 * x;\n      else if (t < 0.9 * x) t = 0.9 * x;\n\n      x = t;\n    }\n  }\n\n  return x;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_D_qIv,\n  R_Q_P01_boundaries\n} from '../common/_general';\n\nimport { qchisq } from '../chi-2/qchisq';\nimport { pnchisq_raw } from './pnchisq';\n\nconst { expm1, min: fmin2 } = Math;\nconst {\n  MAX_VALUE: DBL_MAX,\n  MIN_VALUE: DBL_MIN,\n  EPSILON: DBL_EPSILON,\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer = debug('_qnchisq');\n\nexport function qnchisq(\n  p: number,\n  df: number,\n  ncp: number,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n\n  printer('start');\n  \n  const accu = 1e-13;\n  const racc = 4 * DBL_EPSILON;\n  /* these two are for the \"search\" loops, can have less accuracy: */\n  const Eps = 1e-11; /* must be > accu */\n  const rEps = 1e-10; /* relative tolerance ... */\n\n  // double\n  let ux: number;\n  let lx: number;\n  let ux0: number;\n  let nx: number;\n  let pp: number;\n\n  if (ISNAN(p) || ISNAN(df) || ISNAN(ncp)) {\n    return NaN;\n  }\n\n  if (!R_FINITE(df)) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  /* Was\n     * df = floor(df + 0.5);\n     * if (df < 1 || ncp < 0) ML_ERR_return_NAN;\n     */\n  if (df < 0 || ncp < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  pp = R_D_qIv(log_p, p);\n  if (pp > 1 - DBL_EPSILON) {\n    return lower_tail ? ML_POSINF : 0.0;\n  }\n\n  /* Invert pnchisq(.) :\n     * 1. finding an upper and lower bound */\n  {\n    /* This is Pearson's (1959) approximation,\n       which is usually good to 4 figs or so.  */\n    //double\n    let b;\n    let c;\n    let ff;\n    \n    b = ncp * ncp / (df + 3 * ncp);\n    c = (df + 3 * ncp) / (df + 2 * ncp);\n    ff = (df + 2 * ncp) / (c * c);\n    ux = b + c * qchisq(p, ff, lower_tail, log_p);\n    if (ux < 0) ux = 1;\n    ux0 = ux;\n  }\n\n  if (!lower_tail && ncp >= 80) {\n    /* in this case, pnchisq() works via lower_tail = TRUE */\n    if (pp < 1e-10) ML_ERROR(ME.ME_PRECISION, 'qnchisq', printer);\n    p = /* R_DT_qIv(p)*/ log_p ? -expm1(p) : 0.5 - p + 0.5;\n    lower_tail = true;\n  } else {\n    p = pp;\n  }\n\n  pp = fmin2(1 - DBL_EPSILON, p * (1 + Eps));\n  if (lower_tail) {\n    for (\n      ;\n      ux < DBL_MAX &&\n      pnchisq_raw(ux, df, ncp, Eps, rEps, 10000, true, false) < pp;\n      ux *= 2\n    );\n    pp = p * (1 - Eps);\n    for (\n      lx = fmin2(ux0, DBL_MAX);\n      lx > DBL_MIN &&\n      pnchisq_raw(lx, df, ncp, Eps, rEps, 10000, true, false) > pp;\n      lx *= 0.5\n    );\n  } else {\n    for (\n      ;\n      ux < DBL_MAX &&\n      pnchisq_raw(ux, df, ncp, Eps, rEps, 10000, false, false) > pp;\n      ux *= 2\n    );\n    pp = p * (1 - Eps);\n    for (\n      lx = fmin2(ux0, DBL_MAX);\n      lx > DBL_MIN &&\n      pnchisq_raw(lx, df, ncp, Eps, rEps, 10000, false, false) < pp;\n      lx *= 0.5\n    );\n  }\n\n  /* 2. interval (lx,ux)  halving : */\n  if (lower_tail) {\n    do {\n      nx = 0.5 * (lx + ux);\n      if (pnchisq_raw(nx, df, ncp, accu, racc, 100000, true, false) > p)\n        ux = nx;\n      else lx = nx;\n    } while ((ux - lx) / nx > accu);\n  } else {\n    do {\n      nx = 0.5 * (lx + ux);\n      if (\n        pnchisq_raw(nx, df, ncp, accu, racc, 100000, false, false) < p\n      )\n        ux = nx;\n      else lx = nx;\n    } while ((ux - lx) / nx > accu);\n  }\n  return 0.5 * (ux + lx);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D__1,\n  R_D_negInonint,\n  R_D_nonint_check\n} from '../common/_general';\n\nimport { dbinom_raw } from '../binomial/dbinom';\n\nconst printer = debug('dhyper');\nconst { round: R_forceint } = Math;\nconst { isNaN: ISNAN } = Number;\n\nexport function dhyper(\n  x: number,\n  r: number,\n  b: number,\n  n: number,\n  give_log: boolean = false\n): number {\n  \n    let p: number;\n    let q: number;\n    let p1: number;\n    let p2: number;\n    let p3: number;\n\n    if (ISNAN(x) || ISNAN(r) || ISNAN(b) || ISNAN(n)) return x + r + b + n;\n\n    if (\n      R_D_negInonint(r) ||\n      R_D_negInonint(b) ||\n      R_D_negInonint(n) ||\n      n > r + b\n    )\n      return ML_ERR_return_NAN(printer);\n    if (x < 0) return R_D__0(give_log);\n    let rc = R_D_nonint_check(give_log, x, printer); // incl warning\n    if (rc !== undefined) {\n      return rc;\n    }\n    x = R_forceint(x);\n    r = R_forceint(r);\n    b = R_forceint(b);\n    n = R_forceint(n);\n\n    if (n < x || r < x || n - x > b) return R_D__0(give_log);\n    if (n === 0) return x === 0 ? R_D__1(give_log) : R_D__0(give_log);\n\n    p = n / (r + b);\n    q = (r + b - n) / (r + b);\n\n    p1 = dbinom_raw(x, r, p, q, give_log);\n    p2 = dbinom_raw(n - x, b, p, q, give_log);\n    p3 = dbinom_raw(n, r + b, p, q, give_log);\n\n    return give_log ? p1 + p2 - p3 : p1 * p2 / p3;\n \n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\nimport { lfastchoose } from '../common/choose';\nimport { R_DT_qIv } from '../exp/expm1';\n\nconst { log, exp, min: fmin2, max: fmax2, round: R_forceint } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\n\nconst printer_qhyper = debug('qhyper');\n\nexport function qhyper(\n  p: number,\n  nr: number,\n  nb: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n\n    /* This is basically the same code as  ./phyper.c  *used* to be --> FIXME! */\n    let N;\n    let xstart;\n    let xend;\n    let xr;\n    let xb;\n    let sum;\n    let term;\n    let small_N;\n\n    if (ISNAN(p) || ISNAN(nr) || ISNAN(nb) || ISNAN(n)) return NaN;\n\n    if (/*!R_FINITE(p) ||*/ !R_FINITE(nr) || !R_FINITE(nb) || !R_FINITE(n))\n      return ML_ERR_return_NAN(printer_qhyper);\n\n    let NR = R_forceint(nr);\n    let NB = R_forceint(nb);\n    N = NR + NB;\n    n = R_forceint(n);\n    if (NR < 0 || NB < 0 || n < 0 || n > N)\n      return ML_ERR_return_NAN(printer_qhyper);\n\n    /* Goal:  Find  xr (= #{red balls in sample}) such that\n     *   phyper(xr,  NR,NB, n) >= p > phyper(xr - 1,  NR,NB, n)\n     */\n\n    xstart = fmax2(0, n - NB);\n    xend = fmin2(n, NR);\n\n    let rc = R_Q_P01_boundaries(lowerTail, logP, p, xstart, xend);\n    if (rc !== undefined) {\n      return rc;\n    }\n    xr = xstart;\n    xb = n - xr; /* always ( = #{black balls in sample} ) */\n\n    small_N = N < 1000; /* won't have underflow in product below */\n    /* if N is small,  term := product.ratio( bin.coef );\n       otherwise work with its logarithm to protect against underflow */\n    term = lfastchoose(NR, xr) + lfastchoose(NB, xb) - lfastchoose(N, n);\n    if (small_N) term = exp(term);\n    NR -= xr;\n    NB -= xb;\n\n    if (!lowerTail || logP) {\n      p = R_DT_qIv(lowerTail, logP, p);\n    }\n    p *= 1 - 1000 * DBL_EPSILON; /* was 64, but failed on FreeBSD sometimes */\n    sum = small_N ? term : exp(term);\n\n    while (sum < p && xr < xend) {\n      xr++;\n      NB++;\n      if (small_N) term *= NR / xr * (xb / NB);\n      else term += log(NR / xr * (xb / NB));\n      sum += small_N ? term : exp(term);\n      xb--;\n      NR--;\n    }\n    return xr\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1 } from '../common/_general';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { floor, max: fmax2 } = Math;\n\nimport * as debug from 'debug';\nimport { NumberW } from '../common/toms708';\nimport { pgamma } from '../gamma/pgamma';\n\nconst printer = debug('ppois');\n\nexport function ppois(\n  x: number,\n  lambda: number,\n  lowerTail: boolean = true,\n  logP: boolean = false,\n  //normal: INormal //pass it on to \"pgamma\"->\"pgamma_raw\"->\"ppois_asymp\"->(dpnorm??)->(\"normal.pnorm\")  \n): number {\n\n    if (ISNAN(x) || ISNAN(lambda)) return x + lambda;\n\n    if (lambda < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n    if (x < 0) return R_DT_0(lowerTail, logP);\n    if (lambda === 0) return R_DT_1(lowerTail, logP);\n    if (!R_FINITE(x)) return R_DT_1(lowerTail, logP);\n    x = floor(x + 1e-7);\n\n    return pgamma(lambda, x + 1, 1, !lowerTail, logP);\n\n}\n\nexport function do_search(\n  y: number,\n  z: NumberW,\n  p: number,\n  lambda: number,\n  incr: number,\n // normal: INormal\n): number {\n  if (z.val >= p) {\n    /* search to the left */\n    while (true) {\n      if (\n        y === 0 ||\n        (z.val = ppois(\n          y - incr,\n          lambda,\n          /*l._t.*/ true,\n          /*log_p*/ false,\n         // normal\n        )) < p\n      )\n        return y;\n      y = fmax2(0, y - incr);\n    }\n  } else {\n    /* search to the right */\n\n    while (true) {\n      y = y + incr;\n      if (\n        (z.val = ppois(y, lambda, /*l._t.*/ true, /*log_p*/ false/*, normal*/)) >= p\n      )\n        return y;\n    }\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  imin2,\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D_exp,\n  R_DT_0,\n  R_DT_1,\n  R_DT_val,\n  R_Q_P01_check\n} from '../common/_general';\n\nimport { R_DT_qIv } from '../exp/expm1';\n\nimport { IRNG } from '../rng';\n\nimport { randomGenHelper } from '../r-func';\n\nconst { isFinite: R_FINITE, EPSILON: DBL_EPSILON, isNaN: ISNAN } = Number;\nconst {\n  LN2: M_LN2,\n  abs: fabs,\n  trunc,\n  log,\n  exp,\n  floor,\n  round\n} = Math;\n\nconst printer_dsignrank = debug('dsignrank');\nconst printer_psignrank = debug('psignrank');\nconst printer_qsignrank = debug('qsignrank');\nconst printer_rsignrank = debug('rsignrank');\n\nexport function csignrank(\n  k: number,\n  n: number,\n  u: number,\n  c: number,\n  w: number[]\n): number {\n  if (k < 0 || k > u) return 0;\n  if (k > c) k = u - k;\n\n  if (n === 1) return 1;\n  if (w[0] === 1) return w[k];\n  w[0] = w[1] = 1;\n  for (let j = 2; j < n + 1; ++j) {\n    let i;\n    let end = imin2(j * (j + 1) / 2, c);\n    for (i = end; i >= j; --i) w[i] += w[i - j];\n  }\n  return w[k];\n}\n\nexport function dsignrank(x: number, n: number, logX: boolean = false): number {\n  const rn = round(n);\n  const u = rn * (rn + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n\n  if (ISNAN(x) || ISNAN(n)) return x + n;\n\n  if (n <= 0) {\n    return ML_ERR_return_NAN(printer_dsignrank);\n  }\n  if (fabs(x - round(x)) > 1e-7) {\n    return R_D__0(logX);\n  }\n  x = round(x);\n  if (x < 0 || x > n * (n + 1) / 2) {\n    return R_D__0(logX);\n  }\n  let d = R_D_exp(logX, log(csignrank(trunc(x), n, u, c, w)) - n * M_LN2);\n  return d;\n\n}\n\nexport function psignrank(\n  x: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  const roundN = round(n);\n  const u = roundN * (roundN + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n\n  x => round(x + 1e-7)\n  if (ISNAN(x) || ISNAN(n)) return x + n;\n  if (!R_FINITE(n)) return ML_ERR_return_NAN(printer_psignrank);\n  if (n <= 0) return ML_ERR_return_NAN(printer_psignrank);\n\n  if (x < 0.0) {\n    return R_DT_0(lowerTail, logP);\n  }\n\n  if (x >= u) {\n    return R_DT_1(lowerTail, logP); //returns 1 on the edge case or 0 (because log(1)= 0)\n  }\n  let f = exp(-roundN * M_LN2);\n  let p = 0;\n  if (x <= u / 2) {\n    //smaller then mean\n    for (let i = 0; i <= x; i++) {\n      p += csignrank(i, roundN, u, c, w) * f;\n    }\n  } else {\n    x = n * (n + 1) / 2 - x;\n    for (let i = 0; i < x; i++) {\n      p += csignrank(i, roundN, u, c, w) * f;\n    }\n    lowerTail = !lowerTail; /* p = 1 - p; */\n  }\n  return R_DT_val(lowerTail, logP, p);\n\n} /* psignrank() */\n\nexport function qsignrank(\n  x: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n\n  const roundN = round(n);\n  const u = roundN * (roundN + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n\n  if (ISNAN(x) || ISNAN(n)) {\n    return x + n;\n  }\n\n  if (!R_FINITE(x) || !R_FINITE(n)) {\n    return ML_ERR_return_NAN(printer_qsignrank);\n  }\n  let rc = R_Q_P01_check(logP, x);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  if (roundN <= 0) { return ML_ERR_return_NAN(printer_qsignrank); }\n\n  if (x === R_DT_0(lowerTail, logP)) {\n    return 0;\n  }\n  if (x === R_DT_1(lowerTail, logP)) {\n    return u;\n  }\n\n  if (logP || !lowerTail)\n    x = R_DT_qIv(lowerTail, logP, x); // lower_tail, non-log \"p\"\n\n  //this.w_init_maybe(n);\n  let f = exp(-n * M_LN2);\n  let p = 0;\n  let q = 0;\n  if (x <= 0.5) {\n    x = x - 10 * DBL_EPSILON;\n    while (true) {\n      p += csignrank(q, roundN, u, c, w) * f;\n      if (p >= x) break;\n      q++;\n    }\n  } else {\n    x = 1 - x + 10 * DBL_EPSILON;\n    while (true) {\n      p += csignrank(q, roundN, u, c, w) * f;\n      if (p > x) {\n        q = trunc(u - q);\n        break;\n      }\n      q++;\n    }\n  }\n  return q;\n}\n\nexport function rsignrankOne(n: number, rng: IRNG): number {\n\n  /* NaNs propagated correctly */\n  if (ISNAN(n)) return n;\n  const nRound = round(n);\n  if (nRound < 0) return ML_ERR_return_NAN(printer_rsignrank);\n\n  if (nRound === 0) return 0;\n  let r = 0.0;\n  let k = floor(nRound);\n  for (let i = 0; i < k /**/;) {\n    r += ++i * floor((rng.internal_unif_rand()) + 0.5);\n  }\n  return r;\n}\nexport function rsignrank(\n  N: number,\n  n: number,\n  rng: IRNG\n): number[] {\n  return randomGenHelper(N, rsignrankOne, n, rng);\n}\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  DBL_MANT_DIG,\n  M_1_PI,\n  M_PI_2,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_D_Cval,\n  R_D_log,\n  R_D_Lval,\n  R_D_qIv,\n  R_Q_P01_boundaries\n} from '../common/_general';\n\nimport { R_D_LExp, R_DT_qIv } from '../exp/expm1';\nimport { qnorm } from '../normal/qnorm';\nimport { tanpi } from '../trigonometry/cospi';\nimport { dt } from './dt';\nimport { pt } from './pt';\n\nconst {\n  LN2: M_LN2,\n  PI: M_PI,\n  SQRT2: M_SQRT2,\n  sqrt,\n  pow,\n  log,\n  exp,\n  min: fmin2,\n  abs: fabs,\n  expm1\n} = Math;\n\nconst {\n  isNaN: ISNAN,\n  EPSILON: DBL_EPSILON,\n  MAX_VALUE: DBL_MAX,\n  MIN_VALUE: DBL_MIN,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF,\n  isFinite: R_FINITE\n} = Number;\n\nconst printer_qt = debug('qt');\n\nexport function qt(\n  p: number,\n  ndf: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  const eps = 1e-12;\n  let P;\n  let q;\n\n  const accu = 1e-13;\n  const Eps = 1e-11; /* must be > accur */\n\n  if (ISNAN(p) || ISNAN(ndf)) return p + ndf;\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, ML_NEGINF, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n  if (ndf <= 0) return ML_ERR_return_NAN(printer_qt);\n\n  if (ndf < 1) {\n    /* based on qnt */\n\n    let ux;\n    let lx;\n    let nx;\n    let pp;\n\n    let iter = 0;\n\n    p = R_DT_qIv(lower_tail, log_p, p);\n\n    /* Invert pt(.) :\n     * 1. finding an upper and lower bound */\n    if (p > 1 - DBL_EPSILON) return ML_POSINF;\n    pp = fmin2(1 - DBL_EPSILON, p * (1 + Eps));\n    for (\n      ux = 1;\n      ux < DBL_MAX && pt(ux, ndf, true, false) < pp;\n      ux *= 2\n    );\n    pp = p * (1 - Eps);\n    for (\n      lx = -1;\n      lx > -DBL_MAX && pt(lx, ndf, true, false) > pp;\n      lx *= 2\n    );\n\n    /* 2. interval (lx,ux)  halving\n       regula falsi failed on qt(0.1, 0.1)\n     */\n    do {\n      nx = 0.5 * (lx + ux);\n      if (pt(nx, ndf, true, false) > p) ux = nx;\n      else lx = nx;\n    } while ((ux - lx) / fabs(nx) > accu && ++iter < 1000);\n\n    if (iter >= 1000) {\n      ML_ERROR(ME.ME_PRECISION, 'qt', printer_qt);\n    }\n\n    return 0.5 * (lx + ux);\n  }\n\n  /* Old comment:\n     * FIXME: \"This test should depend on  ndf  AND p  !!\n     * -----  and in fact should be replaced by\n     * something like Abramowitz & Stegun 26.7.5 (p.949)\"\n     *\n     * That would say that if the qnorm value is x then\n     * the result is about x + (x^3+x)/4df + (5x^5+16x^3+3x)/96df^2\n     * The differences are tiny even if x ~ 1e5, and qnorm is not\n     * that accurate in the extreme tails.\n     */\n  if (ndf > 1e20) return qnorm(p, 0, 1, lower_tail, log_p);\n\n  P = R_D_qIv(log_p, p); /* if exp(p) underflows, we fix below */\n\n  let neg = (!lower_tail || P < 0.5) && (lower_tail || P > 0.5);\n  let is_neg_lower = lower_tail === neg; /* both TRUE or FALSE == !xor */\n  if (neg)\n    P = 2 * (log_p ? (lower_tail ? P : -expm1(p)) : R_D_Lval(lower_tail, p));\n  else P = 2 * (log_p ? (lower_tail ? -expm1(p) : P) : R_D_Cval(lower_tail, p));\n  /* 0 <= P <= 1 ; P = 2*min(P', 1 - P')  in all cases */\n\n  if (fabs(ndf - 2) < eps) {\n    /* df ~= 2 */\n    if (P > DBL_MIN) {\n      if (3 * P < DBL_EPSILON)\n        /* P ~= 0 */\n        q = 1 / sqrt(P);\n      else if (P > 0.9)\n        /* P ~= 1 */\n        q = (1 - P) * sqrt(2 / (P * (2 - P))); /* eps/3 <= P <= 0.9 */\n      else q = sqrt(2 / (P * (2 - P)) - 2);\n    } else {\n      /* P << 1, q = 1/sqrt(P) = ... */\n      if (log_p) q = is_neg_lower ? exp(-p / 2) / M_SQRT2 : 1 / sqrt(-expm1(p));\n      else q = ML_POSINF;\n    }\n  } else if (ndf < 1 + eps) {\n    /* df ~= 1  (df < 1 excluded above): Cauchy */\n    if (P === 1) q = 0;\n    else if (P > 0)\n      // some versions of tanpi give Inf, some NaN\n      q = 1 / tanpi(P / 2);\n    else {\n      /* == - tan((P+1) * M_PI_2) -- suffers for P ~= 0 */\n\n      /* P = 0, but maybe = 2*exp(p) ! */\n      if (log_p)\n        /* 1/tan(e) ~ 1/e */\n        q = is_neg_lower ? M_1_PI * exp(-p) : -1 / (M_PI * expm1(p));\n      else q = ML_POSINF;\n    }\n  } else {\n    /*-- usual case;  including, e.g.,  df = 1.1 */\n    let x = 0;\n    let y = 0;\n    let log_P2 = 0 /* -Wall */;\n    let a = 1 / (ndf - 0.5);\n    let b = 48 / (a * a);\n    let c = ((20700 * a / b - 98) * a - 16) * a + 96.36;\n    let d = ((94.5 / (b + c) - 3) / b + 1) * sqrt(a * M_PI_2) * ndf;\n\n    let P_ok1 = P > DBL_MIN || !log_p;\n    let P_ok = P_ok1;\n\n    if (P_ok1) {\n      y = pow(d * P, 2.0 / ndf);\n      P_ok = y >= DBL_EPSILON;\n    }\n    if (!P_ok) {\n      // log.p && P very.small  ||  (d*P)^(2/df) =: y < eps_c\n      log_P2 = is_neg_lower\n        ? R_D_log(log_p, p)\n        : R_D_LExp(log_p, p); /* == log(P / 2) */\n      x = (log(d) + M_LN2 + log_P2) / ndf;\n      y = exp(2 * x);\n    }\n\n    if ((ndf < 2.1 && P > 0.5) || y > 0.05 + a) {\n      /* P > P0(df) */\n      /* Asymptotic inverse expansion about normal */\n      if (P_ok)\n        x = qnorm(\n          0.5 * P,\n          0,\n          1,\n          /*lower_tail*/ false,\n          /*log_p*/ false\n        ); /* log_p && P underflowed */\n      else x = qnorm(log_P2, 0, 1, lower_tail, /*log_p*/ true);\n\n      y = x * x;\n      if (ndf < 5) c += 0.3 * (ndf - 4.5) * (x + 0.6);\n      c = (((0.05 * d * x - 5) * x - 7) * x - 2) * x + b + c;\n      y = (((((0.4 * y + 6.3) * y + 36) * y + 94.5) / c - y - 3) / b + 1) * x;\n      y = expm1(a * y * y);\n      q = sqrt(ndf * y);\n    } else if (!P_ok && x < -M_LN2 * DBL_MANT_DIG) {\n      /* 0.5* log(DBL_EPSILON) */\n      /* y above might have underflown */\n      q = sqrt(ndf) * exp(-x);\n    } else {\n      /* re-use 'y' from above */\n      y =\n        ((1 / (((ndf + 6) / (ndf * y) - 0.089 * d - 0.822) * (ndf + 2) * 3) +\n          0.5 / (ndf + 4)) *\n          y -\n          1) *\n          (ndf + 1) /\n          (ndf + 2) +\n        1 / y;\n      q = sqrt(ndf * y);\n    }\n\n    /* Now apply 2-term Taylor expansion improvement (1-term = Newton):\n     * as by Hill (1981) [ref.above] */\n\n    /* FIXME: This can be far from optimal when log_p = TRUE\n     *      but is still needed, e.g. for qt(-2, df=1.01, log=TRUE).\n     *\tProbably also improvable when  lower_tail = FALSE */\n\n    if (P_ok1) {\n      let it = 0;\n      while (\n        it++ < 10 &&\n        (y = dt(q, ndf, false)) > 0 &&\n        R_FINITE((x = (pt(q, ndf, false, false) - P / 2) / y)) &&\n        fabs(x) > 1e-14 * fabs(q)\n      )\n        /* Newton (=Taylor 1 term):\n         *  q += x;\n         * Taylor 2-term : */\n        q += x * (1 + x * q * (ndf + 1) / (2 * (q * q + ndf)));\n    }\n  }\n  if (neg) q = -q;\n  return q;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { wprob } from './wprob';\n\nimport {\n  //M_1_SQRT_2PI,\n  ME,\n  ML_ERR_return_NAN,\n  ML_ERROR,\n  R_DT_0,\n  R_DT_1\n} from '../common/_general';\n\nimport { R_DT_val } from '../common/_general';\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { exp, sqrt, log, LN2: M_LN2 } = Math;\n\nconst printer_ptukey = debug('_ptukey');\n\n\n/*\n> ptukey\nfunction (q, nmeans, df, nranges = 1, lower.tail = TRUE, log.p = FALSE)\n.Call(C_ptukey, q, nranges, nmeans, df, lower.tail, log.p)\n<bytecode: 0x000000001cde3048>\n<environment: namespace:stats>\n\ndouble ptukey(\n\tdouble q, // q\n\tdouble rr, // nranges\n\tdouble cc, // nmeans\n\tdouble df, // df\n  int lower_tail, // lowertail\n\tint log_p //logp\n*/\nexport function ptukey(\n  q: number,\n  rr: number,\n  cc: number,\n  df: number,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n  /*  function ptukey() [was qprob() ]:\n    \n        q = value of studentized range\n        rr = no. of rows or groups\n        cc = no. of columns or treatments\n        df = degrees of freedom of error term\n        ir[0] = error flag = 1 if wprob probability > 1\n        ir[1] = error flag = 1 if qprob probability > 1\n    \n        qprob = returned probability integral over [0, q]\n    \n        The program will not terminate if ir[0] or ir[1] are raised.\n    \n        All references in wprob to Abramowitz and Stegun\n        are from the following reference:\n    \n        Abramowitz, Milton and Stegun, Irene A.\n        Handbook of Mathematical Functions.\n        New York:  Dover publications, Inc. (1970).\n    \n        All constants taken from this text are\n        given to 25 significant digits.\n    \n        nlegq = order of legendre quadrature\n        ihalfq = int ((nlegq + 1) / 2)\n        eps = max. allowable value of integral\n        eps1 & eps2 = values below which there is\n                  no contribution to integral.\n    \n        d.f. <= dhaf:\tintegral is divided into ulen1 length intervals.  else\n        d.f. <= dquar:\tintegral is divided into ulen2 length intervals.  else\n        d.f. <= deigh:\tintegral is divided into ulen3 length intervals.  else\n        d.f. <= dlarg:\tintegral is divided into ulen4 length intervals.\n    \n        d.f. > dlarg:\tthe range is used to calculate integral.\n    \n        M_LN2 = log(2)\n    \n        xlegq = legendre 16-point nodes\n        alegq = legendre 16-point coefficients\n    \n        The coefficients and nodes for the legendre quadrature used in\n        qprob and wprob were calculated using the algorithms found in:\n    \n        Stroud, A. H. and Secrest, D.\n        Gaussian Quadrature Formulas.\n        Englewood Cliffs,\n        New Jersey:  Prentice-Hall, Inc, 1966.\n    \n        All values matched the tables (provided in same reference)\n        to 30 significant digits.\n    \n        f(x) = .5 + erf(x / sqrt(2)) / 2      for x > 0\n    \n        f(x) = erfc( -x / sqrt(2)) / 2\t      for x < 0\n    \n        where f(x) is standard normal c. d. f.\n    \n        if degrees of freedom large, approximate integral\n        with range distribution.\n     */\n  const nlegq = 16;\n  const ihalfq = 8;\n\n  /*  const double eps = 1.0; not used if = 1 */\n  const eps1 = -30.0;\n  const eps2 = 1.0e-14;\n  const dhaf = 100.0;\n  const dquar = 800.0;\n  const deigh = 5000.0;\n  const dlarg = 25000.0;\n  const ulen1 = 1.0;\n  const ulen2 = 0.5;\n  const ulen3 = 0.25;\n  const ulen4 = 0.125;\n  const xlegq = [\n    0.98940093499164993259615417345,\n    0.944575023073232576077988415535,\n    0.865631202387831743880467897712,\n    0.755404408355003033895101194847,\n    0.617876244402643748446671764049,\n    0.458016777657227386342419442984,\n    0.28160355077925891323046050146,\n    0.95012509837637440185319335425e-1\n  ];\n  const alegq = [\n    0.27152459411754094851780572456e-1,\n    0.622535239386478928628438369944e-1,\n    0.951585116824927848099251076022e-1,\n    0.124628971255533872052476282192,\n    0.149595988816576732081501730547,\n    0.16915651939500253818931207903,\n    0.182603415044923588866763667969,\n    0.189450610455068496285396723208\n  ];\n  //double\n  let ans: number;\n  let f2: number;\n  let f21: number;\n  let f2lf: number;\n  let ff4: number;\n  let otsum: number;\n  let qsqz: number;\n  let rotsum: number;\n  //let t1: number;\n  let twa1: number;\n  let ulen: number;\n  let wprb: number;\n  //let j: number;\n\n  if (ISNAN(q) || ISNAN(rr) || ISNAN(cc) || ISNAN(df)) {\n    return ML_ERR_return_NAN(printer_ptukey);\n  }\n\n  if (q <= 0) {\n    return R_DT_0(lower_tail, log_p);\n  }\n\n  /* df must be > 1 */\n  /* there must be at least two values */\n\n  if (df < 2 || rr < 1 || cc < 2) return ML_ERR_return_NAN(printer_ptukey);\n\n  if (!R_FINITE(q)) return R_DT_1(lower_tail, log_p);\n\n  if (df > dlarg) return R_DT_val(lower_tail, log_p, wprob(q, rr, cc));\n\n  /* calculate leading constant */\n\n  f2 = df * 0.5;\n  /* lgammafn(u) = log(gamma(u)) */\n  f2lf = f2 * log(df) - df * M_LN2 - lgammafn(f2);\n  f21 = f2 - 1.0;\n\n  /* integral is divided into unit, half-unit, quarter-unit, or */\n  /* eighth-unit length intervals depending on the value of the */\n  /* degrees of freedom. */\n\n  ff4 = df * 0.25;\n  if (df <= dhaf) ulen = ulen1;\n  else if (df <= dquar) ulen = ulen2;\n  else if (df <= deigh) ulen = ulen3;\n  else ulen = ulen4;\n\n  f2lf += log(ulen);\n\n  /* integrate over each subinterval */\n\n  ans = 0.0;\n  otsum = 0.0; // to let typscript linting know it is used , it is within the for loop\n  for (let i = 1; i <= 50; i++) {\n    otsum = 0.0;\n\n    /* legendre quadrature with order = nlegq */\n    /* nodes (stored in xlegq) are symmetric around zero. */\n\n    twa1 = (2 * i - 1) * ulen;\n\n    for (let jj = 1; jj <= nlegq; jj++) {\n      const j = ihalfq < jj ? jj - ihalfq - 1 : jj - 1;\n      const t1 =\n        ihalfq < jj\n          ? f2lf +\n            f21 * log(twa1 + xlegq[j] * ulen) -\n            (xlegq[j] * ulen + twa1) * ff4\n          : f2lf +\n            f21 * log(twa1 - xlegq[j] * ulen) +\n            (xlegq[j] * ulen - twa1) * ff4;\n\n      /* if exp(t1) < 9e-14, then doesn't contribute to integral */\n      if (t1 >= eps1) {\n        if (ihalfq < jj) {\n          qsqz = q * sqrt((xlegq[j] * ulen + twa1) * 0.5);\n        } else {\n          qsqz = q * sqrt((-(xlegq[j] * ulen) + twa1) * 0.5);\n        }\n\n        /* call wprob to find integral of range portion */\n\n        wprb = wprob(qsqz, rr, cc);\n        rotsum = wprb * alegq[j] * exp(t1);\n        otsum += rotsum;\n      }\n      /* end legendre integral for interval i */\n      /* L200: */\n    } //for\n\n    /* if integral for interval i < 1e-14, then stop.\n         * However, in order to avoid small area under left tail,\n         * at least  1 / ulen  intervals are calculated.\n         */\n    if (i * ulen >= 1.0 && otsum <= eps2) break;\n\n    /* end of interval i */\n    /* L330: */\n\n    ans += otsum;\n  } //for\n\n  if (otsum > eps2) {\n    /* not converged */\n    ML_ERROR(ME.ME_PRECISION, 'ptukey', printer_ptukey);\n  }\n  if (ans > 1) ans = 1;\n  return R_DT_val(lower_tail, log_p, ans);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ME, ML_ERROR } from '../../common/_general';\n//import { boolVector, numVector } from '../../types';\nimport { K_bessel } from './Kbessel';\n\nconst { isNaN: ISNAN } = Number;\nconst { floor } = Math;\nconst printer = debug('bessel_k');\n\n\nexport function bessel_k(x: number, alpha: number, expo: boolean = false): number {\n  let nb;\n  let ize;\n\n\n  /* NaNs propagated correctly */\n  if (ISNAN(x) || ISNAN(alpha)) return x + alpha;\n\n  if (x < 0) {\n    ML_ERROR(ME.ME_RANGE, 'bessel_k', printer);\n    return NaN;\n  }\n  ize = expo ? 2 : 1;\n  if (alpha < 0)\n    alpha = -alpha;\n  nb = 1 + floor(alpha); /* nb-1 <= |alpha| < nb */\n  alpha -= (nb - 1);\n\n\n\n\n  const rc = K_bessel(x, alpha, nb, ize);\n  if (rc.ncalc !== rc.nb) {/* error input */\n    if (rc.ncalc < 0)\n      printer('bessel_k(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?\\n',\n        rc.x, rc.ncalc, rc.nb, alpha);\n    else\n      printer('bessel_k(%d,nu=%d): precision lost in result\\n',\n        rc.x, alpha + rc.nb - 1);\n  }\n  x = rc.x; // bk[nb - 1];\n  return x;\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\nimport { sinpi } from '../trigonometry';\n\nconst { PI: M_PI, log, exp, trunc } = Math;\n\nconst {\n  EPSILON: DBL_EPSILON,\n  MIN_VALUE: DBL_MIN,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\n\nexport function Rf_gamma_cody(x: number) {\n  /*\n *\n *  NOTES\n   This routine calculates the GAMMA function for a float argument X.\n   Computation is based on an algorithm outlined in reference [1].\n   The program uses rational functions that approximate the GAMMA\n   function to at least 20 significant decimal digits.\tCoefficients\n   for the approximation over the interval (1,2) are unpublished.\n   Those for the approximation for X >= 12 are from reference [2].\n   The accuracy achieved depends on the arithmetic system, the\n   compiler, the intrinsic functions, and proper selection of the\n   machine-dependent constants.\n\n   *******************************************************************\n\n   Error returns\n\n   The program returns the value XINF for singularities or\n   when overflow would occur.\t The computation is believed\n   to be free of underflow and overflow.\n\n   Intrinsic functions required are:\n\n   INT, DBLE, EXP, LOG, REAL, SIN\n\n\n   References:\n   [1]  \"An Overview of Software Development for Special Functions\",\n  W. J. Cody, Lecture Notes in Mathematics, 506,\n  Numerical Analysis Dundee, 1975, G. A. Watson (ed.),\n  Springer Verlag, Berlin, 1976.\n\n   [2]  Computer Approximations, Hart, Et. Al., Wiley and sons, New York, 1968.\n\n   Latest modification: October 12, 1989\n\n   Authors: W. J. Cody and L. Stoltz\n   Applied Mathematics Division\n   Argonne National Laboratory\n   Argonne, IL 60439\n   ----------------------------------------------------------------------*/\n\n  /* ----------------------------------------------------------------------\n   Mathematical constants\n   ----------------------------------------------------------------------*/\n  const sqrtpi = 0.9189385332046727417803297; /* == ??? */\n\n  /* *******************************************************************\n\n   Explanation of machine-dependent constants\n\n   beta\t- radix for the floating-point representation\n   maxexp - the smallest positive power of beta that overflows\n   XBIG\t- the largest argument for which GAMMA(X) is representable\n  in the machine, i.e., the solution to the equation\n  GAMMA(XBIG) = beta**maxexp\n   XINF\t- the largest machine representable floating-point number;\n  approximately beta**maxexp\n   EPS\t- the smallest positive floating-point number such that  1.0+EPS > 1.0\n   XMININ - the smallest positive floating-point number such that\n  1/XMININ is machine representable\n\n   Approximate values for some important machines are:\n\n   beta\t      maxexp\t     XBIG\n\n   CRAY-1\t\t(S.P.)\t      2\t\t8191\t    966.961\n   Cyber 180/855\n   under NOS\t(S.P.)\t      2\t\t1070\t    177.803\n   IEEE (IBM/XT,\n   SUN, etc.)\t(S.P.)\t      2\t\t 128\t    35.040\n   IEEE (IBM/XT,\n   SUN, etc.)\t(D.P.)\t      2\t\t1024\t    171.624\n   IBM 3033\t(D.P.)\t     16\t\t  63\t    57.574\n   VAX D-Format\t(D.P.)\t      2\t\t 127\t    34.844\n   VAX G-Format\t(D.P.)\t      2\t\t1023\t    171.489\n\n   XINF\t EPS\t    XMININ\n\n   CRAY-1\t\t(S.P.)\t 5.45E+2465   7.11E-15\t  1.84E-2466\n   Cyber 180/855\n   under NOS\t(S.P.)\t 1.26E+322    3.55E-15\t  3.14E-294\n   IEEE (IBM/XT,\n   SUN, etc.)\t(S.P.)\t 3.40E+38     1.19E-7\t  1.18E-38\n   IEEE (IBM/XT,\n   SUN, etc.)\t(D.P.)\t 1.79D+308    2.22D-16\t  2.23D-308\n   IBM 3033\t(D.P.)\t 7.23D+75     2.22D-16\t  1.39D-76\n   VAX D-Format\t(D.P.)\t 1.70D+38     1.39D-17\t  5.88D-39\n   VAX G-Format\t(D.P.)\t 8.98D+307    1.11D-16\t  1.12D-308\n\n   *******************************************************************\n\n   ----------------------------------------------------------------------\n   Machine dependent parameters\n   ----------------------------------------------------------------------\n   */\n\n  const xbig = 171.624;\n  /* ML_POSINF ==   const double xinf = 1.79e308;*/\n  /* DBL_EPSILON = const double eps = 2.22e-16;*/\n  /* DBL_MIN ==   const double xminin = 2.23e-308;*/\n\n  /*----------------------------------------------------------------------\n  Numerator and denominator coefficients for rational minimax\n  approximation over (1,2).\n  ----------------------------------------------------------------------*/\n  const p = [\n    -1.71618513886549492533811,\n    24.7656508055759199108314,\n    -379.804256470945635097577,\n    629.331155312818442661052,\n    866.966202790413211295064,\n    -31451.2729688483675254357,\n    -36144.4134186911729807069,\n    66456.1438202405440627855\n  ];\n  const q = [\n    -30.8402300119738975254353,\n    315.350626979604161529144,\n    -1015.15636749021914166146,\n    -3107.77167157231109440444,\n    22538.1184209801510330112,\n    4755.84627752788110767815,\n    -134659.959864969306392456,\n    -115132.259675553483497211\n  ];\n  /*----------------------------------------------------------------------\n  Coefficients for minimax approximation over (12, INF).\n  ----------------------------------------------------------------------*/\n  const c = [\n    -0.001910444077728,\n    8.4171387781295e-4,\n    -5.952379913043012e-4,\n    7.93650793500350248e-4,\n    -0.002777777777777681622553,\n    0.08333333333333333331554247,\n    0.0057083835261\n  ];\n\n  /* Local variables */\n  //int\n  let i: number;\n  let n: number;\n  let parity: number; /*logical*/\n\n  //double\n  let fact: number;\n  let xden: number;\n  let xnum: number;\n  let y: number;\n  let z: number;\n  let yi: number;\n  let res: number;\n  let sum: number;\n  let ysq: number;\n\n  parity = 0;\n  fact = 1;\n  n = 0;\n  y = x;\n  if (y <= 0) {\n    /* -------------------------------------------------------------\n     Argument is negative\n     ------------------------------------------------------------- */\n    y = -x;\n    yi = trunc(y);\n    res = y - yi;\n    if (res !== 0) {\n      if (yi !== trunc(yi * 0.5) * 2) {\n        parity = 1;\n      }\n      fact = -M_PI / sinpi(res);\n      y += 1;\n    } else {\n      return ML_POSINF;\n    }\n  }\n  /* -----------------------------------------------------------------\n   Argument is positive\n   -----------------------------------------------------------------*/\n  if (y < DBL_EPSILON) {\n    /* --------------------------------------------------------------\n     Argument < EPS\n     -------------------------------------------------------------- */\n    if (y >= DBL_MIN) {\n      res = 1 / y;\n    } else {\n      return ML_POSINF;\n    }\n  } else if (y < 12) {\n    yi = y;\n    if (y < 1) {\n      /* ---------------------------------------------------------\n       EPS < argument < 1\n       --------------------------------------------------------- */\n      z = y;\n      y += 1;\n    } else {\n      /* -----------------------------------------------------------\n       1 <= argument < 12, reduce argument if necessary\n       ----------------------------------------------------------- */\n      n = trunc(y) - 1;\n      y -= n;\n      z = y - 1;\n    }\n    /* ---------------------------------------------------------\n     Evaluate approximation for 1. < argument < 2.\n     ---------------------------------------------------------*/\n    xnum = 0;\n    xden = 1;\n    for (i = 0; i < 8; ++i) {\n      xnum = (xnum + p[i]) * z;\n      xden = xden * z + q[i];\n    }\n    res = xnum / xden + 1;\n    if (yi < y) {\n      /* --------------------------------------------------------\n       Adjust result for case  0. < argument < 1.\n       -------------------------------------------------------- */\n      res /= yi;\n    } else if (yi > y) {\n      /* ----------------------------------------------------------\n       Adjust result for case  2. < argument < 12.\n       ---------------------------------------------------------- */\n      for (i = 0; i < n; ++i) {\n        res *= y;\n        y += 1;\n      }\n    }\n  } else {\n    /* -------------------------------------------------------------\n     Evaluate for argument >= 12.,\n     ------------------------------------------------------------- */\n    if (y <= xbig) {\n      ysq = y * y;\n      sum = c[6];\n      for (i = 0; i < 6; ++i) {\n        sum = sum / ysq + c[i];\n      }\n      sum = sum / y - y + sqrtpi;\n      sum += (y - 0.5) * log(y);\n      res = exp(sum);\n    } else {\n      return ML_POSINF;\n    }\n  }\n  /* ----------------------------------------------------------------------\n   Final adjustments and return\n   ----------------------------------------------------------------------*/\n  if (parity) res = -res;\n  if (fact !== 1) res = fact / res;\n  return res;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ME, ML_ERROR } from '../../common/_general';\n\nimport { cospi } from '../../trigonometry/cospi';\nimport { sinpi } from '../../trigonometry/sinpi';\nimport { bessel_y } from '../besselY';\nimport { J_bessel } from './Jbessel';\n\nconst { isNaN: ISNAN }  = Number;\nconst { floor, trunc } = Math;\n\nconst printer = debug('bessel_j');\n\nexport function bessel_j(x: number, alpha: number): number  {\n    //int\n    let nb; \n    //double\n    let na; // , *bj;\n  \n    /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(alpha)) return x + alpha;\n    if (x < 0) {\n      ML_ERROR(ME.ME_RANGE, 'bessel_j', printer);\n        return NaN;\n    }\n    na = floor(alpha);\n    if (alpha < 0) {\n      /* Using Abramowitz & Stegun  9.1.2\n       * this may not be quite optimal (CPU and accuracy wise) */\n      return(((alpha - na === 0.5) ? 0 : bessel_j(x, -alpha) * cospi(alpha)) +\n        ((alpha === na) ? 0 : bessel_y(x, -alpha) * sinpi(alpha)));\n    }\n    else if (alpha > 1e7) {\n      printer(\n        'besselJ(x, nu): nu=%d too large for bessel_j() algorithm',\n        alpha);\n      return NaN;\n    }\n  \n    nb = 1 + trunc(na); /* nb-1 <= alpha < nb */\n    alpha -= (nb - 1); // ==> alpha' in [0, 1)\n    const rc = J_bessel(x, alpha, nb);\n  \n    if (rc.ncalc !== nb) {/* error input */\n      if (rc.ncalc < 0)\n        printer('bessel_j(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?',\n          x, rc.ncalc, rc.nb, alpha);\n      else\n        printer('bessel_j(%d,nu=%d): precision lost in result',\n          x, alpha + nb - 1);\n    }\n    x = rc.x; // bj[nb - 1];\n    return x;\n  }\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ME, ML_ERROR } from '../../common/_general';\nimport { cospi } from '../../trigonometry/cospi';\nimport { sinpi } from '../../trigonometry/sinpi';\nimport { bessel_j } from '../besselJ';\nimport { Y_bessel } from './Ybessel';\n\nconst { floor } = Math;\nconst { isNaN:ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\n\nconst printer = debug('bessel_y');\n\nexport function bessel_y(x: number, alpha: number): number {\n  //double\n  \n  /* NaNs propagated correctly */\n  if (ISNAN(x) || ISNAN(alpha)) return x + alpha;\n\n  if (x < 0) {\n    ML_ERROR(ME.ME_RANGE, 'bessel_y', printer);\n    return NaN;\n  }\n  const na = floor(alpha);\n  if (alpha < 0) {\n    /* Using Abramowitz & Stegun  9.1.2\n     * this may not be quite optimal (CPU and accuracy wise) */\n    return (((alpha - na === 0.5) ? 0 : bessel_y(x, -alpha) * cospi(alpha)) -\n      ((alpha === na) ? 0 : bessel_j(x, -alpha) * sinpi(alpha)));\n  }\n  else if (alpha > 1e7) {\n    printer('besselY(x, nu): nu=%d too large for bessel_y() algorithm',\n      alpha);\n    return NaN;\n  }\n  const nb = 1 + na; /* nb-1 <= alpha < nb */\n  alpha -= (nb - 1);\n\n\n  const rc = Y_bessel(x, alpha, nb);\n  if (rc.ncalc !== nb) {/* error input */\n    if (rc.ncalc === -1) {\n      return ML_POSINF;\n    }\n    else if (rc.ncalc < -1)\n      printer('bessel_y(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?\\n',\n        rc.x, rc.ncalc, nb, alpha);\n    else /* ncalc >= 0 */\n      printer('bessel_y(%d,nu=%d): precision lost in result\\n',\n        rc.x, alpha + nb - 1);\n  }\n  x = rc.x;\n  return x;\n}\n  \n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nexport { Beta } from './beta';\nexport { Binomial } from './binomial';\nexport { NegativeBinomial } from './binomial-negative';\nexport { Cauchy } from './cauchy';\nexport { chebyshev_eval, chebyshev_init } from './chebyshev';\nexport { ChiSquared } from './chi-2';\nexport { Exponential } from './exp';\nexport { FDist } from './f-distro';\nexport { Gamma } from './gamma';\nexport { Geometric } from './geometric';\nexport { HyperGeometric } from './hypergeometric';\nexport { Logistic } from './logis';\nexport { LogNormal } from './lognormal';\nexport { Multinomial, IdmultinomOptions } from './multinom';\nexport { Normal } from './normal';\nexport { Poisson } from './poisson';\nexport { rng, IRNG, IRNGNormal } from './rng';\nexport { SignRank } from './signrank';\n//  stirling, no need to export, it is a util\nexport { StudentT } from './student-t';\n//  trigonometry, no need to export, it is a util\nexport { Tukey } from './tukey';\nexport { Uniform } from './uniform';\nexport { Weibull } from './weibull';\nexport { Wilcoxon } from './wilcoxon';\nexport { hypot, log1p as log1pR } from './log';\n/*\n  Class of Special functions collected here.\n*/\nimport besselSpecial  from './bessel';\nimport betaSpecial  from './beta';\nimport chooseSpecial from './common';\nimport gammaSpecial  from './gamma';\n\nexport const special = Object.freeze({\n  ...gammaSpecial,\n  ...betaSpecial,\n  ...chooseSpecial,\n  ...besselSpecial\n});\n\nimport {\n  array_flatten,\n  c,\n  chain,\n  flatten,\n  ISummary,\n  multiplexer,\n  numberPrecision,\n  Rcycle,\n  seq_len,\n  sequenceFactory,\n  strTypes\n} from './r-func';\n\nexport { ISummary, strTypes };\n\nexport const utils = {\n  //Welch_Satterthwaite,\n  //summary,\n  //sum,\n  numberPrecision,\n  multiplexer,\n  Rcycle,\n  flatten,\n  array_flatten,\n  seq_len,\n  sequenceFactory,\n  seq1: sequenceFactory(0),\n  seq0: sequenceFactory(),\n  chain,\n  combine:c,\n  c\n};\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ME, ML_ERR_return_NAN, ML_ERROR } from '../common/_general';\nimport { gammafn } from '../gamma/gamma_fn';\nimport { lbeta } from './lbeta';\n\n//const xmin =  - 170.5674972726612;\nconst xmax = 171.61447887182298;\nconst lnsml = -708.39641853226412;\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer_beta = debug('beta');\n\nexport function beta(a: number, b: number): number {\n\n\n  if (ISNAN(a) || ISNAN(b)) return a + b;\n\n  if (a < 0 || b < 0) return ML_ERR_return_NAN(printer_beta);\n  else if (a === 0 || b === 0) return ML_POSINF;\n  else if (!R_FINITE(a) || !R_FINITE(b)) return 0;\n\n  if (a + b < xmax) {\n    //\n    // ~= 171.61 for IEEE\n    //\treturn gammafn(a) * gammafn(b) / gammafn(a+b);\n    // All the terms are positive, and all can be large for large\n    //   or small arguments.  They are never much less than one.\n    //   gammafn(x) can still overflow for x ~ 1e-308,\n    //   but the result would too.\n    //\n    return 1 / gammafn(a + b) * gammafn(a) * gammafn(b);\n  } else {\n    let val: number = lbeta(a, b);\n    // underflow to 0 is not harmful per se;  exp(-999) also gives no warning\n    //#ifndef IEEE_754\n    if (val < lnsml) {\n      // a and/or b so big that beta underflows\n      ML_ERROR(ME.ME_UNDERFLOW, 'beta', printer_beta);\n      // return ML_UNDERFLOW; pointless giving incorrect value\n    }\n    //#endif\n    return Math.exp(val);\n  }\n\n}\n","\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n/**\n * Colors.\n */\n\nexports.colors = ['#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC', '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF', '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC', '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF', '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC', '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033', '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366', '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933', '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC', '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF', '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'];\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n// eslint-disable-next-line complexity\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n    return true;\n  } // Internet Explorer and Edge do not support colors.\n\n\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  } // Is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\n\n  return typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || // Is firebug? http://stackoverflow.com/a/398120/376773\n  typeof window !== 'undefined' && window.console && (window.console.firebug || window.console.exception && window.console.table) || // Is firefox >= v31?\n  // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31 || // Double check webkit in userAgent just in case we are in a worker\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/);\n}\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\n\nfunction formatArgs(args) {\n  args[0] = (this.useColors ? '%c' : '') + this.namespace + (this.useColors ? ' %c' : ' ') + args[0] + (this.useColors ? '%c ' : ' ') + '+' + module.exports.humanize(this.diff);\n\n  if (!this.useColors) {\n    return;\n  }\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit'); // The final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function (match) {\n    if (match === '%%') {\n      return;\n    }\n\n    index++;\n\n    if (match === '%c') {\n      // We only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n  args.splice(lastC, 0, c);\n}\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\n\nfunction log() {\n  var _console;\n\n  // This hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return (typeof console === \"undefined\" ? \"undefined\" : _typeof(console)) === 'object' && console.log && (_console = console).log.apply(_console, arguments);\n}\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\n\nfunction save(namespaces) {\n  try {\n    if (namespaces) {\n      exports.storage.setItem('debug', namespaces);\n    } else {\n      exports.storage.removeItem('debug');\n    }\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\n\nfunction load() {\n  var r;\n\n  try {\n    r = exports.storage.getItem('debug');\n  } catch (error) {} // Swallow\n  // XXX (@Qix-) should we be logging these?\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\n\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\n\nfunction localstorage() {\n  try {\n    // TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n    // The Browser also has localStorage in the global context.\n    return localStorage;\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n\nmodule.exports = require('./common')(exports);\nvar formatters = module.exports.formatters;\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n  try {\n    return JSON.stringify(v);\n  } catch (error) {\n    return '[UnexpectedJSONParseError]: ' + error.message;\n  }\n};\n\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\-?\\d?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\"use strict\";\n\n/**\n * Module dependencies.\n */\nvar tty = require('tty');\n\nvar util = require('util');\n/**\n * This is the Node.js implementation of `debug()`.\n */\n\n\nexports.init = init;\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\n/**\n * Colors.\n */\n\nexports.colors = [6, 2, 3, 4, 5, 1];\n\ntry {\n  // Optional dependency (as in, doesn't need to be installed, NOT like optionalDependencies in package.json)\n  // eslint-disable-next-line import/no-extraneous-dependencies\n  var supportsColor = require('supports-color');\n\n  if (supportsColor && (supportsColor.stderr || supportsColor).level >= 2) {\n    exports.colors = [20, 21, 26, 27, 32, 33, 38, 39, 40, 41, 42, 43, 44, 45, 56, 57, 62, 63, 68, 69, 74, 75, 76, 77, 78, 79, 80, 81, 92, 93, 98, 99, 112, 113, 128, 129, 134, 135, 148, 149, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 178, 179, 184, 185, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 214, 215, 220, 221];\n  }\n} catch (error) {} // Swallow - we only care if `supports-color` is available; it doesn't have to be.\n\n/**\n * Build up the default `inspectOpts` object from the environment variables.\n *\n *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js\n */\n\n\nexports.inspectOpts = Object.keys(process.env).filter(function (key) {\n  return /^debug_/i.test(key);\n}).reduce(function (obj, key) {\n  // Camel-case\n  var prop = key.substring(6).toLowerCase().replace(/_([a-z])/g, function (_, k) {\n    return k.toUpperCase();\n  }); // Coerce string value into JS value\n\n  var val = process.env[key];\n\n  if (/^(yes|on|true|enabled)$/i.test(val)) {\n    val = true;\n  } else if (/^(no|off|false|disabled)$/i.test(val)) {\n    val = false;\n  } else if (val === 'null') {\n    val = null;\n  } else {\n    val = Number(val);\n  }\n\n  obj[prop] = val;\n  return obj;\n}, {});\n/**\n * Is stdout a TTY? Colored output is enabled when `true`.\n */\n\nfunction useColors() {\n  return 'colors' in exports.inspectOpts ? Boolean(exports.inspectOpts.colors) : tty.isatty(process.stderr.fd);\n}\n/**\n * Adds ANSI color escape codes if enabled.\n *\n * @api public\n */\n\n\nfunction formatArgs(args) {\n  var name = this.namespace,\n      useColors = this.useColors;\n\n  if (useColors) {\n    var c = this.color;\n    var colorCode = \"\\x1B[3\" + (c < 8 ? c : '8;5;' + c);\n    var prefix = \"  \".concat(colorCode, \";1m\").concat(name, \" \\x1B[0m\");\n    args[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n    args.push(colorCode + 'm+' + module.exports.humanize(this.diff) + \"\\x1B[0m\");\n  } else {\n    args[0] = getDate() + name + ' ' + args[0];\n  }\n}\n\nfunction getDate() {\n  if (exports.inspectOpts.hideDate) {\n    return '';\n  }\n\n  return new Date().toISOString() + ' ';\n}\n/**\n * Invokes `util.format()` with the specified arguments and writes to stderr.\n */\n\n\nfunction log() {\n  return process.stderr.write(util.format.apply(util, arguments) + '\\n');\n}\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\n\nfunction save(namespaces) {\n  if (namespaces) {\n    process.env.DEBUG = namespaces;\n  } else {\n    // If you set a process.env field to null or undefined, it gets cast to the\n    // string 'null' or 'undefined'. Just delete instead.\n    delete process.env.DEBUG;\n  }\n}\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\n\nfunction load() {\n  return process.env.DEBUG;\n}\n/**\n * Init logic for `debug` instances.\n *\n * Create a new `inspectOpts` object in case `useColors` is set\n * differently for a particular `debug` instance.\n */\n\n\nfunction init(debug) {\n  debug.inspectOpts = {};\n  var keys = Object.keys(exports.inspectOpts);\n\n  for (var i = 0; i < keys.length; i++) {\n    debug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];\n  }\n}\n\nmodule.exports = require('./common')(exports);\nvar formatters = module.exports.formatters;\n/**\n * Map %o to `util.inspect()`, all on a single line.\n */\n\nformatters.o = function (v) {\n  this.inspectOpts.colors = this.useColors;\n  return util.inspect(v, this.inspectOpts).replace(/\\s*\\n\\s*/g, ' ');\n};\n/**\n * Map %O to `util.inspect()`, allowing multiple lines if needed.\n */\n\n\nformatters.O = function (v) {\n  this.inspectOpts.colors = this.useColors;\n  return util.inspect(v, this.inspectOpts);\n};\n\n","module.exports = require(\"tty\");","module.exports = require(\"util\");","module.exports = require(\"supports-color\");","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { NumberW } from './NumberW';\n\nconst { trunc, log, abs, min, pow } = Math;\nconst printer_bratio = debug('Toms708.bratio');\n/**\n * Computes the incomplete beta function\n * <p>\n * This translation was made with the aid of the Fortran-to-Java (f2j) system,\n * developed at the University of Tennessee.\n *<p>\n * @author Armido Didonato, Alfred Morris (F77 version)\n * @author John V. Burkhardt\n * @author James Curran (j.curran@auckland.ac.nz) (Java version)\n * @author Jacob Bogers (jkfbogers@gmai.com) Javascript version\n *\n */\n\nexport class Toms708 {\n  /**\n   * Computes the incomplete beta function\n   * <p>\n   * This translation was made with the aid of the Fortran-to-Java (f2j) system,\n   * developed at the University of Tennessee.\n   *<p>\n   * @author Armido Didonato, Alfred Morris (F77 version)\n   * @author John V. Burkhardt\n   * @author James Curran (j.curran@auckland.ac.nz) (Java version)\n   * @author Jacob Bogers (jkfbogers@gmail.com) Javascript version\n   *\n   */\n\n  public static alnrel(a: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc ALNREL evaluates the function LN(1 + A).\n    // c\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const p3 = -0.178874546012214e-1;\n    const p2 = 0.405303492862024;\n    const p1 = -0.129418923021993e1;\n    const q3 = -0.845104217945565e-1;\n    const q2 = 0.747811014037616;\n    const q1 = -0.162752256355323e1;\n    //\n\n    let t = 0.0;\n    let w = 0.0;\n    let x = 0.0;\n    let t2 = 0.0;\n    if (Math.abs(a) > 0.375) {\n      x = 1 + a;\n      return log(x);\n    }\n    t = a / (a + 2.0);\n    t2 = t * t;\n    w =\n      (((p3 * t2 + p2) * t2 + p1) * t2 + 1.0) /\n      (((q3 * t2 + q2) * t2 + q1) * t2 + 1.0);\n    return 2.0 * t * w;\n    //\n  }\n\n  public static algdiv(a: number, b: number) {\n    //\n    // c*********************************************************************72\n    // C\n    // cc ALGDIV computes LN(GAMMA(B)/GAMMA(A+B)) when 8 <= B.\n    // C\n    // C\n    // C     IN THIS ALGORITHM, DEL(X) IS THE FUNCTION DEFINED BY\n    // C     LN(GAMMA(X))  = (X - 0.5)*LN(X) - X + 0.5*LN(2*PI) + DEL(X).\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const c5 = -0.165322962780713e-2;\n    const c4 = 0.837308034031215e-3;\n    const c3 = -0.59520293135187e-3;\n    const c2 = 0.79365066682539e-3;\n    const c1 = -0.277777777760991e-2;\n    const c0 = 0.833333333333333e-1;\n    //\n\n    let s11 = 0.0;\n    let c = 0.0;\n    let d = 0.0;\n    let h = 0.0;\n    let t = 0.0;\n    let u = 0.0;\n    let v = 0.0;\n    let w = 0.0;\n    let x = 0.0;\n    let s3 = 0.0;\n    let s5 = 0.0;\n    let s7 = 0.0;\n    let x2 = 0.0;\n    let s9 = 0.0;\n\n    if (a <= b) {\n      h = a / b;\n      c = h / (1.0 + h);\n      x = 1.0 / (1.0 + h);\n      d = b + (a - 0.5);\n    } else {\n      h = b / a;\n      c = 1.0 / (1.0 + h);\n      x = h / (1.0 + h);\n      d = a + (b - 0.5);\n    }\n\n    // C\n    // C  SET SN  = (1 - X**N)/(1 - X)\n    // C\n    x2 = x * x;\n    s3 = 1.0 + x + x2;\n    s5 = 1.0 + x + x2 * s3;\n    s7 = 1.0 + x + x2 * s5;\n    s9 = 1.0 + x + x2 * s7;\n    s11 = 1.0 + x + x2 * s9;\n    // C\n    // C  SET W  = DEL(B) - DEL(A + B)\n    // C\n    t = Math.pow(1.0 / b, 2);\n    w =\n      ((((c5 * s11 * t + c4 * s9) * t + c3 * s7) * t + c2 * s5) * t + c1 * s3) *\n      t +\n      c0;\n    w *= c / b;\n    // C\n    // C  Combine the results\n    // c\n    u = d * Toms708.alnrel(a / b);\n    v = a * (log(b) - 1.0);\n\n    if (u <= v) return w - u - v;\n\n    return w - v - u;\n  }\n\n  public static apser(a: number, b: number, x: number, eps: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc APSER evaluates I(1-X)(B,A) for A very small.\n    // c\n    // C     APSER YIELDS THE INCOMPLETE BETA RATIO I(SUB(1-X))(B,A) FOR\n    // C     A <= MIN(EPS,EPS*B), B*X <= 1, AND X <= 0.5. USED WHEN\n    // C     A IS VERY SMALL. USE ONLY IF ABOVE INEQUALITIES ARE SATISFIED.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const g = 0.577215664901533;\n    //\n\n    let j = 0.0;\n    let bx = 0.0;\n    let c = 0.0;\n    let s = 0.0;\n    let t = 0.0;\n    let tol = 0.0;\n    let aj = 0.0;\n    bx = b * x;\n    t = x - bx;\n\n    if (b * eps > 2e-2) {\n      c = log(bx) + g + t;\n    } else {\n      c = log(x) + Toms708.psi(b) + g + t;\n    }\n\n    tol = 5.0 * eps * Math.abs(c);\n    j = 1.0;\n    s = 0.0;\n\n    do {\n      j++;\n      t *= x - bx / j;\n      aj = t / j;\n      s += aj;\n    } while (Math.abs(aj) > tol);\n    //\n    return -(a * (c + s));\n  }\n\n  public static basym(\n    a: number,\n    b: number,\n    lambda: number,\n    eps: number\n  ): number {\n    /*c*********************************************************************72\n    c\n    cc BASYM performs an asymptotic expansion for IX(A,B) for large A and B.\n    c\n    C     LAMBDA  = (A + B)*Y - B  AND EPS IS THE TOLERANCE USED.\n    C     IT IS ASSUMED THAT LAMBDA IS NONNEGATIVE AND THAT\n    C     A AND B ARE GREATER THAN OR EQUAL TO 15.\n    C\n    c  Reference:\n    c\n    c    Armido Didonato, Alfred Morris,\n    c    Algorithm 708: \n    c    Significant Digit Computation of the Incomplete Beta Function Ratios,\n    c    ACM Transactions on Mathematical Software,\n    c    Volume 18, Number 3, 1992, pages 360-373.\n    c*/\n    //double J0, J1, LAMBDA;\n\n    let a0 = new Array<number>(21).fill(0);\n    let b0 = new Array<number>(21).fill(0);\n    let c = new Array<number>(21).fill(0);\n    let d = new Array<number>(21).fill(0);\n\n    // C\n    // C  NUM IS THE MAXIMUM VALUE THAT N CAN TAKE IN THE DO LOOP\n    // C  ENDING AT ST<<<<ATEMENT 50. IT IS REQUIRED THAT NUM BE EVEN.\n    // C  THE ARRAYS A0, B0, C, D HAVE DIMENSION NUM + 1.\n    // C\n    let num = 20;\n    // C\n    // C  E0  = 2/SQRT(PI)\n    // C  E1  = 2**(-3/2)\n    // C\n    const e0 = 1.12837916709551;\n    const e1 = 0.353553390593274;\n\n    let h;\n    let r0;\n    let r1;\n    let w0;\n\n    if (a <= b) {\n      h = a / b;\n      r0 = 1.0 / (1.0 + h);\n      r1 = (b - a) / b;\n      w0 = 1.0 / Math.sqrt(a * (1.0 + h));\n    } else {\n      h = b / a;\n      r0 = 1.0 / (1.0 + h);\n      r1 = (b - a) / a;\n      w0 = 1.0 / Math.sqrt(b * (1.0 + h));\n    }\n\n    let f = a * Toms708.rlog1(-lambda / a) + b * Toms708.rlog1(lambda / b);\n    let t = Math.exp(-f);\n    if (t === 0.0) return 0;\n\n    let z0 = Math.sqrt(f);\n    let z = 0.5 * (z0 / e1);\n    let z2 = f + f;\n\n    a0[0] = 2.0 / 3.0 * r1;\n    c[0] = -0.5 * a0[0];\n    d[0] = -c[0];\n    let j0 = 0.5 / e0 * Toms708.erfc1(1, z0);\n    let j1 = e1;\n    let sum = j0 + d[0] * w0 * j1;\n\n    let s = 1.0;\n    let h2 = h * h;\n    let hn = 1.0;\n    let w = w0;\n    let znm1 = z;\n    let zn = z2;\n\n    for (let n = 2; n <= num; n += 2) {\n      hn = h2 * hn;\n      a0[n] = 2.0 * r0 * (1.0 + h * hn) / (n + 2.0);\n      let np1 = n + 1;\n      s = s + hn;\n      a0[np1] = 2.0 * r1 * s / (n + 3.0);\n\n      for (let i = n; i <= np1; i++) {\n        let r = -0.5 * (i + 1.0);\n        b0[1] = r * a0[1];\n\n        for (let m = 2; m <= i; m++) {\n          let bsum = 0.0;\n          let mm1 = m - 1;\n\n          for (let j = 1; j <= mm1; j++) {\n            let mmj = m - j;\n            bsum = bsum + (j * r - mmj) * a0[j] * b0[mmj];\n          }\n\n          b0[m] = r * a0[m] + bsum / m;\n        }\n\n        c[i] = b0[i] / (i + 1.0);\n\n        let dsum = 0.0;\n        let im1 = i - 1;\n\n        for (let j = 1; j <= im1; j++) {\n          let imj = i - j;\n          dsum = dsum + d[imj] * c[j];\n        }\n\n        d[i] = -(dsum + c[i]);\n      }\n\n      j0 = e1 * znm1 + (n - 1.0) * j0;\n      j1 = e1 * zn + n * j1;\n      znm1 = z2 * znm1;\n      zn = z2 * zn;\n      w = w0 * w;\n      let t0 = d[n] * w * j0;\n      w = w0 * w;\n      let t1 = d[np1] * w * j1;\n      sum = sum + (t0 + t1);\n      if (Math.abs(t0) + Math.abs(t1) <= eps * sum) break;\n    }\n\n    let u = Math.exp(-Toms708.bcorr(a, b));\n    return e0 * t * u * sum;\n  }\n\n  public static bcorr(a0: number, b0: number): number {\n    //\n    // c*********************************************************************72\n    // C\n    // cc BCORR evaluates a correction term for LN(GAMMA(A)).\n    // c\n    // C     EVALUATION OF  DEL(A0) + DEL(B0) - DEL(A0 + B0)  WHERE\n    // C     LN(GAMMA(A)) = (A - 0.5)*LN(A) - A + 0.5*LN(2*PI) + DEL(A).\n    // C     IT IS ASSUMED THAT A0 .GE. 8 AND B0 .GE. 8.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const c5 = -0.165322962780713e-2;\n    const c4 = 0.837308034031215e-3;\n    const c3 = -0.59520293135187e-3;\n    const c2 = 0.79365066682539e-3;\n    const c1 = -0.277777777760991e-2;\n    const c0 = 0.833333333333333e-1;\n    //\n\n    let s11 = 0.0;\n    let a = 0.0;\n    let b = 0.0;\n    let c = 0.0;\n    let h = 0.0;\n    let t = 0.0;\n    let w = 0.0;\n    let x = 0.0;\n    let s3 = 0.0;\n    let s5 = 0.0;\n    let s7 = 0.0;\n    let x2 = 0.0;\n    let s9 = 0.0;\n\n    a = Math.min(a0, b0);\n    b = Math.max(a0, b0);\n\n    //\n    h = a / b;\n    c = h / (1.0 + h);\n    x = 1.0 / (1.0 + h);\n    x2 = x * x;\n\n    // C\n    // C  SET SN = (1 - X**N)/(1 - X)\n    // C\n    s3 = 1.0 + (x + x2);\n    s5 = 1.0 + (x + x2 * s3);\n    s7 = 1.0 + (x + x2 * s5);\n    s9 = 1.0 + (x + x2 * s7);\n    s11 = 1.0 + (x + x2 * s9);\n\n    // C\n    // C  SET W = DEL(B) - DEL(A + B)\n    // C\n    t = Math.pow(1.0 / b, 2);\n    w =\n      ((((c5 * s11 * t + c4 * s9) * t + c3 * s7) * t + c2 * s5) * t + c1 * s3) *\n      t +\n      c0;\n    w = w * (c / b);\n\n    // C\n    // C  COMPUTE  DEL(A) + W\n    // C\n    t = Math.pow(1.0 / a, 2);\n    return (((((c5 * t + c4) * t + c3) * t + c2) * t + c1) * t + c0) / a + w;\n    //\n  }\n\n  public static beta_cdf_values(\n    nData: NumberW,\n    a: NumberW,\n    b: NumberW,\n    x: NumberW,\n    fx: NumberW\n  ): void {\n    // C*********************************************************************72\n    // C\n    // Cc BETA_CDF_VALUES returns some values of the Beta  // CDF.\n    // C\n    // C  Discussion:\n    // C\n    // C    The incomplete Beta function may be written\n    // C\n    // C      BETA_INC(A,B,X) = Integral (0 to X) T**(A-1) * (1-T)**(B-1) dT\n    // C                      / Integral (0 to 1) T**(A-1) * (1-T)**(B-1) dT\n    // C\n    // C    Thus,\n    // C\n    // C      BETA_INC(A,B,0.0) = 0.0\n    // C      BETA_INC(A,B,1.0) = 1.0\n    // C\n    // C    The incomplete Beta function is also sometimes  // Called the\n    // C    \"modified\" Beta function, or the \"normalized\" Beta function\n    // C    or the Beta  // CDF (cumulative density function.\n    // C\n    // C    In Mathematica, the function  // Can be evaluated by:\n    // C\n    // C      BETA[X,A,B] / BETA[A,B]\n    // C\n    // C    The function  // Can also be evaluated by using the Statistics package:\n    // C\n    // C      Needs[\"Statistics`ContinuousDistributions`\"]\n    // C      dist = BetaDistribution [ a, b ]\n    // C       // CDF [ dist, x ]\n    // C\n    // C  Modified:\n    // C\n    // C    04 January 2006\n    // C\n    // C  Author:\n    // C\n    // C    John Burkardt\n    // C\n    // C  Reference:\n    // C\n    // C    Milton Abramowitz and Irene Stegun,\n    // C    Handbook of Mathematical Functions,\n    // C    US Department of  // Commerce, 1964.\n    // C\n    // C    Karl Pearson,\n    // C    Tables of the Incomplete Beta Function,\n    // C     // Cambridge University Press, 1968.\n    // C\n    // C    Stephen Wolfram,\n    // C    The Mathematica Book,\n    // C    Fourth Edition,\n    // C    Wolfram Media /  // Cambridge University Press, 1999.\n    // C\n    // C  Parameters:\n    // C\n    // C    Input/output, integer N_DATA.  The user sets N_DATA to 0 before the\n    // C    first  // Call.  On each  // Call, the routine increments N_DATA by 1, and\n    // C    returns the  // Corresponding data; when there is no more data, the\n    // C    output value of N_DATA will be 0 again.\n    // C\n    // C    Output, real A, B, the parameters of the function.\n    // C\n    // C    Output, real X, the argument of the function.\n    // C\n    // C    Output, real FX, the value of the function.\n    // C\n    // C      implicit none\n\n    const nMax = 42;\n\n    const aVec = [\n      0.5,\n      0.5,\n      0.5,\n      1.0,\n      1.0,\n      1.0,\n      1.0,\n      1.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      5.5,\n      10.0,\n      10.0,\n      10.0,\n      10.0,\n      20.0,\n      20.0,\n      20.0,\n      20.0,\n      20.0,\n      30.0,\n      30.0,\n      40.0,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.2e1,\n      0.3e1,\n      0.4e1,\n      0.5e1\n    ];\n\n    const bVec = [\n      0.5,\n      0.5,\n      0.5,\n      0.5,\n      0.5,\n      0.5,\n      0.5,\n      1.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      2.0,\n      5.0,\n      0.5,\n      5.0,\n      5.0,\n      10.0,\n      5.0,\n      10.0,\n      10.0,\n      20.0,\n      20.0,\n      10.0,\n      10.0,\n      20.0,\n      0.5,\n      0.5,\n      0.5,\n      0.5,\n      0.2e1,\n      0.3e1,\n      0.4e1,\n      0.5e1,\n      0.2e1,\n      0.2e1,\n      0.2e1,\n      0.2e1\n    ];\n\n    const fxVec = [\n      0.6376856085851985e-1,\n      0.2048327646991335,\n      0.1e1,\n      0.0,\n      0.5012562893380045e-2,\n      0.513167019494862e-1,\n      0.2928932188134525,\n      0.5,\n      0.28e-1,\n      0.104,\n      0.216,\n      0.352,\n      0.5,\n      0.648,\n      0.784,\n      0.896,\n      0.972,\n      0.4361908850559777,\n      0.1516409096347099,\n      0.8978271484375e-1,\n      0.1e1,\n      0.5,\n      0.4598773297575791,\n      0.2146816102371739,\n      0.9507364826957875,\n      0.5,\n      0.8979413687105918,\n      0.2241297491808366,\n      0.7586405487192086,\n      0.7001783247477069,\n      0.513167019494862e-1,\n      0.1055728090000841,\n      0.1633399734659245,\n      0.2254033307585166,\n      0.36,\n      0.488,\n      0.5904,\n      0.67232,\n      0.216,\n      0.837e-1,\n      0.3078e-1,\n      0.10935e-1\n    ];\n\n    const xVec = [\n      0.01,\n      0.1,\n      1.0,\n      0.0,\n      0.01,\n      0.1,\n      0.5,\n      0.5,\n      0.1,\n      0.2,\n      0.3,\n      0.4,\n      0.5,\n      0.6,\n      0.7,\n      0.8,\n      0.9,\n      0.5,\n      0.9,\n      0.5,\n      1.0,\n      0.5,\n      0.8,\n      0.6,\n      0.8,\n      0.5,\n      0.6,\n      0.7,\n      0.8,\n      0.7,\n      0.1,\n      0.2,\n      0.3,\n      0.4,\n      0.2,\n      0.2,\n      0.2,\n      0.2,\n      0.3,\n      0.3,\n      0.3,\n      0.3\n    ];\n\n    if (nData.val < 0) nData.val = 0;\n\n    nData.val++;\n\n    if (nData.val > nMax) {\n      nData.val = 0;\n\n      a.val = b.val = x.val = fx.val = 0.0;\n    } else {\n      a.val = aVec[nData.val - 1];\n      b.val = bVec[nData.val - 1];\n      x.val = xVec[nData.val - 1];\n      fx.val = fxVec[nData.val - 1];\n    }\n  }\n\n  public static betaln(a0: number, b0: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc BETALN evaluates the logarithm of the Beta function.\n    // C\n    // C     E = 0.5*LN(2*PI)\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const e = 0.918938533204673;\n\n    let a = 0.0;\n    let b = 0.0;\n    let c = 0.0;\n    let h = 0.0;\n    let i = 0;\n    let n = 0;\n    let u = 0.0;\n    let v = 0.0;\n    let w = 0.0;\n    let z = 0.0;\n\n    a = Math.min(a0, b0);\n    b = Math.max(a0, b0);\n\n    if (a < 1) {\n      // C\n      // C  PROCEDURE WHEN A .LT. 1\n      // C\n      if (b < 8.0) return Toms708.gamln(a) + Toms708.algdiv(a, b);\n      else return Toms708.gamln(a) + Toms708.gamln(b) - Toms708.gamln(a + b);\n    } else if (a >= 1 && a < 8) {\n      // C\n      // C  PROCEDURE WHEN 1 <= A .LT. 8\n      // C\n      if (a < 2 && b < 2) {\n        return Toms708.gamln(a) + Toms708.gamln(b) - Toms708.gsumln(a, b);\n      } else if (b > 2) {\n        w = 0.0;\n        if (b < 8.0) {\n          // C\n          // C  REDUCTION OF B WHEN B .LT. 8\n          // C\n          n = trunc(b - 1.0);\n          z = 1.0;\n\n          for (i = 1; i <= n; i++) {\n            b--;\n            z *= b / (a + b);\n          }\n\n          return (\n            w +\n            log(z) +\n            (Toms708.gamln(a) + Toms708.gamln(b) - Toms708.gsumln(a, b))\n          );\n        } else return Toms708.gamln(a) + Toms708.algdiv(a, b);\n      } else if (a > 2) {\n        if (b > 1000.0) {\n          // C\n          // C  REDUCTION OF A WHEN B .GT. 1000\n          // C\n          n = trunc(a - 1.0);\n          w = 1.0;\n\n          for (i = 1; i <= n; i++) {\n            a--;\n            w = w * (a / (1.0 + a / b));\n          }\n\n          return (\n            log(w) - n * log(b) + (Toms708.gamln(a) + Toms708.algdiv(a, b))\n          );\n        }\n\n        // C\n        // C  REDUCTION OF A WHEN B <= 1000\n        // C\n\n        n = trunc(a - 1.0);\n        w = 1.0;\n\n        for (i = 1; i <= n; i++) {\n          a--;\n          h = a / b;\n          w *= h / (1.0 + h);\n        }\n\n        w = log(w);\n        if (b < 8.0) {\n          // C\n          // C  REDUCTION OF B WHEN B .LT. 8\n          // C\n          n = trunc(b - 1.0);\n          z = 1.0;\n\n          for (i = 1; i <= n; i++) {\n            b--;\n            z *= b / (a + b);\n          }\n\n          return (\n            w +\n            log(z) +\n            (Toms708.gamln(a) + Toms708.gamln(b) - Toms708.gsumln(a, b))\n          );\n        } else return w + Toms708.gamln(a) + Toms708.algdiv(a, b);\n      }\n    } //else\n    // C\n    // C  PROCEDURE WHEN A .GE. 8\n    // C\n    w = Toms708.bcorr(a, b);\n    h = a / b;\n    c = h / (1.0 + h);\n    u = -((a - 0.5) * log(c));\n    v = b * Toms708.alnrel(h);\n\n    if (u > v) return -0.5 * log(b) + e + w - u - v;\n    else return -0.5 * log(b) + e + w - v - u;\n  }\n\n  public static bfrac(\n    a: number,\n    b: number,\n    x: number,\n    y: number,\n    lambda: number,\n    eps: number\n  ) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc BFRAC: continued fraction expansion for IX(A,B) when A and B are grea\n    // c\n    // C     IT IS ASSUMED THAT  LAMBDA = (A + B)*Y - B.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n\n    let n = 0.0;\n    let yp1 = 0.0;\n    let alpha = 0.0;\n    let c = 0.0;\n    let e = 0.0;\n    let p = 0.0;\n    let r = 0.0;\n    let s = 0.0;\n    let t = 0.0;\n    let w = 0.0;\n    let c0 = 0.0;\n    let c1 = 0.0;\n    let anp1 = 0.0;\n    let bnp1 = 0.0;\n    let r0 = 0.0;\n    let beta = 0.0;\n    let an = 0.0;\n    let bn = 0.0;\n\n    let dResult = Toms708.brcomp(a, b, x, y);\n\n    if (dResult === 0.0) return 0;\n    //\n    c = 1.0 + lambda;\n    c0 = b / a;\n    c1 = 1.0 + 1.0 / a;\n    yp1 = y + 1.0;\n    //\n    n = 0.0;\n    p = 1.0;\n    s = a + 1.0;\n    an = 0.0;\n    bn = 1.0;\n    anp1 = 1.0;\n    bnp1 = c / c1;\n    r = c1 / c;\n\n    // C\n    // C  CONTINUED FRACTION CALCULATION\n    // C\n\n    while (true) {\n      n++;\n      t = n / a;\n      w = n * (b - n) * x;\n      e = a / s;\n      alpha = p * (p + c0) * e * e * (w * x);\n      e = (1.0 + t) / (c1 + t + t);\n      beta = n + w / s + e * (c + n * yp1);\n      p = 1.0 + t;\n      s = s + 2.0;\n      // C\n      // C  UPDATE AN, BN, ANP1, AND BNP1\n      // C\n      t = alpha * an + beta * anp1;\n      an = anp1;\n      anp1 = t;\n      t = alpha * bn + beta * bnp1;\n      bn = bnp1;\n      bnp1 = t;\n      //\n      r0 = r;\n      r = anp1 / bnp1;\n      if (Math.abs(r - r0) <= eps * r) break;\n\n      // C\n      // C  RESCALE AN, BN, ANP1, AND BNP1\n      // C\n      an = an / bnp1;\n      bn = bn / bnp1;\n      anp1 = r;\n      bnp1 = 1.0;\n    }\n    // C\n    // C  Termination\n    // c\n    dResult *= r;\n\n    return dResult;\n  }\n\n  public static bgrat(\n    a: number,\n    b: number,\n    x: number,\n    y: number,\n    w: NumberW,\n    eps: number,\n    ierr: NumberW\n  ) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc BGRAT uses asymptotic expansion for IX(A,B) when B < A.\n    // c\n    // C     ASYMPTOTIC EXPANSION FOR IX(A,B) WHEN A IS LARGER THAN B.\n    // C     THE RESULT OF THE EXPANSION IS ADDED TO W. IT IS ASSUMED\n    // C     THAT A .GE. 15 AND B <= 1.  EPS IS THE TOLERANCE USED.\n    // C     IERR IS A VARIABLE THAT REPORTS THE STATUS OF THE RESULTS.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n\n    let j = 0.0;\n    let l = 0.0;\n    let lnx = 0.0;\n    let nu = 0.0;\n    let n2 = 0.0;\n    let c = new Array<number>(30);\n    let d = new Array<number>(30);\n    let bm1 = 0.0;\n    let nm1 = 0;\n    let i = 0;\n    let n = 0;\n    //double p = 0.0;\n    let q = 0.0;\n    let r = 0.0;\n    let s = 0.0;\n    let t = 0.0;\n    let u = 0.0;\n    let v = 0.0;\n    let z = 0.0;\n    let sum = 0.0;\n    let bp2n = 0.0;\n    let t2 = 0.0;\n    let coef = 0.0;\n    let dj = 0.0;\n    let cn = 0.0;\n\n    bm1 = b - 0.5 - 0.5;\n    nu = a + 0.5 * bm1;\n\n    if (y <= 0.375) {\n      lnx = Toms708.alnrel(-y);\n    } else {\n      lnx = log(x);\n    }\n\n    z = -(nu * lnx);\n\n    if (b * z !== 0.0) {\n      // C\n      // C  COMPUTATION OF THE EXPANSION\n      // C  SET R = EXP(-Z)*Z**B/GAMMA(B)\n      // C\n      r = b * (1.0 + Toms708.gam1(b)) * Math.exp(b * log(z));\n      r *= Math.exp(a * lnx) * Math.exp(0.5 * bm1 * lnx);\n      u = Toms708.algdiv(b, a) + b * log(nu);\n      u = r * Math.exp(-u);\n\n      if (u === 0.0) {\n        ierr.val = 1;\n        return;\n      }\n\n      let p1 = new NumberW(0);\n      let q1 = new NumberW(0);\n      Toms708.grat1(b, z, r, p1, q1, eps);\n\n      // p = p1.val; // not necessary since p is never used\n      q = q1.val;\n      //\n      v = 0.25 * Math.pow(1.0 / nu, 2);\n      t2 = 0.25 * lnx * lnx;\n      l = w.val / u;\n      j = q / r;\n      sum = j;\n      t = 1.0;\n      cn = 1.0;\n      n2 = 0.0;\n\n      for (n = 1; n <= 30; n++) {\n        bp2n = b + n2;\n        j = (bp2n * (bp2n + 1.0) * j + (z + bp2n + 1.0) * t) * v;\n        n2 = n2 + 2.0;\n        t *= t2;\n        cn /= n2 * (n2 + 1.0);\n        c[n - 1] = cn;\n        s = 0.0;\n\n        if (n !== 1) {\n          nm1 = n - 1;\n          coef = b - n;\n          for (i = 1; i <= nm1; i++) {\n            s += coef * c[i - 1] * d[n - i - 1];\n            coef += b;\n          }\n        }\n\n        d[n - 1] = bm1 * cn + s / n;\n        dj = d[n - 1] * j;\n        sum += dj;\n\n        if (sum <= 0.0) {\n          ierr.val = 1;\n          return;\n        }\n\n        if (Math.abs(dj) <= eps * (sum + l)) {\n          break;\n        }\n      }\n      // C\n      // C  ADD THE RESULTS TO W\n      // C\n\n      ierr.val = 0;\n      w.val += u * sum;\n      return;\n    } else {\n      // C\n      // C  The expansion cannot be computed\n      // c\n      ierr.val = 1;\n      return;\n    }\n  }\n\n  public static brcomp(a: number, b: number, x: number, y: number) {\n    // C*********************************************************************72\n    // C\n    // Cc BRCOMP evaluates X**A*Y**B/BETA(A,B).\n    // C\n    // C  Reference:\n    // C\n    // C    Armido Didonato, Alfred Morris,\n    // C    Algorithm 708:\n    // C    Significant Digit // Computation of the Incomplete Beta Function Ratios,\n    // C    ACM Transactions on Mathematical Software,\n    // C    Volume 18, Number 3, 1992, pages 360-373.\n    // C\n    // C\n    // C  // CONST = 1/SQRT(2*PI)\n    // C\n    const Const = 0.398942280401433;\n\n    if (x === 0.0 || y === 0.0) return 0;\n\n    let b0;\n    let a0 = Math.min(a, b);\n    let lnx;\n    let lny;\n    let c;\n\n    if (a0 < 8.0) {\n      if (x <= 0.375) {\n        lnx = log(x);\n        lny = Toms708.alnrel(-x);\n      } else {\n        if (y <= 0.375) {\n          lnx = Toms708.alnrel(-y);\n          lny = log(y);\n        } else {\n          lnx = log(x);\n          lny = log(y);\n        }\n\n        let z = a * lnx + b * lny;\n\n        if (a0 >= 1.0) {\n          z -= Toms708.betaln(a, b);\n          return Math.exp(z);\n        }\n        // C;\n        // C  procedure for a < 1 or b < 1\n        // C\n        b0 = Math.max(a, b);\n\n        if (b0 < 8.0) {\n          if (b0 <= 1.0) {\n            // C\n            // C  algorithm for b0 <= 1\n            // C\n            let dResult = Math.exp(z);\n            if (dResult === 0.0) return 0;\n\n            let apb = a + b;\n            if (apb <= 1.0) {\n              z = 1.0 + Toms708.gam1(apb);\n            } else {\n              let u = a + b - 1.0;\n              z = (1.0 + Toms708.gam1(u)) / apb;\n            }\n            c = (1.0 + Toms708.gam1(a)) * (1.0 + Toms708.gam1(b)) / z;\n            dResult *= a0 * c / (1.0 + a0 / b0);\n            return dResult;\n          }\n        } else {\n          let u = Toms708.gamln1(a0);\n          let n = b0 - 1.0;\n          if (n >= 1) {\n            c = 1.0;\n            for (let i = 1; i <= n; i++) {\n              b0--;\n              c *= b0 / (a0 + b0);\n            }\n            u = log(c) + u;\n          }\n          z -= u;\n          b0--;\n          let apb = a0 + b0;\n          let t;\n\n          if (apb <= 1.0) {\n            t = 1.0 + Toms708.gam1(apb);\n          } else {\n            u = a0 + b0 - 1.0;\n            t = (1.0 + Toms708.gam1(u)) / apb;\n          }\n          return a0 * Math.exp(z) * (1.0 + Toms708.gam1(b0)) / t;\n        }\n        // C\n        // C  algorithm for b0 >= 8\n        // C\n        let u = Toms708.gamln1(a0) + Toms708.algdiv(a0, b0);\n        return a0 * Math.exp(z - u);\n      }\n    }\n    // C\n    // C  procedure for a >= 8 and b >= 8\n    // C\n    let x0;\n    let y0;\n    let lambda;\n    let e;\n    let h;\n    let u;\n    let v;\n    if (a <= b) {\n      h = a / b;\n      x0 = h / (1.0 + h);\n      y0 = 1.0 / (1.0 + h);\n      lambda = a - (a + b) * x;\n    } else {\n      h = b / a;\n      x0 = 1.0 / (1.0 + h);\n      y0 = h / (1.0 + h);\n      lambda = (a + b) * y - b;\n    }\n    e = -lambda / a;\n    if (Math.abs(e) <= 0.6) {\n      u = Toms708.rlog1(e);\n    } else {\n      u = e - log(x / x0);\n    }\n\n    e = lambda / b;\n\n    if (Math.abs(e) > 0.6) {\n      v = Toms708.rlog1(e);\n    } else {\n      v = e - log(y / y0);\n    }\n\n    let z = Math.exp(-(a * u + b * v));\n    return Const * Math.sqrt(b * x0) * z * Math.exp(-Toms708.bcorr(a, b));\n  }\n\n  public static brcmp1(mu: number, a: number, b: number, x: number, y: number) {\n    // C*********************************************************************\n    // C\n    // C BRCMP1 evaluates EXP(MU) * (X**A*Y**B/BETA(A,B)).\n    // C\n    // C  Reference:\n    // C\n    // C    Armido Didonato, Alfred Morris,\n    // C    Algorithm 708:\n    // C    Significant Digit Computation of the Incomplete Beta Function Ratios,\n    // C    ACM Transactions on Mathematical Software,\n    // C    Volume 18, Number 3, 1992, pages 360-373.\n    // C\n\n    // C  const = 1/sqrt(2*pi)\n    // C\n    const invSqrtPi = 0.398942280401433;\n    let c;\n    let u;\n    let apb;\n\n    let a0 = Math.min(a, b);\n\n    if (a0 < 8.0) {\n      let lnx;\n      let lny;\n\n      if (x <= 0.375) {\n        lnx = log(x);\n        lny = Toms708.alnrel(-x);\n      } else {\n        if (y <= 0.375) {\n          lnx = Toms708.alnrel(-y);\n          lny = log(y);\n        } else {\n          lnx = log(x);\n          lny = log(y);\n        }\n      }\n\n      let z = a * lnx + b * lny;\n      if (a0 <= 1.0) {\n        z -= Toms708.betaln(a, b);\n        return Toms708.esum(mu, z);\n      }\n      // C\n      // C  procedure for a < 1 or b < 1\n      // C\n      let b0 = Math.max(a, b);\n      if (b0 >= 8.0) {\n        u = Toms708.gamln1(a0) + Toms708.algdiv(a0, b0);\n        return a0 * Toms708.esum(mu, z - u);\n      }\n\n      if (b0 <= 1.0) {\n        // C\n        // C  algorithm for b0 <= 1\n        // C\n        let dResult = Toms708.esum(mu, z);\n\n        if (dResult === 0.0) return 0;\n\n        apb = a + b;\n\n        if (apb <= 1.0) {\n          z = 1.0 + Toms708.gam1(apb);\n        } else {\n          u = a + b - 1.0;\n          z = (1.0 + Toms708.gam1(u)) / apb;\n        }\n\n        c = (1.0 + Toms708.gam1(a)) * (1.0 + Toms708.gam1(b)) / z;\n        dResult *= a0 * c / (1.0 + a0 / b0);\n        return dResult;\n      }\n      // C\n      // C  algorithm for 1 < b0 < 8\n      // C\n\n      u = Toms708.gamln1(a0);\n      let n = trunc(b0 - 1.0);\n\n      if (n >= 1) {\n        c = 1.0;\n        for (let i = 1; i <= n; i++) {\n          b0 -= 1.0;\n          c = c * (b0 / (a0 + b0));\n        }\n        u = log(c) + u;\n      }\n\n      z -= u;\n      b0 -= 1.0;\n      apb = a0 + b0;\n      let t;\n\n      if (apb <= 1.0) {\n        t = 1.0 + Toms708.gam1(apb);\n      } else {\n        u = a0 + b0 - 1.0;\n        t = (1.0 + Toms708.gam1(u)) / apb;\n      }\n      return a0 * Toms708.esum(mu, z) * (1.0 + Toms708.gam1(b0)) / t;\n    }\n    // C\n    // C  procedure for a= 8 and b >= 8\n    // C\n\n    let h;\n    let x0;\n    let y0;\n    let lambda;\n\n    if (a <= b) {\n      h = a / b;\n      x0 = h / (1.0 + h);\n      y0 = 1.0 / (1.0 + h);\n      lambda = a - (a + b) * x;\n    } else {\n      h = b / a;\n      x0 = 1.0 / (1.0 + h);\n      y0 = h / (1.0 + h);\n      lambda = (a + b) * y - b;\n    }\n\n    let e = -lambda / a;\n\n    if (Math.abs(e) <= 0.6) {\n      u = Toms708.rlog1(e);\n    } else {\n      u = e - log(x / x0);\n    }\n\n    e = lambda / b;\n    let v;\n\n    if (Math.abs(e) <= 0.6) {\n      v = Toms708.rlog1(e);\n    } else {\n      v = e - log(y / y0);\n    }\n\n    let z = Toms708.esum(mu, -(a * u + b * v));\n    return invSqrtPi * Math.sqrt(b * x0) * z * Math.exp(-Toms708.bcorr(a, b));\n  }\n\n  public static bpser(a: number, b: number, x: number, eps: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc BPSER evaluates IX(A,B) when B <= 1 or B*X <= 0.7.\n    // c\n    // C     POWER SERIES EXPANSION FOR EVALUATING IX(A,B) WHEN B <= 1\n    // C     OR B*X <= 0.7.  EPS IS THE TOLERANCE USED.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n\n    let n = 0.0;\n    let apb = 0.0;\n    let c = 0.0;\n    let i = 0;\n    let m = 0;\n    let t = 0.0;\n    let u = 0.0;\n    let w = 0.0;\n    let z = 0.0;\n    let tol = 0.0;\n    let sum = 0.0;\n    let a0 = 0.0;\n    let b0 = 0.0;\n    let dResult = 0;\n\n    if (x === 0.0) {\n      return 0;\n    }\n    // C\n    // C  COMPUTE THE FACTOR X**A/(A*BETA(A,B))\n    // C\n    a0 = Math.min(a, b);\n    if (a0 >= 1.0) {\n      z = a * log(x) - Toms708.betaln(a, b);\n      dResult = Math.exp(z) / a;\n    } else {\n      b0 = Math.max(a, b);\n      if (b0 < 8.0) {\n        if (b0 <= 1.0) {\n          // C\n          // C  PROCEDURE FOR A0 .LT. 1 AND B0 <= 1\n          // C\n          dResult = Math.pow(x, a);\n          if (dResult === 0.0) {\n            return 0;\n          }\n          //\n          apb = a + b;\n          if (apb <= 1.0) {\n            z = 1.0 + Toms708.gam1(apb);\n          } else {\n            u = a + b - 1.0;\n            z = (1.0 + Toms708.gam1(u)) / apb;\n          } //\n          c = (1.0 + Toms708.gam1(a)) * (1.0 + Toms708.gam1(b)) / z;\n          dResult *= c * (b / apb);\n        } else {\n          // C\n          // C  PROCEDURE FOR A0 .LT. 1 AND 1 .LT. B0 .LT. 8\n          // C\n          //label40:\n          //\tDummy.label(\"Bpser\",40);\n          u = Toms708.gamln1(a0);\n          m = trunc(b0 - 1.0);\n\n          if (m >= 1) {\n            c = 1.0;\n            for (i = 1; i <= m; i++) {\n              b0--;\n              c *= b0 / (a0 + b0);\n            }\n            u = log(c) + u;\n          }\n\n          z = a * log(x) - u;\n          b0--;\n          apb = a0 + b0;\n\n          if (apb <= 1.0) {\n            t = 1.0 + Toms708.gam1(apb);\n          } else {\n            u = a0 + b0 - 1.0;\n            t = (1.0 + Toms708.gam1(u)) / apb;\n          }\n          dResult = Math.exp(z) * (a0 / a) * (1.0 + Toms708.gam1(b0)) / t;\n        }\n      } else {\n        // b0>8\n        // C\n        // C  PROCEDURE FOR A0 .LT. 1 AND B0 .GE. 8\n        // C\n        u = Toms708.gamln1(a0) + Toms708.algdiv(a0, b0);\n        z = a * log(x) - u;\n        dResult = a0 / a * Math.exp(z);\n      }\n    }\n    if (dResult === 0.0 || a <= 0.1 * eps) {\n      return dResult;\n    }\n    // C\n    // C  Compute the series\n    // c\n    sum = 0.0;\n    n = 0.0;\n    c = 1.0;\n    tol = eps / a;\n\n    do {\n      n++;\n      c *= (0.5 + (0.5 - b / n)) * x;\n      w = c / (a + n);\n      sum += w;\n    } while (Math.abs(w) > tol);\n\n    dResult *= 1.0 + a * sum;\n    return dResult;\n  }\n\n\n\n  public static bratio(\n    a: number,\n    b: number,\n    x: number,\n    y: number,\n    w: NumberW,\n    w1: NumberW,\n    ierr: NumberW\n  ) {\n    //\n    // c*********************************************************************72\n    // C\n    // cc BRATIO evaluates the incomplete Beta function IX(A,B).\n    // c\n    // c  Discussion:\n    // c\n    // C     IT IS ASSUMED THAT A AND B ARE NONNEGATIVE, AND THAT X <= 1\n    // C     AND Y = 1 - X.  BRATIO ASSIGNS W AND W1 THE VALUES\n    // C\n    // C                      W  = IX(A,B)\n    // C                      W1 = 1 - IX(A,B)\n    // C\n    // C     IERR IS A VARIABLE THAT REPORTS THE STATUS OF THE RESULTS.\n    // C     IF NO INPUT ERRORS ARE DETECTED THEN IERR IS SET TO 0 AND\n    // C     W AND W1 ARE COMPUTED. OTHERWISE, IF AN ERROR IS DETECTED,\n    // C     THEN W AND W1 ARE ASSIGNED THE VALUE 0 AND IERR IS SET TO\n    // C     ONE OF THE FOLLOWING VALUES ...\n    // C\n    // C        IERR = 1  IF A OR B IS NEGATIVE\n    // C        IERR = 2  IF A = B = 0\n    // C        IERR = 3  IF X .LT. 0 OR X .GT. 1\n    // C        IERR = 4  IF Y .LT. 0 OR Y .GT. 1\n    // C        IERR = 5  IF X + Y .NE. 1\n    // C        IERR = 6  IF X = A = 0\n    // C        IERR = 7  IF Y = B = 0\n    // C\n    // C     WRITTEN BY ALFRED H. MORRIS, JR.\n    // C        NAVAL SURFACE WARFARE CENTER\n    // C        DAHLGREN, VIRGINIA\n    // C     REVISED ... NOV 1991\n    // c\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    // c\n    // C  EPS IS A MACHINE DEPENDENT CONSTANT. EPS IS THE SMALLEST\n    // C  FLOATING POINT NUMBER FOR WHICH 1.0 + EPS .GT. 1.0\n    // C\n\n    let lambda = 0.0;\n    let ind = 0;\n    let n = 0;\n    let t = 0.0;\n    let eps = 0.0;\n    let z = 0.0;\n    let a0 = 0.0;\n    let b0 = 0.0;\n    let x0 = 0.0;\n    let y0 = 0.0;\n    eps = Toms708.spmpar(1);\n    printer_bratio('eps is: %d', eps);\n    w.val = 0.0;\n    w1.val = 0.0;\n\n    if (a < 0.0 || b < 0.0) {\n      ierr.val = 1;\n      return;\n    }\n\n    if (a === 0.0 && b === 0.0) {\n      ierr.val = 2;\n      return;\n    }\n\n    if (x < 0.0 || x > 1.0) {\n      ierr.val = 3;\n      return;\n    }\n\n    if (y < 0.0 || y > 1.0) {\n      ierr.val = 4;\n      return;\n    }\n\n    z = x + y - 0.5 - 0.5;\n    if (abs(z) > 3.0 * eps) {\n      ierr.val = 5;\n      return;\n    }\n\n    //\n    ierr.val = 0;\n    if (x === 0.0) {\n      if (a === 0.0) {\n        ierr.val = 6;\n        return;\n      } else {\n        w.val = 0.0;\n        w1.val = 1.0;\n        return;\n      }\n    }\n\n    if (y === 0.0) {\n      if (b === 0.0) {\n        ierr.val = 7;\n        return;\n      } else {\n        w.val = 1.0;\n        w1.val = 0.0;\n        return;\n      }\n    }\n\n    if (a === 0.0) {\n      w.val = 1.0;\n      w1.val = 0.0;\n      return;\n    }\n\n    if (b === 0.0) {\n      w.val = 0.0;\n      w1.val = 1.0;\n      return;\n    }\n\n    //\n    eps = Math.max(eps, 1e-15);\n    if (Math.max(a, b) < 1.0e-3 * eps) {\n      w.val = b / (a + b);\n      w1.val = a / (a + b);\n      return;\n    }\n    //\n    ind = 0;\n    a0 = a;\n    b0 = b;\n    x0 = x;\n    y0 = y;\n\n    if (min(a0, b0) <= 1.0) {\n      // C\n      // C  PROCEDURE FOR A0 <= 1 OR B0 <= 1\n      // C\n      if (x <= 0.5) {\n        ind = 1;\n        a0 = b;\n        b0 = a;\n        x0 = y;\n        y0 = x;\n      }\n      //\n\n      if (b0 < min(eps, eps * a0)) {\n        w.val = Toms708.fpser(a0, b0, x0, eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n      if (a0 < min(eps, eps * b0) && b0 * x0 <= 1.0) {\n        w1.val = Toms708.apser(a0, b0, x0, eps);\n        w.val = 0.5 + (0.5 - w1.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      if (Math.max(a0, b0) <= 1.0) {\n        if (a0 >= Math.min(0.2, b0) || Math.pow(x0, a0) <= 0.9) {\n          w.val = Toms708.bpser(a0, b0, x0, eps);\n          w1.val = 0.5 + (0.5 - w.val);\n\n          if (ind === 0) {\n            return;\n          } else {\n            t = w.val;\n            w.val = w1.val;\n            w1.val = t;\n            return;\n          }\n        }\n\n        if (x0 >= 0.3) {\n          w1.val = Toms708.bpser(b0, a0, y0, eps);\n          w.val = 0.5 + (0.5 - w1.val);\n\n          if (ind === 0) {\n            return;\n          } else {\n            t = w.val;\n            w.val = w1.val;\n            w1.val = t;\n            return;\n          }\n        }\n\n        n = 20;\n        w1.val = Toms708.bup(b0, a0, y0, x0, n, eps);\n        b0 += n;\n\n        let ierr1 = new NumberW(0);\n\n        Toms708.bgrat(b0, a0, y0, x0, w1, 15.0 * eps, ierr1);\n        w.val = 0.5 + (0.5 - w1.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n\n        //\n      }\n\n      if (b0 <= 1.0) {\n        w.val = Toms708.bpser(a0, b0, x0, eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      if (x0 >= 0.3) {\n        w1.val = Toms708.bpser(b0, a0, y0, eps);\n        w.val = 0.5 + (0.5 - w1.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      if (x0 < 0.1) {\n        if (pow(x0 * b0, a0) <= 0.7) {\n          w.val = Toms708.bpser(a0, b0, x0, eps);\n          w1.val = 0.5 + (0.5 - w.val);\n\n          if (ind === 0) {\n            return;\n          } else {\n            t = w.val;\n            w.val = w1.val;\n            w1.val = t;\n            return;\n          }\n        }\n      }\n\n      if (b0 > 15.0) {\n        let ierr1 = new NumberW(0);\n\n        Toms708.bgrat(b0, a0, y0, x0, w1, 15.0 * eps, ierr1);\n        w.val = 0.5 + (0.5 - w1.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      n = 20;\n      w1.val = Toms708.bup(b0, a0, y0, x0, n, eps);\n      b0 += n;\n\n      let ierr1 = new NumberW(0);\n\n      Toms708.bgrat(b0, a0, y0, x0, w1, 15.0 * eps, ierr1);\n      w.val = 0.5 + (0.5 - w1.val);\n\n      if (ind === 0) {\n        return;\n      } else {\n        t = w.val;\n        w.val = w1.val;\n        w1.val = t;\n        return;\n      }\n    }\n\n    // C\n    // C  PROCEDURE FOR A0 .GT. 1 AND B0 .GT. 1\n    // C\n\n    if (a <= b) {\n      lambda = a - (a + b) * x;\n    } else {\n      lambda = (a + b) * y - b;\n    }\n\n    if (lambda < 0.0) {\n      ind = 1;\n      a0 = b;\n      b0 = a;\n      x0 = y;\n      y0 = x;\n      lambda = abs(lambda);\n    }\n\n    if (b0 < 40.0 && b0 * x0 <= 0.7) {\n      w.val = Toms708.bpser(a0, b0, x0, eps);\n      w1.val = 0.5 + (0.5 - w.val);\n\n      if (ind === 0) {\n        return;\n      } else {\n        t = w.val;\n        w.val = w1.val;\n        w1.val = t;\n        return;\n      }\n    }\n\n    if (b0 < 40.0) {\n      n = Math.trunc(b0);\n      b0 -= n;\n\n      if (b0 === 0.0) {\n        n--;\n        b0 = 1.0;\n      }\n\n      w.val = Toms708.bup(b0, a0, y0, x0, n, eps);\n\n      if (x0 <= 0.7) {\n        w.val += Toms708.bpser(a0, b0, x0, eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n      if (a0 <= 15.0) {\n        n = 20;\n        w.val += Toms708.bup(a0, b0, x0, y0, n, eps);\n        a0 += n;\n      }\n\n      let ierr1 = new NumberW(0);\n\n      Toms708.bgrat(a0, b0, x0, y0, w, 15.0 * eps, ierr1);\n      w1.val = 0.5 + (0.5 - w.val);\n\n      if (ind === 0) {\n        return;\n      } else {\n        t = w.val;\n        w.val = w1.val;\n        w1.val = t;\n        return;\n      }\n    }\n\n    if (a0 <= b0) {\n      if (a0 <= 100.0) {\n        w.val = Toms708.bfrac(a0, b0, x0, y0, lambda, 15.0 * eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      if (lambda > 0.03 * a0) {\n        w.val = Toms708.bfrac(a0, b0, x0, y0, lambda, 15.0 * eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      w.val = Toms708.basym(a0, b0, lambda, 100.0 * eps);\n      w1.val = 0.5 + (0.5 - w.val);\n\n      if (ind === 0) {\n        return;\n      } else {\n        t = w.val;\n        w.val = w1.val;\n        w1.val = t;\n        return;\n      }\n    } else {\n      if (b0 <= 100.0 || lambda > 0.03 * b0) {\n        w.val = Toms708.bfrac(a0, b0, x0, y0, lambda, 15.0 * eps);\n        w1.val = 0.5 + (0.5 - w.val);\n\n        if (ind === 0) {\n          return;\n        } else {\n          t = w.val;\n          w.val = w1.val;\n          w1.val = t;\n          return;\n        }\n      }\n\n      w.val = Toms708.basym(a0, b0, lambda, 100.0 * eps);\n      w1.val = 0.5 + (0.5 - w.val);\n\n      if (ind === 0) {\n        return;\n      } else {\n        t = w.val;\n        w.val = w1.val;\n        w1.val = t;\n        return;\n      }\n    }\n  }\n\n  static bup(\n    a: number,\n    b: number,\n    x: number,\n    y: number,\n    n: number,\n    eps: number\n  ) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc BUP evaluates IX(A,B) - IX(A + N,B), where N is a positive integer.\n    // c\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360 - 373.\n    // c\n    // C     EPS IS THE TOLERANCE USED.\n    // C\n    // C\n    // C  OBTAIN THE SCALING FACTOR EXP(-MU) AND EXP(MU)*(X**A*Y**B/BETA(A,B))/\n    // C\n\n    let dResult;\n\n    let mu = 0;\n    let d = 1.0;\n    let t = 0;\n    let r = 0;\n    let w = 0;\n\n    let k;\n    let l;\n    let apb = a + b;\n    let ap1 = a + 1.0;\n\n    if (n !== 1 && a > 1.0) {\n      if (apb >= 1.1 * ap1) {\n        mu = trunc(Math.abs(Toms708.exparg(1)));\n        k = trunc(Toms708.exparg(0));\n\n        if (k < mu) {\n          mu = k;\n        }\n\n        t = mu;\n        d = Math.exp(-t);\n      }\n    }\n\n    dResult = Toms708.brcmp1(mu, a, b, x, y) / a;\n\n    if (n === 1 || dResult === 0.0) {\n      return dResult;\n    }\n\n    let nm1 = n - 1;\n    w = d;\n\n    // C\n    // C  LET K BE THE INDEX OF THE MAXIMUM TERM\n    // C\n\n    k = 0;\n    if (b <= 1.0) {\n      let kp1 = k + 1;\n\n      for (let i = kp1; i <= nm1; i++) {\n        l = i - 1;\n        d = (apb + l) / (ap1 + l) * x * d;\n        w += d;\n\n        if (d <= eps * w) break;\n      }\n\n      return dResult * w;\n    }\n\n    if (y > 1.0e-4) {\n      r = (b - 1.0) * x / y - a;\n\n      if (r < 1.0) {\n        let kp1 = k + 1;\n\n        for (let i = kp1; i <= nm1; i++) {\n          l = i - 1;\n          d = (apb + l) / (ap1 + l) * x * d;\n          w += d;\n\n          if (d <= eps * w) break;\n        }\n\n        return dResult * w;\n      }\n      k = nm1;\n      t = nm1;\n\n      if (r < t) {\n        k = trunc(r);\n      }\n    } else {\n      k = nm1;\n    }\n\n    // C\n    // C  ADD THE INCREASING TERMS OF THE SERIES\n    // C\n    for (let i = 1; i <= k; i++) {\n      l = i - 1;\n      d = (apb + l) / (ap1 + l) * x * d;\n      w += d;\n    }\n\n    if (k === nm1) {\n      return dResult * w;\n    }\n\n    // C\n    // C  ADD THE REMAINING TERMS OF THE SERIES\n    // C\n\n    let kp1 = k + 1;\n\n    for (let i = kp1; i <= nm1; i++) {\n      l = i - 1;\n      d = (apb + l) / (ap1 + l) * x * d;\n      w += d;\n\n      if (d <= eps * w) break;\n    }\n\n    return dResult * w;\n  }\n\n  public static erf(x: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc ERF evaluates the error function.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    //\n    const c = 0.564189583547756;\n    //\n    const a = [\n      0.77105849500132e-4,\n      -0.133733772997339e-2,\n      0.323076579225834e-1,\n      0.479137145607681e-1,\n      0.128379167095513\n    ];\n\n    const b = [0.301048631703895e-2, 0.538971687740286e-1, 0.375795757275549]; //\n\n    const p = [\n      -1.36864857382717e-7,\n      5.64195517478974e-1,\n      7.21175825088309,\n      4.31622272220567e1,\n      1.5298928504694e2,\n      3.39320816734344e2,\n      4.51918953711873e2,\n      3.00459261020162e2\n    ];\n\n    const q = [\n      1.0,\n      1.27827273196294e1,\n      7.70001529352295e1,\n      2.77585444743988e2,\n      6.38980264465631e2,\n      9.3135409485061e2,\n      7.90950925327898e2,\n      3.00459260956983e2\n    ]; //\n\n    const r = [\n      2.10144126479064,\n      2.62370141675169e1,\n      2.13688200555087e1,\n      4.6580782871847,\n      2.82094791773523e-1\n    ];\n\n    const s = [\n      9.4153775055546e1,\n      1.8711481179959e2,\n      9.90191814623914e1,\n      1.80124575948747e1\n    ]; //\n\n    let ax = 0.0;\n    let bot = 0.0;\n    let t = 0.0;\n    let top = 0.0;\n    let x2 = 0.0;\n\n    ax = Math.abs(x);\n    if (ax <= 0.5) {\n      t = x * x;\n      top = (((a[0] * t + a[1]) * t + a[2]) * t + a[3]) * t + a[4] + 1.0;\n      bot = ((b[0] * t + b[1]) * t + b[2]) * t + 1.0;\n      return x * (top / bot);\n      //\n    } else {\n      if (ax <= 4.0) {\n        top =\n          ((((((p[0] * ax + p[1]) * ax + p[2]) * ax + p[3]) * ax + p[4]) * ax +\n            p[5]) *\n            ax +\n            p[6]) *\n          ax +\n          p[7];\n        bot =\n          ((((((q[0] * ax + q[1]) * ax + q[2]) * ax + q[3]) * ax + q[4]) * ax +\n            q[5]) *\n            ax +\n            q[6]) *\n          ax +\n          q[7];\n\n        return x < 0\n          ? -(0.5 + (0.5 - Math.exp(-x * x) * top / bot))\n          : 0.5 + (0.5 - Math.exp(-x * x) * top / bot);\n      } else {\n        if (ax < 5.8) {\n          x2 = x * x;\n          t = 1.0 / x2;\n          top = (((r[0] * t + r[1]) * t + r[2]) * t + r[3]) * t + r[4];\n          bot = (((s[0] * t + s[2]) * t + s[3]) * t + s[3]) * t + 1.0;\n          let dResult = (c - top / (x2 * bot)) / ax;\n          dResult = 0.5 + (0.5 - Math.exp(-x2) * dResult);\n\n          return x < 0 ? -dResult : dResult;\n        } else {\n          return Toms708.sign(1.0, x);\n        }\n      }\n    }\n  }\n\n  public static erfc1(ind: number, x: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc ERFC1 evaluates the complementary error function.\n    // C\n    // C          ERFC1(IND,X) = ERFC(X)            IF IND = 0\n    // C          ERFC1(IND,X) = EXP(X*X)*ERFC(X)   OTHERWISE\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    //\n    const c = 0.564189583547756;\n    //\n    const a = [\n      0.77105849500132e-4,\n      -0.133733772997339e-2,\n      0.323076579225834e-1,\n      0.479137145607681e-1,\n      0.128379167095513\n    ];\n\n    const b = [0.301048631703895e-2, 0.538971687740286e-1, 0.375795757275549];\n\n    const p = [\n      -1.36864857382717e-7,\n      5.64195517478974e-1,\n      7.21175825088309,\n      4.31622272220567e1,\n      1.5298928504694e2,\n      3.39320816734344e2,\n      4.51918953711873e2,\n      3.00459261020162e2\n    ];\n\n    const q = [\n      1.0,\n      1.27827273196294e1,\n      7.70001529352295e1,\n      2.77585444743988e2,\n      6.38980264465631e2,\n      9.3135409485061e2,\n      7.90950925327898e2,\n      3.00459260956983e2\n    ];\n    //\n    const r = [\n      2.10144126479064,\n      2.62370141675169e1,\n      2.13688200555087e1,\n      4.6580782871847,\n      2.82094791773523e-1\n    ];\n\n    const s = [\n      9.4153775055546e1,\n      1.8711481179959e2,\n      9.90191814623914e1,\n      1.80124575948747e1\n    ];\n\n    // C\n    // C  ABS(X) <= 0.5\n    // C\n\n    let dResult = 0.0;\n    let w = 0.0;\n    let ax = 0.0;\n    let e = 0.0;\n    let bot = 0.0;\n    let t = 0.0;\n    let top = 0.0;\n    ax = Math.abs(x);\n\n    if (ax < 0.5) {\n      t = x * x;\n      top = (((a[0] * t + a[1]) * t + a[2]) * t + a[3]) * t + a[4] + 1.0;\n      bot = ((b[0] * t + b[1]) * t + b[2]) * t + 1.0;\n      dResult = 0.5 + (0.5 - x * (top / bot));\n\n      if (ind !== 0) dResult *= Math.exp(t);\n\n      return dResult;\n    } else if (ax <= 4 && ax >= 0.5) {\n      // I don't think the and is necessary - being safe JMC\n      // C\n      // C  0.5 .LT. ABS(X) <= 4\n      // C\n      top =\n        ((((((p[0] * ax + p[1]) * ax + p[2]) * ax + p[3]) * ax + p[4]) * ax +\n          p[5]) *\n          ax +\n          p[6]) *\n        ax +\n        p[7];\n      bot =\n        ((((((q[0] * ax + q[2]) * ax + q[2]) * ax + q[3]) * ax + q[5]) * ax +\n          q[5]) *\n          ax +\n          q[6]) *\n        ax +\n        q[7];\n      dResult = top / bot;\n    } else {\n      // C\n      // C  ABS(X) .GT. 4\n      // C\n      if (x <= -5.6) {\n        // C\n        // C  LIMIT VALUE FOR LARGE NEGATIVE X\n        // C\n        if (ind !== 0) return 2.0 * Math.exp(x * x);\n        else return 2.0;\n      }\n\n      if (ind !== 0) {\n        t = Math.pow(1.0 / x, 2);\n        top = (((r[0] * t + r[1]) * t + r[2]) * t + r[3]) * t + r[4];\n        bot = (((s[0] * t + s[2]) * t + s[3]) * t + s[3]) * t + 1.0;\n        dResult = (c - t * top / bot) / ax;\n      } else {\n        if (x > 100.0 || x * x > -Toms708.exparg(1)) {\n          // C\n          // C  LIMIT VALUE FOR LARGE POSITIVE X WHEN IND = 0\n          // C\n          return 0;\n        }\n      }\n    }\n\n    // C\n    // C  FINAL ASSEMBLY\n    // C\n    if (ind !== 0) {\n      if (x < 0.0) dResult = 2.0 * Math.exp(x * x) - dResult;\n      return dResult;\n    }\n\n    w = x * x;\n    t = w;\n    e = w - t;\n    dResult *= (0.5 + (0.5 - e)) * Math.exp(-t);\n\n    if (x < 0.0) dResult = 2.0 - dResult;\n\n    return dResult;\n  }\n\n  public static esum(mu: number, x: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc ESUM evaluates EXP(MU + X).\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360 - 373.\n    // c\n    //\n    let w = 0.0;\n\n    if (x <= 0.0) {\n      if (mu < 0) {\n        w = mu;\n        return Math.exp(w) * Math.exp(x);\n      }\n\n      w = mu + x;\n\n      if (w > 0.0) {\n        w = mu;\n        return Math.exp(w) * Math.exp(x);\n      }\n      return Math.exp(w);\n    }\n\n    if (mu > 0) {\n      w = mu;\n      return Math.exp(w) * Math.exp(x);\n    }\n\n    w = mu + x;\n    if (w < 0.0) {\n      w = mu;\n      return Math.exp(w) * Math.exp(x);\n    }\n\n    return Math.exp(w);\n  }\n\n  public static erf_values(nData: NumberW, x: NumberW, fx: NumberW): void {\n    // C*********************************************************************72\n    // C\n    // C ERF_VALUES returns some values of the ERF or \"error\" function for testing.\n    // C\n    // CModified:\n    // C\n    // C17 April 2001\n    // C\n    // CAuthor:\n    // C\n    // CJohn Burkardt\n    // C\n    // CParameters:\n    // C\n    // CInput/output, integer N_DATA.\n    // COn input, if N_DATA is 0, the first test data is returned, and\n    // CN_DATA is set to the index of the test data.  On each subsequent\n    // Call, N_DATA is incremented and that test data is returned.  When\n    // Cthere is no more test data, N_DATA is set to 0.\n    // C\n    // COutput, real X, the argument of the function.\n    // C\n    // COutput, real FX, the value of the function.\n    // C\n    //\n\n    const nmax = 21;\n\n    const bvec = [\n      0.0,\n      0.112462916,\n      0.2227025892,\n      0.3286267595,\n      0.428392355,\n      0.5204998778,\n      0.6038560908,\n      0.6778011938,\n      0.7421009647,\n      0.7969082124,\n      0.8427007929,\n      0.8802050696,\n      0.9103139782,\n      0.9340079449,\n      0.9522851198,\n      0.9661051465,\n      0.9763483833,\n      0.9837904586,\n      0.9890905016,\n      0.9927904292,\n      0.995322265\n    ];\n\n    let xvec = [\n      0.0,\n      0.1,\n      0.2,\n      0.3,\n      0.4,\n      0.5,\n      0.6,\n      0.7,\n      0.8,\n      0.9,\n      1.0,\n      1.1,\n      1.2,\n      1.3,\n      1.4,\n      1.5,\n      1.6,\n      1.7,\n      1.8,\n      1.9,\n      2.0\n    ];\n\n    if (nData.val < 0) nData.val = 0;\n\n    nData.val++;\n\n    if (nmax < nData.val) {\n      nData.val = 0;\n      x.val = 0.0;\n      fx.val = 0.0;\n    } else {\n      x.val = xvec[nData.val - 1];\n      fx.val = bvec[nData.val - 1];\n    }\n  }\n\n  public static exparg(l: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc EXPARG returns the largest value for which EXP can be computed.\n    // c\n    // C     IF L = 0 THEN  EXPARG(L) = THE LARGEST POSITIVE W FOR WHICH\n    // C     EXP(W) CAN BE COMPUTED.\n    // C\n    // C     IF L IS NONZERO THEN  EXPARG(L) = THE LARGEST NEGATIVE W FOR\n    // C     WHICH THE COMPUTED VALUE OF EXP(W) IS NONZERO.\n    // C\n    // C     NOTE... ONLY AN APPROXIMATE VALUE FOR EXPARG(L) IS NEEDED.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n\n    let lnb = 0.0;\n    let m = 0;\n    let b = Toms708.ipmpar(4);\n\n    switch (b) {\n      case 2:\n        lnb = 0.69314718055995;\n        break;\n      case 8:\n        lnb = 2.0794415416798;\n        break;\n      case 16:\n        lnb = 2.7725887222398;\n        break;\n      default:\n        lnb = log(b);\n        break;\n    }\n    //\n\n    if (l !== 0) {\n      m = Toms708.ipmpar(6);\n      return 0.99999 * m * lnb;\n    } else {\n      m = Toms708.ipmpar(7);\n      return 0.99999 * m * lnb;\n    }\n  }\n\n  public static fpser(a: number, b: number, x: number, eps: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc FPSER uses a series for IX(A,B) with B < min(eps,eps*A) and X <= 0.5.\n    // c\n    // c  Discussion:\n    // c\n    // C                 EVALUATION OF IX(A,B)\n    // C\n    // C          FOR B .LT. MIN(EPS,EPS*A) AND X .LE. 0.5.\n    // C\n    // C\n    // C                  SET  FPSER = X**A\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360 - 373.\n    // c\n    //\n\n    let c: number = 0.0;\n    let s: number = 0.0;\n    let t: number = 0.0;\n    let tol: number = 0.0;\n    let an: number = 0.0;\n\n    let dResult = 1.0;\n\n    if (a > 1.0e-3 * eps) {\n      dResult = 0.0;\n      t = a * log(x);\n      if (t < Toms708.exparg(1)) {\n        return dResult;\n      }\n      dResult = Math.exp(t);\n    }\n\n    // C\n    // C  NOTE THAT 1/B(A,B) = B\n    // C\n    dResult = b / a * dResult;\n    tol = eps / a;\n    an = a + 1.0;\n    t = x;\n    s = t / an;\n\n    do {\n      an = an + 1.0;\n      t = x * t;\n      c = t / an;\n      s = s + c;\n    } while (Math.abs(c) > tol);\n    //\n    return dResult * (1.0 + a * s);\n  }\n\n  static gam1(a: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc GAM1 evaluates 1/GAMMA(A+1) - 1  for -0.5 <= A <= 1.5\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n\n    const p = [\n      0.577215664901533,\n      -0.409078193005776,\n      -0.230975380857675,\n      0.597275330452234e-1,\n      0.76696818164949e-2,\n      -0.514889771323592e-2,\n      0.589597428611429e-3\n    ];\n\n    const q = [\n      0.1e1,\n      0.427569613095214,\n      0.158451672430138,\n      0.261132021441447e-1,\n      0.423244297896961e-2\n    ];\n\n    const r = [\n      -0.422784335098468,\n      -0.771330383816272,\n      -0.244757765222226,\n      0.118378989872749,\n      0.930357293360349e-3,\n      -0.118290993445146e-1,\n      0.223047661158249e-2,\n      0.266505979058923e-3,\n      -0.132674909766242e-3\n    ];\n\n    const s2 = 0.559398236957378e-1;\n    const s1 = 0.273076135303957;\n    //\n\n    let d = 0.0;\n    let bot = 0.0;\n    let t = 0.0;\n    let w = 0.0;\n    let top = 0.0;\n\n    t = a;\n    d = a - 0.5;\n    if (d > 0.0) {\n      t = d - 0.5;\n    }\n\n    /*{\n      double _arif_tmp = t;\n      if (_arif_tmp < 0)  \n        Dummy.go_to(\"Gam1\",30);\n      else if (_arif_tmp == 0)  \n        Dummy.go_to(\"Gam1\",10);\n      else   Dummy.go_to(\"Gam1\",20);\n    }*/\n    //\n\n    if (t === 0) {\n      return 0;\n    } else if (t > 0) {\n      top =\n        (((((p[6] * t + p[5]) * t + p[4]) * t + p[3]) * t + p[2]) * t + p[1]) *\n        t +\n        p[0];\n      bot = (((q[4] * t + q[3]) * t + q[2]) * t + q[1]) * t + 1.0;\n      w = top / bot;\n\n      if (d <= 0.0) {\n        return a * w;\n      } else {\n        return t / a * (w - 0.5 - 0.5);\n      }\n    } else {\n      // t < 0\n      top =\n        (((((((r[8] * t + r[7]) * t + r[6]) * t + r[5]) * t + r[4]) * t +\n          r[3]) *\n          t +\n          r[2]) *\n          t +\n          r[1]) *\n        t +\n        r[0];\n      bot = (s2 * t + s1) * t + 1.0;\n      w = top / bot;\n\n      if (d <= 0.0) {\n        return a * (w + 0.5 + 0.5);\n      } else {\n        return t * w / a;\n      }\n    }\n  }\n\n  public static grat1(\n    a: number,\n    x: number,\n    r: number,\n    p: NumberW,\n    q: NumberW,\n    eps: number\n  ) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc GRAT1 evaluates P(A,X) and Q(A,X) when A <= 1.\n    // c\n    // C        EVALUATION OF THE INCOMPLETE GAMMA RATIO FUNCTIONS\n    // C                      P(A,X) AND Q(A,X)\n    // C\n    // C     IT IS ASSUMED THAT A <= 1.  EPS IS THE TOLERANCE TO BE USED.\n    // C     THE INPUT ARGUMENT R HAS THE VALUE E**(-X)*X**A/GAMMA(A).\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n\n    let j = 0.0;\n    let l = 0.0;\n    let am0 = 0.0;\n    let an0 = 0.0;\n    let a2n = 0.0;\n    let b2n = 0.0;\n    let cma = 0.0;\n    let c = 0.0;\n    let g = 0.0;\n    let h = 0.0;\n    let t = 0.0;\n    let w = 0.0;\n    let z = 0.0;\n    let tol = 0.0;\n    let sum = 0.0;\n    let a2nm1 = 0.0;\n    let b2nm1 = 0.0;\n    let an = 0.0;\n\n    if (a * x === 0.0) {\n      if (x <= a) {\n        p.val = 0.0;\n        q.val = 1.0;\n        return;\n      } else {\n        p.val = 1.0;\n        q.val = 0.0;\n        return;\n      }\n    }\n\n    if (a === 0.5) {\n      if (x < 0.25) {\n        p.val = Toms708.erf(Math.sqrt(x));\n        q.val = 0.5 + (0.5 - p.val);\n        return;\n      } else {\n        q.val = Toms708.erfc1(0, Math.sqrt(x));\n        p.val = 0.5 + (0.5 - q.val);\n        return;\n      }\n    }\n\n    if (x < 1.1) {\n      // C\n      // C  TAYLOR SERIES FOR P(A,X)/X**A\n      // C\n      an = 3.0;\n      c = x;\n      sum = x / (a + 3.0);\n      tol = 0.1 * eps / (a + 1.0);\n\n      do {\n        an++;\n        c = -c * (x / an);\n        t = c / (a + an);\n        sum = sum + t;\n      } while (Math.abs(t) > tol);\n\n      j = a * x * ((sum / 6.0 - 0.5 / (a + 2.0)) * x + 1.0 / (a + 1.0));\n      //\n      z = a * log(x);\n      h = Toms708.gam1(a);\n      g = 1.0 + h;\n\n      if (x < 0.25) {\n        if (z > -0.13394) {\n          l = Toms708.rexp(z);\n          w = 0.5 + (0.5 + l);\n          q.val = (w * j - l) * g - h;\n\n          if (q.val < 0.0) {\n            p.val = 1.0;\n            q.val = 0.0;\n            return;\n          }\n\n          p.val = 0.5 + (0.5 - q.val);\n          return;\n        } else {\n          w = Math.exp(z);\n          p.val = w * g * (0.5 + (0.5 - j));\n          q.val = 0.5 + (0.5 - p.val);\n          return;\n        }\n      } else {\n        w = Math.exp(z);\n        p.val = w * g * (0.5 + (0.5 - j));\n        q.val = 0.5 + (0.5 - p.val);\n        return;\n      } //\n    } else {\n      // C\n      // C  CONTINUED FRACTION EXPANSION\n      // C\n\n      a2nm1 = 1.0;\n      a2n = 1.0;\n      b2nm1 = x;\n      b2n = x + (1.0 - a);\n      c = 1.0;\n\n      do {\n        a2nm1 = x * a2n + c * a2nm1;\n        b2nm1 = x * b2n + c * b2nm1;\n        am0 = a2nm1 / b2nm1;\n        c++;\n        cma = c - a;\n        a2n = a2nm1 + cma * a2n;\n        b2n = b2nm1 + cma * b2n;\n        an0 = a2n / b2n;\n      } while (Math.abs(an0 - am0) >= eps * an0);\n\n      q.val = r * an0;\n      p.val = 0.5 + (0.5 - q.val);\n      return;\n    }\n  }\n\n  public static ipmpar(i: number): number {\n    // c*********************************************************************72\n    // C\n    // cc IPMPAR sets integer machine constants.\n    // c\n    // C     IPMPAR PROVIDES THE INTEGER MACHINE CONSTANTS FOR THE COMPUTER\n    // C     THAT IS USED. IT IS ASSUMED THAT THE ARGUMENT I IS AN INTEGER\n    // C     HAVING ONE OF THE VALUES 1-10. IPMPAR(I) HAS THE VALUE ...\n    // C\n    // C  INTEGERS.\n    // C\n    // C     ASSUME INTEGERS ARE REPRESENTED IN THE N-DIGIT, BASE-A FORM\n    // C\n    // C               SIGN ( X(N-1)*A**(N-1) + ... + X(1)*A + X(0) )\n    // C\n    // C               WHERE 0 <= X(I) .LT. A FOR I =0,...,N-1.\n    // C\n    // C     IPMPAR(1)  = A, THE BASE.\n    // C\n    // C     IPMPAR(2)  = N, THE NUMBER OF BASE-A DIGITS.\n    // C\n    // C     IPMPAR(3)  = A**N - 1, THE LARGEST MAGNITUDE.\n    // C\n    // C  FLOATING-POINT NUMBERS.\n    // C\n    // C     IT IS ASSUMED THAT THE SINGLE AND DOUBLE PRECISION doubleING\n    // C     POINT ARITHMETICS HAVE THE SAME BASE, SAY B, AND THAT THE\n    // C     NONZERO NUMBERS ARE REPRESENTED IN THE FORM\n    // C\n    // C               SIGN (B**E) * (X(1)/B + ... + X(M)/B**M)\n    // C\n    // C               WHERE X(I)  = 0,1,...,B-1 FOR I =1,...,M,\n    // C               X(1) .GE. 1, AND EMIN <= E <= EMAX.\n    // C\n    // C     IPMPAR(4)  = B, THE BASE.\n    // C\n    // C  SINGLE-PRECISION\n    // C\n    // C     IPMPAR(5)  = M, THE NUMBER OF BASE-B DIGITS.\n    // C\n    // C     IPMPAR(6)  = EMIN, THE SMALLEST EXPONENT E.\n    // C\n    // C     IPMPAR(7)  = EMAX, THE LARGEST EXPONENT E.\n    // C\n    // C  DOUBLE-PRECISION\n    // C\n    // C     IPMPAR(8)  = M, THE NUMBER OF BASE-B DIGITS.\n    // C\n    // C     IPMPAR(9)  = EMIN, THE SMALLEST EXPONENT E.\n    // C\n    // C     IPMPAR(10)  = EMAX, THE LARGEST EXPONENT E.\n    // C\n    // C\n    // C\n    // C     TO DEFINE THIS FUNCTION FOR THE COMPUTER BEING USED, ACTIVATE\n    // C     THE DATA STATMENTS FOR THE COMPUTER BY REMOVING THE C FROM\n    // C     COLUMN 1. (ALL THE OTHER DATA STATEMENTS SHOULD HAVE C IN\n    // C     COLUMN 1.)\n    // C\n    // C\n    // C\n    // C     IPMPAR IS AN ADAPTATION OF THE FUNCTION I1MACH, WRITTEN BY\n    // C     P.A. FOX, A.D. HALL, AND N.L. SCHRYER (BELL LABORATORIES).\n    // C     IPMPAR WAS FORMED BY A.H. MORRIS (NSWC). THE CONSTANTS ARE\n    // C     FROM BELL LABORATORIES, NSWC, AND OTHER SOURCES.\n    // C\n    const imach = [2, 31, 2147483647, 2, 24, -125, 128, 53, -1021, 1024];\n\n    return imach[i - 1];\n  }\n\n  public static gamma_inc_values(\n    nData: NumberW,\n    a: NumberW,\n    x: NumberW,\n    fx: NumberW\n  ): void {\n    // C *********************************************************************72\n    // C\n    // C  GAMMA_INC_VALUES returns some values of the incomplete Gamma function.\n    // C\n    // C   Discussion:\n    // C\n    // C     The (normalized) incomplete Gamma function P(A,X) is defined as:\n    // C\n    // C       PN(A,X) = 1/Gamma(A) * Integral ( 0 <= T <= X ) T**(A-1) * exp(-T) dT.\n    // C\n    // C     With this definition, for all A and X,\n    // C\n    // C       0 <= PN(A,X) <= 1\n    // C\n    // C     and\n    // C\n    // C       PN(A,INFINITY) = 1.0\n    // C\n    // C     In Mathematica, the function can be evaluated by:\n    // C\n    // C       1 - GammaRegularized[A,X]\n    // C\n    // C   Modified:\n    // C\n    // C     28 August 2004\n    // C\n    // C   Author:\n    // C\n    // C     John Burkardt\n    // C\n    // C   Reference:\n    // C\n    // C     Milton Abramowitz and Irene Stegun,\n    // C     Handbook of Mathematical Functions,\n    // C     US Department of Commerce, 1964.\n    // C\n    // C     Stephen Wolfram,\n    // C     The Mathematica Book,\n    // C     Fourth Edition,\n    // C     Wolfram Media / Cambridge University Press, 1999.\n    // C\n    // C   Parameters:\n    // C\n    // C     Input/output, integer N_DATA.  The user sets N_DATA to 0 before the\n    // C     first call.  On each call, the routine increments N_DATA by 1, and\n    // C     returns the corresponding data; when there is no more data, the\n    // C     output value of N_DATA will be 0 again.\n    // C\n    // C     Output, real ( kind = 4 ) A, the parameter of the function.\n    // C\n    // C     Output, real ( kind = 4 ) X, the argument of the function.\n    // C\n    // C     Output, real ( kind = 4 ) FX, the value of the function.\n    // C\n    let nMax = 20;\n\n    const aVec = [\n      0.1,\n      0.1,\n      0.1,\n      0.5,\n      0.5,\n      0.5,\n      0.1e1,\n      0.1e1,\n      0.1e1,\n      0.11e1,\n      0.11e1,\n      0.11e1,\n      0.2e1,\n      0.2e1,\n      0.2e1,\n      0.6e1,\n      0.6e1,\n      0.11e2,\n      0.26e2,\n      0.41e2\n    ];\n\n    const fxVec = [\n      0.7382350532339351,\n      0.9083579897300343,\n      0.9886559833621947,\n      0.3014646416966613,\n      0.7793286380801532,\n      0.9918490284064973,\n      0.9516258196404043e-1,\n      0.6321205588285577,\n      0.9932620530009145,\n      0.7205974576054322e-1,\n      0.5891809618706485,\n      0.9915368159845525,\n      0.01018582711118352,\n      0.4421745996289254,\n      0.9927049442755639,\n      0.4202103819530612e-1,\n      0.9796589705830716,\n      0.9226039842296429,\n      0.4470785799755852,\n      0.7444549220718699\n    ];\n\n    const xVec = [\n      0.3e-1,\n      0.3,\n      0.15e1,\n      0.75e-1,\n      0.75,\n      0.35e1,\n      0.1,\n      0.1e1,\n      0.5e1,\n      0.1,\n      0.1e1,\n      0.5e1,\n      0.15,\n      0.15e1,\n      0.7e1,\n      0.25e1,\n      0.12e2,\n      0.16e2,\n      0.25e2,\n      0.45e2\n    ];\n\n    if (nData.val < 0) nData.val = 0;\n\n    nData.val++;\n\n    if (nMax < nData.val) {\n      nData.val = 0;\n      a.val = 0.0;\n      x.val = 0.0;\n      fx.val = 0.0;\n    } else {\n      a.val = aVec[nData.val - 1];\n      x.val = xVec[nData.val - 1];\n      fx.val = fxVec[nData.val - 1];\n    }\n  }\n\n  public static gamma_log_values(nData: NumberW, x: NumberW, fx: NumberW) {\n    // C *********************************************************************72\n    // C\n    // C  GAMMA_LOG_VALUES returns some values of the Log Gamma function for testing.\n    // C\n    // C   Modified:\n    // C\n    // C     17 April 2001\n    // C\n    // C   Author:\n    // C\n    // C     John Burkardt\n    // C\n    // C   Reference:\n    // C\n    // C     Milton Abramowitz and Irene Stegun,\n    // C     Handbook of Mathematical Functions,\n    // C     US Department of Commerce, 1964.\n    // C\n    // C   Parameters:\n    // C\n    // C     Input/output, integer N_DATA.\n    // C     On input, if N_DATA is 0, the first test data is returned, and\n    // C     N_DATA is set to the index of the test data.  On each subsequent\n    // C     call, N_DATA is incremented and that test data is returned.  When\n    // C     there is no more test data, N_DATA is set to 0.\n    // C\n    // C     Output, real X, the argument of the function.\n    // C\n    // C     Output, real FX, the value of the function.\n    // C\n    const nmax = 18;\n\n    const bvec = [\n      1.524064183,\n      0.7966780066,\n      0.3982337117,\n      0.1520599127,\n      0.0,\n      -0.04987246543,\n      -0.08537410945,\n      -0.1081747934,\n      -0.119612895,\n      -0.120782204,\n      -0.1125917658,\n      -0.09580771625,\n      -0.07108385116,\n      -0.0389842838,\n      0.0,\n      12.80182743,\n      39.33988571,\n      71.25704193\n    ];\n\n    const xvec = [\n      0.2,\n      0.4,\n      0.6,\n      0.8,\n      1.0,\n      1.1,\n      1.2,\n      1.3,\n      1.4,\n      1.5,\n      1.6,\n      1.7,\n      1.8,\n      1.9,\n      2.0,\n      10.0,\n      20.0,\n      30.0\n    ];\n\n    if (nData.val < 0) nData.val = 0;\n\n    nData.val++;\n\n    if (nmax < nData.val) {\n      nData.val = 0;\n      x.val = 0.0;\n      fx.val = 0.0;\n    } else {\n      x.val = xvec[nData.val - 1];\n      fx.val = bvec[nData.val - 1];\n    }\n  }\n\n  public static gamln(a: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc GAMLN evaluates LN(GAMMA(A)) for positive A.\n    // C\n    // C     WRITTEN BY ALFRED H. MORRIS\n    // C          NAVAL SURFACE WARFARE CENTER\n    // C          DAHLGREN, VIRGINIA\n    // C\n    // C     D = 0.5*(LN(2*PI) - 1)\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const d = 0.418938533204673;\n    //\n    const c5 = -0.165322962780713e-2;\n    const c4 = 0.837308034031215e-3;\n    const c3 = -0.59520293135187e-3;\n    const c2 = 0.79365066682539e-3;\n    const c1 = -0.277777777760991e-2;\n    const c0 = 0.833333333333333e-1;\n    //\n    let i = 0;\n    let n = 0;\n    let t = 0.0;\n    let w = 0.0;\n\n    if (a <= 0.8) return Toms708.gamln1(a) - log(a);\n\n    if (a <= 2.25) {\n      t = a - 0.5 - 0.5;\n      return Toms708.gamln1(t);\n    }\n\n    if (a < 10.0) {\n      n = trunc(a - 1.25);\n      t = a;\n      w = 1.0;\n\n      for (i = 1; i <= n; i++) {\n        t--;\n        w *= t;\n      }\n      return Toms708.gamln1(t - 1.0) + log(w);\n    }\n\n    t = Math.pow(1.0 / a, 2);\n    w = (((((c5 * t + c4) * t + c3) * t + c2) * t + c1) * t + c0) / a;\n    return d + w + (a - 0.5) * (log(a) - 1.0);\n  }\n\n  public static gamln1(a: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc GAMLN1 evaluates LN(GAMMA(1 + A)) for -0.2 <= A <= 1.25\n    // c\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const p6 = -0.271935708322958e-2;\n    const p5 = -0.673562214325671e-1;\n    const p4 = -0.402055799310489;\n    const p3 = -0.780427615533591;\n    const p2 = -0.168860593646662;\n    const p1 = 0.844203922187225;\n    const p0 = 0.577215664901533;\n    const q6 = 0.667465618796164e-3;\n    const q5 = 0.325038868253937e-1;\n    const q4 = 0.361951990101499;\n    const q3 = 0.156875193295039e1;\n    const q2 = 0.312755088914843e1;\n    const q1 = 0.288743195473681e1;\n    // c\n    const r5 = 0.497958207639485e-3;\n    const r4 = 0.17050248402265e-1;\n    const r3 = 0.156513060486551;\n    const r2 = 0.565221050691933;\n    const r1 = 0.848044614534529;\n    const r0 = 0.422784335098467;\n    const s5 = 0.116165475989616e-3;\n    const s4 = 0.713309612391e-2;\n    const s3 = 0.10155218743983;\n    const s2 = 0.548042109832463;\n    const s1 = 0.124313399877507e1;\n    //\n\n    let w = 0.0;\n    let x = 0.0;\n\n    if (a < 0.6) {\n      w =\n        ((((((p6 * a + p5) * a + p4) * a + p3) * a + p2) * a + p1) * a + p0) /\n        ((((((q6 * a + q5) * a + q4) * a + q3) * a + q2) * a + q1) * a + 1.0);\n\n      return -a * w;\n    }\n\n    x = a - 0.5 - 0.5;\n    w =\n      (((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x + r0) /\n      (((((s5 * x + s4) * x + s3) * x + s2) * x + s1) * x + 1.0);\n\n    return x * w;\n  }\n\n  public static gsumln(a: number, b: number): number {\n    //\n    // c*********************************************************************72\n    // c\n    // cc GSUMLN evaluates LN(GAMMA(A + B)) for 1 <= A <= 2 and 1 <= B <= 2.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    let x = a + b - 2;\n\n    if (x <= 0.25) return Toms708.gamln1(1.0 + x);\n\n    if (x <= 1.25) return Toms708.gamln1(x) + Toms708.alnrel(x);\n\n    return Toms708.gamln1(x - 1.0) + log(x * (1.0 + x));\n  }\n\n  public static psi(xx: number) {\n    //\n    // c*********************************************************************72\n    // C\n    // cc PSI evaluates the Digamma function.\n    // c\n    // C\n    // C     PSI(XX) IS ASSIGNED THE VALUE 0 WHEN THE DIGAMMA FUNCTION CANNOT\n    // C     BE COMPUTED.\n    // C\n    // C     THE MAIN COMPUTATION INVOLVES EVALUATION OF RATIONAL CHEBYSHEV\n    // C     APPROXIMATIONS PUBLISHED IN MATH. COMP. 27, 123-127(1973) BY\n    // C     CODY, STRECOK AND THACHER.\n    // C\n    // C\n    // C     PSI WAS WRITTEN AT ARGONNE NATIONAL LABORATORY FOR THE FUNPACK\n    // C     PACKAGE OF SPECIAL FUNCTION SUBROUTINES. PSI WAS MODIFIED BY\n    // C     A.H. MORRIS (NSWC).\n    // C\n    // C\n    // C  PIOV4  = PI/4\n    // C  DX0  = ZERO OF PSI TO EXTENDED PRECISION\n    // C\n    const piov4 = 0.785398163397448;\n    const dx0 = 1.461632144968362341262659542325721325;\n    // C\n    // C  COEFFICIENTS FOR RATIONAL APPROXIMATION OF\n    // C  PSI(X) / (X - X0),  0.5 <= X <= 3.0\n    // C\n\n    const p1 = [\n      0.89538502298197e-2,\n      0.477762828042627e1,\n      0.142441585084029e3,\n      0.118645200713425e4,\n      0.363351846806499e4,\n      0.413810161269013e4,\n      0.130560269827897e4\n    ];\n\n    const q1 = [\n      0.448452573429826e2,\n      0.520752771467162e3,\n      0.22100079924783e4,\n      0.364127349079381e4,\n      0.1908310765963e4,\n      0.691091682714533e-5\n    ];\n\n    // C\n    // C  COEFFICIENTS FOR RATIONAL APPROXIMATION OF\n    // C  PSI(X) - LN(X) + 1 / (2*X),  X .GT. 3.0\n    // C\n\n    const p2 = [\n      -0.212940445131011e1,\n      -0.701677227766759e1,\n      -0.448616543918019e1,\n      -0.648157123766197\n    ];\n\n    const q2 = [\n      0.322703493791143e2,\n      0.892920700481861e2,\n      0.546117738103215e2,\n      0.777788548522962e1\n    ];\n\n    // C\n    // C  MACHINE DEPENDENT CONSTANTS ...\n    // C\n    // C        XMAX1   = THE SMALLEST POSITIVE doubleING POINT CONSTANT\n    // C                 WITH ENTIRELY INTEGER REPRESENTATION.  ALSO USED\n    // C                 AS NEGATIVE OF LOWER BOUND ON ACCEPTABLE NEGATIVE\n    // C                 ARGUMENTS AND AS THE POSITIVE ARGUMENT BEYOND WHICH\n    // C                 PSI MAY BE REPRESENTED AS ALOG(X).\n    // C\n    // C        XSMALL  = ABSOLUTE ARGUMENT BELOW WHICH PI*COTAN(PI*X)\n    // C                 MAY BE REPRESENTED BY 1/X.\n    // C\n    // C\n\n    let nq = 0;\n    let xsmall = 0.0;\n    let xmax1 = 0.0;\n    let den = 0.0;\n    let i = 0;\n    let aug = 0.0;\n    let m = 0;\n    let n = 0;\n    let sgn = 0.0;\n    let w = 0.0;\n    let x = 0.0;\n    let z = 0.0;\n    let upper = 0.0;\n    let xmx0 = 0.0;\n\n    xmax1 = Toms708.ipmpar(3);\n    xmax1 = Math.min(xmax1, 1.0 / Toms708.spmpar(1));\n    xsmall = 1e-9;\n    //\n    x = xx;\n    aug = 0.0;\n    if (x < 0.5) {\n      // C\n      // C  X .LT. 0.5,  USE REFLECTION FORMULA\n      // C  PSI(1-X)  = PSI(X) + PI * COTAN(PI*X)\n      // C\n      if (Math.abs(x) <= xsmall) {\n        // error exit\n        if (x === 0.0) return 0;\n\n        // C\n        // C  0 .LT. ABS(X) <= XSMALL.  USE 1/X AS A SUBSTITUTE\n        // C  FOR  PI*COTAN(PI*X)\n        // C\n        aug = -1 / x;\n      } else {\n        // C\n        // C  REDUCTION OF ARGUMENT FOR COTAN\n        // C\n        w = -x;\n        sgn = piov4;\n        if (w <= 0.0) {\n          w = -w;\n          sgn = -sgn;\n        }\n        // C\n        // C  MAKE AN ERROR EXIT IF X <= -XMAX1\n        // C\n\n        // error exit\n        if (w >= xmax1) return 0;\n\n        nq = trunc(w);\n        w = w - nq;\n        nq = trunc(w * 4.0);\n        w = 4.0 * (w - nq * 0.25);\n        // C\n        // C  W IS NOW RELATED TO THE FRACTIONAL PART OF  4.0 * X.\n        // C  ADJUST ARGUMENT TO CORRESPOND TO VALUES IN FIRST\n        // C  QUADRANT AND DETERMINE SIGN\n        // C\n        n = nq / 2;\n        if (n + n !== nq) {\n          w = 1.0 - w;\n        }\n        z = piov4 * w;\n        m = n / 2;\n        if (m + m !== n) {\n          sgn = -sgn;\n        }\n        // C\n        // C  DETERMINE FINAL VALUE FOR  -PI*COTAN(PI*X)\n        // C\n        n = (nq + 1) / 2;\n        m = n / 2;\n        m = m + m;\n        if (m === n) {\n          // C\n          // C  CHECK FOR SINGULARITY\n          // C\n          // error exit\n          if (z === 0.0) return 0;\n\n          // C\n          // C  USE COS/SIN AS A SUBSTITUTE FOR COTAN, AND\n          // C  SIN/COS AS A SUBSTITUTE FOR TAN\n          // C\n          aug = sgn * (Math.cos(z) / Math.sin(z) * 4.0);\n        } else {\n          aug = sgn * (Math.sin(z) / Math.cos(z) * 4.0);\n        }\n      }\n      x = 1 - x;\n    }\n    if (x <= 3.0) {\n      // C\n      // C  0.5 <= X <= 3.0\n      // C\n      den = x;\n      upper = p1[1] * x;\n      //\n\n      for (i = 0; i < 5; i++) {\n        den = (den + q1[i]) * x;\n        upper = (upper + p1[i + 1]) * x;\n      }\n\n      //\n      den = (upper + p1[6]) / (den + q1[5]);\n      xmx0 = x - dx0;\n      return den * xmx0 + aug;\n\n      // C\n      // C  IF X .GE. XMAX1, PSI  = LN(X)\n      // C\n    }\n    if (x < xmax1) {\n      // C\n      // C  3.0 .LT. X .LT. XMAX1\n      // C\n      w = 1.0 / (x * x);\n      den = w;\n      upper = p2[0] * w;\n      //\n      for (i = 0; i < 3; i++) {\n        den = (den + q2[i]) * w;\n        upper = (upper + p2[i + 1]) * w;\n      } //  Close for() loop.\n      //\n      aug = upper / (den + q2[3]) - 0.5 / x + aug;\n    }\n\n    return aug + log(x);\n  }\n\n  public static psi_values(n: NumberW, x: NumberW, fx: NumberW) {\n    // C *********************************************************************72\n    // C\n    // C  PSI_VALUES returns some values of the Psi or Digamma function for testing.\n    // C\n    // C   Discussion:\n    // C\n    // C     PSI(X) = d LN ( GAMMA ( X ) ) / d X = GAMMA'(X) / GAMMA(X)\n    // C\n    // C     PSI(1) = - Euler's constant.\n    // C\n    // C     PSI(X+1) = PSI(X) + 1 / X.\n    // C\n    // C   Modified:\n    // C\n    // C     17 May 2001\n    // C\n    // C   Author:\n    // C\n    // C     John Burkardt\n    // C\n    // C   Reference:\n    // C\n    // C     Milton Abramowitz and Irene Stegun,\n    // C     Handbook of Mathematical Functions,\n    // C     US Department of Commerce, 1964.\n    // C\n    // C   Parameters:\n    // C\n    // C     Input/output, integer N.\n    // C     On input, if N is 0, the first test data is returned, and N is set\n    // C     to the index of the test data.  On each subsequent call, N is\n    // C     incremented and that test data is returned.  When there is no more\n    // C     test data, N is set to 0.\n    // C\n    // C     Output, real X, the argument of the function.\n    // C\n    // C     Output, real FX, the value of the function.\n    // C\n    const nmax = 11;\n    const fxvec = [\n      -0.5772156649,\n      -0.4237549404,\n      -0.2890398966,\n      -0.1691908889,\n      -0.0613845446,\n      -0.036489974,\n      0.1260474528,\n      0.2085478749,\n      0.2849914333,\n      0.3561841612,\n      0.4227843351\n    ];\n\n    const xvec = [1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0];\n\n    if (n.val < 0) n.val = 0;\n\n    n.val++;\n\n    if (nmax < n.val) {\n      n.val = 0;\n      x.val = 0.0;\n      fx.val = 0.0;\n    } else {\n      x.val = xvec[n.val - 1];\n      fx.val = fxvec[n.val - 1];\n    }\n  }\n\n  public static r4_epsilon(): number {\n    // C *********************************************************************72\n    // C\n    // C R4_EPSILON returns the round off unit for floating arithmetic.\n    // C\n    // C Discussion:\n    // C\n    // C R4_EPSILON is a number R which is a power of 2 with the property that,\n    // C to the precision of the computer's arithmetic,\n    // C 1 < 1 + R\n    // C but\n    // C 1 = ( 1 + R / 2 )\n    // C\n    // C FORTRAN90 provides the superior library routine\n    // C\n    // C EPSILON ( X )\n    // C\n    // C Modified:\n    // C\n    // C 28 November 2005\n    // C\n    // C Author:\n    // C\n    // C John Burkardt\n    // C\n    // C Parameters:\n    // C\n    // C Output, real R4_EPSILON, the floating point round-off unit.\n    // C\n\n    let r = 1.0;\n    let rTest = 1.0 + r / 2.0;\n\n    while (1.0 < rTest) {\n      r = r / 2.0;\n      rTest = 1.0 + r / 2.0;\n    }\n\n    return r;\n  }\n\n  public static rexp(x: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc REXP evaluates the function EXP(X) - 1.\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360 - 373.\n    // c\n    //\n    const q4 = 0.595130811860248e-3;\n    const q3 = -0.119041179760821e-1;\n    const q2 = 0.107141568980644;\n    const q1 = -0.499999999085958;\n    const p2 = 0.238082361044469e-1;\n    const p1 = 0.914041914819518e-9;\n\n    let w = 0.0;\n\n    if (Math.abs(x) <= 0.15) {\n      return (\n        x *\n        (((p2 * x + p1) * x + 1.0) / (((q4 * x + q3) * x + q2) * x + q1) * x +\n          1.0)\n      );\n    } else {\n      w = Math.exp(x);\n\n      if (x <= 0.0) {\n        return w - 0.5 - 0.5;\n      } else {\n        return w * (0.5 + (0.5 - 1.0 / w));\n      }\n    }\n  }\n\n  public static rlog1(x: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc RLOG1 evaluates the function X - LN(1 + X).\n    // C\n    // c  Reference:\n    // c\n    // c    Armido Didonato, Alfred Morris,\n    // c    Algorithm 708:\n    // c    Significant Digit Computation of the Incomplete Beta Function Ratio\n    // c    ACM Transactions on Mathematical Software,\n    // c    Volume 18, Number 3, 1992, pages 360-373.\n    // c\n    //\n    const a = 0.566749439387324e-1;\n    const b = 0.456512608815524e-1;\n    //\n    const p2 = 0.620886815375787e-2;\n    const p1 = -0.224696413112536;\n    const p0 = 0.333333333333333;\n    const q2 = 0.354508718369557;\n    const q1 = -0.127408923933623e1;\n    //\n\n    let h = 0.0;\n    let r = 0.0;\n    let t = 0.0;\n    let w = 0.0;\n    let w1 = 0.0;\n\n    if (x < -0.39 || x > 0.57) {\n      w = x + 0.5 + 0.5;\n\n      return x - log(w);\n    }\n\n    if (x < -0.18) {\n      h = x + 0.3;\n      h = h / 0.7;\n      w1 = a - h * 0.3;\n    } else if (x > 0.18) {\n      h = 0.75 * x - 0.25;\n      w1 = b + h / 3.0;\n    } else {\n      // C\n      // C  ARGUMENT REDUCTION\n      // C\n      h = x;\n      w1 = 0.0;\n    }\n\n    // C\n    // C  Series expansion\n    // c\n    r = h / (h + 2.0);\n    t = r * r;\n    w = ((p2 * t + p1) * t + p0) / ((q2 * t + q1) * t + 1.0);\n\n    return 2.0 * t * (1.0 / (1.0 - r) - r * w) + w1;\n    //\n  }\n\n  /**\n   * Fortran floating point transfer of sign (SIGN) intrinsic function.\n   * <p>\n   * Returns:<br>\n   * <ul>\n   *   <li> abs(a1), if a2 &gt;= 0\n   *   <li>-abs(a1), if a2 &lt; 0\n   * </ul>\n   *\n   * @param a1 floating point value\n   * @param a2 sign transfer indicator\n   *\n   * @return equivalent of Fortran SIGN(a1,a2) as described above.\n   *  <p>\n   *  @author Keith Seymour (seymour@cs.utk.edu)\n   */\n  public static sign(a1: number, a2: number): number {\n    return a2 >= 0 ? Math.abs(a1) : -Math.abs(a1);\n  }\n\n  public static spmpar(i: number) {\n    //\n    // c*********************************************************************72\n    // c\n    // cc SPMPAR returns single precision real machine constants.\n    // c\n    // C     SPMPAR PROVIDES THE SINGLE PRECISION MACHINE CONSTANTS FOR\n    // C     THE COMPUTER BEING USED. IT IS ASSUMED THAT THE ARGUMENT\n    // C     I IS AN INTEGER HAVING ONE OF THE VALUES 1, 2, OR 3. IF THE\n    // C     SINGLE PRECISION ARITHMETIC BEING USED HAS M BASE B DIGITS AND\n    // C     ITS SMALLEST AND LARGEST EXPONENTS ARE EMIN AND EMAX, THEN\n    // C\n    // C        SPMPAR(1)  = B**(1 - M), THE MACHINE PRECISION,\n    // C\n    // C        SPMPAR(2)  = B**(EMIN - 1), THE SMALLEST MAGNITUDE,\n    // C\n    // C        SPMPAR(3)  = B**EMAX*(1 - B**(-M)), THE LARGEST MAGNITUDE.\n    // C\n    // C\n    // C     WRITTEN BY\n    // C        ALFRED H. MORRIS, JR.\n    // C        NAVAL SURFACE WARFARE CENTER\n    // C        DAHLGREN VIRGINIA\n    // C\n    //\n\n    let emin = 0;\n    let emax = 0;\n    let binv = 0.0;\n    let bm1 = 0.0;\n    let ibeta = 0;\n    let b = 0.0;\n    let m = 0;\n    let one = 0.0;\n    let w = 0.0;\n    let z = 0.0;\n\n    if (i > 1) {\n      if (i > 2) {\n        ibeta = Toms708.ipmpar(4);\n        m = Toms708.ipmpar(5);\n        emax = Toms708.ipmpar(7);\n        //\n        b = ibeta;\n        bm1 = ibeta - 1;\n        one = 1.0;\n        z = Math.pow(b, m - 1);\n        w = ((z - one) * b + bm1) / (b * z);\n        //\n        z = Math.pow(b, emax - 2);\n        return w * z * b * b;\n      } else {\n        b = Toms708.ipmpar(4);\n        emin = Toms708.ipmpar(6);\n        one = 1.0;\n        binv = one / b;\n        w = Math.pow(b, emin + 2);\n        return w * binv * binv * binv;\n      }\n    }\n    //else\n    b = Toms708.ipmpar(4);\n    m = Toms708.ipmpar(5);\n    return Math.pow(b, 1 - m);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst { abs:fabs } = Math;\nconst { isNaN:ISNAN } = Number;\n\n// needed by rpois\nexport function fsign(x: number, signal: boolean) {\n    if (ISNAN(x)) return x;\n    return signal ? fabs(x) : -fabs(x); \n}\n\n\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../';\nimport { MersenneTwister } from '../mersenne-twister';\nimport { IRNGNormal } from './inormal-rng';\n\nconst { log, sqrt, min: fmin2, max: fmax2, abs: fabs, exp } = Math;\n\nexport class BuggyKindermanRamage extends IRNGNormal {\n  constructor(_rng: IRNG  = new MersenneTwister(0) ) {\n    super(_rng);\n  }\n\n  protected internal_norm_rand() {\n    /* see Reference above */\n    /* note: this has problems, but is retained for\n         * reproducibility of older codes, with the same\n         * numeric code */\n\n    const A = 2.216035867166471;\n    const C1 = 0.398942280401433;\n    const C2 = 0.180025191068563;\n\n    const g = (x: number) => C1 * exp(-x * x / 2.0) - C2 * (A - x);\n\n    const u1 = this.rng.internal_unif_rand();\n    let u2: number;\n    let u3: number;\n    let tt: number;\n    if (u1 < 0.884070402298758) {\n      let u2 = this.rng.internal_unif_rand();\n      return A * (1.1311316354418 * u1 + u2 - 1);\n    }\n\n    if (u1 >= 0.973310954173898) {\n      /* tail: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = A * A - 2 * log(u3);\n        if (u2 * u2 < A * A / tt)\n          return u1 < 0.986655477086949 ? sqrt(tt) : -sqrt(tt);\n      }\n    }\n\n    if (u1 >= 0.958720824790463) {\n      /* region3: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = A - 0.63083480192196 * fmin2(u2, u3);\n        if (fmax2(u2, u3) <= 0.755591531667601) return u2 < u3 ? tt : -tt;\n        if (0.034240503750111 * fabs(u2 - u3) <= g(tt))\n          return u2 < u3 ? tt : -tt;\n      }\n    }\n\n    if (u1 >= 0.911312780288703) {\n      /* region2: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = 0.479727404222441 + 1.10547366102207 * fmin2(u2, u3);\n        if (fmax2(u2, u3) <= 0.87283497667179) return u2 < u3 ? tt : -tt;\n        if (0.049264496373128 * fabs(u2 - u3) <= g(tt))\n          return u2 < u3 ? tt : -tt;\n      }\n    }\n\n    /* ELSE\t region1: */\n    for (;;) {\n      u2 = this.rng.internal_unif_rand();\n      u3 = this.rng.internal_unif_rand();\n      tt = 0.479727404222441 - 0.59550713801594 * fmin2(u2, u3);\n      if (fmax2(u2, u3) <= 0.805577924423817) return u2 < u3 ? tt : -tt;\n    }\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../';\nimport { MersenneTwister } from '../mersenne-twister';\nimport { IRNGNormal } from './inormal-rng';\n\nconst { log, sqrt, cos, sin } = Math;\n\nconst DBL_MIN = 2.22507e-308;\nconst M_PI = 3.14159265358979323846264338327950288;\n\nexport class BoxMuller extends IRNGNormal {\n  private BM_norm_keep: number;\n\n  private reset() {\n    this.BM_norm_keep = 0;\n  }\n\n  constructor(_rng: IRNG = new MersenneTwister(0) ) {\n    super(_rng);\n    this.BM_norm_keep = 0;\n    _rng.register('INIT', this.reset.bind(this));\n  }\n\n  protected internal_norm_rand() {\n    let s = 0.0;\n    let theta = 0;\n\n    if (this.BM_norm_keep !== 0.0) {\n      /* An exact test is intentional */\n      s = this.BM_norm_keep;\n      this.BM_norm_keep = 0.0;\n      return s;\n    } else {\n      theta = 2 * M_PI * (this.rng.internal_unif_rand());\n      let R =\n        sqrt(-2 * log(this.rng.internal_unif_rand())) +\n        10 * DBL_MIN; /* ensure non-zero */\n      this.BM_norm_keep = R * sin(theta);\n      return R * cos(theta);\n    }\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../';\nimport { MersenneTwister } from '../mersenne-twister';\nimport { IRNGNormal } from './inormal-rng';\n\nconst a = [\n  0.0,\n  0.03917609,\n  0.07841241,\n  0.1177699,\n  0.1573107,\n  0.1970991,\n  0.2372021,\n  0.2776904,\n  0.3186394,\n  0.3601299,\n  0.4022501,\n  0.4450965,\n  0.4887764,\n  0.5334097,\n  0.5791322,\n  0.626099,\n  0.6744898,\n  0.7245144,\n  0.7764218,\n  0.8305109,\n  0.8871466,\n  0.9467818,\n  1.00999,\n  1.077516,\n  1.150349,\n  1.229859,\n  1.318011,\n  1.417797,\n  1.534121,\n  1.67594,\n  1.862732,\n  2.153875\n];\n\nconst d = [\n  0.0,\n  0.0,\n  0.0,\n  0.0,\n  0.0,\n  0.2636843,\n  0.2425085,\n  0.2255674,\n  0.2116342,\n  0.1999243,\n  0.1899108,\n  0.1812252,\n  0.1736014,\n  0.1668419,\n  0.1607967,\n  0.1553497,\n  0.1504094,\n  0.1459026,\n  0.14177,\n  0.1379632,\n  0.1344418,\n  0.1311722,\n  0.128126,\n  0.1252791,\n  0.1226109,\n  0.1201036,\n  0.1177417,\n  0.1155119,\n  0.1134023,\n  0.1114027,\n  0.1095039\n];\n\nconst t = [\n  7.673828e-4,\n  0.00230687,\n  0.003860618,\n  0.005438454,\n  0.007050699,\n  0.008708396,\n  0.01042357,\n  0.01220953,\n  0.01408125,\n  0.01605579,\n  0.0181529,\n  0.02039573,\n  0.02281177,\n  0.02543407,\n  0.02830296,\n  0.03146822,\n  0.03499233,\n  0.03895483,\n  0.04345878,\n  0.04864035,\n  0.05468334,\n  0.06184222,\n  0.07047983,\n  0.08113195,\n  0.09462444,\n  0.1123001,\n  0.136498,\n  0.1716886,\n  0.2276241,\n  0.330498,\n  0.5847031\n];\n\nconst h = [\n  0.03920617,\n  0.03932705,\n  0.03950999,\n  0.03975703,\n  0.04007093,\n  0.04045533,\n  0.04091481,\n  0.04145507,\n  0.04208311,\n  0.04280748,\n  0.04363863,\n  0.04458932,\n  0.04567523,\n  0.04691571,\n  0.04833487,\n  0.04996298,\n  0.05183859,\n  0.05401138,\n  0.05654656,\n  0.0595313,\n  0.06308489,\n  0.06737503,\n  0.07264544,\n  0.07926471,\n  0.08781922,\n  0.09930398,\n  0.1155599,\n  0.1404344,\n  0.1836142,\n  0.2790016,\n  0.7010474\n];\n\nexport class AhrensDieter extends IRNGNormal {\n  constructor(_rng: IRNG = new MersenneTwister(0) ) {\n    super(_rng);\n  }\n\n  protected internal_norm_rand() {\n    let u1: number = this.rng.internal_unif_rand();\n    let s = 0.0;\n    let w: number;\n    let aa: number;\n    let tt: number;\n    let u2: number;\n    let y: number;\n    if (u1 > 0.5) {\n      s = 1.0;\n    }\n    u1 = u1 + u1 - s;\n    u1 *= 32.0;\n\n    const i = new Int32Array([u1]);\n    if (i[0] === 32) i[0] = 31;\n    if (i[0] !== 0) {\n      u2 = u1 - i[0];\n      aa = a[i[0] - 1];\n      while (u2 <= t[i[0] - 1]) {\n        u1 = this.rng.internal_unif_rand();\n        w = u1 * (a[i[0]] - aa);\n        tt = (w * 0.5 + aa) * w;\n        for (;;) {\n          if (u2 > tt) {\n            // this used to be a goto))\n            y = aa + w;\n            return s === 1.0 ? -y : y;\n          }\n          u1 = this.rng.internal_unif_rand();\n          if (u2 < u1) break;\n          tt = u1;\n          u2 = this.rng.internal_unif_rand();\n        }\n        u2 = this.rng.internal_unif_rand();\n      }\n      w = (u2 - t[i[0] - 1]) * h[i[0] - 1];\n    } else {\n      i[0] = 6;\n      aa = a[31];\n      for (;;) {\n        u1 = u1 + u1;\n        if (u1 >= 1.0) break;\n        aa = aa + d[i[0] - 1];\n        i[0] = i[0] + 1;\n      }\n      u1 = (u1 - 1.0) as number;\n      // used to be a goto\n      jump: for (;;) {\n        w = u1 * d[i[0] - 1];\n        tt = (w * 0.5 + aa) * w;\n        for (;;) {\n          u2 = this.rng.internal_unif_rand();\n          if (u2 > tt) break jump;\n          u1 = this.rng.internal_unif_rand();\n          if (u2 < u1) break;\n          tt = u1;\n        }\n        u1 = this.rng.internal_unif_rand();\n      }\n      //jump:; (goto label)\n    }\n    // deliver: (goto label)\n    y = aa + w;\n    return s === 1.0 ? -y : y;\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { IRNG } from '../';\nimport { MersenneTwister } from '../mersenne-twister';\nimport { IRNGNormal } from './inormal-rng';\n\nconst { exp, log, sqrt, max: fmax2, min: fmin2, abs: fabs } = Math;\n\nconst A = 2.216035867166471;\nconst C1 = 0.398942280401433;\nconst C2 = 0.180025191068563;\n/*----------- Constants and definitions for  Kinderman - Ramage --- */\n/*\n     *  REFERENCE\n     *\n     *    Kinderman A. J. and Ramage J. G. (1976).\n     *    Computer generation of normal random variables.\n     *    JASA 71, 893-896.\n     */\nexport class KindermanRamage extends IRNGNormal {\n  constructor(_rng: IRNG  = new MersenneTwister(0) ) {\n    super(_rng);\n  }\n\n  protected internal_norm_rand() {\n    let u1: number;\n    let u2: number;\n    let u3: number;\n    let tt: number;\n    const g = (x: number) => C1 * exp(-x * x / 2.0) - C2 * (A - x);\n    // corrected version from Josef Leydold\n\n    u1 = this.rng.internal_unif_rand();\n\n    if (u1 < 0.884070402298758) {\n      u2 = this.rng.internal_unif_rand();\n      return A * (1.13113163544418 * u1 + u2 - 1);\n    }\n\n    if (u1 >= 0.973310954173898) {\n      /* tail: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = A * A - 2 * log(u3);\n        if (u2 * u2 < A * A / tt)\n          return u1 < 0.986655477086949 ? sqrt(tt) : -sqrt(tt);\n      }\n    }\n\n    if (u1 >= 0.958720824790463) {\n      /* region3: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = A - 0.63083480192196 * fmin2(u2, u3);\n        if (fmax2(u2, u3) <= 0.755591531667601) return u2 < u3 ? tt : -tt;\n        if (0.034240503750111 * fabs(u2 - u3) <= g(tt))\n          return u2 < u3 ? tt : -tt;\n      }\n    }\n\n    if (u1 >= 0.911312780288703) {\n      /* region2: */\n      for (;;) {\n        u2 = this.rng.internal_unif_rand();\n        u3 = this.rng.internal_unif_rand();\n        tt = 0.479727404222441 + 1.10547366102207 * fmin2(u2, u3);\n        if (fmax2(u2, u3) <= 0.87283497667179) return u2 < u3 ? tt : -tt;\n        if (0.049264496373128 * fabs(u2 - u3) <= g(tt))\n          return u2 < u3 ? tt : -tt;\n      }\n    }\n\n    /* ELSE\t region1: */\n    for (;;) {\n      u2 = this.rng.internal_unif_rand();\n      u3 = this.rng.internal_unif_rand();\n      tt = 0.479727404222441 - 0.59550713801594 * fmin2(u2, u3);\n      if (tt < 0) continue;\n      if (fmax2(u2, u3) <= 0.805577924423817) return u2 < u3 ? tt : -tt;\n      if (0.053377549506886 * fabs(u2 - u3) <= g(tt)) return u2 < u3 ? tt : -tt;\n    }\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { DBL_MAX_EXP, ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func'\nimport { IRNGNormal } from '../rng/normal';\n\nconst { LN2: M_LN2, log, min: fmin2, max: fmax2, exp, sqrt } = Math;\nconst { MAX_VALUE: DBL_MAX, isFinite: R_FINITE } = Number;\nconst printer = debug('rbeta');\n\nexport const expmax = DBL_MAX_EXP * M_LN2; /* = log(DBL_MAX) */\n\nexport function rbeta(n: number|number[], aa: number, bb: number, rng: IRNGNormal){\n  return randomGenHelper(n, rbetaOne, aa, bb, rng);\n}\n\nexport function rbetaOne(\n  aa: number,\n  bb: number,\n  rng: IRNGNormal\n): number  {\n\n  if (aa < 0 || bb < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  if (!R_FINITE(aa) && !R_FINITE(bb))\n    // a = b = Inf : all mass at 1/2\n    return 0.5;\n  if (aa === 0 && bb === 0)\n    // point mass 1/2 at each of {0,1} :\n    return rng.internal_unif_rand() < 0.5 ? 0 : 1;\n  // now, at least one of a, b is finite and positive\n  if (!R_FINITE(aa) || bb === 0) return 1.0;\n  if (!R_FINITE(bb) || aa === 0) return 0.0;\n\n  let a;\n  let b;\n  let alpha;\n  let r;\n  let s;\n  let t;\n  let u1 = 0;\n  let u2;\n  let v = 0;\n  let w = 0;\n  let y;\n  let z;\n  let qsame;\n  /* FIXME:  Keep Globals (properly) for threading */\n  /* Uses these GLOBALS to save time when many rv's are generated : */\n  let beta = 0;\n  let gamma = 0;\n  let delta;\n  let k1 = 0;\n  let k2 = 0;\n  let olda = -1.0;\n  let oldb = -1.0;\n\n  /* Test if we need new \"initializing\" */\n  qsame = olda === aa && oldb === bb;\n  if (!qsame) {\n    olda = aa;\n    oldb = bb;\n  }\n\n  a = fmin2(aa, bb);\n  b = fmax2(aa, bb); /* a <= b */\n  alpha = a + b;\n\n  function v_w_from__u1_bet(AA: number) {\n    v = beta * log(u1 / (1.0 - u1));\n    if (v <= expmax) {\n      w = AA * exp(v);\n      if (!R_FINITE(w)) {\n        w = DBL_MAX;\n      }\n    } else {\n      w = DBL_MAX;\n    }\n  }\n\n  if (a <= 1.0) {\n    /* --- Algorithm BC --- */\n\n    /* changed notation, now also a <= b (was reversed) */\n\n    if (!qsame) {\n      /* initialize */\n      beta = 1.0 / a;\n      delta = 1.0 + b - a;\n      k1 = delta * (0.0138889 + 0.0416667 * a) / (b * beta - 0.777778);\n      k2 = 0.25 + (0.5 + 0.25 / delta) * a;\n    }\n    /* FIXME: \"do { } while()\", but not trivially because of \"continue\"s:*/\n    for (; ;) {\n      u1 = rng.internal_unif_rand();\n      u2 = rng.internal_unif_rand();\n      if (u1 < 0.5) {\n        y = u1 * u2;\n        z = u1 * y;\n        if (0.25 * u2 + z - y >= k1) continue;\n      } else {\n        z = u1 * u1 * u2;\n        if (z <= 0.25) {\n          v_w_from__u1_bet(b);\n          break;\n        }\n        if (z >= k2) continue;\n      }\n\n      v_w_from__u1_bet(b);\n\n      if (alpha * (log(alpha / (a + w)) + v) - 1.3862944 >= log(z)) break;\n    }\n    return aa === a ? a / (a + w) : w / (a + w);\n  } else {\n    /* Algorithm BB */\n\n    if (!qsame) {\n      /* initialize */\n      beta = sqrt((alpha - 2.0) / (2.0 * a * b - alpha));\n      gamma = a + 1.0 / beta;\n    }\n    do {\n      u1 = rng.internal_unif_rand();\n      u2 = rng.internal_unif_rand();\n\n      v_w_from__u1_bet(a);\n\n      z = u1 * u1 * u2;\n      r = gamma * v - 1.3862944;\n      s = a + r - w;\n      if (s + 2.609438 >= 5.0 * z) break;\n      t = log(z);\n      if (s > t) break;\n    } while (r + alpha * log(alpha / (b + w)) < t);\n\n    return aa !== a ? b / (b + w) : w / (b + w);\n  }\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../rng/irng';\nimport { MersenneTwister } from '../rng/mersenne-twister';\nimport { dbinom } from './dbinom';\nimport { pbinom } from './pbinom';\nimport { qbinom } from './qbinom';\nimport { rbinom } from './rbinom';\n\nexport function Binomial(rng: IRNG = new MersenneTwister()) {\n  return {\n    dbinom,\n    pbinom,\n    qbinom,\n    rbinom: (N: number, nin: number, pp: number) => rbinom(N, nin, pp, rng)\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { Inversion, IRNGNormal } from '../rng/normal';\nimport { dnbinom as _dnbinom, dnbinom_mu } from './dnbinom';\nimport { pnbinom as _pnbinom, pnbinom_mu } from './pnbinom';\nimport { qnbinom as _qnbinom, qnbinom_mu } from './qnbinom';\nimport { rnbinom as _rnbinom, rnbinom_mu } from './rnbinom';\n\nconst errText = Object.freeze([\n  'at most specify either argument \"mu\" or  \"prob\", but not both at the same time!',\n  'both arguments \"mu\" and \"prob\" are undefined'\n]);\n\n\n\nfunction select(\n  fs: 'd' | 'p' | 'r' | 'q',\n  mu?: number,\n  prob?: number\n) {\n  const selector = {\n    mu: {\n      d: dnbinom_mu,\n      p: pnbinom_mu,\n      q: qnbinom_mu,\n      r: rnbinom_mu\n    },\n    p: {\n      d: _dnbinom,\n      p: _pnbinom,\n      q: _qnbinom,\n      r: _rnbinom\n    }\n  };\n\n  if (prob !== undefined && mu !== undefined) {\n    throw new Error(errText[0]);\n  }\n  if (prob === undefined && mu === undefined) {\n    throw new Error(errText[1]);\n  }\n  const s = prob === undefined ? 'mu' : 'p';\n  return selector[s][fs] as any;\n}\n\nexport function NegativeBinomial(rng: IRNGNormal = new Inversion()) {\n  function dnbinom(\n    x: number | number[],\n    size: number,\n    prob?: number,\n    mu?: number,\n    giveLog =  false\n  ): number|number[] {\n    const val = mu || prob;\n    return select('d', mu, prob)(x, size, val, giveLog);\n  }\n\n  function pnbinom(\n    q: number | number[],\n    size: number,\n    prob?: number,\n    mu?: number,\n    lowerTail = true,\n    logP = false\n  ): number | number[] {\n    const val = mu || prob;\n    return select('p', mu, prob)(q, size, val, lowerTail, logP);\n  }\n\n  function qnbinom(\n    q: number | number[],\n    size: number,\n    prob?: number,\n    mu?: number,\n    lowerTail = true,\n    logP = false\n  ): number | number[] {\n    const val = mu || prob;\n    return select('q', mu, prob)(q, size, val, lowerTail, logP);\n  }\n\n  function rnbinom(\n    n: number,\n    size: number,\n    prob?: number,\n    mu?: number\n  ): number | number[] {\n    const val = mu || prob;\n    return select('r', mu, prob)(n, size, val, rng);\n  }\n\n  return {\n    dnbinom,\n    pnbinom,\n    qnbinom,\n    rnbinom\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_D__0,\n  R_D__1,\n  R_D_exp,\n  R_D_nonint_check\n} from '../common/_general';\n\nimport { dbinom_raw } from '../binomial/dbinom';\nimport { lgammafn_sign } from '../gamma/lgammafn_sign';\n\nconst printer = debug('dnbinom');\nconst { log, round: R_forceint, log1p } = Math;\nconst { isFinite: R_FINITE, isNaN: ISNAN } = Number;\n\nexport function dnbinom<T>(\n  xx: T,\n  size: number,\n  prob: number,\n  give_log: boolean\n): T {\n  const fx: number[] = Array.isArray(xx) ? xx : ([xx] as any);\n\n  const result = fx.map(x => {\n    let ans: number;\n    let p: number;\n\n    if (ISNAN(x) || ISNAN(size) || ISNAN(prob)) {\n      return x + size + prob;\n    }\n\n    if (prob <= 0 || prob > 1 || size < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    let rc = R_D_nonint_check(give_log, x, printer);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (x < 0 || !R_FINITE(x)) {\n      return R_D__0(give_log);\n    }\n    /* limiting case as size approaches zero is point mass at zero */\n    if (x === 0 && size === 0) {\n      return R_D__1(give_log);\n    }\n\n    x = R_forceint(x);\n\n    ans = dbinom_raw(size, x + size, prob, 1 - prob, give_log);\n\n    p = size / (size + x);\n\n    return give_log ? log(p) + ans : p * ans;\n  });\n\n  return result.length === 1 ? result[0] : (result as any);\n}\n\nconst printer_dnbinom_mu = debug('dnbinom_mu');\n\nexport function dnbinom_mu<T>(\n  xx: T,\n  size: number,\n  mu: number,\n  give_log: boolean\n): T {\n  const fx: number[] = Array.isArray(xx) ? xx : ([xx] as any);\n\n  const result = fx.map(x => {\n    /* originally, just set  prob :=  size / (size + mu)  and called dbinom_raw(),\n     * but that suffers from cancellation when   mu << size  */\n    let ans: number;\n    let p: number;\n\n    if (ISNAN(x) || ISNAN(size) || ISNAN(mu)) {\n      return x + size + mu;\n    }\n\n    if (mu < 0 || size < 0) {\n      return ML_ERR_return_NAN(printer_dnbinom_mu);\n    }\n\n    let rc = R_D_nonint_check(give_log, x, printer_dnbinom_mu);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (x < 0 || !R_FINITE(x)) {\n      return R_D__0(give_log);\n    }\n\n    /* limiting case as size approaches zero is point mass at zero,\n     * even if mu is kept constant. limit distribution does not\n     * have mean mu, though.\n     */\n    if (x === 0 && size === 0) {\n      return R_D__1(give_log);\n    }\n\n    x = R_forceint(x);\n    if (x === 0) {\n      /* be accurate, both for n << mu, and n >> mu :*/\n      // old code   size * (size < mu ? log(size / (size + mu)) : log1p(- mu / (size + mu))));\n      let llogx: number;\n      if (size < mu) {\n        llogx = log(size / (size + mu));\n      } else {\n        llogx = log1p(-mu / (size + mu));\n      }\n      return R_D_exp(give_log, size * llogx);\n    }\n    if (x < 1e-10 * size) {\n      /* don't use dbinom_raw() but MM's formula: */\n      /* FIXME --- 1e-8 shows problem; rather use algdiv() from ./toms708.c */\n      p = size < mu ? log(size / (1 + size / mu)) : log(mu / (1 + mu / size));\n      return R_D_exp(\n        give_log,\n        x * p - mu - lgammafn_sign(x + 1) + log1p(x * (x - 1) / (2 * size))\n      );\n    }\n\n    /* else: no unnecessary cancellation inside dbinom_raw, when\n     * x_ = size and n_ = x+size are so close that n_ - x_ loses accuracy\n     */\n\n    ans = dbinom_raw(\n      size,\n      x + size,\n      size / (size + mu),\n      mu / (size + mu),\n      give_log\n    );\n    p = size / (size + x);\n\n    return give_log ? log(p) + ans : p * ans;\n  });\n  return result.length === 0 ? result[0] : (result as any);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1,\n  R_Q_P01_boundaries\n} from '../common/_general';\n\nimport { NumberW } from '../common/toms708';\n\nimport { R_DT_qIv } from '../exp/expm1';\nimport { qnorm } from '../normal/qnorm';\n\nimport { pnbinom } from './pnbinom';\n\nconst {\n  isNaN: ISNAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  EPSILON: DBL_EPSILON\n} = Number;\n\nconst { max: fmax2, sqrt, floor, round: R_forceint } = Math;\n\nconst printer_do_search = debug('do_search');\n\nfunction do_search(\n  y: number,\n  z: NumberW,\n  p: number,\n  n: number,\n  pr: number,\n  incr: number\n): number {\n  printer_do_search(\n    'start: y:%d, z:%o, p:%d, n:%d, pr:%d, incr:%d',\n    y,\n    z,\n    p,\n    n,\n    pr,\n    incr\n  );\n  if (z.val >= p) {\n    //* search to the left\n    while (true) {\n      if (\n        y === 0 ||\n        (z.val = pnbinom(\n          y - incr,\n          n,\n          pr,\n          true, ///log_p,\n          false\n        )) < p\n      ) {\n        printer_do_search('exit1');\n        return y;\n      }\n      y = fmax2(0, y - incr);\n    } //while\n  } else {\n    // search to the right\n\n    while (true) {\n      y = y + incr;\n      if (\n        (z.val = pnbinom(\n          y,\n          n,\n          pr, //l._t.\n          true,\n          false\n        )) >= p\n      ) {\n        printer_do_search('exit2');\n        return y;\n      }\n    } //while\n  } //if\n}\n\nconst printer_qnbinom = debug('qnbinom');\n\nexport function qnbinom(\n  p: number,\n  size: number,\n  prob: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n    let P;\n    let Q;\n    let mu;\n    let sigma;\n    let gamma;\n    let y;\n\n    const z = new NumberW(0);\n\n    if (ISNAN(p) || ISNAN(size) || ISNAN(prob)) {\n      return NaN;\n    }\n\n    /* this happens if specified via mu, size, since\n       prob == size/(size+mu)\n    */\n    if (prob === 0 && size === 0) return 0;\n\n    if (prob <= 0 || prob > 1 || size < 0) {\n      return ML_ERR_return_NAN(printer_qnbinom);\n    }\n\n    if (prob === 1 || size === 0) return 0;\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n    Q = 1.0 / prob;\n    P = (1.0 - prob) * Q;\n    mu = size * P;\n    sigma = sqrt(size * P * Q);\n    gamma = (Q + P) / sigma;\n\n    /* Note : \"same\" code in qpois.c, qbinom.c, qnbinom.c --\n     * FIXME: This is far from optimal [cancellation for p ~= 1, etc]: */\n    if (!lower_tail || log_p) {\n      p = R_DT_qIv(\n        lower_tail,\n        log_p,\n        p\n      ); /* need check again (cancellation!): */\n      if (p === R_DT_0(lower_tail, log_p)) return 0;\n      if (p === R_DT_1(lower_tail, log_p)) return ML_POSINF;\n    }\n    /* temporary hack --- FIXME --- */\n    if (p + 1.01 * DBL_EPSILON >= 1) return ML_POSINF;\n\n    /* y := approx.value (Cornish-Fisher expansion) :  */\n    z.val = qnorm(p, 0, 1, /*lower_tail*/ true, /*log_p*/ false);\n    y = R_forceint(mu + sigma * (z.val + gamma * (z.val * z.val - 1) / 6));\n\n    z.val = pnbinom(y, size, prob, /*lower_tail*/ true, /*log_p*/ false);\n\n    /* fuzz to ensure left continuity: */\n    p *= 1 - 64 * DBL_EPSILON;\n\n    /* If the C-F value is not too large a simple search is OK */\n    if (y < 1e5) return do_search(y, z, p, size, prob, 1);\n    /* Otherwise be a bit cleverer in the search */\n    {\n      let incr = floor(y * 0.001);\n      let oldincr;\n      do {\n        oldincr = incr;\n        y = do_search(y, z, p, size, prob, incr);\n        incr = fmax2(1, floor(incr / 100));\n      } while (oldincr > 1 && incr > y * 1e-15);\n      return y;\n    }\n \n}\n\nexport function qnbinom_mu(\n  p: number,\n  size: number,\n  mu: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n  return qnbinom(p, size, /* prob = */ size / (size + mu), lower_tail, log_p);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\n\nimport { rgammaOne } from '../gamma/rgamma';\nimport { rpoisOne } from '../poisson/rpois';\nimport { randomGenHelper } from '../r-func'\nimport { IRNGNormal } from '../rng/normal/inormal-rng';\n\nconst { isFinite: R_FINITE } = Number;\n\nconst printer_rnbinom = debug('rnbinom');\n\nexport function rnbinom(\n  n: number | number[],\n  size: number,\n  prob: number,\n  rng: IRNGNormal\n): number[] {\n  printer_rnbinom('n:%d, size:%d, prob:%d', n, size, prob);\n  return randomGenHelper(n, rnbinomOne, size, prob, rng)\n}\n\nexport function rnbinomOne(\n  size: number,\n  prob: number,\n  rng: IRNGNormal\n): number | number[] {\n\n  if (\n    !R_FINITE(size) ||\n    !R_FINITE(prob) ||\n    size <= 0 ||\n    prob <= 0 ||\n    prob > 1\n  ) {\n    /* prob = 1 is ok, PR#1218 */\n    return ML_ERR_return_NAN(printer_rnbinom);\n  }\n  return prob === 1\n    ? 0\n    : (rpoisOne(\n      rgammaOne(size, (1 - prob) / prob, rng),\n      rng\n    ) as number);\n\n}\n\nconst printer_rnbinom_mu = debug('rnbinom_mu');\n\nexport function rnbinom_mu(n: number | number[] = 1, size: number, mu: number, rng: IRNGNormal): number[] {\n  printer_rnbinom_mu('n:%d, size:%d, mu:%d', n, size, mu);\n  return randomGenHelper(n, _rnbinom_mu, size, mu, rng)\n}\n\nfunction _rnbinom_mu(size: number, mu: number, rng: IRNGNormal): number {\n\n\n  if (!R_FINITE(size) || !R_FINITE(mu) || size <= 0 || mu < 0) {\n    return ML_ERR_return_NAN(printer_rnbinom_mu);\n  }\n  return mu === 0\n    ? 0\n    : (rpoisOne(\n      rgammaOne(size, mu / size, rng),\n      rng\n    ) as number);\n\n}\n\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dcauchy } from './dcauchy';\nimport { pcauchy } from './pcauchy';\nimport { qcauchy } from './qcauchy';\nimport { rcauchy } from './rcauchy';\n\nimport { MersenneTwister } from '../rng/mersenne-twister';\n\nexport function Cauchy(rng = new MersenneTwister(0)) {\n  return {\n    rcauchy: (n: number, location = 0, scale = 1) =>\n      rcauchy(n, location, scale, rng),\n    dcauchy,\n    pcauchy,\n    qcauchy\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\n\nconst { isNaN: ISNAN } = Number;\nconst { PI: M_PI, log } = Math;\nconst printer = debug('dcauchy');\n\nexport function dcauchy(\n  x: number,\n  location = 0,\n  scale = 1,\n  giveLog = false\n): number {\n  \n    let y: number;\n    /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(location) || ISNAN(scale)) {\n      return x + location + scale;\n    }\n\n    if (scale <= 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    y = (x - location) / scale;\n    return giveLog\n      ? -log(M_PI * scale * (1 + y * y))\n      : 1 / (M_PI * scale * (1 + y * y));\n \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D_val, R_DT_0, R_DT_1 } from '../common/_general';\n\nimport { R_D_Clog } from '../common/_general';\nimport { atanpi } from '../trigonometry';\n\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { abs: fabs } = Math;\n\nconst printer = debug('pcauchy');\n\nexport function pcauchy(\n  x: number,\n  location = 0,\n  scale = 1,\n  lowerTail = true,\n  logP = false\n): number {\n\n\n  if (ISNAN(x) || ISNAN(location) || ISNAN(scale))\n    return x + location + scale;\n\n  if (scale <= 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  x = (x - location) / scale;\n  if (ISNAN(x)) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (!R_FINITE(x)) {\n    if (x < 0) return R_DT_0(lowerTail, logP);\n    else return R_DT_1(lowerTail, logP);\n  }\n\n  if (!lowerTail) x = -x;\n  /* for large x, the standard formula suffers from cancellation.\n   * This is from Morten Welinder thanks to  Ian Smith's  atan(1/x) : */\n\n  if (fabs(x) > 1) {\n    let y = atanpi(1 / x);\n    return x > 0 ? R_D_Clog(logP, y) : R_D_val(logP, -y);\n  } else {\n    return R_D_val(logP, 0.5 + atanpi(x));\n  }\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_Q_P01_check } from '../common/_general';\n\nimport { tanpi } from '../trigonometry/tanpi';\n\nconst { expm1, exp } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst { ML_POSINF, ML_NEGINF } = {\n  ML_POSINF: Infinity,\n  ML_NEGINF: -Infinity\n};\n\nconst printer = debug('qcauchy');\n\nexport function qcauchy(\n  p: number,\n  location = 0,\n  scale = 1,\n  lowerTail = true,\n  logP = false\n): number {\n  \n    if (ISNAN(p) || ISNAN(location) || ISNAN(scale)) return NaN;\n    let lower_tail = lowerTail;\n\n    let rc = R_Q_P01_check(logP, p);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (scale <= 0 || !R_FINITE(scale)) {\n      if (scale === 0) return location;\n      /* else */ return ML_ERR_return_NAN(printer);\n    }\n\n    const my_INF = location + (lower_tail ? scale : -scale) * ML_POSINF;\n    if (logP) {\n      if (p > -1) {\n        /* when ep := exp(p),\n       * tan(pi*ep)= -tan(pi*(-ep))= -tan(pi*(-ep)+pi) = -tan(pi*(1-ep)) =\n       *\t\t = -tan(pi*(-expm1(p))\n       * for p ~ 0, exp(p) ~ 1, tan(~0) may be better than tan(~pi).\n       */\n        if (p === 0)\n          /* needed, since 1/tan(-0) = -Inf  for some arch. */\n          return my_INF;\n        lower_tail = !lower_tail;\n        p = -expm1(p);\n      } else p = exp(p);\n    } else {\n      if (p > 0.5) {\n        if (p === 1) return my_INF;\n        p = 1 - p;\n        lower_tail = !lower_tail;\n      }\n    }\n\n    if (p === 0.5) return location; // avoid 1/Inf below\n    if (p === 0) return location + (lower_tail ? scale : -scale) * ML_NEGINF; // p = 1. is handled above\n    return location + (lower_tail ? -scale : scale) / tanpi(p);\n    /*\t-1/tan(pi * p) = -cot(pi * p) = tan(pi * (p - 1/2))  */\n  \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func';\nimport { IRNG } from '../rng';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { PI: M_PI } = Math;\nconst printer = debug('rcauchy');\n\nexport function rcauchy(n: number,\n  location = 0,\n  scale = 1,\n  rng: IRNG): number[] {\n  return randomGenHelper(n, rcauchyOne, location, scale, rng);\n}\n\nexport function rcauchyOne(\n\n  location = 0,\n  scale = 1,\n  rng: IRNG\n): number {\n\n  if (ISNAN(location) || !R_FINITE(scale) || scale < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  if (scale === 0 || !R_FINITE(location)) return location;\n  else return location + scale * Math.tan(M_PI * (rng.internal_unif_rand()));\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { Inversion, IRNGNormal } from '../rng/normal';\nimport { dchisq as _dchisq } from './dchisq';\nimport { dnchisq as _dnchisq } from './dnchisq';\nimport { pchisq as _pchisq } from './pchisq';\nimport { pnchisq as _pnchisq } from './pnchisq';\nimport { qchisq as _qchisq } from './qchisq';\nimport { qnchisq as _qnchisq } from './qnchisq';\nimport { rchisq as _rchisq } from './rchisq';\nimport { rnchisq as _rnchisq } from './rnchisq';\n\nexport function ChiSquared(rng: IRNGNormal = new Inversion()) {\n  function rchisq(n: number|number[] = 1, df: number, ncp?: number) {\n    return ncp === undefined\n      ? _rchisq(n, df, rng)\n      : _rnchisq(n, df, ncp, rng);\n  }\n\n  function qchisq(\n    p: number,\n    df: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    return ncp === undefined\n      ? _qchisq(p, df, lowerTail, logP)\n      : _qnchisq(p, df, ncp, lowerTail, logP);\n  }\n\n  function pchisq(\n    p: number,\n    df: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    return ncp === undefined\n      ? _pchisq(p, df, lowerTail, logP)\n      : _pnchisq(p, df, ncp, lowerTail, logP);\n  }\n\n  function dchisq(\n    x: number,\n    df: number,\n    ncp?: number,\n    log: boolean = false\n  ) {\n    return ncp === undefined ? _dchisq(x, df, log) : _dnchisq(x, df, ncp, log);\n  }\n\n  return {\n      dchisq,\n      pchisq,\n      qchisq,\n      rchisq\n  };\n}\n","\nimport { NumberW } from '../common/toms708';\nimport { do_del } from './do_del';\n\nconst {  log, abs: fabs} = Math;\n\n\nimport {\n    M_1_SQRT_2PI,\n    M_SQRT_32,\n    R_D__0,\n    R_D__1\n  } from '../common/_general';\n\nconst {\n    EPSILON: DBL_EPSILON,\n    MIN_VALUE: DBL_MIN\n  } = Number;\n\nexport function pnorm_both(\n    x: number,\n    cum: NumberW,\n    ccum: NumberW,\n    i_tail: boolean,\n    log_p: boolean\n  ) {\n    /* i_tail in {0,1,2} means: \"lower\", \"upper\", or \"both\" :\n         if(lower) return  *cum := P[X <= x]\n         if(upper) return *ccum := P[X >  x] = 1 - P[X <= x]\n      */\n    const a = [\n      2.2352520354606839287,\n      161.02823106855587881,\n      1067.6894854603709582,\n      18154.981253343561249,\n      0.065682337918207449113\n    ];\n    const b = [\n      47.20258190468824187,\n      976.09855173777669322,\n      10260.932208618978205,\n      45507.789335026729956\n    ];\n    const c = [\n      0.39894151208813466764,\n      8.8831497943883759412,\n      93.506656132177855979,\n      597.27027639480026226,\n      2494.5375852903726711,\n      6848.1904505362823326,\n      11602.651437647350124,\n      9842.7148383839780218,\n      1.0765576773720192317e-8\n    ];\n    const d = [\n      22.266688044328115691,\n      235.38790178262499861,\n      1519.377599407554805,\n      6485.558298266760755,\n      18615.571640885098091,\n      34900.952721145977266,\n      38912.003286093271411,\n      19685.429676859990727\n    ];\n    const p = [\n      0.21589853405795699,\n      0.1274011611602473639,\n      0.022235277870649807,\n      0.001421619193227893466,\n      2.9112874951168792e-5,\n      0.02307344176494017303\n    ];\n    const q = [\n      1.28426009614491121,\n      0.468238212480865118,\n      0.0659881378689285515,\n      0.00378239633202758244,\n      7.29751555083966205e-5\n    ];\n  \n    let xden;\n    let xnum;\n    let temp;\n    \n    let xsq;\n    let y;\n  \n    let min = DBL_MIN;\n  \n    let lower: boolean;\n    let upper: boolean;\n  \n    /* will never happen\n    if (ISNAN(x)) {\n      cum.val = ccum.val = x;\n      return;\n    }*/\n  \n    /* Consider changing these : */\n    const eps = DBL_EPSILON * 0.5; //1.1102230246251565e-16\n  \n    /* i_tail in {0,1,2} =^= {lower, upper, both} */\n    lower = i_tail !== true;\n    upper = i_tail !== false;\n  \n    y = fabs(x);\n    if (y <= 0.67448975) {\n      /* qnorm(3/4) = .6744.... -- earlier had 0.66291 */\n      if (y > eps) {\n        xsq = x * x;\n        xnum = a[4] * xsq;\n        xden = xsq;\n        for (let i = 0; i < 3; ++i) {\n          xnum = (xnum + a[i]) * xsq;\n          xden = (xden + b[i]) * xsq;\n        }\n      } else {\n        xnum = xden = 0.0;\n      }\n  \n      temp = x * (xnum + a[3]) / (xden + b[3]);\n      if (lower) cum.val = 0.5 + temp;\n      if (upper) ccum.val = 0.5 - temp;\n      if (log_p) {\n        if (lower) cum.val = log(cum.val);\n        if (upper) ccum.val = log(ccum.val);\n      }\n    } else if (y <= M_SQRT_32) {\n      /* Evaluate pnorm for 0.674.. = qnorm(3/4) < |x| <= sqrt(32) ~= 5.657 */\n  \n      xnum = c[8] * y;\n      xden = y;\n      for (let i = 0; i < 7; ++i) {\n        xnum = (xnum + c[i]) * y;\n        xden = (xden + d[i]) * y;\n      }\n      temp = (xnum + c[7]) / (xden + d[7]);\n  \n      //function do_del(ccum: NumberW, cum: NumberW, log_p: boolean, X: number, temp: number, upper: number, lower: number, x: number):\n      /*\n          #define swap_tail\n              if (x > 0.) {// swap  ccum <--> cum \n                  temp = *cum; if(lower) *cum = *ccum; *ccum = temp; \\\n              }\n          */\n      /*\n     log_p,   x> 0 &&  lower,   x<=0 &&   higher, path \n      T              T            F               A+B\n      T              F            T               A+B\n      T              F            F               B  \n      F              X            X               C \n      */    \n      do_del(ccum, cum, log_p, y, temp, upper, lower, x);\n      //swap_tail;\n      if (x > 0) {\n        // swap  ccum <--> cum\n        temp = cum.val;\n        if (lower) {\n          cum.val = ccum.val;\n        }\n        ccum.val = temp;\n      }\n    } else if (\n      (log_p && y < 1e170) /* avoid underflow below */ ||\n      /*  ^^^^^ MM FIXME: can speedup for log_p and much larger |x| !\n           * Then, make use of  Abramowitz & Stegun, 26.2.13, something like\n      \n           xsq = x*x;\n      \n           if(xsq * DBL_EPSILON < 1.)\n              del = (1. - (1. - 5./(xsq+6.)) / (xsq+4.)) / (xsq+2.);\n           else\n              del = 0.;\n           *cum = -.5*xsq - M_LN_SQRT_2PI - log(x) + log1p(-del);\n           *ccum = log1p(-exp(*cum)); /.* ~ log(1) = 0 *./\n      \n            swap_tail;\n      \n           [Yes, but xsq might be infinite.]\n      \n          */\n      (lower && -37.5193 < x && x < 8.2924) ||\n      (upper && -8.2924 < x && x < 37.5193)\n    ) {\n      /* else\t  |x| > sqrt(32) = 5.657 :\n       * the next two case differentiations were really for lower=T, log=F\n       * Particularly\t *not*\tfor  log_p !\n      \n       * Cody had (-37.5193 < x  &&  x < 8.2924) ; R originally had y < 50\n       *\n       * Note that we do want symmetry(0), lower/upper -> hence use y\n       */\n      /* Evaluate pnorm for x in (-37.5, -5.657) union (5.657, 37.5) */\n      xsq = 1.0 / (x * x); /* (1./x)*(1./x) might be better */\n      xnum = p[5] * xsq;\n      xden = xsq;\n      for (let i = 0; i < 4; ++i) {\n        xnum = (xnum + p[i]) * xsq;\n        xden = (xden + q[i]) * xsq;\n      }\n      temp = xsq * (xnum + p[4]) / (xden + q[4]);\n      temp = (M_1_SQRT_2PI - temp) / y;\n       /*\n     log_p,   x> 0 &&  lower,   x<=0 &&   higher(upper), path \n      T              T            F                       A+B\n      T              F            T                       A+B\n      T              F            F                       B  \n      F              X            X                       C \n      */ \n      do_del(ccum, cum, log_p, x, temp, upper, lower, x);\n      //do_del(x);\n      //swap_tail;\n      if (x > 0) {\n        // swap  ccum <--> cum\n        temp = cum.val;\n        if (lower) {\n          cum.val = ccum.val;\n        }\n        ccum.val = temp;\n      }\n    } else {\n      /* large x such that probs are 0 or 1 */\n      if (x > 0) {\n        cum.val = R_D__1(log_p);\n        ccum.val = R_D__0(log_p);\n      } else {\n        cum.val = R_D__0(log_p);\n        ccum.val = R_D__1(log_p);\n      }\n    }\n  \n    /* do not return \"denormalized\" -- we do in R */\n    if (log_p) {\n      if (cum.val > -min) cum.val = -0;\n      if (ccum.val > -min) {\n        ccum.val = -0;\n      }\n    } else {\n      if (cum.val < min) cum.val = 0;\n      if (ccum.val < min) ccum.val = 0;\n    }\n  \n    return;\n  }\n  \n","import { NumberW } from '../common/toms708';\n\nconst { trunc } = Math;\nconst SIXTEN = 16; /* Cutoff allowing exact \"*\" and \"/\" */\nconst { log, exp, log1p } = Math;\n      \nexport function do_del(\n    ccum: NumberW,\n    cum: NumberW,\n    log_p: boolean,\n    X: number,\n    temp: number,\n    upper: boolean,\n    lower: boolean,\n    x: number\n  ): void {\n    let xsq = trunc(X * SIXTEN) / SIXTEN;\n    let del = (X - xsq) * (X + xsq);\n    if (log_p) {\n      //B\n      cum.val = -xsq * xsq * 0.5 + -del * 0.5 + log(temp);\n      if ((lower && x > 0) || (upper && x <= 0))\n        //A\n        ccum.val = log1p(-exp(-xsq * xsq * 0.5) * exp(-del * 0.5) * temp);\n    } else {\n      //C\n      cum.val = exp(-xsq * xsq * 0.5) * exp(-del * 0.5) * temp;\n      ccum.val = 1.0 - cum.val;\n    }\n  }\n\n  /*\n     log_p,   x> 0 &&  lower,   x<=0 &&   higher, path \n      T              T            F               A+B\n      T              F            T               A+B\n      T              F            F               B  \n      F              X            X               C \n  */ \n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst { max: fmax2, log1p, exp, abs: fabs } = Math;\n\nexport function logspace_add(logx: number, logy: number) {\n  return fmax2(logx, logy) + log1p(exp(-fabs(logx - logy)));\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dexp as _dexp } from './dexp';\nimport { pexp as _pexp } from './pexp';\nimport { qexp as _qexp } from './qexp';\nimport { rexp as _rexp } from './rexp';\n\nimport { IRNG, rng } from '../rng';\nconst { MersenneTwister } = rng;\n\nexport function Exponential(rng: IRNG = new MersenneTwister(0)) {\n  /*\n  NOTE: scale = 1/rate, the R code looks like\n      > rexp\n      function (n, rate = 1) \n        .Call(C_rexp, n, 1/rate)\n        <bytecode: 0x0000000005f90fd0>\n        <environment: namespace:stats>\n  */\n  return {\n    dexp: (x: number, rate = 1, asLog = false) =>\n      _dexp(x, 1 / rate, asLog),\n\n    pexp: (q: number, rate = 1, lowerTail = true, logP = false) =>\n      _pexp(q, 1 / rate, lowerTail, logP),\n\n    qexp: (p: number, rate = 1, lowerTail = true, logP = false) =>\n      _qexp(p, 1 / rate, lowerTail, logP),\n\n    rexp: (n: number, rate = 1) => _rexp(n, 1 / rate, rng)\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { ML_ERR_return_NAN, R_D__0 } from '../common/_general';\n\nimport * as debug from 'debug';\n\n\nconst { log, exp } = Math;\nconst { isNaN: ISNAN } = Number;\nconst printer = debug('dexp');\n\n\n\nexport function dexp(x: number, scale: number, give_log: boolean = false): number {\n  /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(scale)) {\n      return NaN;\n    }\n\n    if (scale <= 0.0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (x < 0) {\n      return R_D__0(give_log);\n    }\n    return give_log ? -x / scale - log(scale) : exp(-x / scale) / scale;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { ML_ERR_return_NAN, R_D_exp, R_DT_0 } from '../common/_general';\n\n\nimport * as debug from 'debug';\nimport { R_Log1_Exp } from './expm1';\n\nconst { expm1 } = Math;\nconst { isNaN: ISNAN } = Number;\nconst printer = debug('pexp');\n\nexport function pexp(\n  q: number,\n  scale: number,\n  lower_tail: boolean,\n  log_p: boolean\n): number {\n    if (ISNAN(q) || ISNAN(scale)) return q + scale;\n    if (scale < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (q <= 0) return R_DT_0(lower_tail, log_p);\n    /* same as weibull( shape = 1): */\n    q = -(q / scale);\n    return lower_tail\n      ? log_p ? R_Log1_Exp(q) : -expm1(q)\n      : R_D_exp(log_p, q);\n \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_DT_0, R_Q_P01_check } from '../common/_general';\n\nimport { R_DT_Clog } from './expm1';\n\nconst { isNaN: ISNAN } = Number;\nconst printer = debug('qexp');\n\nexport function qexp(p: number, scale: number, lower_tail: boolean, log_p: boolean): number {\n  \n    if (ISNAN(p) || ISNAN(scale)) return p + scale;\n\n    if (scale < 0) return ML_ERR_return_NAN(printer);\n\n    let rc = R_Q_P01_check(log_p, p);\n    if (rc !== undefined) {\n      return rc;\n    }\n    if (p === R_DT_0(lower_tail, log_p)) return 0;\n\n    return -scale * R_DT_Clog(lower_tail, log_p, p);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { ML_ERR_return_NAN } from '../common/_general';\n\nimport * as debug from 'debug';\nimport { randomGenHelper } from '../r-func'\nimport { IRNG } from '../rng/irng';\nimport { exp_rand } from './sexp';\n\nconst { isFinite: R_FINITE } = Number;\nconst printer = debug('rexp');\n\n\nexport function rexp(\n  n: number | number[],\n  scale: number,\n  rng: IRNG\n): number[] {\n  return randomGenHelper(n, rexpOne, scale, rng);\n}\n\nexport function rexpOne(\n  scale: number = 1,\n  rng: IRNG\n): number | number[] {\n\n    if (!R_FINITE(scale) || scale <= 0.0) {\n      if (scale === 0) return 0;\n      /* else */\n      return ML_ERR_return_NAN(printer);\n    }\n    return scale * exp_rand(rng.internal_unif_rand); // --> in ./sexp.c\n}\n","'use strict';\n/*\n *  Javascript conversion by Jacob Bogers Nov 2017\n *  jkfbogers@gmail.com\n *\n   The following code was taken from earlier versions of\n   http://www-cs-faculty.stanford.edu/~knuth/programs/rng.c-old\n   http://www-cs-faculty.stanford.edu/~knuth/programs/rng.c\n*/\n\n\nimport { fixup } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\nimport { TAOCP1997init } from './taocp-1997-init';\n/* helpers */\n/* helpers */\n/* helpers */\nconst MM = 1 << 30; /* the modulus */\nconst KK = 100; /* the long lag */\nconst LL = 37; /* the short lag */\nconst QUALITY = 1009; /* recommended quality level for high-res use */\nconst qualityBuffer = new ArrayBuffer(QUALITY * 4);\nconst ran_arr_buf = new Uint32Array(qualityBuffer); //uint32\nconst KT = 9.31322574615479e-10; /* = 2^-30 */\nconst mod_diff = (x: number, y: number) => (x - y) & (MM - 1);\n//const is_odd = (x: number) => x & 1; /* units bit of x */\n\nconst SEED_LEN = 101;\n\nexport class KnuthTAOCP extends IRNG {\n  private buf: ArrayBuffer;\n\n  private m_seed: Int32Array;\n\n  private get KT_pos() {\n    return this.m_seed[100];\n  }\n\n  private set KT_pos(v: number) {\n    this.m_seed[100] = v;\n  }\n\n  private fixupSeeds(): void {\n    if (this.KT_pos <= 0) this.KT_pos = 100;\n    /* check for all zeroes */\n    const s = this.m_seed.slice(0, 100);\n    if (s.find(v => !!v) === undefined) this.init(timeseed());\n    return;\n  }\n\n  private KT_next() {\n    const s = this.m_seed;\n    if (this.KT_pos >= 100) {\n      this.ran_arr_cycle();\n      this.KT_pos = 0;\n    }\n    return s[this.KT_pos++];\n  }\n\n  private RNG_Init_R_KT(_seed: number) {\n    this.m_seed.set(TAOCP1997init(_seed % 1073741821));\n    this.KT_pos = 100;\n    this.fixupSeeds();\n  }\n\n  private ran_arr_cycle(): number {\n    this.ran_array(ran_arr_buf, QUALITY);\n    ran_arr_buf[KK] = -1;\n    return ran_arr_buf[0];\n  }\n\n  private ran_array(aa: Uint32Array, n: number) {\n    let i;\n    let j;\n    const ran_x = this.m_seed;\n    for (j = 0; j < KK; j++) aa[j] = ran_x[j];\n    for (; j < n; j++) aa[j] = mod_diff(aa[j - KK], aa[j - LL]);\n    for (i = 0; i < LL; i++, j++) ran_x[i] = mod_diff(aa[j - KK], aa[j - LL]);\n    for (; i < KK; i++, j++) ran_x[i] = mod_diff(aa[j - KK], ran_x[i - LL]);\n  }\n\n  public constructor(_seed = timeseed()) {\n    super(_seed);\n  }\n\n  public _setup() {\n    this.buf = new ArrayBuffer(SEED_LEN * 4);\n    this._kind = IRNGType.KNUTH_TAOCP;\n    this._name = 'Knuth-TAOCP';\n    this.m_seed = new Int32Array(this.buf).fill(0);\n  }\n\n  public init(_seed: number  =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Uint32Array([0]);\n    s[0] = _seed;\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    this.RNG_Init_R_KT(s[0]);\n    super.init(_seed);\n  }\n\n  public set seed(_seed: number[]) {\n\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  internal_unif_rand(): number {\n     return fixup(this.KT_next() * KT);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { sequenceFactory } from '../../r-func';\n\nconst { trunc } = Math;\n\n\nexport function TAOCP1997init(seed: number): Uint32Array {\n  const KK = 100;\n  const LL = 37;\n  const MM = 1073741824; // pow(2, 30);\n  const MMF = 1073741824 - 1; //\n  const KKK = 199; //KK + KK - 1;\n  const KKL = 63; //KK - LL;\n\n  let ss = seed - seed % 2 + 2;\n  const X = new Uint32Array(KKK);\n  const arr = sequenceFactory(-1);\n  for (let j of arr(1, KK)) {\n    X[j] = ss;\n    ss = ss + ss;\n    if (ss >= MM) ss = ss - MM + 2;\n  }\n  X[1]++; //not js is zero based!!\n  ss = seed;\n  let T = 69;\n\n  while (T > 0) {\n    //console.log('TopT', T);\n    for (let j of arr(KK, 2, -1)) {\n      X[j + j] = X[j];\n    }\n    for (let j of arr(KKK, KKL + 1, -2)) {\n      X[KKK - j] = X[j] - X[j] % 2;\n    }\n\n    for (let j of arr(KKK, KK + 1, -1)) {\n      //console.log({ j2: j - KKL, j, x:X[j]});\n      if (X[j] % 2 === 1) {\n        X[j - KKL] = (X[j - KKL] - X[j]) & MMF;\n        X[j - KK] = (X[j - KK] - X[j]) & MMF;\n      }\n    }\n\n    if (ss & 1) {\n      for (let j of arr(KK, 1, -1)) {\n        X[j + 1] = X[j];\n      }\n      //console.log({xb:X[0], Xk:X[KK]} );\n      X[1 - 1] = X[KK + 1 - 1];\n      //  console.log({_xb:X[0], _Xk:X[KK]} );\n      //  console.log('');\n\n      if (X[KK + 1 - 1] % 2 === 1) {\n        X[LL + 1 - 1] = (X[LL + 1 - 1] - X[KK + 1 - 1]) & MMF;\n      }\n    }\n\n    if (ss) {\n      ss = trunc(ss / 2);\n    } else {\n      T = T - 1;\n    }\n  }\n\n  const res = new Uint32Array(KK);\n  res.set(X.slice(LL, KK));\n  res.set(X.slice(0, LL), KK - LL);\n  return res;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\n\n\nimport { fixup } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst QUALITY = 1009; /* recommended quality level for high-res use */\nconst SEED_LEN = 101;\nconst LL = 37; /* the short lag */\nconst KK = 100; /* the long lag */\nconst TT = 70; /* guaranteed separation between streams */\nconst MM = 1073741824; /* the modulus */\n\nfunction mod_diff(x: number, y: number) {\n  const d = new Uint32Array(3); // yes we need to do 32 bit all the way\n  d[0] = x;\n  d[1] = y;\n\n  d[2] = (d[0] - d[1]) & (MM - 1);\n  return d[2];\n}\n\nfunction is_odd(x: number): boolean {\n  return x % 2 === 1;\n}\n\n\nexport class KnuthTAOCP2002 extends IRNG {\n  //\n  //\n  private qualityBuffer: ArrayBuffer;\n  private ran_arr_buf: Uint32Array;\n  //\n  //\n\n  private m_seed: Uint32Array;\n  private ran_x: Uint32Array;\n\n  private get KT_pos() {\n    return this.m_seed[100];\n  }\n\n  private set KT_pos(v: number) {\n    this.m_seed[100] = v;\n  }\n\n  private ran_array(\n    aa: Uint32Array,\n    n: number /* put n new random numbers in aa */\n  ) {\n    let i: number;\n    let j: number;\n    for (j = 0; j < KK; j++) {\n      aa[j] = this.ran_x[j];\n    }\n    for (; j < n; j++) {\n      aa[j] = mod_diff(aa[j - KK], aa[j - LL]);\n    }\n    for (i = 0; i < LL; i++, j++) {\n      this.ran_x[i] = mod_diff(aa[j - KK], aa[j - LL]);\n    }\n    for (; i < KK; i++, j++) {\n      this.ran_x[i] = mod_diff(aa[j - KK], this.ran_x[i - LL]);\n    }\n  }\n\n  private ran_arr_cycle() {\n    this.ran_array(this.ran_arr_buf, QUALITY);\n    this.ran_arr_buf[KK] = -1;\n  }\n\n  private ran_start(_seed: number) {\n    //\n    let t: number;\n    let j: number;\n    //\n    const x = new Uint32Array(KK + KK - 1);\n    //\n    const ss = new Uint32Array(1);\n    const se = new Uint32Array([_seed]);\n    //\n    ss[0] = (se[0] + 2) & (MM - 2);\n    //\n    for (j = 0; j < KK; j++) {\n      x[j] = ss[0]; /* bootstrap the buffer */\n      ss[0] = ss[0] << 1;\n      if (ss[0] >= MM) {\n        ss[0] = ss[0] - (MM - 2); /* cyclic shift 29 bits */\n      }\n    }\n    //\n    //\n    //\n    x[1]++; /* make x[1] (and only x[1]) odd */\n    for (ss[0] = se[0] & (MM - 1), t = TT - 1; t; ) {\n      for (j = KK - 1; j > 0; j--) {\n        x[j + j] = x[j];\n        x[j + j - 1] = 0; /* \"square\" */\n      }\n      for (j = KK + KK - 2; j >= KK; j--) {\n        x[j - (KK - LL)] = mod_diff(x[j - (KK - LL)], x[j]);\n        x[j - KK] = mod_diff(x[j - KK], x[j]);\n      }\n      if (is_odd(ss[0])) {\n        /* \"multiply by z\" */\n        for (j = KK; j > 0; j--) {\n          x[j] = x[j - 1];\n        }\n        x[0] = x[KK]; /* shift the buffer cyclically */\n        x[LL] = mod_diff(x[LL], x[KK]);\n      }\n      if (ss[0]) {\n        ss[0] = ss[0] >>> 1;\n      } else {\n        t--;\n      }\n    }\n    for (j = 0; j < LL; j++) {\n      this.ran_x[j + KK - LL] = x[j];\n    }\n    for (; j < KK; j++) {\n      this.ran_x[j - LL] = x[j];\n    }\n    for (j = 0; j < 10; j++) {\n      this.ran_array(x, KK + KK - 1); /* warm things up */\n    }\n  }\n\n  private RNG_Init_KT2(_seed: number) {\n    this.ran_start(_seed % 1073741821);\n    this.KT_pos = 100;\n  }\n\n  private KT_next() {\n    if (this.KT_pos >= 100) {\n      this.ran_arr_cycle();\n      this.KT_pos = 0;\n    }\n    return this.ran_x[this.KT_pos++];\n  }\n\n  constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n  public _setup() {\n    this._kind = IRNGType.KNUTH_TAOCP2002;\n    this._name = 'Knuth-TAOCP-2002';\n    this.qualityBuffer = new ArrayBuffer(QUALITY * 4);\n    this.ran_arr_buf = new Uint32Array(this.qualityBuffer);\n    const buf = new ArrayBuffer(SEED_LEN * 4);\n    this.m_seed = new Uint32Array(buf).fill(0);\n    this.ran_x = this.m_seed;\n  }\n\n  internal_unif_rand(): number {\n    const KT = 9.31322574615479e-10;\n    return fixup(this.KT_next() * KT);\n  }\n\n  public init(_seed: number =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Uint32Array([0]);\n    s[0] = _seed;\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n\n    this.RNG_Init_KT2(s[0]);\n    super.init(_seed);\n  }\n  public set seed(_seed: number[]) {\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst SEED_LEN = 6;\nconst a12 = 1403580; //least 64 bits\nconst a13n = 810728;\nconst m2 = 4294944443;\nconst m1 = 4294967087;\nconst normc = 2.328306549295727688e-10;\nconst a21 = 527612;\nconst a23n = 1370589;\n\nexport class LecuyerCMRG extends IRNG {\n  private m_seed: Int32Array;\n\n\n  constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n  public _setup() {\n    this._kind = IRNGType.LECUYER_CMRG;\n    this._name = \"L'Ecuyer-CMRG\";\n    this.m_seed = new Int32Array(SEED_LEN).fill(0);\n  }\n\n  public init(se: number =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Int32Array([0]);\n\n    s[0] = se;\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    for (let j = 0; j < this.m_seed.length; j++) {\n      s[0] = 69069 * s[0] + 1;\n      while (s[0] >= m2) {\n        s[0] = 69069 * s[0] + 1;\n      }\n\n      this.m_seed[j] = s[0];\n    }\n    super.init(se);\n  }\n\n  internal_unif_rand(): number {\n\n    const II = this.m_seed;\n\n    //const pp2 = pow.bind(pow, 2);\n    //const break32 = pp2(32);\n\n    let k;\n    let p1;\n    let p2;\n\n    p1 = a12 * new Uint32Array([II[1]])[0] - a13n * new Uint32Array([II[0]])[0];\n    //here, p1 is around 50 bits, worst case\n    k = new Int32Array([p1 / m1])[0];\n    // here because k is capped to be 32 bits signed\n\n    p1 -= k * m1;\n    // here k*m1 is around 32*32 is 64 bits\n\n    if (p1 < 0.0) p1 += m1;\n\n    II[0] = II[1];\n    II[1] = II[2];\n    II[2] = new Int32Array([p1])[0];\n\n    p2 = a21 * new Uint32Array([II[5]])[0] - a23n * new Uint32Array([II[3]])[0];\n\n    k = new Int32Array([p2 / m2])[0];\n    p2 -= k * m2;\n    if (p2 < 0.0) p2 += m2;\n    II[3] = II[4];\n    II[4] = II[5];\n    II[5] = new Int32Array([p2])[0];\n\n    return (p1 > p2 ? p1 - p2 : p1 - p2 + m1) * normc;\n  }\n\n  public set seed(_seed: number[]) {\n\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { fixup, i2_32m1 } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst SEED_LEN = 2;\n//const buf = new ArrayBuffer(SEED_LEN * 4);\n\nexport class MarsagliaMultiCarry extends IRNG {\n\n  private m_seed: Int32Array;\n\n  private fixupSeeds(): void {\n    const s = this.m_seed;\n    if (s[0] === 0) s[0] = 1;\n    if (s[1] === 0) s[1] = 1;\n    return;\n  }\n\n  public constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n  public init(_seed: number = timeseed()) {\n    /* Initial scrambling */\n    const s = new Int32Array([_seed]);\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    for (let j = 0; j < this.m_seed.length; j++) {\n      s[0] = 69069 * s[0] + 1;\n      this.m_seed[j] = s[0];\n    }\n    this.fixupSeeds();\n    super.init(_seed);\n  }\n\n  public _setup() {\n    this._kind = IRNGType.MARSAGLIA_MULTICARRY;\n    this._name = 'Marsaglia-MultiCarry';\n    this.m_seed = new Int32Array( new ArrayBuffer(SEED_LEN * 4)).fill(0);\n  }\n\n  internal_unif_rand(): number {\n    const s = this.m_seed;\n    s[0] = 36969 * (s[0] & 65535) + (s[0] >>> 16);\n    s[1] = 18000 * (s[1] & 65535) + (s[1] >>> 16);\n\n    const un = new Uint32Array(SEED_LEN);\n    un[0] = s[0] << 16;\n    un[1] = s[1] & 0xffff;\n    un[0] = un[0] ^ un[1];\n\n    //const i2_32m1 = 2.328306437080797e-10; /* = 1/(2^32 - 1) */\n\n    return fixup(un[0] * i2_32m1); /* in [0,1) */\n  }\n\n  public set seed(_seed: number[]) {\n\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { fixup, i2_32m1 } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst SEED_LEN = 2;\nconst buf = new ArrayBuffer(SEED_LEN * 4);\n\nexport class SuperDuper extends IRNG {\n\n  private m_seed: Int32Array;\n\n  constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n  public _setup() {\n    this._kind = IRNGType.SUPER_DUPER;\n    this._name = 'Super-Duper';\n    this.m_seed = new Int32Array(buf).fill(0);\n  }\n\n  internal_unif_rand(): number {\n    const s = this.m_seed;\n    /* This is Reeds et al (1984) implementation;\n               * modified using __unsigned__\tseeds instead of signed ones\n               */\n\n    s[0] ^= (s[0] >>> 15) & 0x1ffff; /* ) 0377777 = 0x1FFFF Tausworthe */\n    s[0] ^= s[0] << 17;\n    s[1] *= 69069; /* Congruential */\n    const un = new Uint32Array(SEED_LEN);\n    un[0] = s[0];\n    un[1] = s[1];\n    un[0] = un[0] ^ un[1];\n    return fixup(un[0] * i2_32m1); /* in [0,1) */\n  }\n\n  private fixupSeeds(): void {\n    const s = this.m_seed;\n    if (s[0] === 0) s[0] = 1;\n    /* I2 = Congruential: must be ODD */\n    s[1] |= 1;\n    return;\n  }\n\n  public init(_seed: number  =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Uint32Array([_seed]);\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    for (let j = 0; j < this.m_seed.length; j++) {\n      s[0] = 69069 * s[0] + 1;\n      this.m_seed[j] = s[0];\n    }\n    this.fixupSeeds();\n    super.init(_seed);\n  }\n\n  public set seed(_seed: number[]) {\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst { trunc } = Math;\nconst frac = (x: number) => x - trunc(x);\n\nimport { fixup } from '../fixup';\nimport { IRNG } from '../irng';\nimport { IRNGType } from '../irng-type';\nimport { timeseed } from '../timeseed';\n\nconst SEED_LEN = 3;\n\nexport class WichmannHill extends IRNG {\n\n  private m_seed: Uint32Array;\n\n  constructor(_seed: number = timeseed()) {\n    super(_seed);\n  }\n\n\n  public _setup() {\n    this._kind = IRNGType.WICHMANN_HILL;\n    this._name = 'Wichmann-Hill';\n    const buf = new ArrayBuffer(SEED_LEN * 4);\n    this.m_seed = new Uint32Array(buf).fill(0);\n  }\n\n  internal_unif_rand(): number {\n    const s = this.m_seed;\n    s[0] = (s[0] * 171) % 30269;\n    s[1] = (s[1] * 172) % 30307;\n    s[2] = (s[2] * 170) % 30323;\n\n    let value = s[0] / 30269.0 + s[1] / 30307.0 + s[2] / 30323.0;\n\n    return fixup(frac(value)); /* in [0,1) */\n  }\n\n  public fixupSeeds(): void {\n    const s = this.m_seed;\n    s[0] = s[0] % 30269;\n    s[1] = s[1] % 30307;\n    s[2] = s[2] % 30323;\n\n    if (s[0] === 0) s[0] = 1;\n    if (s[1] === 0) s[1] = 1;\n    if (s[2] === 0) s[2] = 1;\n    return;\n  }\n\n  public init(seed: number =  timeseed()) {\n    /* Initial scrambling */\n    const s = new Uint32Array([seed]);\n\n    for (let j = 0; j < 50; j++) {\n      s[0] = 69069 * s[0] + 1;\n    }\n    for (let j = 0; j < this.m_seed.length; j++) {\n      s[0] = 69069 * s[0] + 1;\n      this.m_seed[j] = s[0];\n    }\n    this.fixupSeeds();\n    super.init(seed);\n  }\n\n  public set seed(_seed: number[]) {\n\n\n    if (_seed.length > this.m_seed.length || _seed.length === 0) {\n      this.init(timeseed());\n      return;\n    }\n    this.m_seed.set(_seed);\n  }\n\n  public get seed() {\n    return Array.from(this.m_seed);\n  }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n//needed for rf\nimport { rchisqOne } from '../chi-2/rchisq';\nimport { rnchisqOne } from '../chi-2/rnchisq';\nimport { randomGenHelper } from '../r-func';\nimport { Inversion, IRNGNormal } from '../rng/normal';\n//\nimport { df as _df } from './df';\nimport { dnf } from './dnf';\n//\nimport { pf as _pf } from './pf';\nimport { pnf } from './pnf';\n//\nimport { qf as _qf } from './qf';\nimport { qnf } from './qnf';\nimport { rfOne as _rfOne } from './rf';\n\nexport function FDist(rng: IRNGNormal = new Inversion()) {\n  function df(\n    x: number,\n    df1: number,\n    df2: number,\n    ncp?: number,\n    log: boolean = false\n  ) {\n    /*\n    function (x, df1, df2, ncp, log = FALSE) \n      {\n    if (missing(ncp)) \n        .Call(C_df, x, df1, df2, log)\n    else .Call(C_dnf, x, df1, df2, ncp, log)\n      }\n    */\n    if (ncp === undefined) {\n      return _df(x, df1, df2, log);\n    }\n    return dnf(x, df1, df2, ncp, log);\n  }\n  function pf(\n    q: number,\n    df1: number,\n    df2: number,\n    ncp?: number,\n    lowerTail = true,\n    logP = false\n  ) {\n    /*  if (missing(ncp)) \n        .Call(C_pf, q, df1, df2, lower.tail, log.p)\n    else .Call(C_pnf, q, df1, df2, ncp, lower.tail, log.p)\n*/\n    if (ncp === undefined) {\n      return _pf(q, df1, df2, lowerTail, logP);\n    }\n    return pnf(q, df1, df2, ncp, lowerTail, logP);\n  }\n\n  function qf(\n    p: number,\n    df1: number,\n    df2: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    if (ncp === undefined) {\n      return _qf(p, df1, df2, lowerTail, logP);\n    }\n    return qnf(p, df1, df2, ncp, lowerTail, logP);\n  }\n\n \n  function rf(n: number|number, n1: number, n2: number, rng: IRNGNormal): number[] {\n    return randomGenHelper(n, rfOne, n1, n2, rng);\n  }\n\n  function rfOne(df1: number, df2: number, ncp?: number) {\n\n    if (ncp === undefined) {\n      return _rfOne(df1, df2, rng);\n    }\n\n    if (Number.isNaN(ncp)) {\n      return NaN;\n    }\n\n\n    const numerator = rnchisqOne(df1, ncp, rng) / df1;\n    const denominator = rchisqOne(df2, rng) / df2;\n\n    return numerator / denominator;\n  }\n\n  return {\n    df,\n    pf,\n    qf,\n    rf\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D__0, R_D__1 } from '../common/_general';\n\nimport { dbinom_raw } from '../binomial/dbinom';\nimport { dgamma } from '../gamma/dgamma';\n\nconst { log } = Math;\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer_df = debug('df');\n\nexport function df(\n  x: number,\n  m: number,\n  n: number,\n  giveLog = false\n): number {\n  \n    let p: number;\n    let q: number;\n    let f: number;\n    let dens: number;\n\n    if (ISNAN(x) || ISNAN(m) || ISNAN(n)) {\n      return x + m + n;\n    }\n    if (m <= 0 || n <= 0) {\n      return ML_ERR_return_NAN(printer_df);\n    }\n    if (x < 0) {\n      return R_D__0(giveLog);\n    }\n    if (x === 0) {\n      return m > 2 ? R_D__0(giveLog) : m === 2 ? R_D__1(giveLog) : ML_POSINF;\n    }\n    if (!R_FINITE(m) && !R_FINITE(n)) {\n      /* both +Inf */\n      if (x === 1) {\n        return ML_POSINF;\n      } else {\n        return R_D__0(giveLog);\n      }\n    }\n    if (!R_FINITE(n)) {\n      /* must be +Inf by now */\n      return dgamma(x, m / 2, 2 / m, giveLog);\n    }\n    if (m > 1e14) {\n      /* includes +Inf: code below is inaccurate there */\n      dens = dgamma(1 / x, n / 2, 2 / n, giveLog);\n      return giveLog ? dens - 2 * log(x) : dens / (x * x);\n    }\n\n    f = 1 / (n + x * m);\n    q = n * f;\n    p = x * m * f;\n\n    if (m >= 2) {\n      f = m * q / 2;\n      dens = dbinom_raw((m - 2) / 2, (m + n - 2) / 2, p, q, giveLog);\n    } else {\n      f = m * m * q / (2 * p * (m + n));\n      dens = dbinom_raw(m / 2, (m + n) / 2, p, q, giveLog);\n    }\n    return giveLog ? log(f) + dens : f * dens;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_D__0 } from '../common/_general';\n\nimport { dnbeta } from '../beta/dnbeta';\nimport { dnchisq } from '../chi-2/dnchisq';\nimport { dgamma } from '../gamma/dgamma';\n\nconst { log1p, log } = Math;\n\nconst {\n  isFinite: R_FINITE,\n  isNaN: ISNAN,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer = debug('dnf');\n\nexport function dnf(\n  x: number,\n  df1: number,\n  df2: number,\n  ncp: number,\n  giveLog: boolean\n): number {\n    let y: number;\n    let z: number;\n    let f: number;\n\n    if (ISNAN(x) || ISNAN(df1) || ISNAN(df2) || ISNAN(ncp)) {\n      return x + df2 + df1 + ncp;\n    }\n\n    /* want to compare dnf(ncp=0) behavior with df() one, hence *NOT* :\n     * if (ncp == 0)\n     *   return df(x, df1, df2, give_log); */\n\n    if (df1 <= 0 || df2 <= 0 || ncp < 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n    if (x < 0) {\n      return R_D__0(giveLog);\n    }\n    if (!R_FINITE(ncp)) {\n      /* ncp = +Inf -- FIXME?: in some cases, limit exists */\n      return ML_ERR_return_NAN(printer);\n    }\n\n    /* This is not correct for  df1 == 2, ncp > 0 - and seems unneeded:\n     *  if (x == 0.) return(df1 > 2 ? R_D__0 : (df1 == 2 ? R_D__1 : ML_POSINF));\n     */\n    if (!R_FINITE(df1) && !R_FINITE(df2)) {\n      /* both +Inf */\n      /* PR: not sure about this (taken from  ncp==0)  -- FIXME ? */\n      if (x === 1) return ML_POSINF;\n      else return R_D__0(giveLog);\n    }\n    if (!R_FINITE(df2))\n      /* i.e.  = +Inf */\n      return df1 * dnchisq(x * df1, df1, ncp, giveLog);\n    /*\t ==  dngamma(x, df1/2, 2./df1, ncp, give_log)  -- but that does not exist */\n    if (df1 > 1e14 && ncp < 1e7) {\n      /* includes df1 == +Inf: code below is inaccurate there */\n      f =\n        1 +\n        ncp / df1; /* assumes  ncp << df1 [ignores 2*ncp^(1/2)/df1*x term] */\n      z = dgamma(1 / x / f, df2 / 2, 2 / df2, giveLog);\n      return giveLog ? z - 2 * log(x) - log(f) : z / (x * x) / f;\n    }\n\n    y = df1 / df2 * x;\n    z = dnbeta(y / (1 + y), df1 / 2, df2 / 2, ncp, giveLog) as number;\n    return giveLog\n      ? z + log(df1) - log(df2) - 2 * log1p(y)\n      : z * (df1 / df2) / (1 + y) / (1 + y);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1, R_P_bounds_01 } from '../common/_general';\n\n//import { INormal } from '../exp/expm1'normal';\nimport { pbeta } from '../beta/pbeta';\nimport { pchisq } from '../chi-2/pchisq';\n\nconst {\n  isNaN: ISNAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  NaN: ML_NAN,\n  isFinite: ML_VALID\n} = Number;\n\nconst { LN2: M_LN2 } = Math;\n\nconst printer_pf = debug('pf');\n\nexport function pf(\n  q: number,\n  df1: number,\n  df2: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n     \n    if (ISNAN(q) || ISNAN(df1) || ISNAN(df2)) return q + df2 + df1;\n\n    if (df1 <= 0 || df2 <= 0) {\n      return ML_ERR_return_NAN(printer_pf);\n    }\n\n    let rc = R_P_bounds_01(lowerTail, logP, q, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    /* move to pchisq for very large values - was 'df1 > 4e5' in 2.0.q,\n       now only needed for df1 = Inf or df2 = Inf {since pbeta(0,*)=0} : */\n    if (df2 === ML_POSINF) {\n      if (df1 === ML_POSINF) {\n        if (q < 1) return R_DT_0(lowerTail, logP);\n        if (q === 1) return logP ? -M_LN2 : 0.5;\n        if (q > 1) return R_DT_1(lowerTail, logP);\n      }\n\n      return pchisq(q * df1, df1, lowerTail, logP);\n    }\n\n    if (df1 === ML_POSINF)\n      /* was \"fudge\"\t'df1 > 4e5' in 2.0.q */\n      return pchisq(df2 / q, df2, !lowerTail, logP);\n\n    /* Avoid squeezing pbeta's first parameter against 1 :  */\n    if (df1 * q > df2)\n      q = pbeta(df2 / (df2 + df1 * q), df2 / 2, df1 / 2, !lowerTail, logP);\n    else\n      q = pbeta(df1 * q / (df2 + df1 * q), df1 / 2, df2 / 2, lowerTail, logP);\n\n    return ML_VALID(q) ? q : ML_NAN;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_P_bounds_01 } from '../common/_general';\n\nimport { pnbeta2 } from '../beta/pnbeta';\nimport { pnchisq } from '../chi-2/pnchisq';\n\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer_pnf = debug('pnf');\nexport function pnf(\n  x: number,\n  df1: number,\n  df2: number,\n  ncp: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n \n    let y;\n\n    if (ISNAN(x) || ISNAN(df1) || ISNAN(df2) || ISNAN(ncp))\n      return x + df2 + df1 + ncp;\n\n    if (df1 <= 0 || df2 <= 0 || ncp < 0) return ML_ERR_return_NAN(printer_pnf);\n    if (!R_FINITE(ncp)) return ML_ERR_return_NAN(printer_pnf);\n    if (!R_FINITE(df1) && !R_FINITE(df2))\n      /* both +Inf */\n      return ML_ERR_return_NAN(printer_pnf);\n\n    let rc = R_P_bounds_01(lowerTail, logP, x, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n    if (df2 > 1e8)\n      /* avoid problems with +Inf and loss of accuracy */\n      return pnchisq(x * df1, df1, ncp, lowerTail, logP);\n\n    y = df1 / df2 * x;\n    return pnbeta2(\n      y / (1 + y),\n      1 / (1 + y),\n      df1 / 2,\n      df2 / 2,\n      ncp,\n      lowerTail,\n      logP\n    );\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { qbeta } from '../beta/qbeta';\nimport { qchisq } from '../chi-2/qchisq';\n\nconst printer = debug('qf');\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  NaN: ML_NAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  isFinite: ML_VALID\n} = Number;\n\nexport function qf<T>(\n  pp: T,\n  df1: number,\n  df2: number,\n  lower_tail: boolean,\n  log_p: boolean\n): T {\n  const fp: number[] = Array.isArray(pp) ? pp : ([pp] as any);\n  const result = fp.map(p => {\n    if (ISNAN(p) || ISNAN(df1) || ISNAN(df2)) return p + df1 + df2;\n\n    if (df1 <= 0 || df2 <= 0) return ML_ERR_return_NAN(printer);\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    /* fudge the extreme DF cases -- qbeta doesn't do this well.\n       But we still need to fudge the infinite ones.\n     */\n\n    if (df1 <= df2 && df2 > 4e5) {\n      if (!R_FINITE(df1))\n        /* df1 == df2 == Inf : */\n        return 1;\n      /* else */\n      return qchisq(p, df1, lower_tail, log_p) / df1;\n    }\n    if (df1 > 4e5) {\n      /* and so  df2 < df1 */\n      return df2 / qchisq(p, df2, !lower_tail, log_p);\n    }\n\n    // FIXME: (1/qb - 1) = (1 - qb)/qb; if we know qb ~= 1, should use other tail\n    p = (1 / qbeta(p, df2 / 2, df1 / 2, !lower_tail, log_p) - 1) * (df2 / df1);\n    return ML_VALID(p) ? p : ML_NAN;\n  });\n  return result.length === 1 ? result[0] : (result as any);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\n\nimport { qnbeta } from '../beta/qnbeta';\nimport { qnchisq } from '../chi-2/qnchisq';\n\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\n\nconst printer = debug('qnf');\n\nexport function qnf(\n  p: number,\n  df1: number,\n  df2: number,\n  ncp: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n    let y;\n\n    if (ISNAN(p) || ISNAN(df1) || ISNAN(df2) || ISNAN(ncp))\n      return p + df1 + df2 + ncp;\n\n    switch (true) {\n      case df1 <= 0 || df2 <= 0 || ncp < 0:\n      case !R_FINITE(ncp):\n      case !R_FINITE(df1) && !R_FINITE(df2):\n        return ML_ERR_return_NAN(printer);\n      default:\n        // pass through\n        break;\n    }\n    //if (df1 <= 0 || df2 <= 0 || ncp < 0) ML_ERR_return_NAN(printer);\n    //if (!R_FINITE(ncp)) ML_ERR_return_NAN;\n    //if (!R_FINITE(df1) && !R_FINITE(df2)) ML_ERR_return_NAN;\n    let rc = R_Q_P01_boundaries(lowerTail, logP, p, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (df2 > 1e8)\n      /* avoid problems with +Inf and loss of accuracy */\n      return qnchisq(p, df1, ncp, lowerTail, logP) / df1;\n\n    y = qnbeta(p, df1 / 2, df2 / 2, ncp, lowerTail, logP);\n    return y / (1 - y) * (df2 / df1);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { rchisqOne } from '../chi-2/rchisq';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { IRNGNormal } from '../rng/normal';\n\nconst printer = debug('rf');\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\n\nexport function rfOne(\n  n1: number,\n  n2: number,\n  rng: IRNGNormal\n): number {\n\n    let v1;\n    let v2;\n    if (ISNAN(n1) || ISNAN(n2) || n1 <= 0 || n2 <= 0) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    v1 = R_FINITE(n1) ? rchisqOne(n1, rng) / n1 : 1;\n    v2 = R_FINITE(n2) ? rchisqOne(n2, rng) / n2 : 1;\n    return v1 / v2;\n  \n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport {\n  DBL_MANT_DIG,\n  DBL_MAX_EXP,\n  DBL_MIN_EXP,\n  imin2,\n  M_LOG10_2,\n  R_pow_di\n} from '../common/_general';\nimport { NumberW } from '../common/toms708';\n\nconst printer = debug('dpsifn');\n\nconst {\n  NaN: ML_NAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  isNaN: ISNAN,\n  EPSILON: DBL_EPSILON\n} = Number;\n\nconst n_max = 100;\n\nconst {\n  pow,\n  abs: fabs,\n  max: fmax2,\n  min: fmin2,\n  exp,\n  log,\n  sin,\n  cos,\n  PI: M_PI,\n  round,\n  round: R_forceint\n} = Math;\n\n/* From R, currently only used for kode = 1, m = 1 : */\nfunction dpsifn(\n  x: number,\n  n: number,\n  kode: number,\n  m: number,\n  ans: number[],\n  nz: NumberW,\n  ierr: NumberW\n): void {\n  const bvalues = [\n    /* Bernoulli Numbers */\n    1.0,\n    -5.0e-1,\n    1.66666666666666667e-1,\n    -3.33333333333333333e-2,\n    2.38095238095238095e-2,\n    -3.33333333333333333e-2,\n    7.57575757575757576e-2,\n    -2.53113553113553114e-1,\n    1.16666666666666667,\n    -7.09215686274509804,\n    5.49711779448621554e1,\n    -5.29124242424242424e2,\n    6.1921231884057971e3,\n    -8.65802531135531136e4,\n    1.42551716666666667e6,\n    -2.7298231067816092e7,\n    6.01580873900642368e8,\n    -1.51163157670921569e10,\n    4.29614643061166667e11,\n    -1.37116552050883328e13,\n    4.88332318973593167e14,\n    -1.92965793419400681e16\n  ];\n  //  ints\n  let nx: number;\n  let xinc = 0 as number;\n  let xdmln = 0 as number;\n  let i; //i\n  let j; //j\n  let k; //k\n  let mm; //mm\n  let mx; //mx\n  let nn; //nn\n  let np; //np\n  let fn; //fn\n\n  //double\n  let arg;\n  let den;\n  let elim;\n  let eps;\n  let fln;\n  let fx;\n  let rln;\n  let rxsq;\n  let r1m4;\n  let r1m5;\n  let s;\n  let slope;\n  let t;\n  let ta;\n  let tk;\n  let tol;\n  let tols;\n  let tss;\n  let tst;\n  let tt;\n  let t1;\n  let t2;\n  let wdtol;\n  let xdmy = 0;\n  let xln = 0.0; /* -Wall */\n  let xm;\n  let xmin;\n  let xq;\n  let yint;\n  // array\n  let trm = new Array(23).fill(0);\n\n  let trmr = new Array(n_max + 1).fill(0);\n\n  ierr.val = 0;\n\n  if (n < 0 || kode < 1 || kode > 2 || m < 1) {\n    ierr.val = 1;\n    return;\n  }\n\n  if (x <= 0) {\n    /* use\tAbramowitz & Stegun 6.4.7 \"Reflection Formula\"\n         *\tpsi(k, x) = (-1)^k psi(k, 1-x)\t-  pi^{n+1} (d/dx)^n cot(x)\n         */\n    if (x === round(x)) {\n      /* non-positive integer : +Inf or NaN depends on n */\n      for (j = 0; j < m; j++ /* k = j + n : */)\n        ans[j] = (j + n) % 2 ? ML_POSINF : ML_NAN;\n      return;\n    }\n    /* This could cancel badly */\n    dpsifn(1 - x, n, /*kode = */ 1, m, ans, nz, ierr);\n    /* ans[j] === (-1)^(k+1) / gamma(k+1) * psi(k, 1 - x)\n         *\t     for j = 0:(m-1) ,\tk = n + j\n         */\n\n    /* Cheat for now: only work for\t m = 1, n in {0,1,2,3} : */\n    if (m > 1 || n > 3) {\n      /* doesn't happen for digamma() .. pentagamma() */\n      /* not yet implemented */\n      ierr.val = 4;\n      return;\n    }\n    x *= M_PI; /* pi * x */\n    if (n === 0) tt = cos(x) / sin(x);\n    else if (n === 1) tt = -1 / R_pow_di(sin(x), 2);\n    else if (n === 2) tt = 2 * cos(x) / R_pow_di(sin(x), 3);\n    else if (n === 3)\n      tt =\n        -2 *\n        (2 * R_pow_di(cos(x), 2) + 1) /\n        R_pow_di(sin(x), 4); /* can not happen! */\n    else tt = ML_NAN;\n    /* end cheat */\n\n    s = n % 2 ? -1 : 1; /* s = (-1)^n */\n    /* t := pi^(n+1) * d_n(x) / gamma(n+1)\t, where\n         *\t\t   d_n(x) := (d/dx)^n cot(x)*/\n    t1 = t2 = s = 1;\n    for (k = 0, j = k - n; j < m; k++ , j++ , s = -s) {\n      /* k === n+j , s = (-1)^k */\n      t1 *= M_PI; /* t1 === pi^(k+1) */\n      if (k >= 2) t2 *= k; /* t2 === k! === gamma(k+1) */\n      if (j >= 0)\n        /* by cheat above,  tt === d_k(x) */\n        ans[j] = s * (ans[j] + t1 / t2 * tt);\n    }\n    if (n === 0 && kode === 2)\n      /* unused from R, but \"wrong\": xln === 0 :*/\n      ans[0] += xln;\n    return;\n  } /* x <= 0 */\n\n  /* else :  x > 0 */\n  nz.val = 0;\n  xln = log(x);\n  if (kode === 1 && m === 1) {\n    /* the R case  ---  for very large x: */\n    let lrg = 1 / (2 * DBL_EPSILON);\n    if (n === 0 && x * xln > lrg) {\n      ans[0] = -xln;\n      return;\n    } else if (n >= 1 && x > n * lrg) {\n      ans[0] = exp(-n * xln) / n; /* === x^-n / n  ===  1/(n * x^n) */\n      return;\n    }\n  }\n  mm = m;\n  nx = imin2(-DBL_MIN_EXP, DBL_MAX_EXP); /* = 1021 */\n  r1m5 = M_LOG10_2;\n  r1m4 = Number.EPSILON * 0.5;\n  wdtol = fmax2(r1m4, 0.5e-18); /* 1.11e-16 */\n\n  /* elim = approximate exponential over and underflow limit */\n  elim = 2.302 * (nx * r1m5 - 3.0); /* = 700.6174... */\n\n  let L10 = false; // goto flag\n  let L20 = false;\n  let L30 = false;\n\n  while (true) {\n    nn = n + mm - 1;\n    fn = nn;\n    t = (fn + 1) * xln;\n\n    /* overflow and underflow test for small and large x */\n\n    if (fabs(t) > elim) {\n      if (t <= 0.0) {\n        nz.val = 0;\n        ierr.val = 2;\n        return;\n      }\n    } else {\n      if (x < wdtol) {\n        ans[0] = R_pow_di(x, -n - 1);\n        if (mm !== 1) {\n          for (k = 1; k < mm; k++) ans[k] = ans[k - 1] / x;\n        }\n        if (n === 0 && kode === 2) ans[0] += xln;\n        return;\n      }\n\n      /* compute xmin and the number of terms of the series,  fln+1 */\n\n      rln = r1m5 * DBL_MANT_DIG;\n      rln = fmin2(rln, 18.06);\n      fln = fmax2(rln, 3.0) - 3.0;\n      yint = 3.5 + 0.4 * fln;\n      slope = 0.21 + fln * (0.0006038 * fln + 0.008677);\n      xm = yint + slope * fn;\n      mx = (xm >> 0) + 1;\n      xmin = mx;\n      //\n      if (n !== 0) {\n        xm = -2.302 * rln - fmin2(0.0, xln);\n        arg = xm / n;\n        arg = fmin2(0.0, arg);\n        eps = exp(arg);\n        xm = 1.0 - eps;\n        if (fabs(arg) < 1.0e-3) xm = -arg;\n        fln = x * xm / eps;\n        xm = xmin - x;\n        if (xm > 7.0 && fln < 15.0) break;\n      }\n      xdmy = x;\n      xdmln = xln;\n      xinc = 0.0;\n      if (x < xmin) {\n        nx = x >> 0;\n        xinc = xmin - nx;\n        xdmy = x + xinc;\n        xdmln = log(xdmy);\n      }\n\n      /* generate w(n+mm-1, x) by the asymptotic expansion */\n\n      t = fn * xdmln;\n      t1 = xdmln + xdmln;\n      t2 = t + xdmln;\n      tk = fmax2(fabs(t), fmax2(fabs(t1), fabs(t2)));\n      if (tk <= elim) {\n        /* for all but large x */\n        L10 = true;\n        break;\n      } // if\n    } // if else\n    nz.val++; /* underflow */\n    mm--;\n    ans[mm] = 0;\n    if (mm === 0) {\n      return;\n    }\n  } /* end{for()} */\n  if (!L10) {\n    nn = (fln >> 0) + 1;\n    np = n + 1;\n    t1 = (n + 1) * xln;\n    t = exp(-t1);\n    s = t;\n    den = x;\n    for (i = 1; i <= nn; i++) {\n      den += 1;\n      trm[i] = pow(den, -np);\n      s += trm[i];\n    }\n    ans[0] = s;\n    if (n === 0 && kode === 2) ans[0] = s + xln;\n\n    if (mm !== 1) {\n      /* generate higher derivatives, j > n */\n\n      tol = wdtol / 5.0;\n      for (j = 1; j < mm; j++) {\n        t /= x;\n        s = t;\n        tols = t * tol;\n        den = x;\n        for (i = 1; i <= nn; i++) {\n          den += 1;\n          trm[i] /= den;\n          s += trm[i];\n          if (trm[i] < tols) break;\n        } //for\n        ans[j] = s;\n      } //for\n    }\n    return;\n  }\n  //L10:\n  tss = exp(-t);\n  tt = 0.5 / xdmy;\n  t1 = tt;\n  tst = wdtol * tt;\n  if (nn !== 0) t1 = tt + 1.0 / fn;\n  rxsq = 1.0 / (xdmy * xdmy);\n  ta = 0.5 * rxsq;\n  t = (fn + 1) * ta;\n  s = t * bvalues[2];\n  //\n\n  if (fabs(s) >= tst) {\n    tk = 2.0;\n    for (k = 4; k <= 22; k++) {\n      t = t * ((tk + fn + 1) / (tk + 1.0)) * ((tk + fn) / (tk + 2.0)) * rxsq;\n      trm[k] = t * bvalues[k - 1];\n      if (fabs(trm[k]) < tst) break;\n      s += trm[k];\n      tk += 2;\n    } //for\n  } //if\n  s = (s + t1) * tss;\n  // while (true) is a goto capture\n  while (true) {\n    if (xinc !== 0.0) {\n      /* backward recur from xdmy to x */\n\n      nx = xinc >> 0;\n      np = nn + 1;\n      if (nx > n_max) {\n        nz.val = 0;\n        ierr.val = 3;\n        return;\n      } else {\n        if (nn === 0) {\n          L20 = true;\n          break;\n        }\n        xm = xinc - 1.0;\n        fx = x + xm;\n\n        /* this loop should not be changed. fx is accurate when x is small */\n        for (i = 1; i <= nx; i++) {\n          trmr[i] = pow(fx, -np);\n          s += trmr[i];\n          xm -= 1;\n          fx = x + xm;\n        }\n      }\n    }\n\n    ans[mm - 1] = s;\n    if (fn === 0) {\n      L30 = true;\n      break;\n    }\n    /* generate lower derivatives,  j < n+mm-1 */\n    for (j = 2; j <= mm; j++) {\n      fn--;\n      tss *= xdmy;\n      t1 = tt;\n      if (fn !== 0) t1 = tt + 1.0 / fn;\n      t = (fn + 1) * ta;\n      s = t * bvalues[2];\n      if (fabs(s) >= tst) {\n        tk = 4 + fn;\n        for (k = 4; k <= 22; k++) {\n          trm[k] = trm[k] * (fn + 1) / tk;\n          if (fabs(trm[k]) < tst) break;\n          s += trm[k];\n          tk += 2;\n        }\n      }\n      s = (s + t1) * tss;\n      if (xinc !== 0.0) {\n        if (fn === 0) {\n          L20 = true;\n          break;\n        }\n        xm = xinc - 1.0;\n        fx = x + xm;\n        for (i = 1; i <= nx; i++) {\n          trmr[i] = trmr[i] * fx;\n          s += trmr[i];\n          xm -= 1;\n          fx = x + xm;\n        }\n      }\n      ans[mm - j] = s;\n      if (fn === 0) {\n        L30 = true;\n        break;\n        //goto L30;\n      }\n    } //for\n    return;\n  } // goto capture end\n  //L20:\n  printer(L20 ? 'goto L20 was set!' : 'goto L20 was not set');\n\n  if (!L30) {\n    for (i = 1; i <= nx; i++) {\n      s += 1 / (x + (nx - i));\n      /* avoid disastrous cancellation, PR#13714 */\n    }\n  }\n  //L30:\n  if (kode !== 2)\n    /* always */\n    ans[0] = s - xdmln;\n  else if (xdmy !== x) {\n    xq = xdmy / x;\n    ans[0] = s - log(xq);\n  }\n  return;\n} /* dpsifn() */\n\n/*\n#ifdef MATHLIB_STANDALONE\n# define ML_TREAT_psigam(_IERR_)\t\\\n    if(_IERR_ !== 0) {\t\t\t\\\n    errno = EDOM;\t\t\t\\\n    return ML_NAN;\t\t\t\\\n    }\n#else\n# define ML_TREAT_psigam(_IERR_)\t\\\n    if(_IERR_ !== 0)\t\t\t\\\n    return ML_NAN\n#endif\n*/\nconst print_psigamma = debug('psigamma');\n\nexport function psigamma(x: number, deriv: number): number {\n  /* n-th derivative of psi(x);  e.g., psigamma(x,0) === digamma(x) */\n  // double\n  let ans = [0];\n  // ints\n  let nz = new NumberW();\n  let ierr = new NumberW();\n\n  let k;\n  let n;\n  nz.val = 0;\n  ierr.val = 0;\n  ans[0] = 0;\n\n  if (ISNAN(x)) return x;\n  deriv = R_forceint(deriv);\n  n = deriv >> 0;\n  if (n > n_max) {\n    print_psigamma('\"deriv = %d > %d (= n_max)', n, n_max);\n    return ML_NAN;\n  }\n  dpsifn(x, n, 1, 1, ans, nz, ierr);\n  if (ierr.val !== 0) {\n    return ML_NAN;\n  }\n\n  /* Now, ans ===  A := (-1)^(n+1) / gamma(n+1) * psi(n, x) */\n  ans[0] = -ans[0]; /* = (-1)^(0+1) * gamma(0+1) * A */\n  for (k = 1; k <= n; k++) ans[0] *= -k; /* = (-1)^(k+1) * gamma(k+1) * A */\n  return ans[0]; /* = psi(n, x) */\n\n}\n\n//https://commons.wikimedia.org/wiki/File:Digamma_function_plot.png\n\nexport function digamma(x: number): number {\n  let ans = [0];\n  let nz = new NumberW();\n  let ierr = new NumberW();\n\n  ans[0] = 0;\n  nz.val = 0;\n  ierr.val = 0;\n  if (ISNAN(x)) return x;\n  dpsifn(x, 0, 1, 1, ans, nz, ierr);\n  if (ierr.val !== 0) {\n    return ML_NAN;\n  }\n  return -ans[0];\n}\n\n//https://commons.wikimedia.org/wiki/Category:Polygamma_function#/media/File:Trigamma_function_plot.png\n\nexport function trigamma(x: number): number {\n  let ans = [0];\n  let nz = new NumberW(0);\n  let ierr = new NumberW(0);\n\n\n  ans[0] = 0;\n  nz.val = 0;\n  ierr.val = 0;\n\n  if (ISNAN(x)) return x;\n  dpsifn(x, 1, 1, 1, ans, nz, ierr);\n  if (ierr.val !== 0) {\n    return ML_NAN;\n  }\n  return ans[0];\n\n}\n//https://commons.wikimedia.org/wiki/Category:Polygamma_function#/media/File:Tetragamma_function_plot.png\nexport function tetragamma(x: number): number {\n  let ans = [0];\n  let nz = new NumberW();\n  let ierr = new NumberW();\n\n  ans[0] = 0;\n  nz.val = 0;\n  ierr.val = 0;\n\n  if (ISNAN(x)) return x;\n  dpsifn(x, 2, 1, 1, ans, nz, ierr);\n  if (ierr.val !== 0) {\n    return ML_NAN;\n  }\n  return -2.0 * ans[0];\n}\n// replaced by psigamma function\nexport function pentagamma(x: number): number {\n  let ans = [0];\n  let nz = new NumberW();\n  let ierr = new NumberW();\n\n  ans[0] = 0;\n  nz.val = 0;\n  ierr.val = 0;\n\n  if (ISNAN(x)) return x;\n  dpsifn(x, 3, 1, 1, ans, nz, ierr);\n  if (ierr.val !== 0) {\n    return ML_NAN;\n  }\n  return 6.0 * ans[0];\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { Inversion, IRNGNormal } from '../rng/normal';\n\nimport { dgeom } from './dgeom';\nimport { pgeom } from './pgeom';\nimport { qgeom } from './qgeom';\nimport { rgeom as _rgeom } from './rgeom';\n\nexport function Geometric(rng: IRNGNormal = new Inversion()) {\n  return {\n    dgeom,\n    pgeom,\n    qgeom,\n    rgeom: (N: number, prob: number) => _rgeom(N, prob, rng)\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { dbinom_raw } from '../binomial/dbinom';\nimport { ML_ERR_return_NAN, R_D__0, R_D_nonint_check } from '../common/_general';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst { round: R_forceint, log } = Math;\n\nconst printer = debug('dgeom');\n\nexport function dgeom(x: number, p: number, giveLog: boolean = false): number {\n  \n    let prob: number;\n\n    if (ISNAN(x) || ISNAN(p)) return x + p;\n\n    if (p <= 0 || p > 1) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    let rc = R_D_nonint_check(giveLog, x, printer);\n    if (rc !== undefined) {\n      return rc;\n    }\n    if (x < 0 || !R_FINITE(x) || p === 0) {\n      return R_D__0(giveLog);\n    }\n    x = R_forceint(x);\n\n    /* prob = (1-p)^x, stable for small p */\n    prob = dbinom_raw(0, x, p, 1 - p, giveLog);\n\n    return giveLog ? log(p) + prob : p * prob;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1 } from '../common/_general';\n\nimport { R_DT_Clog } from '../exp/expm1';\n\nconst { expm1, log1p, log, exp, floor } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('pgeom');\n\nexport function pgeom(\n  x: number,\n  p: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n\n    if (ISNAN(x) || ISNAN(p)) return x + p;\n\n    if (p <= 0 || p > 1) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (x < 0) return R_DT_0(lowerTail, logP);\n    if (!R_FINITE(x)) return R_DT_1(lowerTail, logP);\n    x = floor(x + 1e-7);\n\n    if (p === 1) {\n      /* we cannot assume IEEE */\n      x = lowerTail ? 1 : 0;\n      return logP ? log(x) : x;\n    }\n    x = log1p(-p) * (x + 1);\n    if (logP) return R_DT_Clog(lowerTail, logP, x);\n    else return lowerTail ? -expm1(x) : exp(x);\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { R_DT_Clog } from '../exp/expm1';\n\nconst { ceil, max: fmax2, log1p } = Math;\nconst { POSITIVE_INFINITY: ML_POSINF, isNaN: ISNAN } = Number;\nconst printer = debug('qgeom');\n\nexport function qgeom(\n  p: number,\n  prob: number,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n\n    if (prob <= 0 || prob > 1) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (ISNAN(p) || ISNAN(prob)) return p + prob;\n\n    if (prob === 1) return 0;\n    /* add a fuzz to ensure left continuity, but value must be >= 0 */\n    return fmax2(\n      0,\n      ceil(R_DT_Clog(lower_tail, log_p, p) / log1p(-prob) - 1 - 1e-12)\n    );\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { exp_rand } from '../exp/sexp';\nimport { rpoisOne } from '../poisson/rpois';\nimport { IRNGNormal } from '../rng/normal';\n\nconst { isFinite: R_FINITE } = Number;\n\nconst printer = debug('rgeom');\n\nexport function rgeom(n, p, rng): number[] {\n   return Array.from({length:n}).map(() => rgeomOne(p, rng))\n}\n\nexport function rgeomOne(\n  p: number,\n  rng: IRNGNormal\n): number {\n\n    if (!R_FINITE(p) || p <= 0 || p > 1) return ML_ERR_return_NAN(printer);\n\n    return rpoisOne(\n      exp_rand(rng.internal_unif_rand) * ((1 - p) / p),\n      rng\n    ) as number;\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dhyper } from './dhyper';\nimport { phyper } from './phyper';\nimport { qhyper } from './qhyper';\nimport { rhyper as _rhyper } from './rhyper';\n\nimport { IRNG } from '../rng/irng';\nimport { MersenneTwister } from '../rng/mersenne-twister';\n\n\nexport function HyperGeometric(rng: IRNG = new MersenneTwister()) {\n  //rhyper(nn, m, n, k)\n  function rhyper(N: number, nn1in: number, nn2in: number, kkin: number) {\n    return _rhyper(N, nn1in, nn2in, kkin, rng);\n  }\n\n  return {\n    dhyper,\n    phyper,\n    qhyper,\n    rhyper\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_D_Lval, R_DT_0, R_DT_1 } from '../common/_general';\nimport { R_DT_log } from '../exp/expm1';\nimport { dhyper } from './dhyper';\n\nconst { floor, round: R_forceint, log1p } = Math;\nconst { EPSILON: DBL_EPSILON, isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\n//NOTE: p[d]hyper is not  typo!!\n//const printer_pdhyper = debug('pdhyper');\n\nfunction pdhyper(\n  x: number,\n  NR: number,\n  NB: number,\n  n: number,\n  log_p: boolean\n): number {\n  /*\n     * Calculate\n     *\n     *\t    phyper (x, NR, NB, n, TRUE, FALSE)\n     *   [log]  ----------------------------------\n     *\t       dhyper (x, NR, NB, n, FALSE)\n     *\n     * without actually calling phyper.  This assumes that\n     *\n     *     x * (NR + NB) <= n * NR\n     *\n     */\n\n  let sum = 0;\n  let term = 1;\n\n  while (x > 0 && term >= DBL_EPSILON * sum) {\n    term *= x * (NB - n + x) / (n + 1 - x) / (NR + 1 - x);\n    sum += term;\n    x--;\n  }\n\n  let ss = sum;\n  return log_p ? log1p(ss) : 1 + ss;\n}\n\n/* FIXME: The old phyper() code was basically used in ./qhyper.c as well\n * -----  We need to sync this again!\n*/\nconst printer_phyper = debug('phyper');\n\nexport function phyper(\n  x: number,\n  nr: number,\n  nb: number,\n  nn: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  /* Sample of  n balls from  NR red  and\t NB black ones;\t x are red */\n\n    let d: number;\n    let pd: number;\n    let lower_tail = lowerTail; //copy it gets changed\n    let log_p = logP;\n    let NR = nr;\n    let NB = nb;\n    let n = nn;\n    if (ISNAN(x) || ISNAN(NR) || ISNAN(NB) || ISNAN(n)) return x + NR + NB + n;\n\n    x = floor(x + 1e-7);\n    NR = R_forceint(NR);\n    NB = R_forceint(NB);\n    n = R_forceint(n);\n\n    if (NR < 0 || NB < 0 || !R_FINITE(NR + NB) || n < 0 || n > NR + NB) {\n      return ML_ERR_return_NAN(printer_phyper);\n    }\n\n    if (x * (NR + NB) > n * NR) {\n      /* Swap tails.\t*/\n      let oldNB = NB;\n      NB = NR;\n      NR = oldNB;\n      x = n - x - 1;\n      lower_tail = !lower_tail;\n    }\n\n    if (x < 0) return R_DT_0(lower_tail, log_p);\n    if (x >= NR || x >= n) return R_DT_1(lower_tail, log_p);\n\n    d = dhyper(x, NR, NB, n, log_p);\n    pd = pdhyper(x, NR, NB, n, log_p);\n\n    return log_p\n      ? R_DT_log(lower_tail, log_p, d + pd)\n      : R_D_Lval(lower_tail, d * pd);\n\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n//\nimport { rbinomOne } from '../binomial/rbinom';\nimport {\n  imax2,\n  imin2,\n  M_LN_SQRT_2PI,\n  ML_ERR_return_NAN\n} from '../common/_general';\nimport { IRNG } from '../rng/irng';\nimport { qhyper } from './qhyper';\n//\nconst { log, round: R_forceint, exp, sqrt } = Math;\nconst { isFinite: R_FINITE, MAX_SAFE_INTEGER: INT_MAX } = Number;\nconst printer_afc = debug('afc');\n\n// afc(i) :=  ln( i! )\t[logarithm of the factorial i]\nexport function afc(i: number): number {\n  // If (i > 7), use Stirling's approximation, otherwise use table lookup.\n  const al = [\n    0.0 /*ln(0!)=ln(1)*/,\n    0.0 /*ln(1!)=ln(1)*/,\n    0.69314718055994530941723212145817 /*ln(2) */,\n    1.7917594692280550008124773583807 /*ln(6) */,\n    3.17805383034794561964694160129705 /*ln(24)*/,\n    4.78749174278204599424770093452324,\n    6.57925121201010099506017829290394,\n    8.52516136106541430016553103634712\n    /* 10.60460290274525022841722740072165, approx. value below =\n           10.6046028788027; rel.error = 2.26 10^{-9}\n\n          FIXME: Use constants and if(n > ..) decisions from ./stirlerr.c\n          -----  will be even *faster* for n > 500 (or so)\n        */\n  ];\n\n  if (i < 0) {\n    printer_afc('rhyper.c: afc(i), i=%d < 0 -- SHOULD NOT HAPPEN!', i);\n    return -1; // unreached\n  }\n  if (i <= 7) {\n    return al[i];\n  }\n  // else i >= 8 :\n  let di = i;\n  let i2 = di * di;\n  return (\n    (di + 0.5) * log(di) -\n    di +\n    M_LN_SQRT_2PI +\n    (0.0833333333333333 - 0.00277777777777778 / i2) / di\n  );\n}\n\nexport function rhyper(\n  N: number,\n  nn1in: number,\n  nn2in: number,\n  kkin: number,\n  rng: IRNG\n): number[] {\n\n  return Array.from({length:N}).map(() => rhyperOne(nn1in, nn2in, kkin, rng));\n}\n\n//     rhyper(NR, NB, n) -- NR 'red', NB 'blue', n drawn, how many are 'red'\nconst printer_rhyper = debug('_rhyper');\n\nfunction rhyperOne(\n  nn1in: number,\n  nn2in: number,\n  kkin: number,\n  rng: IRNG\n): number {\n  /* extern double afc(int); */\n\n  let nn1 = 0;\n  let nn2 = 0;\n  let kk = 0;\n  let ix = 0; // return value (coerced to double at the very end)\n  let setup1 = false;\n  let setup2 = false;\n\n  /* These should become 'thread_local globals' : */\n  let ks = -1;\n  let n1s = -1;\n  let n2s = -1;\n  let m = 0;\n  let minjx = 0;\n  let maxjx = 0;\n  let k = 0;\n  let n1 = 0;\n  let n2 = 0; // <- not allowing larger integer par\n  let tn = 0;\n\n  // II :\n  let w = 0;\n  // III:\n  let a = 0;\n  let d = 0;\n  let s = 0;\n  let xl = 0;\n  let xr = 0;\n  let kl = 0;\n  let kr = 0;\n  let lamdl = 0;\n  let lamdr = 0;\n  let p1 = 0;\n  let p2 = 0;\n  let p3 = 0;\n\n  /* check parameter validity */\n\n  if (!R_FINITE(nn1in) || !R_FINITE(nn2in) || !R_FINITE(kkin))\n    return ML_ERR_return_NAN(printer_rhyper);\n\n  nn1in = R_forceint(nn1in);\n  nn2in = R_forceint(nn2in);\n  kkin = R_forceint(kkin);\n\n  if (nn1in < 0 || nn2in < 0 || kkin < 0 || kkin > nn1in + nn2in)\n    return ML_ERR_return_NAN(printer_rhyper);\n  if (nn1in >= INT_MAX || nn2in >= INT_MAX || kkin >= INT_MAX) {\n    /* large n -- evade integer overflow (and inappropriate algorithms)\n           -------- */\n    // FIXME: Much faster to give rbinom() approx when appropriate; -> see Kuensch(1989)\n    // Johnson, Kotz,.. p.258 (top) mention the *four* different binomial approximations\n    if (kkin === 1) {\n      // Bernoulli\n      return rbinomOne(kkin, nn1in / (nn1in + nn2in), rng);\n    }\n    // Slow, but safe: return  F^{-1}(U)  where F(.) = phyper(.) and  U ~ U[0,1]\n    return qhyper(rng.internal_unif_rand(), nn1in, nn2in, kkin, false, false);\n  }\n  nn1 = nn1in;\n  nn2 = nn2in;\n  kk = kkin;\n\n  /* if new parameter values, initialize */\n  if (nn1 !== n1s || nn2 !== n2s) {\n    setup1 = true;\n    setup2 = true;\n  } else if (kk !== ks) {\n    setup1 = false;\n    setup2 = true;\n  } else {\n    setup1 = false;\n    setup2 = false;\n  }\n  if (setup1) {\n    n1s = nn1;\n    n2s = nn2;\n    tn = nn1 + nn2;\n    if (nn1 <= nn2) {\n      n1 = nn1;\n      n2 = nn2;\n    } else {\n      n1 = nn2;\n      n2 = nn1;\n    }\n  }\n  if (setup2) {\n    ks = kk;\n    if (kk + kk >= tn) {\n      k = tn - kk;\n    } else {\n      k = kk;\n    }\n  }\n  if (setup1 || setup2) {\n    m = (k + 1) * (n1 + 1) / (tn + 2);\n    minjx = imax2(0, k - n2);\n    maxjx = imin2(n1, k);\n\n    printer_rhyper(\n      'rhyper(nn1=%d, nn2=%d, kk=%d), setup: floor(mean)= m=%d, jx in (%d..%d)',\n      nn1,\n      nn2,\n      kk,\n      m,\n      minjx,\n      maxjx\n    );\n  }\n  /* generate random variate --- Three basic cases */\n\n  //let goto_L_finis = false;\n  if (minjx === maxjx) {\n    /* I: degenerate distribution ---------------- */\n\n    printer_rhyper('rhyper(), branch I (degenerate)');\n\n    ix = maxjx;\n    //goto_L_finis = true;\n    //goto L_finis; // return appropriate variate\n  } else if (m - minjx < 10) {\n    // II: (Scaled) algorithm HIN (inverse transformation) ----\n    const scale = 1e25; // scaling factor against (early) underflow\n    const con = 57.5646273248511421;\n    // 25*log(10) = log(scale) { <==> exp(con) == scale }\n    if (setup1 || setup2) {\n      let lw; // log(w);  w = exp(lw) * scale = exp(lw + log(scale)) = exp(lw + con)\n      if (k < n2) {\n        lw = afc(n2) + afc(n1 + n2 - k) - afc(n2 - k) - afc(n1 + n2);\n      } else {\n        lw = afc(n1) + afc(k) - afc(k - n2) - afc(n1 + n2);\n      }\n      w = exp(lw + con);\n    }\n    let p = 0;\n    let u = 0;\n    printer_rhyper('rhyper(), branch II; w = %d > 0', w);\n\n    //L10:\n    let goto_L10 = false;\n    while (true) {\n      p = w;\n      ix = minjx;\n      u = (rng.internal_unif_rand()) * scale;\n\n      printer_rhyper('  _new_ u = %d', u);\n\n      while (u > p) {\n        u -= p;\n        p *= (n1 - ix) * (k - ix);\n        ix++;\n        p = p / ix / (n2 - k + ix);\n        printer_rhyper('       ix=%d, u=%d, p=%d (u-p=%d)\\n', ix, u, p, u - p);\n        if (ix > maxjx) {\n          goto_L10 = true;\n          break;\n          //goto L10;\n          // FIXME  if(p == 0.)  we also \"have lost\"  => goto L10\n        }\n      }\n      if (!goto_L10) {\n        break;\n      }\n    }\n  } else {\n    /* III : H2PE Algorithm --------------------------------------- */\n    // never used??\n    //let u = 0;\n    // let v = 0;\n\n    if (setup1 || setup2) {\n      s = sqrt((tn - k) * k * n1 * n2 / (tn - 1) / tn / tn);\n\n      /* remark: d is defined in reference without int. */\n      /* the truncation centers the cell boundaries at 0.5 */\n\n      d = 1.5 * s + 0.5;\n      xl = m - d + 0.5;\n      xr = m + d + 0.5;\n      a = afc(m) + afc(n1 - m) + afc(k - m) + afc(n2 - k + m);\n      kl = exp(a - afc(xl) - afc(n1 - xl) - afc(k - xl) - afc(n2 - k + xl));\n      kr = exp(\n        a -\n        afc(xr - 1) -\n        afc(n1 - xr + 1) -\n        afc(k - xr + 1) -\n        afc(n2 - k + xr - 1)\n      );\n      lamdl = -log(xl * (n2 - k + xl) / (n1 - xl + 1) / (k - xl + 1));\n      lamdr = -log((n1 - xr + 1) * (k - xr + 1) / xr / (n2 - k + xr));\n      p1 = d + d;\n      p2 = p1 + kl / lamdl;\n      p3 = p2 + kr / lamdr;\n    }\n\n    printer_rhyper(\n      'rhyper(), branch III {accept/reject}: (xl,xr)= (%d,%d); (lamdl,lamdr)= (%d,%d)\\n',\n      xl,\n      xr,\n      lamdl,\n      lamdr\n    );\n    printer_rhyper('-------- p123= c(%d,%d,%d)\\n', p1, p2, p3);\n\n    let n_uv = 0;\n    //L30:\n    //let goto_L30 = false;\n    while (true) {\n      let u: number = (rng.internal_unif_rand()) * p3;\n      let v: number = rng.internal_unif_rand();\n      n_uv++;\n      if (n_uv >= 10000) {\n        printer_rhyper(\n          'rhyper() branch III: giving up after %d rejections',\n          n_uv\n        );\n        return ML_ERR_return_NAN(printer_rhyper);\n      }\n\n      printer_rhyper(' ... L30: new (u=%d, v ~ U[0,1])[%d]\\n', u, n_uv);\n\n      if (u < p1) {\n        /* rectangular region */\n        ix = xl + u;\n      } else if (u <= p2) {\n        /* left tail */\n        ix = xl + log(v) / lamdl;\n        if (ix < minjx) {\n          //goto_L30 = true;\n          continue;\n          //goto L30;\n        }\n        v = v * (u - p1) * lamdl;\n      } else {\n        /* right tail */\n        ix = xr - log(v) / lamdr;\n        if (ix > maxjx) {\n          //goto_L30 = true;\n          continue;\n          //goto L30;\n        }\n        v = v * (u - p2) * lamdr;\n      }\n\n      /* acceptance/rejection test */\n      let reject = true;\n\n      if (m < 100 || ix <= 50) {\n        /* explicit evaluation */\n        /* The original algorithm (and TOMS 668) have\n                   f = f * i * (n2 - k + i) / (n1 - i) / (k - i);\n                   in the (m > ix) case, but the definition of the\n                   recurrence relation on p134 shows that the +1 is\n                   needed. */\n        let i;\n        let f = 1.0;\n        if (m < ix) {\n          for (i = m + 1; i <= ix; i++)\n            f = f * (n1 - i + 1) * (k - i + 1) / (n2 - k + i) / i;\n        } else if (m > ix) {\n          for (i = ix + 1; i <= m; i++)\n            f = f * i * (n2 - k + i) / (n1 - i + 1) / (k - i + 1);\n        }\n        if (v <= f) {\n          reject = false;\n        }\n      } else {\n        const deltal = 0.0078;\n        const deltau = 0.0034;\n\n        let e;\n        let g;\n        let r;\n        let t;\n        let y;\n        let de;\n        let dg;\n        let dr;\n        let ds;\n        let dt;\n        let gl;\n        let gu;\n        let nk;\n        let nm;\n        let ub;\n        let xk;\n        let xm;\n        let xn;\n        let y1;\n        let ym;\n        let yn;\n        let yk;\n        let alv;\n\n        printer_rhyper(\" ... accept/reject 'large' case v=%d\", v);\n\n        /* squeeze using upper and lower bounds */\n        y = ix;\n        y1 = y + 1.0;\n        ym = y - m;\n        yn = n1 - y + 1.0;\n        yk = k - y + 1.0;\n        nk = n2 - k + y1;\n        r = -ym / y1;\n        s = ym / yn;\n        t = ym / yk;\n        e = -ym / nk;\n        g = yn * yk / (y1 * nk) - 1.0;\n        dg = 1.0;\n        if (g < 0.0) dg = 1.0 + g;\n        gu = g * (1.0 + g * (-0.5 + g / 3.0));\n        gl = gu - 0.25 * (g * g * g * g) / dg;\n        xm = m + 0.5;\n        xn = n1 - m + 0.5;\n        xk = k - m + 0.5;\n        nm = n2 - k + xm;\n        ub =\n          y * gu -\n          m * gl +\n          deltau +\n          xm * r * (1 + r * (-0.5 + r / 3.0)) +\n          xn * s * (1 + s * (-0.5 + s / 3.0)) +\n          xk * t * (1 + t * (-0.5 + t / 3.0)) +\n          nm * e * (1 + e * (-0.5 + e / 3.0));\n        /* test against upper bound */\n        alv = log(v);\n        if (alv > ub) {\n          reject = true;\n        } else {\n          /* test against lower bound */\n          dr = xm * (r * r * r * r);\n          if (r < 0.0) dr /= 1.0 + r;\n          ds = xn * (s * s * s * s);\n          if (s < 0.0) ds /= 1.0 + s;\n          dt = xk * (t * t * t * t);\n          if (t < 0.0) dt /= 1.0 + t;\n          de = nm * (e * e * e * e);\n          if (e < 0.0) de /= 1.0 + e;\n          if (\n            alv <\n            ub - 0.25 * (dr + ds + dt + de) + (y + m) * (gl - gu) - deltal\n          ) {\n            reject = false;\n          } else {\n            /** Stirling's formula to machine accuracy\n             */\n            if (\n              alv <=\n              a - afc(ix) - afc(n1 - ix) - afc(k - ix) - afc(n2 - k + ix)\n            ) {\n              reject = false;\n            } else {\n              reject = true;\n            }\n          }\n        }\n      } // else\n      if (reject) {\n        //goto_L30 = true;\n        continue;\n      }\n      break;\n    } // for the goto_L30\n  }\n\n  //L_finis:\n  /* return appropriate variate */\n\n  if (kk + kk >= tn) {\n    if (nn1 > nn2) {\n      ix = kk - nn2 + ix;\n    } else {\n      ix = nn1 - ix;\n    }\n  } else {\n    if (nn1 > nn2) ix = kk - ix;\n  }\n  return ix;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG } from '../rng/irng';\nimport { MersenneTwister } from '../rng/mersenne-twister';\nimport { dlogis } from './dlogis';\nimport { plogis } from './plogis';\nimport { qlogis } from './qlogis';\nimport { rlogis as _rlogis } from './rlogis';\n\nexport function Logistic(rng: IRNG = new MersenneTwister(0)) {\n  //\n  function rlogis(N: number, location: number = 0, scale: number = 1) {\n    return _rlogis(N, location, scale, rng);\n  }\n\n  return {\n    dlogis,\n    plogis,\n    qlogis,\n    rlogis\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\n\nconst { log, exp, abs: fabs } = Math;\nconst { isNaN: ISNAN } = Number;\n\nconst printer_dlogis = debug('dlogis');\n\nexport function dlogis(\n  x: number,\n  location: number = 0,\n  scale: number = 1,\n  give_log: boolean = false\n): number {\n    let e: number;\n    let f: number;\n\n    if (ISNAN(x) || ISNAN(location) || ISNAN(scale)) return NaN;\n    if (scale <= 0.0) {\n      return ML_ERR_return_NAN(printer_dlogis);\n    }\n\n    x = fabs((x - location) / scale);\n    e = exp(-x);\n    f = 1.0 + e;\n    return give_log ? -(x + log(scale * f * f)) : e / (scale * f * f);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_P_bounds_Inf_01 } from '../common/_general';\n\n\nconst { exp, log1p } = Math;\nconst { isNaN: ISNAN } = Number;\n\n\nexport function Rf_log1pexp(x: number): number {\n  if (x <= 18) return log1p(exp(x));\n  if (x > 33.3) return x;\n  // else: 18.0 < x <= 33.3 :\n  return x + exp(-x);\n}\n\nconst printer_plogis = debug('plogis');\n\nexport function plogis(\n  x: number,\n  location: number = 0,\n  scale: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n\n  if (ISNAN(x) || ISNAN(location) || ISNAN(scale))\n    return x + location + scale;\n\n  if (scale <= 0.0) {\n    return ML_ERR_return_NAN(printer_plogis);\n  }\n\n  x = (x - location) / scale;\n  if (ISNAN(x)) {\n    return ML_ERR_return_NAN(printer_plogis);\n  }\n  let rc = R_P_bounds_Inf_01(lower_tail, log_p, x);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  if (log_p) {\n    // log(1 / (1 + exp( +- x ))) = -log(1 + exp( +- x))\n    return -Rf_log1pexp(lower_tail ? -x : x);\n  }\n  return 1 / (1 + exp(lower_tail ? -x : x));\n\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { R_Log1_Exp } from '../exp/expm1';\n\n\nconst {\n  isNaN: ISNAN,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF\n} = Number;\n\nconst { log } = Math;\n\nconst printer_qlogis = debug('qlogis');\n\nexport function qlogis(\n  p: number,\n  location: number = 0,\n  scale: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n\n    if (ISNAN(p) || ISNAN(location) || ISNAN(scale))\n      return p + location + scale;\n\n    let rc = R_Q_P01_boundaries(lower_tail, log_p, p, ML_NEGINF, ML_POSINF);\n    if (rc !== undefined) {\n      return rc;\n    }\n\n    if (scale < 0) {\n      return ML_ERR_return_NAN(printer_qlogis);\n    }\n    if (scale === 0) return location;\n\n    /* p := logit(p) = log( p / (1-p) )\t : */\n    if (log_p) {\n      if (lower_tail) p = p - R_Log1_Exp(p);\n      else p = R_Log1_Exp(p) - p;\n    } else p = log(lower_tail ? p / (1 - p) : (1 - p) / p);\n\n    return location + scale * p;\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { IRNG } from '../rng';\n\nconst { log } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer_rlogis = debug('rlogis');\n\n\nexport function rlogis( N: number, location: number = 0,\n  scale: number = 1,\n  rng: IRNG): number[] {\n    return Array.from({length:N}).map(() => rlogisOne(location, scale, rng));\n}\n\nexport function rlogisOne(\n  location: number = 0,\n  scale: number = 1,\n  rng: IRNG\n): number {\n\n    if (ISNAN(location) || !R_FINITE(scale)) {\n      return ML_ERR_return_NAN(printer_rlogis);\n    }\n\n    if (scale === 0 || !R_FINITE(location)) return location;\n    else {\n      let u: number = rng.internal_unif_rand();\n      return location + scale * log(u / (1 - u));\n    }\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { dlnorm } from './dlnorm';\nimport { plnorm } from './plnorm';\nimport { qlnorm } from './qlnorm';\nimport { rlnorm } from './rlnorm';\n\nimport { Inversion, IRNGNormal } from '../rng/normal';\n\nexport function LogNormal(rng: IRNGNormal = new Inversion()) {\n  return {\n    dlnorm,\n    plnorm,\n    qlnorm,\n    rlnorm: (n: number, meanlog: number = 0, sdlog: number = 1): number | number[] =>\n      rlnorm(n, meanlog, sdlog, rng)\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport {\n  M_1_SQRT_2PI,\n  M_LN_SQRT_2PI,\n  ML_ERR_return_NAN,\n  R_D__0\n} from '../common/_general';\n\nconst { isNaN: ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\nconst { log, exp } = Math;\nconst printer = debug('dlnorm');\n\nexport function dlnorm(\n  fx: number,\n  meanlog: number,\n  sdlog: number,\n  give_log: boolean\n): number {\n \n    if (ISNAN(fx) || ISNAN(meanlog) || ISNAN(sdlog)) {\n      return fx + meanlog + sdlog;\n    }\n    if (sdlog <= 0) {\n      if (sdlog < 0) {\n        return ML_ERR_return_NAN(printer);\n      }\n      // sdlog == 0 :\n      return log(fx) === meanlog ? ML_POSINF : R_D__0(give_log);\n    }\n    if (fx <= 0) {\n      return R_D__0(give_log);\n    }\n    let y = (log(fx) - meanlog) / sdlog;\n    return give_log\n      ? -(M_LN_SQRT_2PI + 0.5 * y * y + log(fx * sdlog))\n      : M_1_SQRT_2PI * exp(-0.5 * y * y) / (fx * sdlog);\n    /* M_1_SQRT_2PI = 1 / sqrt(2 * pi) */\n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_DT_0 } from '../common/_general';\nimport { pnorm5 as pnorm } from '../normal/pnorm';\n\nconst { isNaN: ISNAN } = Number;\nconst { log } = Math;\n\nconst printer = debug('plnorm');\n\nexport function plnorm(\n  x: number,\n  meanlog: number = 0,\n  sdlog: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n\n \n    if (ISNAN(x) || ISNAN(meanlog) || ISNAN(sdlog))\n      return x + meanlog + sdlog;\n\n    if (sdlog < 0) return ML_ERR_return_NAN(printer);\n\n    if (x > 0) return pnorm(log(x), meanlog, sdlog, lower_tail, log_p);\n    return R_DT_0(lower_tail, log_p);\n  \n\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { R_Q_P01_boundaries } from '../common/_general';\n\nimport { qnorm } from '../normal/qnorm';\n\nconst { exp } = Math;\nconst { isNaN: ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\n\nexport function qlnorm(\n  p: number,\n  meanlog: number = 0,\n  sdlog: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n  \n    if (ISNAN(p) || ISNAN(meanlog) || ISNAN(sdlog)) return p + meanlog + sdlog;\n\n    R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n\n    return exp(qnorm(p, meanlog, sdlog, lower_tail, log_p));\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { rnormOne } from '../normal/rnorm';\nimport { randomGenHelper } from '../r-func';\nimport { IRNGNormal } from '../rng/normal';\n\nconst { exp } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('rlnorm');\n\n\nexport function rlnorm(\n  N: number,\n  meanlog: number = 0,\n  sdlog: number = 1,\n  rng: IRNGNormal\n): number[] {\n  return randomGenHelper(N, rlnormOne, meanlog, sdlog, rng);\n}\n\nexport function rlnormOne(\n  meanlog: number = 0,\n  sdlog: number = 1,\n  rng: IRNGNormal\n): number {\n  if (ISNAN(meanlog) || !R_FINITE(sdlog) || sdlog < 0) {\n    return ML_ERR_return_NAN(printer);\n  }\n  return exp(rnormOne(meanlog, sdlog, rng));\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dmultinom, IdmultinomOptions } from './dmultinom';\nimport { rmultinom as _rmultinom } from './rmultinom';\n//FIXME: convert dmultinom from pure R to ts equivalent\n\nimport { IRNG } from '../rng/irng';\nimport { MersenneTwister } from '../rng/mersenne-twister';\n\nexport { IdmultinomOptions };\n\nexport function Multinomial(rng: IRNG = new MersenneTwister(0)) {\n  function rmultinom(n: number, size: number, prob: number | number[]) {\n    return _rmultinom(n, size, prob, rng);\n  }\n  return {\n    rmultinom,\n    dmultinom\n  };\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport special  from '../gamma';\nimport { array_flatten, sum } from '../r-func';\nconst { isFinite } = Number;\n\nconst { lgamma } = special;\n\n\nexport interface IdmultinomOptions {\n  x: number[];\n  size?: number;\n  prob: number[];\n  asLog?: boolean;\n}\n\nexport function dmultinom(\n  o: IdmultinomOptions\n): number {\n  // init\n  // first prob and x must have the same length\n  o.asLog = !!o.asLog;\n  let x: number[] = array_flatten(o.x).filter(f => !!f);\n  //\n  let prob: number[] = array_flatten(o.prob);\n  let badProb = !!prob.find(f => !isFinite(f) || f < 0);\n  let s = sum(prob);\n  if (badProb || s === 0) {\n    throw new Error('probabilities must be finite, non-negative and not all 0');\n  }\n  prob = prob.map(v => v / s);\n  x = x.map(Math.round);\n  if (x.find(v => v < 0)) {\n    throw new Error('probabilities must be finite, non-negative and not all 0');\n  }\n  const N = sum(x);\n  const size = !!o.size ? o.size : N;\n  if (size !== N) {\n    throw new Error(`size:${size} != sum(x):${N}, i.e. one is wrong`);\n  }\n  const i0 = prob.map(p => p === 0);\n  if (i0.includes(true)) {\n    if (i0.find((_v, i) => x[i] !== 0)) {\n      return o.asLog ? -Infinity : 0;\n    }\n    x = x.filter((_v, i) => i0[i]);\n    prob = prob.filter((_v, i) => i0[i]);\n  }\n  // checks after cleaning\n  const errMsg: string[] = [];\n  if (prob.length <= 1) {\n    errMsg.push(`number of propabilities need to be at least 2, it is:${prob.length}`);\n  }\n  if (x.length <= 1) {\n    errMsg.push(`number of quantiles need to be at least 2, it is :${x.length}`);\n  }\n  if (x.length !== prob.length) {\n    errMsg.push(`number of effective quantiles:${x.length} is not equal to number of effective probabilities:${prob.length}.`);\n  }\n  if (errMsg.length) {\n    throw new Error(errMsg.join('\\n'));\n  }\n  const s1 = x.map(v => v + 1).map(v => lgamma(v)); //(x.map(v=>v+1));\n  const s2 = prob.map(Math.log);\n  const s3 = x.map((v, i) => v * s2[i] - s1[i]);\n\n  const r = lgamma(size + 1) + sum(s3);\n  return o.asLog ? r : Math.exp(r);\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nconst { isFinite: R_FINITE } = Number;\nconst { abs: fabs } = Math;\n\nimport { rbinomOne } from '../binomial/rbinom';\nimport { flatten, randomGenHelper, sum } from '../r-func';\nimport { IRNG } from '../rng/irng';\n\nconst printer_rmultinom = debug('rmultinom');\n\n\nexport function rmultinom(\n  n: number,\n  size: number,\n  prob: number | number[],\n  rng: IRNG\n): number[] {\n  return randomGenHelper(n, rmultinomOne, size, prob, rng)\n}\n\n//workhorse\nexport function rmultinomOne(\n  size: number,\n  prob: number | number[],\n  rng: IRNG\n): number[] {\n  /* `Return' vector  rN[1:K] {K := length(prob)}\n     *  where rN[j] ~ Bin(n, prob[j]) ,  sum_j rN[j] == n,  sum_j prob[j] == 1,\n     */\n  const rN: number[] = [];\n  let p = Array.from(flatten(prob));\n  const K = p.length;\n  //let pp;\n  /* This calculation is sensitive to exact values, so we try to\n       ensure that the calculations are as accurate as possible\n       so different platforms are more likely to give the same\n       result. */\n  if (p.length === 0) {\n    printer_rmultinom('list of probabilities cannot be empty');\n    return rN;\n  }\n  if (size < 0) {\n    printer_rmultinom('Illegal Argument:size is negative');\n    rN.splice(0);\n    return rN;\n  }\n  /* Note: prob[K] is only used here for checking  sum_k prob[k] = 1 ;\n     *       Could make loop one shorter and drop that check !\n     */\n  //check probabilities\n  if (p.find(pp => !R_FINITE(pp) || pp < 0)) {\n    printer_rmultinom('some propbabilities are invalid or negative numbers');\n    rN.splice(0);\n    return rN;\n  }\n\n  rN.splice(0, rN.length, ...new Array(K).fill(0)); //remove, insert and init\n\n  if (size === 0) {\n    return rN;\n  }\n  /* Generate the first K-1 obs. via binomials */\n  // context vars for the next loop\n  let _size = size;\n  let p_tot = sum(p);\n\n  printer_rmultinom('%o', { p, p_tot, _size, K, rN });\n  for (let k = 0; k < K - 1; k++) {\n    //can happen, protect against devide by zero\n    if (fabs(p_tot) < Number.EPSILON) {\n      rN[k] = _size;\n      _size = 0;\n      p_tot = 0;\n      continue;\n    }\n\n    const pp = p[k] / p_tot;\n\n    if (pp === 0) {\n      rN[k] = 0;\n      continue;\n    }\n    // nothing left, rest will be zero\n    if (_size === 0) {\n      rN[k] = 0;\n      continue;\n    }\n    /* printf(\"[%d] %.17f\\n\", k+1, pp); */\n    rN[k] = pp < 1 ? (rbinomOne(_size, pp, rng) as number) : _size;\n    //adjust size\n    _size -= rN[k];\n    //adjust probabilities\n    p_tot -= p[k];\n    printer_rmultinom('%o', { p_tot, _size, k, rN });\n  }\n  rN[K - 1] = _size; //left over\n  return rN;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n'use strict';\nimport { dnorm4 as dnorm } from './dnorm';\nimport { pnorm5 as pnorm } from './pnorm';\nimport { qnorm } from './qnorm';\nimport { rnorm as _rnorm } from './rnorm';\n\nimport { IRNGNormal, rng as _rng } from '../rng';\nconst { normal: { Inversion } } = _rng;\n\n\nexport function Normal(prng: IRNGNormal = new Inversion()) {\n\n  return {\n    rnorm: (n = 1, mu = 0, sigma = 1) => _rnorm(n, mu, sigma, prng),\n    dnorm,\n    pnorm,\n    qnorm,\n    rng: prng,\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dpois } from './dpois';\nimport { ppois } from './ppois';\nimport { qpois } from './qpois';\nimport { rpois } from './rpois';\n\nimport { Inversion, IRNGNormal } from '../rng/normal';\n\n\nexport function Poisson(rng: IRNGNormal = new Inversion()) {\n  return {\n    dpois,\n    ppois,\n    qpois,\n    rpois: (n: number, lambda: number) => rpois(n, lambda, rng)\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { NumberW } from '../common/toms708';\n\nimport { ppois } from './ppois';\n\nimport { qnorm } from '../normal/qnorm';\n\nimport { R_DT_qIv } from '../exp/expm1'; \n\nconst { max: fmax2, sqrt, floor, round: nearbyint } = Math;\nconst {\n  isNaN: ISNAN,\n  EPSILON: DBL_EPSILON,\n  POSITIVE_INFINITY: ML_POSINF,\n  isFinite: R_FINITE\n} = Number;\n\nfunction do_search(\n  y: number,\n  z: NumberW,\n  p: number,\n  lambda: number,\n  incr: number\n): number {\n  if (z.val >= p) {\n    // search to the left\n    while (true) {\n      if (y === 0 || (z.val = ppois(y - incr, lambda, true, false)) < p)\n        return y;\n      y = fmax2(0, y - incr);\n    }\n  } else {\n    // search to the right\n\n    while (true) {\n      y = y + incr;\n      if ((z.val = ppois(y, lambda, true, false)) >= p) return y;\n    }\n  }\n}\n\n\n\nconst printer_qpois = debug('_qpois');\n\nexport function qpois(\n  p: number,\n  lambda: number,\n  lower_tail: boolean,\n  log_p: boolean\n  // normal: INormal\n): number {\n  let mu;\n  let sigma;\n  let gamma;\n  let y;\n  let z = new NumberW(0);\n\n  if (ISNAN(p) || ISNAN(lambda)) return p + lambda;\n\n  if (!R_FINITE(lambda)) {\n    return ML_ERR_return_NAN(printer_qpois);\n  }\n  if (lambda < 0) return ML_ERR_return_NAN(printer_qpois);\n  if (lambda === 0) return 0;\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  mu = lambda;\n  sigma = sqrt(lambda);\n  /* gamma = sigma; PR#8058 should be kurtosis which is mu^-0.5 */\n  gamma = 1.0 / sigma;\n\n  /* Note : \"same\" code in qpois.c, qbinom.c, qnbinom.c --\n     * FIXME: This is far from optimal [cancellation for p ~= 1, etc]: */\n  if (!lower_tail || log_p) {\n    p = R_DT_qIv(lower_tail, log_p, p); /* need check again (cancellation!): */\n    if (p === 0) return 0;\n    if (p === 1) return ML_POSINF;\n  }\n  /* temporary hack --- FIXME --- */\n  if (p + 1.01 * DBL_EPSILON >= 1) return ML_POSINF;\n\n  /* y := approx.value (Cornish-Fisher expansion) :  */\n  z.val = qnorm(p, 0, 1, /*lower_tail*/ true, /*log_p*/ false);\n\n  y = nearbyint(mu + sigma * (z.val + gamma * (z.val * z.val - 1) / 6));\n\n  z.val = ppois(y, lambda, /*lower_tail*/ true, /*log_p*/ false);\n\n  /* fuzz to ensure left continuity; 1 - 1e-7 may lose too much : */\n  p *= 1 - 64 * DBL_EPSILON;\n\n  /* If the mean is not too large a simple search is OK */\n  if (lambda < 1e5) return do_search(y, z, p, lambda, 1);\n  /* Otherwise be a bit cleverer in the search */\n  {\n    let incr = floor(y * 0.001);\n    let oldincr;\n    do {\n      oldincr = incr;\n      y = do_search(y, z, p, lambda, incr);\n      incr = fmax2(1, floor(incr / 100));\n    } while (oldincr > 1 && incr > lambda * 1e-15);\n    return y;\n  }\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { IRNG, rng } from '../rng';\nimport { dsignrank } from './dsign';\nimport { psignrank } from './psign';\nimport { qsignrank } from './qsign';\nimport { rsignrank as _rsignrank } from './rsign';\n\nconst { MersenneTwister } = rng;\n\nexport function SignRank(rng: IRNG = new MersenneTwister(0)) {\n\n  function rsignrank(N: number, n: number) {\n    return _rsignrank(N, n, rng);\n  }\n\n  return {\n    dsignrank,\n    psignrank,\n    qsignrank,\n    rsignrank\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_D__0, R_D_exp } from '../common/_general';\nimport { csignrank } from './csignrank';\n\nconst { round, trunc, abs: fabs, log, LN2: M_LN2 } = Math;\nconst { isNaN: ISNAN } = Number;\n\nconst printer_dsignrank = debug('dsignrank');\n\nexport function dsignrank(x: number, n: number, logX: boolean = false): number {\n  const rn = round(n);\n  const u = rn * (rn + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n  if (ISNAN(x) || ISNAN(n)) return x + n;\n\n  if (n <= 0) {\n    return ML_ERR_return_NAN(printer_dsignrank);\n  }\n  if (fabs(x - round(x)) > 1e-7) {\n    return R_D__0(logX);\n  }\n  x = round(x);\n  if (x < 0 || x > n * (n + 1) / 2) {\n    return R_D__0(logX);\n  }\n  let d = R_D_exp(logX, log(csignrank(trunc(x), n, u, c, w)) - n * M_LN2);\n  return d;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { imin2 } from '../common/_general';\n\nexport function csignrank(\n    k: number,\n    n: number,\n    u: number,\n    c: number,\n    w: number[]\n  ): number {\n    if (k < 0 || k > u) return 0;\n    if (k > c) k = u - k;\n  \n    if (n === 1) return 1;\n    if (w[0] === 1) return w[k];\n    w[0] = w[1] = 1;\n    for (let j = 2; j < n + 1; ++j) {\n      let i;\n      let end = imin2(j * (j + 1) / 2, c);\n      for (i = end; i >= j; --i) w[i] += w[i - j];\n    }\n    return w[k];\n  }\n  \n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1,\n  R_DT_val\n} from '../common/_general';\nimport { csignrank } from './signrank';\n\nconst { round, trunc, LN2: M_LN2, exp } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst printer_psignrank = debug('psignrank');\n\nexport function psignrank(\n  x: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  const roundN = round(n);\n  const u = roundN * (roundN + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n\n  x = round(x + 1e-7);\n  let lowerT = lowerTail; // temp copy on each iteration\n  if (ISNAN(x) || ISNAN(n)) return NaN;\n  if (!R_FINITE(n)) return ML_ERR_return_NAN(printer_psignrank);\n  if (n <= 0) return ML_ERR_return_NAN(printer_psignrank);\n\n  if (x < 0.0) {\n    return R_DT_0(lowerTail, logP);\n  }\n\n  if (x >= u) {\n    return R_DT_1(lowerTail, logP); //returns 1 on the edge case or 0 (because log(1)= 0)\n  }\n  let f = exp(-roundN * M_LN2);\n  let p = 0;\n  if (x <= u / 2) {\n    //smaller then mean\n    for (let i = 0; i <= x; i++) {\n      p += csignrank(i, roundN, u, c, w) * f;\n    }\n  } else {\n    x = n * (n + 1) / 2 - x;\n    for (let i = 0; i < x; i++) {\n      p += csignrank(i, roundN, u, c, w) * f;\n    }\n    lowerT = !lowerT; /* p = 1 - p; */\n  }\n  return R_DT_val(lowerT, logP, p);\n\n} /* psignrank() */\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1,\n  R_Q_P01_check\n} from '../common/_general';\nimport { R_DT_qIv } from '../exp/expm1';\nimport { csignrank } from './signrank';\n\nconst { round, trunc, LN2: M_LN2, exp } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\nconst printer_qsignrank = debug('qsignrank');\n\nexport function qsignrank(\n  x: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  const roundN = round(n);\n  const u = roundN * (roundN + 1) / 2;\n  const c = trunc(u / 2);\n  const w = Array.from<number>({ length: c + 1 }).fill(0);\n\n  if (ISNAN(x) || ISNAN(n)) {\n    return NaN;\n  }\n\n  if (/*!R_FINITE(x) ||*/ !R_FINITE(n)) {\n    return ML_ERR_return_NAN(printer_qsignrank);\n  }\n\n  let rc = R_Q_P01_check(logP, x);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  if (roundN <= 0) {\n    return ML_ERR_return_NAN(printer_qsignrank);\n  }\n\n  if (x === R_DT_0(lowerTail, logP)) {\n    return 0;\n  }\n\n  if (x === R_DT_1(lowerTail, logP)) {\n    return u;\n  }\n\n  if (logP || !lowerTail) {\n    x = R_DT_qIv(lowerTail, logP, x); // lower_tail, non-log \"p\"\n  }\n\n  //this.w_init_maybe(n);\n  let f = exp(-n * M_LN2);\n  let p = 0;\n  let q = 0;\n  if (x <= 0.5) {\n    x = x - 10 * DBL_EPSILON;\n    while (true) {\n      p += csignrank(q, roundN, u, c, w) * f;\n      if (p >= x) break;\n      q++;\n    }\n  } else {\n    x = 1 - x + 10 * DBL_EPSILON;\n    while (true) {\n      p += csignrank(q, roundN, u, c, w) * f;\n      if (p > x) {\n        q = trunc(u - q);\n        break;\n      }\n      q++;\n    }\n  }\n  return q;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { IRNG } from '../rng/irng';\n\nconst { isNaN: ISNAN } = Number;\nconst { floor, round } = Math;\nconst printer_rsignrank = debug('rsignrank');\n\nexport function rsignrank(nn: number, n: number, rng: IRNG): number | number[] {\n  return Array.from({ length: nn}).map(() => {\n    /* NaNs propagated correctly */\n    if (ISNAN(n)) return n;\n    const nRound = round(n);\n    if (nRound < 0) return ML_ERR_return_NAN(printer_rsignrank);\n\n    if (nRound === 0) return 0;\n    let r = 0.0;\n    let k = floor(nRound);\n    for (let i = 0; i < k /**/; ) {\n      r += ++i * floor((rng.internal_unif_rand()) + 0.5);\n    }\n    return r;\n  });\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { rchisq } from '../chi-2/rchisq';\nimport { rnorm } from '../normal/rnorm';\nimport { IRNGNormal } from '../rng/normal/inormal-rng';\nimport { Inversion } from '../rng/normal/inversion';\n//\nimport { dnt } from './dnt';\nimport { dt as _dt } from './dt';\nimport { pnt } from './pnt';\nimport { pt as _pt } from './pt';\nimport { qnt } from './qnt';\nimport { qt as _qt } from './qt';\n//\nimport { rt as _rt } from './rt';\n\n\nexport function StudentT(rng: IRNGNormal = new Inversion()) {\n  function dt(x: number , df: number, ncp?: number, asLog = false) {\n    if (ncp === undefined) {\n      return _dt(x, df, asLog);\n    }\n    return dnt(x, df, ncp, asLog);\n  }\n\n  function pt(\n    q: number,\n    df: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP = false\n  ) {\n    if (ncp === undefined) {\n      return _pt(q, df, lowerTail, logP);\n    }\n\n    return pnt(q, df, ncp, lowerTail, logP);\n  }\n\n  function qt(\n    p: number,\n    df: number,\n    ncp?: number,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    if (ncp === undefined) {\n      return _qt(p, df, lowerTail, logP);\n    }\n    return qnt(p, df, ncp, lowerTail, logP);\n  }\n\n  function rt(n: number, df: number, ncp?: number) {\n    if (ncp === undefined) {\n      return _rt(n, df, rng);\n    } else if (Number.isNaN(ncp)) {\n      return Array.from({length:n }).fill(NaN);\n    } else {\n     \n      const norm = rnorm(n, ncp, 1, rng); // bleed this first from rng\n      const chisq = rchisq(n, df, rng).map(v => v / df).map(Math.sqrt);\n      const result = norm.map((n, i) => n / chisq[i]);\n      return result;\n    }\n  }\n\n  return {\n    dt,\n    pt,\n    qt,\n    rt\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nimport { M_LN_SQRT_PI, ML_ERR_return_NAN, R_D__0 } from '../common/_general';\n\nimport { lgammafn_sign as lgammafn } from '../gamma/lgammafn_sign';\nimport { dnorm4 as dnorm } from '../normal/dnorm';\nimport { dt } from './dt';\nimport { pnt } from './pnt';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\nconst { abs: fabs, sqrt, log, exp } = Math;\n\nconst printer_dnt = debug('dnt');\nexport function dnt(\n  x: number,\n  df: number,\n  ncp: number = 0,\n  giveLog: boolean = false\n): number {\n\n  if (ISNAN(x) || ISNAN(df)) return x + df;\n\n  /* If non-positive df then error */\n  if (df <= 0.0) return ML_ERR_return_NAN(printer_dnt);\n\n  if (ncp === 0.0) return dt(x, df, giveLog);\n\n  /* If x is infinite then return 0 */\n  if (!R_FINITE(x)) return R_D__0(giveLog);\n\n  /* If infinite df then the density is identical to a\n     normal distribution with mean = ncp.  However, the formula\n     loses a lot of accuracy around df=1e9\n  */\n  if (!R_FINITE(df) || df > 1e8) return dnorm(x, ncp, 1, giveLog);\n\n  /* Do calculations on log scale to stabilize */\n\n  /* Consider two cases: x ~= 0 or not */\n  const u = function() {\n    if (fabs(x) > sqrt(df * DBL_EPSILON)) {\n      printer_dnt('fabs(x:%d)>sqrt(df*espsilon):%d', fabs(x), sqrt(df * DBL_EPSILON));\n      return (\n        log(df) -\n        log(fabs(x)) +\n        log(\n          fabs(\n            pnt(x * sqrt((df + 2) / df), df + 2, ncp, true, false) -\n            pnt(x, df, ncp, true, false)\n          )\n        )\n      );\n      /* FIXME: the above still suffers from cancellation (but not horribly) */\n    } else {\n      /* x ~= 0 : -> same value as for  x = 0 */\n      printer_dnt('fabs(x:%d)<=sqrt(df*espsilon):%d', fabs(x), sqrt(df * DBL_EPSILON));\n      return (\n        lgammafn((df + 1) / 2) -\n        lgammafn(df / 2) -\n        (M_LN_SQRT_PI + 0.5 * (log(df) + ncp * ncp))\n      );\n    }\n  }();\n  printer_dnt('u=%d, giveLog=%s', u, giveLog);\n  return giveLog ? u : exp(u);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\nimport { R_DT_qIv } from '../exp/expm1';\nimport { qnorm } from '../normal/qnorm';\nimport { pnt } from './pnt';\nimport { qt } from './qt';\n\nconst { abs: fabs, max: fmax2, min: fmin2 } = Math;\nconst {\n  MAX_VALUE: DBL_MAX,\n  EPSILON: DBL_EPSILON,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF,\n  NEGATIVE_INFINITY: ML_NEGINF,\n  isNaN: ISNAN\n} = Number;\nconst printer = debug('qnt');\n\n\nexport function qnt(\n  p: number,\n  df: number,\n  ncp: number,\n  lower_tail: boolean,\n  log_p: boolean\n) {\n  const accu = 1e-13;\n  const Eps = 1e-11; /* must be > accu */\n\n  let ux;\n  let lx;\n  let nx;\n  let pp;\n\n  if (ISNAN(p) || ISNAN(df) || ISNAN(ncp)) return p + df + ncp;\n\n  /* Was\n     * df = floor(df + 0.5);\n     * if (df < 1 || ncp < 0) ML_ERR_return_NAN;\n     */\n  if (df <= 0.0) return ML_ERR_return_NAN(printer);\n\n  if (ncp === 0.0 && df >= 1.0) return qt(p, df, lower_tail, log_p);\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, ML_NEGINF, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n  if (!R_FINITE(df))\n    // df = Inf ==> limit N(ncp,1)\n    return qnorm(p, ncp, 1, lower_tail, log_p);\n\n  p = R_DT_qIv(lower_tail, log_p, p);\n\n  /* Invert pnt(.) :\n     * 1. finding an upper and lower bound */\n  if (p > 1 - DBL_EPSILON) return ML_POSINF;\n  pp = fmin2(1 - DBL_EPSILON, p * (1 + Eps));\n  for (\n    ux = fmax2(1, ncp);\n    ux < DBL_MAX && pnt(ux, df, ncp, true, false) < pp;\n    ux *= 2\n  );\n  pp = p * (1 - Eps);\n  for (\n    lx = fmin2(-1, -ncp);\n    lx > -DBL_MAX && pnt(lx, df, ncp, true, false) > pp;\n    lx *= 2\n  );\n\n  /* 2. interval (lx,ux)  halving : */\n  do {\n    nx = 0.5 * (lx + ux); // could be zero\n    if (pnt(nx, df, ncp, true, false) > p) ux = nx;\n    else lx = nx;\n  } while (ux - lx > accu * fmax2(fabs(lx), fabs(ux)));\n\n  return 0.5 * (lx + ux);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { rchisqOne } from '../chi-2/rchisq';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func';\nimport { IRNGNormal } from '../rng/normal';\n\nconst { sqrt } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst printer = debug('rt');\n\nexport function rt(n: number| number[], df: number, rng: IRNGNormal) { \n  return randomGenHelper(n, rtOne, df, rng);\n}\n\nexport function rtOne(df: number, rng: IRNGNormal): number {\n  if (ISNAN(df) || df <= 0.0) {\n    return ML_ERR_return_NAN(printer);\n  }\n\n  if (!R_FINITE(df)) return rng.norm_randOne();\n\n  /* Some compilers (including MW6) evaluated this from right to left\n        return norm_rand() / sqrt(rchisq(df) / df); */\n\n  let num = rng.norm_randOne() as number;\n  return num / sqrt(rchisqOne(df, rng) / df);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { ptukey as _pt } from './ptukey';\nimport { qtukey as _qt } from './qtukey';\n\n\nexport function Tukey() {\n\n  /*\n  > ptukey\n  function (q, nmeans, df, nranges = 1, lower.tail = TRUE, log.p = FALSE)\n  .Call(C_ptukey, q, nranges, nmeans, df, lower.tail, log.p)\n  <bytecode: 0x000000001cde3048>\n  <environment: namespace:stats>\n  \n  double ptukey(\n    double q,  // q\n    double rr, // nranges\n    double cc, // nmeans\n    double df, // df\n    int lower_tail, // lowertail\n    int log_p       // logp\n  */\n\n  function ptukey(\n    q: number,\n    nmeans: number,\n    df: number,\n    nranges: number = 1,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  ) {\n    return _pt(q, nranges, nmeans, df, lowerTail, logP);\n  }\n  //\n  /*\n  /**\n> qtukey\nfunction (p, nmeans, df, nranges = 1, lower.tail = TRUE, log.p = FALSE)\n.Call(C_qtukey, p, nranges, nmeans, df, lower.tail, log.p)\n<bytecode: 0x000000001cde4a80>\n<environment: namespace:stats>\n  */\n  function qtukey(\n    q: number,\n    nmeans: number,\n    df: number,\n    nranges: number = 1,\n    lowerTail: boolean = true,\n    logP: boolean = false\n  )  {\n    return _qt(q, nranges, nmeans, df, lowerTail, logP);\n  }\n\n  return {\n    ptukey,\n    qtukey\n  };\n\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { M_1_SQRT_2PI } from '../common/_general';\nimport { pnorm5 as pnorm } from '../normal/pnorm';\n\nconst { exp, pow } = Math;\n\nconst bb = 8;\nconst C2 = -50;\nconst wlar = 3;\nconst wincr1 = 2;\nconst wincr2 = 3;\nconst nleg = 12;\nconst ihalf = 6;\n\nconst xleg = [\n  0.981560634246719250690549090149,\n  0.904117256370474856678465866119,\n  0.769902674194304687036893833213,\n  0.587317954286617447296702418941,\n  0.367831498998180193752691536644,\n  0.125233408511468915472441369464\n];\n\nconst aleg = [\n  0.047175336386511827194615961485,\n  0.106939325995318430960254718194,\n  0.160078328543346226334652529543,\n  0.20316742672306592174906445581,\n  0.233492536538354808760849898925,\n  0.249147045813402785000562436043\n];\n\nconst C3 = 60;\nconst C1 = -30;\n\nexport function wprob(w: number, rr: number, cc: number): number {\n  /*  wprob() :\n      \n          This function calculates probability integral of Hartley's\n          form of the range.\n      \n          w     = value of range\n          rr    = no. of rows or groups\n          cc    = no. of columns or treatments\n          ir    = error flag = 1 if pr_w probability > 1\n          pr_w = returned probability integral from (0, w)\n      \n          program will not terminate if ir is raised.\n      \n          bb = upper limit of legendre integration\n          iMax = maximum acceptable value of integral\n          nleg = order of legendre quadrature\n          ihalf = int ((nleg + 1) / 2)\n          wlar = value of range above which wincr1 intervals are used to\n                 calculate second part of integral,\n                 else wincr2 intervals are used.\n          C1, C2, C3 = values which are used as cutoffs for terminating\n          or modifying a calculation.\n      \n          M_1_SQRT_2PI = 1 / sqrt(2 * pi);  from abramowitz & stegun, p. 3.\n          M_SQRT2 = sqrt(2)\n          xleg = legendre 12-point nodes\n          aleg = legendre 12-point coefficients\n       */\n\n  /* looks like this is suboptimal for double precision.\n         (see how C1-C3 are used) <MM>\n      */\n  /* const double iMax  = 1.; not used if = 1*/\n  //\n  //double\n  //\n  let a: number;\n  let ac: number;\n  let pr_w: number;\n  let b: number;\n  let binc: number;\n  let c: number;\n  let cc1: number;\n  let pminus: number;\n  let pplus: number;\n  let qexpo: number;\n  let qsqz: number;\n  let rinsum: number;\n  let wi: number;\n  let wincr: number;\n  let xx: number;\n  let blb: number;\n  let bub: number;\n  let einsum: number;\n  let elsum: number;\n  //\n  // int\n  //\n  let j: number;\n\n  qsqz = w * 0.5;\n\n  /* if w >= 16 then the integral lower bound (occurs for c=20) */\n  /* is 0.99999999999995 so return a value of 1. */\n\n  if (qsqz >= bb) {\n    return 1.0;\n  }\n\n  /* find (f(w/2) - 1) ^ cc */\n  /* (first term in integral of hartley's form). */\n\n  pr_w =\n    2 * pnorm(qsqz, 0, 1, true, false) - 1; /* erf(qsqz / M_SQRT2) */\n  /* if pr_w ^ cc < 2e-22 then set pr_w = 0 */\n  if (pr_w >= exp(C2 / cc)) pr_w = pow(pr_w, cc);\n  else pr_w = 0.0;\n\n  /* if w is large then the second component of the */\n  /* integral is small, so fewer intervals are needed. */\n\n  if (w > wlar) wincr = wincr1;\n  else wincr = wincr2;\n\n  /* find the integral of second term of hartley's form */\n  /* for the integral of the range for equal-length */\n  /* intervals using legendre quadrature.  limits of */\n  /* integration are from (w/2, 8).  two or three */\n  /* equal-length intervals are used. */\n\n  /* blb and bub are lower and upper limits of integration. */\n\n  blb = qsqz;\n  binc = (bb - qsqz) / wincr;\n  bub = blb + binc;\n  einsum = 0.0;\n\n  /* integrate over each interval */\n\n  cc1 = cc - 1.0;\n  for (wi = 1; wi <= wincr; wi++) {\n    elsum = 0.0;\n    a = 0.5 * (bub + blb);\n\n    /* legendre quadrature with order = nleg */\n\n    b = 0.5 * (bub - blb);\n\n    for (let jj = 1; jj <= nleg; jj++) {\n      if (ihalf < jj) {\n        j = nleg - jj + 1;\n        xx = xleg[j - 1];\n      } else {\n        j = jj;\n        xx = -xleg[j - 1];\n      }\n      c = b * xx;\n      ac = a + c;\n\n      /* if exp(-qexpo/2) < 9e-14, */\n      /* then doesn't contribute to integral */\n\n      qexpo = ac * ac;\n      if (qexpo > C3) break;\n\n      pplus = 2 * pnorm(ac, 0, 1, true, false);\n      pminus = 2 * pnorm(ac, w, 1, true, false);\n\n      /* if rinsum ^ (cc-1) < 9e-14, */\n      /* then doesn't contribute to integral */\n\n      rinsum = pplus * 0.5 - pminus * 0.5;\n      if (rinsum >= exp(C1 / cc1)) {\n        rinsum = aleg[j - 1] * exp(-(0.5 * qexpo)) * pow(rinsum, cc1);\n        elsum += rinsum;\n      }\n    }\n    elsum *= 2.0 * b * cc * M_1_SQRT_2PI;\n    einsum += elsum;\n    blb = bub;\n    bub += binc;\n  }\n\n  /* if pr_w ^ rr < 9e-14, then return 0 */\n  pr_w += einsum;\n  if (pr_w <= exp(C1 / rr)) return 0;\n\n  pr_w = pow(pr_w, rr);\n  if (pr_w >= 1)\n    /* 1 was iMax was eps */\n    return 1;\n  return pr_w;\n} /* wprob() */\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst { sqrt, log } = Math;\n\nfunction qinv(p: number, c: number, v: number): number {\n  const p0 = 0.322232421088;\n  const q0 = 0.99348462606e-1;\n  const p1 = -1.0;\n  const q1 = 0.588581570495;\n  const p2 = -0.342242088547;\n  const q2 = 0.531103462366;\n  const p3 = -0.204231210125;\n  const q3 = 0.10353775285;\n  const p4 = -0.453642210148e-4;\n  const q4 = 0.38560700634e-2;\n  const c1 = 0.8832;\n  const c2 = 0.2368;\n  const c3 = 1.214;\n  const c4 = 1.208;\n  const c5 = 1.4142;\n  const vmax = 120.0;\n\n  let ps;\n  let q;\n  let t;\n  let yi;\n\n  ps = 0.5 - 0.5 * p;\n  yi = sqrt(log(1.0 / (ps * ps)));\n  t =\n    yi +\n    ((((yi * p4 + p3) * yi + p2) * yi + p1) * yi + p0) /\n    ((((yi * q4 + q3) * yi + q2) * yi + q1) * yi + q0);\n  if (v < vmax) t += (t * t * t + t) / v / 4.0;\n  q = c1 - c2 * t;\n  if (v < vmax) q += -c3 / v + c4 * t / v;\n  return t * (q * log(c - 1.0) + c5);\n}\n\n/*\n *  Copenhaver, Margaret Diponzio & Holland, Burt S.\n *  Multiple comparisons of simple effects in\n *  the two-way analysis of variance with fixed effects.\n *  Journal of Statistical Computation and Simulation,\n *  Vol.30, pp.1-15, 1988.\n *\n *  Uses the secant method to find critical values.\n *\n *  p = confidence level (1 - alpha)\n *  rr = no. of rows or groups\n *  cc = no. of columns or treatments\n *  df = degrees of freedom of error term\n *\n *  ir(1) = error flag = 1 if wprob probability > 1\n *  ir(2) = error flag = 1 if ptukey probability > 1\n *  ir(3) = error flag = 1 if convergence not reached in 50 iterations\n *\t\t       = 2 if df < 2\n *\n *  qtukey = returned critical value\n *\n *  If the difference between successive iterates is less than eps,\n *  the search is terminated\n */\n\nimport * as debug from 'debug';\n\nimport { ME, ML_ERR_return_NAN, ML_ERROR, R_Q_P01_boundaries } from '../common/_general';\nimport { R_DT_qIv } from '../exp/expm1';\nimport { ptukey } from './ptukey'\n\nconst { isNaN: ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\nconst { abs: fabs, max: fmax2 } = Math;\nconst printer = debug('qtukey');\n/**\n> qtukey\nfunction (p, nmeans, df, nranges = 1, lower.tail = TRUE, log.p = FALSE)\n.Call(C_qtukey, p, nranges, nmeans, df, lower.tail, log.p)\n<bytecode: 0x000000001cde4a80>\n<environment: namespace:stats>\n\n*/\n\nexport function qtukey(\n  p: number, //p\n  rr: number, //ranges\n  cc: number, //nmeans\n  df: number, //df\n  lower_tail: boolean = true, //lower.tail\n  log_p: boolean = false //log.p\n): number {\n  const eps = 0.0001;\n  const maxiter = 50;\n\n  let ans = 0.0;\n  let valx0;\n  let valx1;\n  let x0;\n  let x1;\n  let xabs;\n  let iter;\n\n  if (ISNAN(p) || ISNAN(rr) || ISNAN(cc) || ISNAN(df)) {\n    ML_ERROR(ME.ME_DOMAIN, 'qtukey', printer);\n    return NaN;\n  }\n\n  /* df must be > 1 ; there must be at least two values */\n  if (df < 2 || rr < 1 || cc < 2) return ML_ERR_return_NAN(printer);\n\n  let rc = R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n\n  p = R_DT_qIv(lower_tail, log_p, p); /* lower_tail,non-log \"p\" */\n\n  /* Initial value */\n\n  x0 = qinv(p, cc, df);\n\n  /* Find prob(value < x0) */\n\n  valx0 = ptukey(x0, rr, cc, df, /*LOWER*/ true, /*LOG_P*/ false) - p;\n\n  /* Find the second iterate and prob(value < x1). */\n  /* If the first iterate has probability value */\n  /* exceeding p then second iterate is 1 less than */\n  /* first iterate; otherwise it is 1 greater. */\n\n  if (valx0 > 0.0) x1 = fmax2(0.0, x0 - 1.0);\n  else x1 = x0 + 1.0;\n  valx1 = ptukey(x1, rr, cc, df, /*LOWER*/ true, /*LOG_P*/ false) - p;\n\n  /* Find new iterate */\n\n  for (iter = 1; iter < maxiter; iter++) {\n    ans = x1 - valx1 * (x1 - x0) / (valx1 - valx0);\n    valx0 = valx1;\n\n    /* New iterate must be >= 0 */\n\n    x0 = x1;\n    if (ans < 0.0) {\n      ans = 0.0;\n      valx1 = -p;\n    }\n    /* Find prob(value < new iterate) */\n\n    valx1 =\n      ptukey(ans, rr, cc, df, /*LOWER*/ true, /*LOG_P*/ false) - p;\n    x1 = ans;\n\n    /* If the difference between two successive */\n    /* iterates is less than eps, stop */\n\n    xabs = fabs(x1 - x0);\n    if (xabs < eps) return ans;\n  }\n\n  /* The process did not converge in 'maxiter' iterations */\n  ML_ERROR(ME.ME_NOCONV, 'qtukey', printer);\n  return ans;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { dunif } from './dunif';\nimport { punif } from './punif';\nimport { qunif } from './qunif';\nimport { runif } from './runif';\n\nimport { IRNG, rng } from '../rng';\nconst { MersenneTwister } = rng;\n\nexport function Uniform(rng: IRNG = new MersenneTwister(0)) {\n  return {\n    dunif,\n    punif,\n    qunif,\n    runif: (n: number = 1, min: number = 0, max: number = 1) =>\n      runif(n, min, max, rng)\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { R_D__0 } from '../common/_general';\n\nconst { isNaN: ISNAN } = Number;\nconst { log } = Math;\n\nexport function dunif(\n  x: number,\n  min: number = 0,\n  max: number = 1,\n  logP: boolean = false\n): number {\n    if (ISNAN(x) || ISNAN(min) || ISNAN(max)) {\n      return x + min + max;\n    }\n    if (min <= x && x <= max) {\n      return logP ? -log(max - min) : 1 / (max - min);\n    }\n    return R_D__0(logP); // return logP ? ML_NEGINF : 0.0;\n\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\nconst printer = debug('punif');\n\nimport { ML_ERR_return_NAN, R_D_val, R_DT_0, R_DT_1 } from '../common/_general';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nexport function punif(\n  q: number ,\n  min: number = 0,\n  max: number = 1,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number  {\n    if (ISNAN(q) || ISNAN(min) || ISNAN(max)) {\n      return q + min + max;\n    }\n\n    if (max < min) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (!R_FINITE(min) || !R_FINITE(max)) {\n      return ML_ERR_return_NAN(printer);\n    }\n\n    if (q >= max) {\n      return R_DT_1(lowerTail, logP);\n    }\n\n    if (q <= min) {\n      return R_DT_0(lowerTail, logP);\n    }\n\n    if (lowerTail) {\n      return R_D_val(logP, (q - min) / (max - min));\n    }\n    \n    return R_D_val(logP, (max - q) / (max - min)); \n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { ML_ERR_return_NAN, R_Q_P01_check } from '../common/_general';\n\nimport * as debug from 'debug';\nimport { R_DT_qIv } from '../exp/expm1';\n\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\nconst printer = debug('qunif');\n\nexport function qunif(\n  p: number,\n  min: number = 0,\n  max: number = 1,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  \n    if (ISNAN(p) || ISNAN(min) || ISNAN(max)) return NaN;\n\n    let rc = R_Q_P01_check(logP, p);\n    if (rc !== undefined) {\n      return rc;\n    }\n    if (!R_FINITE(min) || !R_FINITE(max)) return ML_ERR_return_NAN(printer);\n    if (max < min) return ML_ERR_return_NAN(printer);\n    if (max === min) return min;\n\n    return min + R_DT_qIv(lowerTail, logP, p) * (max - min);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func';\nimport { IRNG } from '../rng';\n\nconst { isFinite: R_FINITE } = Number;\nconst printer = debug('runif');\n\nexport function runif(n: number|number[], min = 0, max = 1, u: IRNG) {\n  return randomGenHelper(n, runifOne, min, max, u)\n}\n\nexport function runifOne(\n  n: number = 1,\n  min: number = 0,\n  max: number = 1,\n  u: IRNG\n): number {\n  if (!(R_FINITE(min) && R_FINITE(max) && max > min)) {\n    return ML_ERR_return_NAN(printer);\n  }\n  const s = u.internal_unif_rand();\n  return (max - min) * s + min;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dweibull } from './dweibull';\nimport { pweibull } from './pweibull';\nimport { qweibull } from './qweibull';\nimport { rweibull as _rweibull } from './rweibull';\n\nimport { IRNG, rng as _rng } from '../rng';\n\nexport function Weibull(rng: IRNG = new _rng.MersenneTwister(0)) {\n  function rweibull(n: number, shape: number, scale: number = 1) {\n    return _rweibull(n, shape, scale, rng);\n  }\n\n  return {\n    dweibull,\n    pweibull,\n    qweibull,\n    rweibull\n  };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D__0 } from '../common/_general';\n\nconst { pow, log, exp } = Math;\nconst {\n  isNaN: ISNAN,\n  isFinite: R_FINITE,\n  POSITIVE_INFINITY: ML_POSINF\n} = Number;\nconst printer = debug('dweilbull');\n\nexport function dweibull(\n  x: number,\n  shape: number,\n  scale: number = 1,\n  give_log: boolean = false\n): number {\n  if (ISNAN(x) || ISNAN(shape) || ISNAN(scale)) return x + shape + scale;\n  if (shape <= 0 || scale <= 0) return ML_ERR_return_NAN(printer);\n\n  if (x < 0) return R_D__0(give_log);\n  if (!R_FINITE(x)) return R_D__0(give_log);\n  /* need to handle x == 0 separately */\n  if (x === 0 && shape < 1) return ML_POSINF;\n  let tmp1 = pow(x / scale, shape - 1);\n  let tmp2 = tmp1 * (x / scale);\n  /* These are incorrect if tmp1 == 0 */\n  return give_log\n    ? -tmp2 + log(shape * tmp1 / scale)\n    : shape * tmp1 * exp(-tmp2) / scale;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D_exp, R_DT_0 } from '../common/_general';\n\nimport { R_Log1_Exp } from '../exp/expm1';\n\nconst { expm1, pow } = Math;\nconst { isNaN: ISNAN } = Number;\nconst printer = debug('pweibull');\n\nexport function pweibull(\n  x: number,\n  shape: number,\n  scale: number = 1,\n  lower_tail: boolean = true,\n  log_p: boolean = false\n): number {\n    if (ISNAN(x) || ISNAN(shape) || ISNAN(scale)) return x + shape + scale;\n\n    if (shape <= 0 || scale <= 0) return ML_ERR_return_NAN(printer);\n\n    if (x <= 0) {\n      return R_DT_0(lower_tail, log_p);\n    }\n    x = -pow(x / scale, shape);\n    return lower_tail ? (log_p ? R_Log1_Exp(x) : -expm1(x)) : R_D_exp(log_p, x);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_Q_P01_boundaries } from '../common/_general';\n\nimport { R_DT_Clog } from '../exp/expm1';\n\nconst { pow } = Math;\nconst { isNaN: ISNAN, POSITIVE_INFINITY: ML_POSINF } = Number;\nconst printer = debug('qweibull');\n\nexport function qweibull(\n  p: number,\n  shape: number,\n  scale: number = 1,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  if (ISNAN(p) || ISNAN(shape) || ISNAN(scale)) return p + shape + scale;\n\n  if (shape <= 0 || scale <= 0) return ML_ERR_return_NAN(printer);\n\n  let rc = R_Q_P01_boundaries(lowerTail, logP, p, 0, ML_POSINF);\n  if (rc !== undefined) {\n    return rc;\n  }\n  return scale * pow(-R_DT_Clog(lowerTail, logP, p), 1 / shape);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper } from '../r-func';\nimport { IRNG } from '../rng';\n\nconst { log, pow } = Math;\nconst { isFinite: R_FINITE } = Number;\nconst printer = debug('rweibull');\n\nexport  function rweibull(\n  n: number|number[],\n  shape: number,\n  scale: number = 1,\n  rng: IRNG\n){\n  return randomGenHelper(n, rweibullOne, shape, scale, rng)\n}\n\nexport function rweibullOne(\n  shape: number,\n  scale: number = 1,\n  rng: IRNG\n): number {\n\n  if (!R_FINITE(shape) || !R_FINITE(scale) || shape <= 0 || scale <= 0) {\n    if (scale === 0) return 0;\n    /* else */\n    return ML_ERR_return_NAN(printer);\n  }\n\n  return scale * pow(-log((rng.internal_unif_rand())), 1.0 / shape);\n\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { dwilcox } from './dwilcox';\nimport { pwilcox } from './pwilcox';\nimport { qwilcox } from './qwilcox';\nimport { rwilcox as _rwilc }  from './rwilcox';\n//import { WilcoxonCache } from './WilcoxonCache';\n\nimport { IRNG } from '../rng';\nimport { MersenneTwister } from '../rng/mersenne-twister';\n\n\nexport function Wilcoxon(rng: IRNG = new MersenneTwister(0)){\n    function rwilcox(nn: number, m: number, n: number){\n        return _rwilc(nn, m, n, rng);\n    }\n    return {\n        dwilcox,\n        pwilcox,\n        qwilcox,\n        rwilcox\n    };\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_D__0 } from '../common/_general';\nimport { internal_choose, internal_lchoose } from '../common/choose';\nimport { cwilcox } from './cwilcox';\nimport { WilcoxonCache } from './WilcoxonCache';\n\nconst { round: R_forceint, abs: fabs, log } = Math;\nconst { isNaN: ISNAN } = Number;\nconst printer_dwilcox = debug('dwilcox');\n\nexport function dwilcox(\n  x: number,\n  m: number,\n  n: number,\n  giveLog: boolean = false\n): number {\n  // outside the potential loop\n\n  m = R_forceint(m);\n  n = R_forceint(n);\n\n  //const nm = m * n;\n \n    const w = new WilcoxonCache();\n    //#ifdef IEEE_754\n    /* NaNs propagated correctly */\n\n    if (ISNAN(x) || ISNAN(m) || ISNAN(n)) {\n     // console.log(`1. x:${x}, m:${m}, n:${n}`);\n      return (x + m + n);\n    }\n    //#endif\n\n    if (m <= 0 || n <= 0) {\n     // console.log(`2. x:${x}, m:${m}, n:${n}`);\n      return ML_ERR_return_NAN(printer_dwilcox);\n    }\n\n    if (fabs(x - R_forceint(x)) > 1e-7) {\n     // console.log(`3. x:${x}, m:${m}, n:${n}`);\n      return R_D__0(giveLog);\n    }\n    x = R_forceint(x);\n    if (x < 0 || x > m * n) {\n      return R_D__0(giveLog);\n    }\n    //const w = initw(m, n);\n    //console.log(`0. special: ${w[4][4].length}`);\n    //const c1 = cwilcox(x, m, n, w);\n    \n    //console.log(`4. c1:${c1} <- x:${x}, m:${m}, n:${n}`);\n    return giveLog\n      ? log(cwilcox(x, m, n, w)) - internal_lchoose(m + n, n)\n      : cwilcox(x, m, n, w) / internal_choose(m + n, n);\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN, R_DT_0, R_DT_1, R_DT_val } from '../common/_general';\nimport { internal_choose } from '../common/choose';\n\nimport { WilcoxonCache } from './WilcoxonCache';\n\nimport { cwilcox } from './cwilcox';\n\nconst { round: R_forceint, floor } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE } = Number;\n\nconst printer_pwilcox = debug('pwilcox');\nexport function pwilcox(\n  q: number,\n  m: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  m = R_forceint(m);\n  n = R_forceint(n);\n  const w = new WilcoxonCache();\n\n  let lower_tail = lowerTail;\n  if (ISNAN(q) || ISNAN(m) || ISNAN(n)) return q + m + n;\n  if (!R_FINITE(m) || !R_FINITE(n)) return ML_ERR_return_NAN(printer_pwilcox);\n\n  if (m <= 0 || n <= 0) return ML_ERR_return_NAN(printer_pwilcox);\n\n  q = floor(q + 1e-7);\n\n  if (q < 0.0) return R_DT_0(lower_tail, logP);\n  if (q >= m * n) return R_DT_1(lower_tail, logP);\n\n  //let mm = m;\n  // let nn = n;\n  //w_init_maybe(mm, nn);\n  let c = internal_choose(m + n, n);\n  let p = 0;\n  /* Use summation of probs over the shorter range */\n  if (q <= m * n / 2) {\n    for (let i = 0; i <= q; i++) p += cwilcox(i, m, n, w) / c;\n  } else {\n    q = m * n - q;\n    for (let i = 0; i < q; i++) p += cwilcox(i, m, n, w) / c;\n    lower_tail = !lower_tail; /* p = 1 - p; */\n  }\n\n  return R_DT_val(lower_tail, logP, p);\n\n} /* pwilcox */\n\n/* x is 'p' in R function qwilcox */\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport {\n  ML_ERR_return_NAN,\n  R_DT_0,\n  R_DT_1,\n  R_Q_P01_check\n} from '../common/_general';\nimport { R_DT_qIv } from '../exp/expm1';\nimport { cwilcox } from './cwilcox';\nimport { WilcoxonCache } from './WilcoxonCache';\n\nimport { internal_choose } from '../common/choose';\n\nconst { round: R_forceint, trunc } = Math;\nconst { isNaN: ISNAN, isFinite: R_FINITE, EPSILON: DBL_EPSILON } = Number;\n\nconst printer_qwilcox = debug('qwilcox');\n\nexport function qwilcox(\n  x: number,\n  m: number,\n  n: number,\n  lowerTail: boolean = true,\n  logP: boolean = false\n): number {\n  m = R_forceint(m);\n  n = R_forceint(n);\n  const w = new WilcoxonCache();\n\n  if (ISNAN(x) || ISNAN(m) || ISNAN(n)) return x + m + n;\n  if (!R_FINITE(x) || !R_FINITE(m) || !R_FINITE(n))\n    return ML_ERR_return_NAN(printer_qwilcox);\n  R_Q_P01_check(logP, x);\n\n  if (m <= 0 || n <= 0) return ML_ERR_return_NAN(printer_qwilcox);\n\n  if (x === R_DT_0(lowerTail, logP)) return 0;\n  if (x === R_DT_1(lowerTail, logP)) return m * n;\n\n  if (logP || !lowerTail)\n    x = R_DT_qIv(lowerTail, logP, x); /* lower_tail,non-log \"p\" */\n\n  let c = internal_choose(m + n, n);\n  let p = 0;\n  let q = 0;\n  if (x <= 0.5) {\n    x = x - 10 * DBL_EPSILON;\n    while (true) {\n      p += cwilcox(q, m, n, w) / c;\n      if (p >= x) break;\n      q++;\n    }\n  } else {\n    x = 1 - x + 10 * DBL_EPSILON;\n    while (true) {\n      p += cwilcox(q, m, n, w) / c;\n      if (p > x) {\n        q = trunc(m * n - q);\n        break;\n      }\n      q++;\n    }\n  }\n  return q;\n}\n","'use strict'\n/* This is a conversion from libRmath.so to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\n\nimport { ML_ERR_return_NAN } from '../common/_general';\nimport { randomGenHelper, seq_len } from '../r-func';\nimport { IRNG } from '../rng';\n\nconst printer_rwilcox = debug('rwilcox');\nconst { round: R_forceint, trunc, floor } = Math;\nconst { isNaN: ISNAN } = Number;\n\nexport function rwilcox(\n  N: number| number[],\n  m: number,\n  n: number,\n  rng: IRNG\n): number[] {\n  return randomGenHelper(N, rwilcoxOne, m, n, rng);\n}\n\nexport function rwilcoxOne(m: number, n: number, rng: IRNG): number {\n    /* NaNs propagated correctly */\n    if (ISNAN(m) || ISNAN(n)) return m + n;\n\n    m = R_forceint(m);\n    n = R_forceint(n);\n    if (m < 0 || n < 0) return ML_ERR_return_NAN(printer_rwilcox);\n\n    if (m === 0 || n === 0) return 0;\n\n    let r = 0.0;\n    let k = trunc(m + n);\n    let x: number[] = Array.from(seq_len({ length:k, base: 0}))\n    printer_rwilcox(`------v`);\n    for (let i = 0; i < n; i++) {\n      let j = floor(k * (rng.internal_unif_rand()));\n      r += x[j];\n      x[j] = x[--k];\n      printer_rwilcox('i:%d,\\tn:%d\\tj:%d\\tk:%d\\tr:%d\\tx:%o', i, n, j, k, x);\n    }\n\n    return r - n * (n - 1) / 2;\n\n  }\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nexport * from './log1p';\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/* want to compile log1p as Rlog1p if HAVE_LOG1P && !HAVE_WORKING_LOG1P */\nimport * as debug from 'debug';\n\nconst {\n  NEGATIVE_INFINITY: ML_NEGINF,\n  POSITIVE_INFINITY: ML_POSINF,\n  EPSILON: DBL_EPSILON,\n  isNaN: ISNAN,\n  isFinite: R_FINITE\n} = Number;\nimport { chebyshev_eval }  from '../chebyshev/index';\nimport { ME , ML_ERR_return_NAN, ML_ERROR } from '../common/_general';\n\n//import { chebyshev_eval } from '../exp/expm1'chebyshev';\n\n//const { log1p } = Math;\nconst { abs: fabs, max: fmax2, min: fmin2 } = Math;\nconst printer = debug('log1p')\n\nexport function log1p(x: number): number {\n    // series for log1p on the interval -.375 to .375\n     //\t\t\t\t     with weighted error   6.35e-32\n     //\t\t\t\t      log weighted error  31.20\n     //\t\t\t    significant figures required  30.93\n     //\t\t\t\t decimal places required  32.01\n     //\n    const alnrcs = [\n        +.10378693562743769800686267719098e+1,\n        -.13364301504908918098766041553133e+0,\n        +.19408249135520563357926199374750e-1,\n        -.30107551127535777690376537776592e-2,\n        +.48694614797154850090456366509137e-3,\n        -.81054881893175356066809943008622e-4,\n        +.13778847799559524782938251496059e-4,\n        -.23802210894358970251369992914935e-5,\n        +.41640416213865183476391859901989e-6,\n        -.73595828378075994984266837031998e-7,\n        +.13117611876241674949152294345011e-7,\n        -.23546709317742425136696092330175e-8,\n        +.42522773276034997775638052962567e-9,\n        -.77190894134840796826108107493300e-10,\n        +.14075746481359069909215356472191e-10,\n        -.25769072058024680627537078627584e-11,\n        +.47342406666294421849154395005938e-12,\n        -.87249012674742641745301263292675e-13,\n        +.16124614902740551465739833119115e-13,\n        -.29875652015665773006710792416815e-14,\n        +.55480701209082887983041321697279e-15,\n        -.10324619158271569595141333961932e-15,\n        +.19250239203049851177878503244868e-16,\n        -.35955073465265150011189707844266e-17,\n        +.67264542537876857892194574226773e-18,\n        -.12602624168735219252082425637546e-18,\n        +.23644884408606210044916158955519e-19,\n        -.44419377050807936898878389179733e-20,\n        +.83546594464034259016241293994666e-21,\n        -.15731559416479562574899253521066e-21,\n        +.29653128740247422686154369706666e-22,\n        -.55949583481815947292156013226666e-23,\n        +.10566354268835681048187284138666e-23,\n        -.19972483680670204548314999466666e-24,\n        +.37782977818839361421049855999999e-25,\n        -.71531586889081740345038165333333e-26,\n        +.13552488463674213646502024533333e-26,\n        -.25694673048487567430079829333333e-27,\n        +.48747756066216949076459519999999e-28,\n        -.92542112530849715321132373333333e-29,\n        +.17578597841760239233269760000000e-29,\n        -.33410026677731010351377066666666e-30,\n        +.63533936180236187354180266666666e-31,\n    ];\n    //\n    //#ifdef NOMORE_FOR_THREADS\n    //    static int nlnrel = 0;\n    //    static double xmin = 0.0;\n    \n    //    if (xmin == 0.0) xmin = -1 + sqrt(DBL_EPSILON);// was sqrt(d1mach(4)); \n    //    if (nlnrel == 0) // initialize chebychev coefficients \n    //    nlnrel = chebyshev_init(alnrcs, 43, DBL_EPSILON/20);//was .1*d1mach(3)\n    //#else\n    //\n    const nlnrel = 22;\n    const xmin = -0.999999985;\n    // 22: for IEEE double precision where DBL_EPSILON =  2.22044604925031e-16 \n    //#endif\n\n    if (x === 0.) return 0.; // speed \n    if (x === -1) return (ML_NEGINF);\n    if (x < -1) return ML_ERR_return_NAN(printer);\n\n    if (fabs(x) <= .375) {\n    // Improve on speed (only);\n      // again give result accurate to IEEE double precision: \n        if (fabs(x) < .5 * DBL_EPSILON)\n            return x;\n\n        if ((0 < x && x < 1e-8) || (-1e-9 < x && x < 0))\n            return x * (1 - .5 * x);\n        // else \n        return x * (1 - x * chebyshev_eval(x / .375, alnrcs, nlnrel));\n    }\n    // else \n    if (x < xmin) {\n        // answer less than half precision because x too near -1 \n        ML_ERROR(ME.ME_PRECISION, 'log1p', printer);\n    }\n    return Math.log(1 + x);\n}\n\n\n/* Used as a substitute for the C99 function hypot, which all currently\n   known platforms have */\n\n/* hypot(a,b)\tfinds sqrt(a^2 + b^2)\n *\t\twithout overflow or destructive underflow.\n */\n\n export function hypot(a: number, b: number) {\n  let p: number;\n  let r: number;\n  let s: number;\n  let t: number;\n  let tmp: number;\n  let u: number;\n\n  if (ISNAN(a) || ISNAN(b)) {\n    //* propagate Na(N)s: \n    return a + b;\n  }\n  if (!R_FINITE(a) || !R_FINITE(b)) {\n    return ML_POSINF;\n  }\n  p = fmax2(fabs(a), fabs(b));\n  if (p !== 0.0) {\n    // r = (min(|a|,|b|) / p) ^2 \n    tmp = fmin2(fabs(a), fabs(b)) / p;\n    r = tmp * tmp;\n    while (true) {\n      t = 4.0 + r;\n      // This was a test of 4.0 + r == 4.0, but optimizing\n      //      compilers nowadays infinite loop on that. \n      if (fabs(r) < 2 * DBL_EPSILON) break;\n      s = r / t;\n      u = 1 + 2 * s;\n      p *= u;\n\n      // r = (s / u)^2 * r \n      tmp = s / u;\n      r *= tmp * tmp;\n    }\n  }\n  return p;\n}\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport { bessel_i as besselI } from './besselI';\nimport { bessel_j as besselJ } from './besselJ';\nimport { bessel_k as besselK } from './besselK';\nimport { bessel_y as besselY } from './besselY';\n\n\n\nexport default {  \n    besselJ,\n    besselY,\n    besselK,\n    besselI,\n};\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ME, ML_ERROR } from '../../common/_general';\nimport { sinpi } from '../../trigonometry/sinpi';\nimport { bessel_k } from '../besselK';\nimport { I_bessel } from './IBessel';\n\nconst { isNaN: ISNAN } = Number;\nconst { exp, trunc, floor, PI: M_PI } = Math;\n\nconst printer = debug('bessel_i');\n\n\n/* .Internal(besselI(*)) : */\nexport function bessel_i(x: number, alpha: number, expo: boolean = false): number {\n\n    //int\n    let nb;\n    let ize;\n\n    //double \n    let na;\n\n    /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(alpha)) return x + alpha;\n    if (x < 0) {\n        ML_ERROR(ME.ME_RANGE, 'bessel_i', printer);\n        return NaN;\n    }\n    ize = expo ? 2 : 1;\n    na = floor(alpha);\n    if (alpha < 0) {\n        /* Using Abramowitz & Stegun  9.6.2 & 9.6.6\n         * this may not be quite optimal (CPU and accuracy wise) */\n        return (bessel_i(x, -alpha, expo) +\n            ((alpha === na) ? /* sin(pi * alpha) = 0 */ 0 :\n                bessel_k(x, -alpha, expo) *\n                ((ize === 1) ? 2. : 2. * exp(-2. * x)) / M_PI * sinpi(-alpha)));\n    }\n    nb = 1 + trunc(na); /* nb-1 <= alpha < nb */\n    alpha -= (nb - 1);\n\n\n\n    const rc = I_bessel(x, alpha, nb, ize);\n    if (rc.ncalc !== rc.nb) {/* error input */\n        if (rc.ncalc < 0)\n            printer('bessel_i(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?',\n                x, rc.ncalc, rc.nb, alpha);\n        else\n            printer('bessel_i(%d,nu=%d): precision lost in result\\n',\n                rc.x, alpha + rc.nb - 1);\n    }\n    x = rc.x; // bi[nb - 1];\n\n    return x;\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport * as debug from 'debug';\n\nimport { ME, ML_ERROR } from '../../common/_general';\nimport { sqxmin_BESS_K, xmax_BESS_K } from '../bessel-constants';\nimport { IBesselRC } from '../IBesselRC';\n\nconst M_SQRT_2dPI = 0.797884560802865355879892119869;\nconst { min, log, exp, abs: fabs, sinh, trunc, sqrt, max } = Math;\nconst { MAX_VALUE: DBL_MAX, EPSILON: DBL_EPSILON, MIN_VALUE: DBL_MIN } = Number;\nconst printer = debug('K_bessel');\nconst ML_POSINF = Infinity;\n\nexport function K_bessel(\n    x: number,\n    alpha: number,\n    nb: number,\n    ize: number\n): IBesselRC {\n    /*-------------------------------------------------------------------\n  \n      This routine calculates modified Bessel functions\n      of the third kind, K_(N+ALPHA) (X), for non-negative\n      argument X, and non-negative order N+ALPHA, with or without\n      exponential scaling.\n  \n      Explanation of variables in the calling sequence\n  \n     X     - Non-negative argument for which\n       K's or exponentially scaled K's (K*EXP(X))\n       are to be calculated.\tIf K's are to be calculated,\n       X must not be greater than XMAX_BESS_K.\n     ALPHA - Fractional part of order for which\n       K's or exponentially scaled K's (K*EXP(X)) are\n       to be calculated.  0 <= ALPHA < 1.0.\n     NB    - Number of functions to be calculated, NB > 0.\n       The first function calculated is of order ALPHA, and the\n       last is of order (NB - 1 + ALPHA).\n     IZE   - Type.\tIZE = 1 if unscaled K's are to be calculated,\n          = 2 if exponentially scaled K's are to be calculated.\n     BK    - Output vector of length NB.\tIf the\n       routine terminates normally (NCALC=NB), the vector BK\n       contains the functions K(ALPHA,X), ... , K(NB-1+ALPHA,X),\n       or the corresponding exponentially scaled functions.\n       If (0 < NCALC < NB), BK(I) contains correct function\n       values for I <= NCALC, and contains the ratios\n       K(ALPHA+I-1,X)/K(ALPHA+I-2,X) for the rest of the array.\n     NCALC - Output variable indicating possible errors.\n       Before using the vector BK, the user should check that\n       NCALC=NB, i.e., all orders have been calculated to\n       the desired accuracy.\tSee error returns below.\n  \n  \n     *******************************************************************\n  \n     Error returns\n  \n      In case of an error, NCALC != NB, and not all K's are\n      calculated to the desired accuracy.\n  \n      NCALC < -1:  An argument is out of range. For example,\n      NB <= 0, IZE is not 1 or 2, or IZE=1 and ABS(X) >= XMAX_BESS_K.\n      In this case, the B-vector is not calculated,\n      and NCALC is set to MIN0(NB,0)-2\t so that NCALC != NB.\n      NCALC = -1:  Either  K(ALPHA,X) >= XINF  or\n      K(ALPHA+NB-1,X)/K(ALPHA+NB-2,X) >= XINF.\t In this case,\n      the B-vector is not calculated.\tNote that again\n      NCALC != NB.\n  \n      0 < NCALC < NB: Not all requested function values could\n      be calculated accurately.  BK(I) contains correct function\n      values for I <= NCALC, and contains the ratios\n      K(ALPHA+I-1,X)/K(ALPHA+I-2,X) for the rest of the array.\n  \n  \n     Intrinsic functions required are:\n  \n       ABS, AINT, EXP, INT, LOG, MAX, MIN, SINH, SQRT\n  \n  \n     Acknowledgement\n  \n      This program is based on a program written by J. B. Campbell\n      (2) that computes values of the Bessel functions K of float\n      argument and float order.  Modifications include the addition\n      of non-scaled functions, parameterization of machine\n      dependencies, and the use of more accurate approximations\n      for SINH and SIN.\n  \n     References: \"On Temme's Algorithm for the Modified Bessel\n          Functions of the Third Kind,\" Campbell, J. B.,\n          TOMS 6(4), Dec. 1980, pp. 581-586.\n  \n         \"A FORTRAN IV Subroutine for the Modified Bessel\n          Functions of the Third Kind of Real Order and Real\n          Argument,\" Campbell, J. B., Report NRC/ERB-925,\n          National Research Council, Canada.\n  \n      Latest modification: May 30, 1989\n  \n      Modified by: W. J. Cody and L. Stoltz\n           Applied Mathematics Division\n           Argonne National Laboratory\n           Argonne, IL  60439\n  \n     -------------------------------------------------------------------\n    */\n    /*---------------------------------------------------------------------\n     * Mathematical constants\n     *\tA = LOG(2) - Euler's constant\n     *\tD = SQRT(2/PI)\n     ---------------------------------------------------------------------*/\n    const a = .11593151565841244881;\n\n    /*---------------------------------------------------------------------\n      P, Q - Approximation for LOG(GAMMA(1+ALPHA))/ALPHA + Euler's constant\n      Coefficients converted from hex to decimal and modified\n      by W. J. Cody, 2/26/82 */\n    const p = [.805629875690432845, 20.4045500205365151,\n        157.705605106676174, 536.671116469207504, 900.382759291288778,\n        730.923886650660393, 229.299301509425145, .822467033424113231];\n    const q = [29.4601986247850434, 277.577868510221208,\n        1206.70325591027438, 2762.91444159791519, 3443.74050506564618,\n        2210.63190113378647, 572.267338359892221];\n    /* R, S - Approximation for (1-ALPHA*PI/SIN(ALPHA*PI))/(2.D0*ALPHA) */\n    const r = [- .48672575865218401848, 13.079485869097804016,\n    -101.96490580880537526, 347.65409106507813131,\n        3.495898124521934782e-4];\n\n    const s = [- 25.579105509976461286, 212.57260432226544008,\n    -610.69018684944109624, 422.69668805777760407];\n    /* T    - Approximation for SINH(Y)/Y */\n    const t = [1.6125990452916363814e-10,\n        2.5051878502858255354e-8, 2.7557319615147964774e-6,\n        1.9841269840928373686e-4, .0083333333333334751799,\n        .16666666666666666446];\n    /*---------------------------------------------------------------------*/\n    const estm = [52.0583, 5.7607, 2.7782, 14.4303, 185.3004, 9.3715];\n    const estf = [41.8341, 7.1075, 6.4306, 42.511, 1.35633, 84.5096, 20.];\n\n    /* Local variables */\n    //int\n    let iend;\n    let i;\n    let j;\n    let k;\n    let m;\n    let ii;\n    let mplus1;\n\n    //double\n    let x2by4;\n    let twox;\n    let c;\n    let blpha;\n    let ratio;\n    let wminf;\n    let d1;\n    let d2;\n    let d3;\n    let f0;\n    let f1;\n    let f2;\n    let p0;\n    let q0;\n    let t1;\n    let t2;\n    let twonu;\n    let dm;\n    let ex;\n    let bk1;\n    let bk2;\n    let nu;\n\n    let bk = new Array<number>(nb).fill(0);\n\n\n\n    ii = 0; /* -Wall */\n\n    ex = x;\n    nu = alpha;\n    let ncalc = min(nb, 0) - 2;\n\n    if (nb > 0 && (0. <= nu && nu < 1.) && (1 <= ize && ize <= 2)) {\n        for (let cnt = 0; cnt < 1; cnt++) {\n            if (ex <= 0 || (ize === 1 && ex > xmax_BESS_K)) {\n                if (ex <= 0) {\n                    if (ex < 0) ML_ERROR(ME.ME_RANGE, 'K_bessel', printer);\n                    // for (i = 0; i < nb; i++)\n                    bk[0] = ML_POSINF;\n                }\n                else /* would only have underflow */\n                    //for (i = 0; i < nb; i++)\n                    bk[0] = 0.;\n                ncalc = nb;\n                return { x: bk[0], nb, ncalc };\n            }\n            k = 0;\n            if (nu < sqxmin_BESS_K) {\n                nu = 0.;\n            }\n            else if (nu > .5) {\n                k = 1;\n                nu -= 1.;\n            }\n            twonu = nu + nu;\n            iend = nb + k - 1;\n            c = nu * nu;\n            d3 = -c;\n            if (ex <= 1.) {\n                /* ------------------------------------------------------------\n                   Calculation of P0 = GAMMA(1+ALPHA) * (2/X)**ALPHA\n                      Q0 = GAMMA(1-ALPHA) * (X/2)**ALPHA\n                   ------------------------------------------------------------ */\n                d1 = 0.; d2 = p[0];\n                t1 = 1.; t2 = q[0];\n                for (i = 2; i <= 7; i += 2) {\n                    d1 = c * d1 + p[i - 1];\n                    d2 = c * d2 + p[i];\n                    t1 = c * t1 + q[i - 1];\n                    t2 = c * t2 + q[i];\n                }\n                d1 = nu * d1;\n                t1 = nu * t1;\n                f1 = log(ex);\n                f0 = a + nu * (p[7] - nu * (d1 + d2) / (t1 + t2)) - f1;\n                q0 = exp(-nu * (a - nu * (p[7] + nu * (d1 - d2) / (t1 - t2)) - f1));\n                f1 = nu * f0;\n                p0 = exp(f1);\n                /* -----------------------------------------------------------\n                   Calculation of F0 =\n                   ----------------------------------------------------------- */\n                d1 = r[4];\n                t1 = 1.;\n                for (i = 0; i < 4; ++i) {\n                    d1 = c * d1 + r[i];\n                    t1 = c * t1 + s[i];\n                }\n                /* d2 := sinh(f1)/ nu = sinh(f1)/(f1/f0)\n                 *\t   = f0 * sinh(f1)/f1 */\n                if (fabs(f1) <= .5) {\n                    f1 *= f1;\n                    d2 = 0.;\n                    for (i = 0; i < 6; ++i) {\n                        d2 = f1 * d2 + t[i];\n                    }\n                    d2 = f0 + f0 * f1 * d2;\n                }\n                else {\n                    d2 = sinh(f1) / nu;\n                }\n                f0 = d2 - nu * d1 / (t1 * p0);\n                if (ex <= 1e-10) {\n                    /* ---------------------------------------------------------\n                       X <= 1.0E-10\n                       Calculation of K(ALPHA,X) and X*K(ALPHA+1,X)/K(ALPHA,X)\n                       --------------------------------------------------------- */\n                    bk[0] = f0 + ex * f0;\n                    if (ize === 1) {\n                        bk[0] -= ex * bk[0];\n                    }\n                    ratio = p0 / f0;\n                    c = ex * DBL_MAX;\n                    if (k !== 0) {\n                        /* ---------------------------------------------------\n                           Calculation of K(ALPHA,X)\n                           and  X*K(ALPHA+1,X)/K(ALPHA,X),\tALPHA >= 1/2\n                           --------------------------------------------------- */\n                        ncalc = -1;\n                        if (bk[0] >= c / ratio) {\n                            return { x: bk[nb - 1], nb, ncalc };\n                        }\n                        bk[0] = ratio * bk[0] / ex;\n                        twonu += 2.;\n                        ratio = twonu;\n                    }\n                    ncalc = 1;\n                    if (nb === 1)\n                        return { x: bk[nb - 1], nb, ncalc };\n\n                    /* -----------------------------------------------------\n                       Calculate  K(ALPHA+L,X)/K(ALPHA+L-1,X),\n                       L = 1, 2, ... , NB-1\n                       ----------------------------------------------------- */\n                    ncalc = -1;\n                    for (i = 1; i < nb; ++i) {\n                        if (ratio >= c)\n                            return { x: bk[nb - 1], nb, ncalc };\n\n                        bk[i] = ratio / ex;\n                        twonu += 2.;\n                        ratio = twonu;\n                    }\n                    ncalc = 1;\n                    break; //goto L240\n                }\n                else {\n                    /* ------------------------------------------------------\n                       10^-10 < X <= 1.0\n                       ------------------------------------------------------ */\n                    c = 1.;\n                    x2by4 = ex * ex / 4.;\n                    p0 = .5 * p0;\n                    q0 = .5 * q0;\n                    d1 = -1.;\n                    d2 = 0.;\n                    bk1 = 0.;\n                    bk2 = 0.;\n                    f1 = f0;\n                    f2 = p0;\n                    do {\n                        d1 += 2.;\n                        d2 += 1.;\n                        d3 = d1 + d3;\n                        c = x2by4 * c / d2;\n                        f0 = (d2 * f0 + p0 + q0) / d3;\n                        p0 /= d2 - nu;\n                        q0 /= d2 + nu;\n                        t1 = c * f0;\n                        t2 = c * (p0 - d2 * f0);\n                        bk1 += t1;\n                        bk2 += t2;\n                    } while (fabs(t1 / (f1 + bk1)) > DBL_EPSILON ||\n                        fabs(t2 / (f2 + bk2)) > DBL_EPSILON);\n                    bk1 = f1 + bk1;\n                    bk2 = 2. * (f2 + bk2) / ex;\n                    if (ize === 2) {\n                        d1 = exp(ex);\n                        bk1 *= d1;\n                        bk2 *= d1;\n                    }\n                    wminf = estf[0] * ex + estf[1];\n                }\n            }\n            else if (DBL_EPSILON * ex > 1.) {\n                /* -------------------------------------------------\n                   X > 1./EPS\n                   ------------------------------------------------- */\n                ncalc = nb;\n                bk1 = 1. / (M_SQRT_2dPI * sqrt(ex));\n                //for (i = 0; i < nb; ++i)\n                //  bk[i] = bk1;\n                return { x: bk1, nb, ncalc };\n\n            }\n            else {\n                /* -------------------------------------------------------\n                   X > 1.0\n                   ------------------------------------------------------- */\n                twox = ex + ex;\n                blpha = 0.;\n                ratio = 0.;\n                if (ex <= 4.) {\n                    /* ----------------------------------------------------------\n                       Calculation of K(ALPHA+1,X)/K(ALPHA,X),  1.0 <= X <= 4.0\n                       ----------------------------------------------------------*/\n                    d2 = trunc(estm[0] / ex + estm[1]);\n                    m = trunc(d2);\n                    d1 = d2 + d2;\n                    d2 -= .5;\n                    d2 *= d2;\n                    for (i = 2; i <= m; ++i) {\n                        d1 -= 2.;\n                        d2 -= d1;\n                        ratio = (d3 + d2) / (twox + d1 - ratio);\n                    }\n                    /* -----------------------------------------------------------\n                       Calculation of I(|ALPHA|,X) and I(|ALPHA|+1,X) by backward\n                       recurrence and K(ALPHA,X) from the wronskian\n                       -----------------------------------------------------------*/\n                    d2 = trunc(estm[2] * ex + estm[3]);\n                    m = trunc(d2);\n                    c = fabs(nu);\n                    d3 = c + c;\n                    d1 = d3 - 1.;\n                    f1 = DBL_MIN;\n                    f0 = (2. * (c + d2) / ex + .5 * ex / (c + d2 + 1.)) * DBL_MIN;\n                    for (i = 3; i <= m; ++i) {\n                        d2 -= 1.;\n                        f2 = (d3 + d2 + d2) * f0;\n                        blpha = (1. + d1 / d2) * (f2 + blpha);\n                        f2 = f2 / ex + f1;\n                        f1 = f0;\n                        f0 = f2;\n                    }\n                    f1 = (d3 + 2.) * f0 / ex + f1;\n                    d1 = 0.;\n                    t1 = 1.;\n                    for (i = 1; i <= 7; ++i) {\n                        d1 = c * d1 + p[i - 1];\n                        t1 = c * t1 + q[i - 1];\n                    }\n                    p0 = exp(c * (a + c * (p[7] - c * d1 / t1) - log(ex))) / ex;\n                    f2 = (c + .5 - ratio) * f1 / ex;\n                    bk1 = p0 + (d3 * f0 - f2 + f0 + blpha) / (f2 + f1 + f0) * p0;\n                    if (ize === 1) {\n                        bk1 *= exp(-ex);\n                    }\n                    wminf = estf[2] * ex + estf[3];\n                }\n                else {\n                    /* ---------------------------------------------------------\n                       Calculation of K(ALPHA,X) and K(ALPHA+1,X)/K(ALPHA,X), by\n                       backward recurrence, for  X > 4.0\n                       ----------------------------------------------------------*/\n                    dm = trunc(estm[4] / ex + estm[5]);\n                    m = trunc(dm);\n                    d2 = dm - .5;\n                    d2 *= d2;\n                    d1 = dm + dm;\n                    for (i = 2; i <= m; ++i) {\n                        dm -= 1.;\n                        d1 -= 2.;\n                        d2 -= d1;\n                        ratio = (d3 + d2) / (twox + d1 - ratio);\n                        blpha = (ratio + ratio * blpha) / dm;\n                    }\n                    bk1 = 1. / ((M_SQRT_2dPI + M_SQRT_2dPI * blpha) * sqrt(ex));\n                    if (ize === 1)\n                        bk1 *= exp(-ex);\n                    wminf = estf[4] * (ex - fabs(ex - estf[6])) + estf[5];\n                }\n                /* ---------------------------------------------------------\n                   Calculation of K(ALPHA+1,X)\n                   from K(ALPHA,X) and  K(ALPHA+1,X)/K(ALPHA,X)\n                   --------------------------------------------------------- */\n                bk2 = bk1 + bk1 * (nu + .5 - ratio) / ex;\n            }\n            /*--------------------------------------------------------------------\n              Calculation of 'NCALC', K(ALPHA+I,X),\tI  =  0, 1, ... , NCALC-1,\n              &\t  K(ALPHA+I,X)/K(ALPHA+I-1,X),\tI = NCALC, NCALC+1, ... , NB-1\n              -------------------------------------------------------------------*/\n            ncalc = nb;\n            bk[0] = bk1;\n            if (iend === 0)\n                return { x: bk[nb - 1], nb, ncalc };\n\n            j = 1 - k;\n            if (j >= 0)\n                bk[j] = bk2;\n\n            if (iend === 1)\n                return { x: bk[nb - 1], nb, ncalc };\n\n            m = min(trunc(wminf - nu), iend);\n            for (i = 2; i <= m; ++i) {\n                t1 = bk1;\n                bk1 = bk2;\n                twonu += 2.;\n                if (ex < 1.) {\n                    if (bk1 >= DBL_MAX / twonu * ex)\n                        break;\n                }\n                else {\n                    if (bk1 / ex >= DBL_MAX / twonu)\n                        break;\n                }\n                bk2 = twonu / ex * bk1 + t1;\n                ii = i;\n                ++j;\n                if (j >= 0) {\n                    bk[j] = bk2;\n                }\n            }\n\n            m = ii;\n            if (m === iend) {\n                return { x: bk[nb - 1], nb, ncalc };\n            }\n            ratio = bk2 / bk1;\n            mplus1 = m + 1;\n            ncalc = -1;\n            for (i = mplus1; i <= iend; ++i) {\n                twonu += 2.;\n                ratio = twonu / ex + 1. / ratio;\n                ++j;\n                if (j >= 1) {\n                    bk[j] = ratio;\n                }\n                else {\n                    if (bk2 >= DBL_MAX / ratio)\n                        return { x: bk[nb - 1], nb, ncalc };\n\n                    bk2 *= ratio;\n                }\n            }\n            ncalc = max(1, mplus1 - k);\n            if (ncalc === 1)\n                bk[0] = bk2;\n            if (nb === 1) {\n                return { x: bk2, nb, ncalc };\n            }\n        } //for loop \"goto\" guard\n        //gotoL420:\n        for (i = ncalc; i < nb; ++i) { /* i ==  ncalc */\n            bk[i] *= bk[i - 1];\n            (ncalc)++;\n        }\n    }\n    return { x: bk[nb - 1], nb, ncalc };\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { Rf_gamma_cody } from '../../gamma/gamma_cody';\nimport { enmten_BESS, ensig_BESS, enten_BESS, exparg_BESS, nsig_BESS, rtnsig_BESS, xlrg_BESS_IJ } from '../bessel-constants';\nimport { IBesselRC } from '../IBesselRC';\n\nconst { sqrt, pow, min, max: fmax, exp, trunc } = Math;\nconst { POSITIVE_INFINITY: ML_POSINF } = Number;\n\nconst printer = debug('I_bessel');\n\nexport function I_bessel(\n    x: number,\n    alpha: number,\n    nb: number,\n    ize: number\n): IBesselRC {\n    /* -------------------------------------------------------------------\n \n     This routine calculates Bessel functions I_(N+ALPHA) (X)\n     for non-negative argument X, and non-negative order N+ALPHA,\n     with or without exponential scaling.\n \n \n     Explanation of variables in the calling sequence\n \n     X     - Non-negative argument for which\n         I's or exponentially scaled I's (I*EXP(-X))\n         are to be calculated.\tIf I's are to be calculated,\n         X must be less than exparg_BESS (IZE=1) or xlrg_BESS_IJ (IZE=2),\n         (see bessel.h).\n     ALPHA - Fractional part of order for which\n         I's or exponentially scaled I's (I*EXP(-X)) are\n         to be calculated.  0 <= ALPHA < 1.0.\n     NB    - Number of functions to be calculated, NB > 0.\n         The first function calculated is of order ALPHA, and the\n         last is of order (NB - 1 + ALPHA).\n     IZE   - Type.\tIZE = 1 if unscaled I's are to be calculated,\n                = 2 if exponentially scaled I's are to be calculated.\n     BI    - Output vector of length NB.\tIf the routine\n         terminates normally (NCALC=NB), the vector BI contains the\n         functions I(ALPHA,X) through I(NB-1+ALPHA,X), or the\n         corresponding exponentially scaled functions.\n     NCALC - Output variable indicating possible errors.\n         Before using the vector BI, the user should check that\n         NCALC=NB, i.e., all orders have been calculated to\n         the desired accuracy.\tSee error returns below.\n \n \n     *******************************************************************\n     *******************************************************************\n \n     Error returns\n \n      In case of an error,\tNCALC != NB, and not all I's are\n      calculated to the desired accuracy.\n \n      NCALC < 0:  An argument is out of range. For example,\n         NB <= 0, IZE is not 1 or 2, or IZE=1 and ABS(X) >= EXPARG_BESS.\n         In this case, the BI-vector is not calculated, and NCALC is\n         set to MIN0(NB,0)-1 so that NCALC != NB.\n \n      NB > NCALC > 0: Not all requested function values could\n         be calculated accurately.\tThis usually occurs because NB is\n         much larger than ABS(X).  In this case, BI[N] is calculated\n         to the desired accuracy for N <= NCALC, but precision\n         is lost for NCALC < N <= NB.  If BI[N] does not vanish\n         for N > NCALC (because it is too small to be represented),\n         and BI[N]/BI[NCALC] = 10**(-K), then only the first NSIG-K\n         significant figures of BI[N] can be trusted.\n \n \n     Intrinsic functions required are:\n \n         DBLE, EXP, gamma_cody, INT, MAX, MIN, REAL, SQRT\n \n \n     Acknowledgement\n \n      This program is based on a program written by David J.\n      Sookne (2) that computes values of the Bessel functions J or\n      I of float argument and long order.  Modifications include\n      the restriction of the computation to the I Bessel function\n      of non-negative float argument, the extension of the computation\n      to arbitrary positive order, the inclusion of optional\n      exponential scaling, and the elimination of most underflow.\n      An earlier version was published in (3).\n \n     References: \"A Note on Backward Recurrence Algorithms,\" Olver,\n              F. W. J., and Sookne, D. J., Math. Comp. 26, 1972,\n              pp 941-947.\n \n             \"Bessel Functions of Real Argument and Integer Order,\"\n              Sookne, D. J., NBS Jour. of Res. B. 77B, 1973, pp\n              125-132.\n \n             \"ALGORITHM 597, Sequence of Modified Bessel Functions\n              of the First Kind,\" Cody, W. J., Trans. Math. Soft.,\n              1983, pp. 242-245.\n \n      Latest modification: May 30, 1989\n \n      Modified by: W. J. Cody and L. Stoltz\n               Applied Mathematics Division\n               Argonne National Laboratory\n               Argonne, IL  60439\n    */\n\n    /*-------------------------------------------------------------------\n      Mathematical constants\n      -------------------------------------------------------------------*/\n    const const__ = 1.585;\n\n    /* Local variables */\n    //int\n    let nend;\n    let intx;\n    let nbmx;\n    let k;\n    let l;\n    let n;\n    let nstart;\n\n    //double\n    let pold;\n    let test;\n    let p;\n    let em;\n    let en;\n    let empal;\n    let emp2al;\n    let halfx;\n    let aa;\n    let bb;\n    let cc;\n    let psave;\n    let plast;\n    let tover;\n    let psavel;\n    let sum;\n    let nu;\n    let twonu;\n\n    //int\n    let ncalc = nb;\n    let bi2 = new Array<number>(nb).fill(0);\n    /*Parameter adjustments */\n    //--bi;\n    nu = alpha;\n    twonu = nu + nu;\n\n    /*-------------------------------------------------------------------\n      Check for X, NB, OR IZE out of range.\n      ------------------------------------------------------------------- */\n    if (nb > 0 && x >= 0. && (0. <= nu && nu < 1.) &&\n        (1 <= ize && ize <= 2)) {\n\n        ncalc = nb;\n        if (ize === 1 && x > exparg_BESS) {\n            //for (k = 1; k <= nb; k++)\n            //\tbi2[k-1] = ML_POSINF; /* the limit *is* = Inf */\n            return { x: ML_POSINF, nb, ncalc };\n        }\n        if (ize === 2 && x > xlrg_BESS_IJ) {\n            //for (k = 1; k <= nb; k++)\n            //\tbi2[k-1] = 0.; /* The limit exp(-x) * I_nu(x) --> 0 : */\n            return { x: 0., nb, ncalc };\n        }\n        intx = trunc(x); /* fine, since x <= xlrg_BESS_IJ <<< LONG_MAX */\n        if (x >= rtnsig_BESS) { /* \"non-small\" x ( >= 1e-4 ) */\n            /* -------------------------------------------------------------------\n               Initialize the forward sweep, the P-sequence of Olver\n               ------------------------------------------------------------------- */\n            nbmx = nb - intx;\n            n = intx + 1;\n            en = (n + n) + twonu;\n            plast = 1.;\n            p = en / x;\n            /* ------------------------------------------------\n               Calculate general significance test\n               ------------------------------------------------ */\n            test = ensig_BESS + ensig_BESS;\n            if (intx * 2 > nsig_BESS * 5) {\n                test = sqrt(test * p);\n            }\n            else {\n                test /= pow(const__, intx);\n            }\n            let gotoL120: boolean = false;\n            if (nbmx >= 3) {\n                /* --------------------------------------------------\n                   Calculate P-sequence until N = NB-1\n                   Check for possible overflow.\n                   ------------------------------------------------ */\n                tover = enten_BESS / ensig_BESS;\n                nstart = intx + 2;\n                nend = nb - 1;\n                for (k = nstart; k <= nend; ++k) {\n                    n = k;\n                    en += 2.;\n                    pold = plast;\n                    plast = p;\n                    p = en * plast / x + pold;\n                    if (p > tover) {\n                        /* ------------------------------------------------\n                           To avoid overflow, divide P-sequence by TOVER.\n                           Calculate P-sequence until ABS(P) > 1.\n                           ---------------------------------------------- */\n                        tover = enten_BESS;\n                        p /= tover;\n                        plast /= tover;\n                        psave = p;\n                        psavel = plast;\n                        nstart = n + 1;\n                        do {\n                            ++n;\n                            en += 2.;\n                            pold = plast;\n                            plast = p;\n                            p = en * plast / x + pold;\n                        } while (p <= 1.);\n\n                        bb = en / x;\n                        /* ------------------------------------------------\n                           Calculate backward test, and find NCALC,\n                           the highest N such that the test is passed.\n                           ------------------------------------------------ */\n                        test = pold * plast / ensig_BESS;\n                        test *= .5 - .5 / (bb * bb);\n                        p = plast * tover;\n                        --n;\n                        en -= 2.;\n                        nend = min(nb, n);\n                        for (l = nstart; l <= nend; ++l) {\n                            ncalc = l - 1;\n                            pold = psavel;\n                            psavel = psave;\n                            psave = en * psavel / x + pold;\n                            if (psave * psavel > test) {\n                                break;\n                            }\n                            ncalc = nend;\n                        }\n                        gotoL120 = true;\n                        break;\n                    }//if\n                }//for\n                if (gotoL120 === false) {\n                    n = nend;\n                    en = (n + n) + twonu;\n                    /*---------------------------------------------------\n                      Calculate special significance test for NBMX > 2.\n                      --------------------------------------------------- */\n                    test = fmax(test, sqrt(plast * ensig_BESS) * sqrt(p + p));\n                }\n            }//if\n            /* --------------------------------------------------------\n               Calculate P-sequence until significance test passed.\n               -------------------------------------------------------- */\n            if (gotoL120 === false) {\n                do {\n                    ++n;\n                    en += 2.;\n                    pold = plast;\n                    plast = p;\n                    p = en * plast / x + pold;\n                } while (p < test);\n            }\n\n            //L120:\n            /* -------------------------------------------------------------------\n             Initialize the backward recursion and the normalization sum.\n             ------------------------------------------------------------------- */\n            ++n;\n            en += 2.;\n            bb = 0.;\n            aa = 1. / p;\n            em = n - 1.;\n            empal = em + nu;\n            emp2al = em - 1. + twonu;\n            sum = aa * empal * emp2al / em;\n            nend = n - nb;\n            let gotoL230 = false;\n            //let gotoL220 = false; //for doc purpose, because L220 follows the for loop immediatly\n            //for loop used to skip over rest of code and simualte \"goto\"\n            for (let cnt = 0; cnt < 1; cnt++) {\n                if (nend < 0) {\n                    /* -----------------------------------------------------\n                       N < NB, so store BI[N] and set higher orders to 0..\n                       ----------------------------------------------------- */\n                    bi2[n - 1] = aa;\n                    nend = -nend;\n                    for (l = 1; l <= nend; ++l) {\n                        bi2[n + l - 1] = 0.;\n                    }\n                }\n                else {\n                    if (nend > 0) {\n                        /* -----------------------------------------------------\n                           Recur backward via difference equation,\n                           calculating (but not storing) BI[N], until N = NB.\n                           --------------------------------------------------- */\n\n                        for (l = 1; l <= nend; ++l) {\n                            --n;\n                            en -= 2.;\n                            cc = bb;\n                            bb = aa;\n                            /* for x ~= 1500,  sum would overflow to 'inf' here,\n                             * and the final bi[] /= sum would give 0 wrongly;\n                             * RE-normalize (aa, sum) here -- no need to undo */\n                            if (nend > 100 && aa > 1e200) {\n                                /* multiply by  2^-900 = 1.18e-271 */\n                                let pow05_to_900 = pow(2, -900);\n                                cc = cc * pow05_to_900;\n                                bb = bb * pow05_to_900;\n                                sum = sum * pow05_to_900;\n                            }\n                            aa = en * bb / x + cc;\n                            em -= 1.;\n                            emp2al -= 1.;\n                            if (n === 1) {\n                                break;\n                            }\n                            if (n === 2) {\n                                emp2al = 1.;\n                            }\n                            empal -= 1.;\n                            sum = (sum + aa * empal) * emp2al / em;\n                        }\n                    }\n                    /* ---------------------------------------------------\n                       Store BI[NB]\n                       --------------------------------------------------- */\n                    bi2[n - 1] = aa;\n                    if (nb <= 1) {\n                        sum = sum + sum + aa;\n                        gotoL230 = true;\n                        break; //for loop used to skip over rest of code and simualte \"goto\"\n                    }\n                    /* -------------------------------------------------\n                       Calculate and Store BI[NB-1]\n                       ------------------------------------------------- */\n                    --n;\n                    en -= 2.;\n                    bi2[n - 1] = en * aa / x + bb;\n                    if (n === 1) {\n                        //gotoL220 = true;\n                        break; //for loop used to skip over rest of code and simualte \"goto\"\n                    }\n                    em -= 1.;\n                    if (n === 2)\n                        emp2al = 1.;\n                    else\n                        emp2al -= 1.;\n\n                    empal -= 1.;\n                    sum = (sum + bi2[n - 1] * empal) * emp2al / em;\n                }// if else\n                nend = n - 2;\n                if (nend > 0) {\n                    /* --------------------------------------------\n                       Calculate via difference equation\n                       and store BI[N], until N = 2.\n                       ------------------------------------------ */\n                    for (l = 1; l <= nend; ++l) {\n                        --n;\n                        en -= 2.;\n                        bi2[n - 1] = en * bi2[n] / x + bi2[n + 1];\n                        em -= 1.;\n                        if (n === 2)\n                            emp2al = 1.;\n                        else\n                            emp2al -= 1.;\n                        empal -= 1.;\n                        sum = (sum + bi2[n - 1] * empal) * emp2al / em;\n                    }//for\n                }//if\n                /* ----------------------------------------------\n                   Calculate BI[1]\n                   -------------------------------------------- */\n                bi2[0] = 2. * empal * bi2[1] / x + bi2[2];\n            }//for loop for \"goto\" simulation\n\n            //L220:\n            if (gotoL230 === false) {\n                sum = sum + sum + bi2[0];\n            }\n\n            //L230:\n            /* ---------------------------------------------------------\n               Normalize.  Divide all BI[N] by sum.\n               --------------------------------------------------------- */\n            if (nu !== 0.)\n                sum *= (Rf_gamma_cody(1. + nu) * pow(x * .5, -nu));\n            if (ize === 1)\n                sum *= exp(-(x));\n            aa = enmten_BESS;\n            if (sum > 1.)\n                aa *= sum;\n            for (n = 1; n <= nb; ++n) {\n                if (bi2[n - 1] < aa)\n                    bi2[n - 1] = 0.;\n                else\n                    bi2[n - 1] /= sum;\n            }\n            const rc = { x: bi2[nb - 1], nb, ncalc };\n            printer('normalize, devide all  Bi[N] by sum, result:%o', rc);\n            return rc;\n        }\n        else { /* small x  < 1e-4 */\n            /* -----------------------------------------------------------\n               Two-term ascending series for small X.\n               -----------------------------------------------------------*/\n            aa = 1.;\n            empal = 1. + nu;\n\n            /* No need to check for underflow */\n            halfx = .5 * x;\n\n            if (nu !== 0.)\n                aa = pow(halfx, nu) / Rf_gamma_cody(empal);\n            if (ize === 2)\n                aa *= exp(-(x));\n            bb = halfx * halfx;\n            bi2[0] = aa + aa * bb / empal;\n            if (x !== 0. && bi2[0] === 0.)\n                ncalc = 0;\n            if (nb > 1) {\n                if (x === 0.) {\n                    for (n = 2; n <= nb; ++n)\n                        bi2[n - 1] = 0.;\n                }\n                else {\n                    /* -------------------------------------------------\n                       Calculate higher-order functions.\n                       ------------------------------------------------- */\n                    cc = halfx;\n                    tover = (enmten_BESS + enmten_BESS) / x;\n                    if (bb !== 0.)\n                        tover = enmten_BESS / bb;\n                    for (n = 2; n <= nb; ++n) {\n                        aa /= empal;\n                        empal += 1.;\n                        aa *= cc;\n                        if (aa <= tover * empal)\n                            bi2[n - 1] = aa = 0.;\n                        else\n                            bi2[n - 1] = aa + aa * bb / empal;\n                        if (bi2[n - 1] === 0. && ncalc > n)\n                            ncalc = n - 1;\n                    }\n                }\n            }\n        }\n    }\n    else { /* argument out of range */\n        ncalc = min(nb, 0) - 1;\n    }\n    const rc = { x: bi2[nb - 1], nb, ncalc };\n    printer('drop off, result:%o', rc);\n    return rc;\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { cospi } from '../../trigonometry/cospi';\nimport { sinpi } from '../../trigonometry/sinpi';\nimport { M_eps_sinc, thresh_BESS_Y, xlrg_BESS_Y } from '../bessel-constants';\nimport { IBesselRC } from '../IBesselRC';\n\nconst M_SQRT_2dPI = 0.797884560802865355879892119869;\nconst M_1_PI = 0.3183098861837907;\nconst M_PI_2 = 1.5707963267948966;\n\n\nconst { min, trunc, sqrt, sin, cos, log, abs, pow, PI: M_PI } = Math;\nconst {\n    MIN_VALUE: DBL_MIN,\n    EPSILON: DBL_EPSILON,\n    NEGATIVE_INFINITY: ML_NEGINF,\n    MAX_VALUE: DBL_MAX\n} = Number;\n\nconst printer = debug('Y_bessel');\n\nexport function Y_bessel(x: number, alpha: number, nb: number): IBesselRC {\n    /* ----------------------------------------------------------------------\n \n      This routine calculates Bessel functions Y_(N+ALPHA) (X)\n     v for non-negative argument X, and non-negative order N+ALPHA.\n \n \n      Explanation of variables in the calling sequence\n \n      X     - Non-negative argument for which\n          Y's are to be calculated.\n      ALPHA - Fractional part of order for which\n          Y's are to be calculated.  0 <= ALPHA < 1.0.\n      NB    - Number of functions to be calculated, NB > 0.\n          The first function calculated is of order ALPHA, and the\n          last is of order (NB - 1 + ALPHA).\n      BY    - Output vector of length NB.\tIf the\n          routine terminates normally (NCALC=NB), the vector BY\n          contains the functions Y(ALPHA,X), ... , Y(NB-1+ALPHA,X),\n          If (0 < NCALC < NB), BY(I) contains correct function\n          values for I <= NCALC, and contains the ratios\n          Y(ALPHA+I-1,X)/Y(ALPHA+I-2,X) for the rest of the array.\n      NCALC - Output variable indicating possible errors.\n          Before using the vector BY, the user should check that\n          NCALC=NB, i.e., all orders have been calculated to\n          the desired accuracy.\tSee error returns below.\n \n \n      *******************************************************************\n \n      Error returns\n \n       In case of an error, NCALC != NB, and not all Y's are\n       calculated to the desired accuracy.\n \n       NCALC < -1:  An argument is out of range. For example,\n         NB <= 0, IZE is not 1 or 2, or IZE=1 and ABS(X) >=\n         XMAX.  In this case, BY[0] = 0.0, the remainder of the\n         BY-vector is not calculated, and NCALC is set to\n         MIN0(NB,0)-2  so that NCALC != NB.\n       NCALC = -1:  Y(ALPHA,X) >= XINF.  The requested function\n         values are set to 0.0.\n       1 < NCALC < NB: Not all requested function values could\n         be calculated accurately.  BY(I) contains correct function\n         values for I <= NCALC, and and the remaining NB-NCALC\n         array elements contain 0.0.\n \n \n      Intrinsic functions required are:\n \n          DBLE, EXP, INT, MAX, MIN, REAL, SQRT\n \n \n      Acknowledgement\n \n         This program draws heavily on Temme's Algol program for Y(a,x)\n         and Y(a+1,x) and on Campbell's programs for Y_nu(x).\tTemme's\n         scheme is used for  x < THRESH, and Campbell's scheme is used\n         in the asymptotic region.  Segments of code from both sources\n         have been translated into Fortran 77, merged, and heavily modified.\n         Modifications include parameterization of machine dependencies,\n         use of a new approximation for ln(gamma(x)), and built-in\n         protection against over/underflow.\n \n      References: \"Bessel functions J_nu(x) and Y_nu(x) of float\n               order and float argument,\" Campbell, J. B.,\n               Comp. Phy. Comm. 18, 1979, pp. 133-142.\n \n              \"On the numerical evaluation of the ordinary\n               Bessel function of the second kind,\" Temme,\n               N. M., J. Comput. Phys. 21, 1976, pp. 343-350.\n \n       Latest modification: March 19, 1990\n \n       Modified by: W. J. Cody\n                Applied Mathematics Division\n                Argonne National Laboratory\n                Argonne, IL  60439\n      ----------------------------------------------------------------------*/\n\n\n    /* ----------------------------------------------------------------------\n      Mathematical constants\n        FIVPI = 5*PI\n        PIM5 = 5*PI - 15\n     ----------------------------------------------------------------------*/\n    const fivpi = 15.707963267948966192;\n    const pim5 = .70796326794896619231;\n\n    /*----------------------------------------------------------------------\n          Coefficients for Chebyshev polynomial expansion of\n          1/gamma(1-x), abs(x) <= .5\n          ----------------------------------------------------------------------*/\n    const ch = [-6.7735241822398840964e-24,\n    -6.1455180116049879894e-23, 2.9017595056104745456e-21,\n        1.3639417919073099464e-19, 2.3826220476859635824e-18,\n    -9.0642907957550702534e-18, -1.4943667065169001769e-15,\n    -3.3919078305362211264e-14, -1.7023776642512729175e-13,\n        9.1609750938768647911e-12, 2.4230957900482704055e-10,\n        1.7451364971382984243e-9, -3.3126119768180852711e-8,\n    -8.6592079961391259661e-7, -4.9717367041957398581e-6,\n        7.6309597585908126618e-5, .0012719271366545622927,\n        .0017063050710955562222, -.07685284084478667369,\n    -.28387654227602353814, .92187029365045265648];\n\n    /* Local variables */\n\n    //ints\n    let i: number;\n    let k: number;\n    let na: number;\n    let ncalc: number;\n\n    //doubles\n    let alfa;\n    let div;\n    let ddiv;\n    let even;\n    let gamma;\n    let term;\n    let cosmu;\n    let sinmu;\n\n    let b;\n    let c;\n    let d;\n    let e;\n    let f;\n    let g;\n    let h;\n    let p;\n    let q;\n    let r;\n    let s;\n    let d1;\n    let d2;\n    let q0;\n    let pa;\n    let pa1;\n    let qa;\n    let qa1;\n    let en;\n    let ya;\n    let ya1;\n    let twobyx;\n    let den;\n    let odd;\n    let aye;\n    let dmu;\n    let x2;\n    let xna;\n    let en1 = ya = ya1 = 0;\t\t/* -Wall */\n\n    let ex = x;\n    let nu = alpha;\n    let by = new Array(nb).fill(0);\n    if (\n        !(nb > 0 && 0. <= nu && nu < 1.)\n    ) {\n        printer('violaton: abort nb=%d, nu=%d', nb, nu);\n        by[0] = 0.;\n        ncalc = min(nb, 0) - 1;\n        return { x: 0, nb, ncalc };\n    }\n\n    if (ex < DBL_MIN || ex > xlrg_BESS_Y) {\n        /* Warning is not really appropriate, give\n             * proper limit:\n             * ML_ERROR(ME_RANGE, \"Y_bessel\"); */\n        printer('range issue: x < DBL_MIN but still bigger then 1e8 x=(%d)', ex);\n        ncalc = nb;\n        if (ex > xlrg_BESS_Y) by[0] = 0.; /*was ML_POSINF */\n        else if (ex < DBL_MIN) by[0] = ML_NEGINF;\n        return { x: by[0], nb, ncalc };\n    }\n    xna = trunc(nu + .5);\n    na = trunc(xna);\n    if (na === 1) {/* <==>  .5 <= *alpha < 1\t <==>  -5. <= nu < 0 */\n        nu -= xna;\n    }\n    if (nu === -.5) {\n        p = M_SQRT_2dPI / sqrt(ex);\n        ya = p * sin(ex);\n        ya1 = -p * cos(ex);\n    }\n    else if (ex < 3.) {\n        /* -------------------------------------------------------------\n\t\t   Use Temme's scheme for small X\n\t\t   ------------------------------------------------------------- */\n        b = ex * .5;\n        d = -log(b);\n        f = nu * d;\n        e = pow(b, -nu);\n        if (abs(nu) < M_eps_sinc)\n            c = M_1_PI;\n        else\n            c = nu / sinpi(nu);\n\n        /* ------------------------------------------------------------\n\t\t   Computation of sinh(f)/f\n\t\t   ------------------------------------------------------------ */\n        if (abs(f) < 1.) {\n            x2 = f * f;\n            en = 19.;\n            s = 1.;\n            for (i = 1; i <= 9; ++i) {\n                s = s * x2 / en / (en - 1.) + 1.;\n                en -= 2.;\n            }\n        }\n        else {\n            s = (e - 1. / e) * .5 / f;\n        }\n        /* --------------------------------------------------------\n\t\t   Computation of 1/gamma(1-a) using Chebyshev polynomials */\n        x2 = nu * nu * 8.;\n        aye = ch[0];\n        even = 0.;\n        alfa = ch[1];\n        odd = 0.;\n        for (i = 3; i <= 19; i += 2) {\n            even = -(aye + aye + even);\n            aye = -even * x2 - aye + ch[i - 1];\n            odd = -(alfa + alfa + odd);\n            alfa = -odd * x2 - alfa + ch[i];\n        }\n        even = (even * .5 + aye) * x2 - aye + ch[20];\n        odd = (odd + alfa) * 2.;\n        gamma = odd * nu + even;\n        /* End of computation of 1/gamma(1-a)\n\t\t   ----------------------------------------------------------- */\n        g = e * gamma;\n        e = (e + 1. / e) * .5;\n        f = 2. * c * (odd * e + even * s * d);\n        e = nu * nu;\n        p = g * c;\n        q = M_1_PI / g;\n        c = nu * M_PI_2;\n        if (abs(c) < M_eps_sinc)\n            r = 1.;\n        else\n            r = sinpi(nu / 2) / c;\n\n        r = M_PI * c * r * r;\n        c = 1.;\n        d = -b * b;\n        h = 0.;\n        ya = f + r * q;\n        ya1 = p;\n        en = 1.;\n\n        while (abs(g / (1. + abs(ya))) +\n            abs(h / (1. + abs(ya1))) > DBL_EPSILON) {\n            f = (f * en + p + q) / (en * en - e);\n            c *= (d / en);\n            p /= en - nu;\n            q /= en + nu;\n            g = c * (f + r * q);\n            h = c * p - en * g;\n            ya += g;\n            ya1 += h;\n            en += 1.;\n        }\n        ya = -ya;\n        ya1 = -ya1 / b;\n    }\n    else if (ex < thresh_BESS_Y) {\n        /* --------------------------------------------------------------\n\t\t   Use Temme's scheme for moderate X :  3 <= x < 16\n\t\t   -------------------------------------------------------------- */\n        c = (.5 - nu) * (.5 + nu);\n        b = ex + ex;\n        e = ex * M_1_PI * cospi(nu) / DBL_EPSILON;\n        e *= e;\n        p = 1.;\n        q = -ex;\n        r = 1. + ex * ex;\n        s = r;\n        en = 2.;\n        while (r * en * en < e) {\n            en1 = en + 1.;\n            d = (en - 1. + c / en) / s;\n            p = (en + en - p * d) / en1;\n            q = (-b + q * d) / en1;\n            s = p * p + q * q;\n            r *= s;\n            en = en1;\n        }\n        f = p / s;\n        p = f;\n        g = -q / s;\n        q = g;\n\n        for (; ;) {\n            //L220:\n            en -= 1.;\n            if (en > 0.) {\n                r = en1 * (2. - p) - 2.;\n                s = b + en1 * q;\n                d = (en - 1. + c / en) / (r * r + s * s);\n                p = d * r;\n                q = d * s;\n                e = f + 1.;\n                f = p * e - g * q;\n                g = q * e + p * g;\n                en1 = en;\n                continue;\n                //goto L220;\n            }\n            break;\n        }\n        f = 1. + f;\n        d = f * f + g * g;\n        pa = f / d;\n        qa = -g / d;\n        d = nu + .5 - p;\n        q += ex;\n        pa1 = (pa * q - qa * d) / ex;\n        qa1 = (qa * q + pa * d) / ex;\n        b = ex - M_PI_2 * (nu + .5);\n        c = cos(b);\n        s = sin(b);\n        d = M_SQRT_2dPI / sqrt(ex);\n        ya = d * (pa * s + qa * c);\n        ya1 = d * (qa1 * s - pa1 * c);\n    }\n    else { /* x > thresh_BESS_Y */\n        /* ----------------------------------------------------------\n           Use Campbell's asymptotic scheme.\n           ---------------------------------------------------------- */\n        na = 0;\n        d1 = trunc(ex / fivpi);\n        i = trunc(d1);\n        dmu = ex - 15. * d1 - d1 * pim5 - (alpha + .5) * M_PI_2;\n        if (i - (i / 2 << 1) === 0) {\n            cosmu = cos(dmu);\n            sinmu = sin(dmu);\n        }\n        else {\n            cosmu = -cos(dmu);\n            sinmu = -sin(dmu);\n        }\n        ddiv = 8. * ex;\n        dmu = alpha;\n        den = sqrt(ex);\n        for (k = 1; k <= 2; ++k) {\n            p = cosmu;\n            cosmu = sinmu;\n            sinmu = -p;\n            d1 = (2. * dmu - 1.) * (2. * dmu + 1.);\n            d2 = 0.;\n            div = ddiv;\n            p = 0.;\n            q = 0.;\n            q0 = d1 / div;\n            term = q0;\n            for (i = 2; i <= 20; ++i) {\n                d2 += 8.;\n                d1 -= d2;\n                div += ddiv;\n                term = -term * d1 / div;\n                p += term;\n                d2 += 8.;\n                d1 -= d2;\n                div += ddiv;\n                term *= (d1 / div);\n                q += term;\n                if (abs(term) <= DBL_EPSILON) {\n                    break;\n                }\n            }\n            p += 1.;\n            q += q0;\n            if (k === 1)\n                ya = M_SQRT_2dPI * (p * cosmu - q * sinmu) / den;\n            else\n                ya1 = M_SQRT_2dPI * (p * cosmu - q * sinmu) / den;\n            dmu += 1.;\n        }\n    }\n    if (na === 1) {\n        h = 2. * (nu + 1.) / ex;\n        if (h > 1.) {\n            if (abs(ya1) > DBL_MAX / h) {\n                h = 0.;\n                ya = 0.;\n            }\n        }\n        h = h * ya1 - ya;\n        ya = ya1;\n        ya1 = h;\n    }\n    /* ---------------------------------------------------------------\n\t   Now have first one or two Y's\n\t   --------------------------------------------------------------- */\n    by[0] = ya;\n    ncalc = 1;\n    if (nb > 1) {\n        by[1] = ya1;\n        if (ya1 !== 0.) {\n            aye = 1. + alpha;\n            twobyx = 2. / ex;\n            ncalc = 2;\n            for (i = 2; i < nb; ++i) {\n                if (twobyx < 1.) {\n                    if (abs(by[i - 1]) * twobyx >= DBL_MAX / aye)\n                        break;\n                    //goto L450;\n                }\n                else {\n                    if (abs(by[i - 1]) >= DBL_MAX / aye / twobyx)\n                        break;\n                    //goto L450;\n                }\n                by[i] = twobyx * aye * by[i - 1] - by[i - 2];\n                aye += 1.;\n                ++(ncalc);\n            }//for\n        }//if\n    }//if\n    //L450:\n    // for (i = ncalc; i < nb; ++i)\n    //   by[i] = ML_NEGINF; /* was 0 */\n    return { x: by[ncalc - 1], nb, ncalc };\n}\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport * as debug from 'debug';\nimport { ME, ML_ERROR } from '../../common/_general';\nimport { Rf_gamma_cody } from '../../gamma/gamma_cody';\nimport {\n    enmten_BESS,\n    ensig_BESS,\n    enten_BESS,\n    xlrg_BESS_IJ\n} from '../bessel-constants';\nimport { IBesselRC } from '../IBesselRC';\n\nconst { min, trunc, pow, sqrt, sin, cos, max, abs } = Math;\n\nconst printer = debug('J_bessel');\n\nexport function J_bessel(x: number, alpha: number, nb: number): IBesselRC {\n    /*\n     Calculates Bessel functions J_{n+alpha} (x)\n     for non-negative argument x, and non-negative order n+alpha, n = 0,1,..,nb-1.\n  \n      Explanation of variables in the calling sequence.\n  \n     X     - Non-negative argument for which J's are to be calculated.\n     ALPHA - Fractional part of order for which\n       J's are to be calculated.  0 <= ALPHA < 1.\n     NB    - Number of functions to be calculated, NB >= 1.\n       The first function calculated is of order ALPHA, and the\n       last is of order (NB - 1 + ALPHA).\n     B     - Output vector of length NB.  If RJBESL\n       terminates normally (NCALC=NB), the vector B contains the\n       functions J/ALPHA/(X) through J/NB-1+ALPHA/(X).\n     NCALC - Output variable indicating possible errors.\n       Before using the vector B, the user should check that\n       NCALC=NB, i.e., all orders have been calculated to\n       the desired accuracy.\tSee the following\n  \n       ****************************************************************\n  \n     Error return codes\n  \n      In case of an error,  NCALC != NB, and not all J's are\n      calculated to the desired accuracy.\n  \n      NCALC < 0:\tAn argument is out of range. For example,\n         NBES <= 0, ALPHA < 0 or > 1, or X is too large.\n         In this case, b[1] is set to zero, the remainder of the\n         B-vector is not calculated, and NCALC is set to\n         MIN(NB,0)-1 so that NCALC != NB.\n  \n      NB > NCALC > 0: Not all requested function values could\n         be calculated accurately.  This usually occurs because NB is\n         much larger than ABS(X).\t In this case, b[N] is calculated\n         to the desired accuracy for N <= NCALC, but precision\n         is lost for NCALC < N <= NB.  If b[N] does not vanish\n         for N > NCALC (because it is too small to be represented),\n         and b[N]/b[NCALC] = 10^(-K), then only the first NSIG - K\n         significant figures of b[N] can be trusted.\n  \n  \n      Acknowledgement\n  \n      This program is based on a program written by David J. Sookne\n      (2) that computes values of the Bessel functions J or I of float\n      argument and long order.  Modifications include the restriction\n      of the computation to the J Bessel function of non-negative float\n      argument, the extension of the computation to arbitrary positive\n      order, and the elimination of most underflow.\n  \n      References:\n  \n      Olver, F.W.J., and Sookne, D.J. (1972)\n      \"A Note on Backward Recurrence Algorithms\";\n      Math. Comp. 26, 941-947.\n  \n      Sookne, D.J. (1973)\n      \"Bessel Functions of Real Argument and Integer Order\";\n      NBS Jour. of Res. B. 77B, 125-132.\n  \n      Latest modification: March 19, 1990\n  \n      Author: W. J. Cody\n        Applied Mathematics Division\n        Argonne National Laboratory\n        Argonne, IL  60439\n     *******************************************************************\n     */\n\n    /* ---------------------------------------------------------------------\n      Mathematical constants\n \n     PI2\t  = 2 / PI\n     TWOPI1 = first few significant digits of 2 * PI\n     TWOPI2 = (2*PI - TWOPI1) to working precision, i.e.,\n        TWOPI1 + TWOPI2 = 2 * PI to extra precision.\n     --------------------------------------------------------------------- */\n    const pi2 = .636619772367581343075535;\n    const twopi1 = 6.28125;\n    const twopi2 = .001935307179586476925286767;\n\n    /*---------------------------------------------------------------------\n     *  Factorial(N)\n     *--------------------------------------------------------------------- */\n    const fact: number[] = [1., 1., 2., 6., 24., 120., 720., 5040., 40320.,\n        362880., 3628800., 39916800., 479001600., 6227020800., 87178291200.,\n        1.307674368e12, 2.0922789888e13, 3.55687428096e14, 6.402373705728e15,\n        1.21645100408832e17, 2.43290200817664e18, 5.109094217170944e19,\n        1.12400072777760768e21, 2.585201673888497664e22,\n        6.2044840173323943936e23];\n\n    /* Local variables */\n    //const int lim = nb;\n    let b2 = new Array(nb).fill(0);\n\n    //START ints\n    let i_nend;\n    let nbmx;\n    let i;\n    let j;\n    let l;\n    let i_m;\n    let n;\n    let nstart;\n    //END ints \n\n    //START double\n    let capp;\n    let capq;\n    let pold;\n    let vcos;\n    let test;\n    let vsin;\n\n    let p;\n    let s;\n    let t;\n    let z;\n    let alpem;\n    let halfx;\n    let aa;\n    let bb;\n    let cc;\n    let psave;\n    let plast;\n    let tover;\n    let t1;\n    let alp2em;\n    let em;\n    let en;\n    let xc;\n    let xk;\n    let xm;\n    let psavel;\n    let gnu;\n    let xin;\n    let sum;\n    //END DOUBLE\n\n    //int\n    let ncalc;\n    let gotoL190 = false;\n\n    /* Parameter adjustment */\n    //--b;\n\n    let nu = alpha;\n    let twonu = nu + nu;\n\n    /*-------------------------------------------------------------------\n      Check for out of range arguments.\n      -------------------------------------------------------------------*/\n\n    if (\n        !(nb > 0 && x >= 0. && 0. <= nu && nu < 1.)\n    ) {\n        /* Error return -- X, NB, or ALPHA is out of range : */\n        b2[0] = 0.;\n        ncalc = min(nb, 0) - 1;\n        return { x, nb, ncalc };\n    }\n\n\n    ncalc = nb;\n    if (x > xlrg_BESS_IJ) {\n        ML_ERROR(ME.ME_RANGE, 'J_bessel', printer);\n        /* indeed, the limit is 0,\n         * but the cutoff happens too early */\n        return { x: 0, nb, ncalc };\n    }\n    let intxj = trunc(x);\n\n    /*===================================================================\n      Branch into  3 cases :\n      1) use 2-term ascending series for small X\n      2) use asymptotic form for large X when NB is not too large\n      3) use recursion otherwise\n      ===================================================================*/\n\n    if (x < 1 / 10000) {\n        printer('x < 0.0001 , x=%d, nb=%d', x, nb);\n        /* ---------------------------------------------------------------\n           Two-term ascending series for small X.\n           --------------------------------------------------------------- */\n        alpem = 1. + nu;\n\n        halfx = (x > enmten_BESS) ? .5 * x : 0.;\n        aa = (nu !== 0.) ? pow(halfx, nu) / (nu * Rf_gamma_cody(nu)) : 1.;\n        bb = (x + 1. > 1.) ? -halfx * halfx : 0.;\n        b2[0] = aa + aa * bb / alpem;\n        if (x !== 0. && b2[0] === 0.)\n            ncalc = 0;\n\n        if (nb !== 1) {\n            if (x <= 0.) {\n                for (n = 2; n <= nb; ++n)\n                    b2[n - 1] = 0.;\n            }\n            else {\n                /* ----------------------------------------------\n                   Calculate higher order functions.\n                   ---------------------------------------------- */\n                if (bb === 0.)\n                    tover = (enmten_BESS + enmten_BESS) / x;\n                else\n                    tover = enmten_BESS / bb;\n                cc = halfx;\n                for (n = 2; n <= nb; ++n) {\n                    aa /= alpem;\n                    alpem += 1.;\n                    aa *= cc;\n                    if (aa <= tover * alpem)\n                        aa = 0.;\n\n                    b2[n - 1] = aa + aa * bb / alpem;\n                    if (b2[n - 1] === 0. && ncalc > n)\n                        ncalc = n - 1;\n                }\n            }\n        }\n    }\n    else if (x > 25. && nb <= intxj + 1) {\n        printer('x > 25 and nb < int(x+1) :x=%d, nb=%d', x, nb);\n        /* ------------------------------------------------------------\n           Asymptotic series for X > 25 (and not too large nb)\n           ------------------------------------------------------------ */\n        xc = sqrt(pi2 / x);\n        xin = 1 / (64 * x * x);\n        if (x >= 130.) i_m = 4;\n        else if (x >= 35.) i_m = 8;\n        else i_m = 11;\n        xm = 4. * i_m;\n        /* ------------------------------------------------\n           Argument reduction for SIN and COS routines.\n           ------------------------------------------------ */\n        t = trunc(x / (twopi1 + twopi2) + .5);\n        z = (x - t * twopi1) - t * twopi2 - (nu + .5) / pi2;\n        vsin = sin(z);\n        vcos = cos(z);\n        gnu = twonu;\n        for (i = 1; i <= 2; ++i) {\n            s = (xm - 1. - gnu) * (xm - 1. + gnu) * xin * .5;\n            t = (gnu - (xm - 3.)) * (gnu + (xm - 3.));\n            t1 = (gnu - (xm + 1.)) * (gnu + (xm + 1.));\n            let k = i_m + i_m;\n            capp = s * t / fact[k];\n            capq = s * t1 / fact[k + 1];\n            xk = xm;\n            for (; k >= 4; k -= 2) {/* k + 2(j-2) == 2m */\n                xk -= 4.;\n                s = (xk - 1. - gnu) * (xk - 1. + gnu);\n                t1 = t;\n                t = (gnu - (xk - 3.)) * (gnu + (xk - 3.));\n                capp = (capp + 1. / fact[k - 2]) * s * t * xin;\n                capq = (capq + 1. / fact[k - 1]) * s * t1 * xin;\n\n            }\n            capp += 1.;\n            capq = (capq + 1.) * (gnu * gnu - 1.) * (.125 / x);\n            b2[i - 1] = xc * (capp * vcos - capq * vsin);\n            if (nb === 1) {\n                //return (BesselRC) { 0, nb, ncalc };\n                return { x: b2[nb - 1], nb, ncalc };\n            }\n\n        /* vsin <--> vcos */ t = vsin; vsin = -vcos; vcos = t;\n            gnu += 2.;\n        }\n        /* -----------------------------------------------\n           If  NB > 2, compute J(X,ORDER+I)\tfor I = 2, NB-1\n           ----------------------------------------------- */\n        if (nb > 2)\n            for (gnu = twonu + 2., j = 3; j <= nb; j++ , gnu += 2.)\n                b2[j - 1] = gnu * b2[j - 1 - 1] / x - b2[j - 2 - 1];\n    }\n    else {\n        printer('rest: x=%d, nb=%d\\t', x, nb);\n        /* rtnsig_BESS <= x && ( x <= 25 || intx+1 < *nb ) :\n           --------------------------------------------------------\n           Use recurrence to generate results.\n           First initialize the calculation of P*S.\n           -------------------------------------------------------- */\n        nbmx = nb - intxj;\n        n = intxj + 1;\n        en = (n + n) + twonu;\n        plast = 1.;\n        p = en / x;\n        /* ---------------------------------------------------\n           Calculate general significance test.\n           --------------------------------------------------- */\n        test = ensig_BESS + ensig_BESS;\n        if (nbmx >= 3) {\n            /* ------------------------------------------------------------\n               Calculate P*S until N = NB-1.  Check for possible overflow.\n               ---------------------------------------------------------- */\n            tover = enten_BESS / ensig_BESS;\n            nstart = intxj + 2;\n            i_nend = nb - 1;\n            en = (nstart + nstart) - 2. + twonu;\n            for (let k = nstart; k <= i_nend; ++k) {\n                n = k;\n                en += 2.;\n                pold = plast;\n                plast = p;\n                p = en * plast / x - pold;\n                if (p > tover) {\n                    /* -------------------------------------------\n                       To avoid overflow, divide P*S by TOVER.\n                       Calculate P*S until ABS(P) > 1.\n                       -------------------------------------------*/\n                    tover = enten_BESS;\n                    p /= tover;\n                    plast /= tover;\n                    psave = p;\n                    psavel = plast;\n                    nstart = n + 1;\n                    do {\n                        ++n;\n                        en += 2.;\n                        pold = plast;\n                        plast = p;\n                        p = en * plast / x - pold;\n                    } while (p <= 1.);\n\n                    bb = en / x;\n                    /* -----------------------------------------------\n                       Calculate backward test and find NCALC,\n                       the highest N such that the test is passed.\n                       ----------------------------------------------- */\n                    test = pold * plast * (.5 - .5 / (bb * bb));\n                    test /= ensig_BESS;\n                    p = plast * tover;\n                    --n;\n                    en -= 2.;\n                    i_nend = min(nb, n);\n                    for (l = nstart; l <= i_nend; ++l) {\n                        pold = psavel;\n                        psavel = psave;\n                        psave = en * psavel / x - pold;\n                        if (psave * psavel > test) {\n                            ncalc = l - 1;\n                            break;\n                        }\n                        ncalc = l;\n                    }\n                    gotoL190 = true;\n                    break;\n                }//if\n            }//for\n            n = i_nend;\n            en = (n + n) + twonu;\n            /* -----------------------------------------------------\n               Calculate special significance test for NBMX > 2.\n               -----------------------------------------------------*/\n            test = max(test, sqrt(plast * ensig_BESS) * sqrt(p + p));\n        }\n        /* ------------------------------------------------\n           Calculate P*S until significance test passes. */\n        if (!gotoL190) {\n            do {\n                ++n;\n                en += 2.;\n                pold = plast;\n                plast = p;\n                p = en * plast / x - pold;\n            } while (p < test);\n        }\n        /*---------------------------------------------------------------\n        Initialize the backward recursion and the normalization sum.\n        --------------------------------------------------------------- */\n        ++n;\n        en += 2.;\n        bb = 0.;\n        aa = 1. / p;\n        em = i_m = n >> 1; //integer devide by 2 with sign preservation \n        i_m = (n << 1) - (i_m << 2); /* = 2 n - 4 (n/2)\n               = 0 for even, 2 for odd n */\n        if (i_m === 0)\n            sum = 0.;\n        else {\n            alpem = em - 1. + nu;\n            alp2em = em + em + nu;\n            sum = aa * alpem * alp2em / em;\n        }\n        i_nend = n - nb;\n        /* if (nend > 0) */\n        /* --------------------------------------------------------\n           Recur backward via difference equation, calculating\n           (but not storing) b[N], until N = NB.\n           -------------------------------------------------------- */\n        for (l = 1; l <= i_nend; ++l) {\n            --n;\n            en -= 2.;\n            cc = bb;\n            bb = aa;\n            aa = en * bb / x - cc;\n            i_m = i_m ? 0 : 2; /* m = 2 - m failed on gcc4-20041019 */\n            if (i_m !== 0) {\n                em -= 1.;\n                alp2em = em + em + nu;\n                if (n === 1)\n                    break;\n\n                alpem = em - 1. + nu;\n                if (alpem === 0.)\n                    alpem = 1.;\n                sum = (sum + aa * alp2em) * alpem / em;\n            }\n        }\n        /*--------------------------------------------------\n          Store b[NB].\n          --------------------------------------------------*/\n        b2[n - 1] = aa;\n        //one loop to get rid of \"gotos\"\n        let gotoL240 = false;\n        let gotoL250 = false;\n        for (let cnt = 1; cnt > 0; cnt--) {\n            if (i_nend >= 0) {\n                if (nb <= 1) {\n                    if (nu + 1. === 1.)\n                        alp2em = 1.;\n                    else\n                        alp2em = nu;\n                    sum += b2[0] * alp2em;\n                    gotoL250 = true;\n                    break;\n                }\n                else {/*-- nb >= 2 : ---------------------------\n            Calculate and store b[NB-1].\n            ----------------------------------------*/\n                    --n;\n                    en -= 2.;\n                    b2[n - 1] = en * aa / x - bb;\n                    if (n === 1) {\n                        gotoL240 = true;\n                        break;\n                    }\n\n                    i_m = i_m ? 0 : 2; /* m = 2 - m failed on gcc4-20041019 */\n                    if (i_m !== 0) {\n                        em -= 1.;\n                        alp2em = em + em + nu;\n                        alpem = em - 1. + nu;\n                        if (alpem === 0.)\n                            alpem = 1.;\n                        sum = (sum + b2[n - 1] * alp2em) * alpem / em;\n                    }//if\n                }//if else\n            }// if\n        }//while the break\n\n        /* if (n - 2 != 0) */\n        /* --------------------------------------------------------\n           Calculate via difference equation and store b[N],\n           until N = 2.\n           -------------------------------------------------------- */\n        if (gotoL250 === false && gotoL240 === false) {\n            for (n = n - 1; n >= 2; n--) {\n                en -= 2.;\n                b2[n - 1] = en * b2[n + 1 - 1] / x - b2[n + 2 - 1];\n                i_m = i_m ? 0 : 2; /* m = 2 - m failed on gcc4-20041019 */\n                if (i_m !== 0) {\n                    em -= 1.;\n                    alp2em = em + em + nu;\n                    alpem = em - 1. + nu;\n                    if (alpem === 0.)\n                        alpem = 1.;\n                    sum = (sum + b2[n - 1] * alp2em) * alpem / em;\n                }\n            }\n            /* ---------------------------------------\n               Calculate b[1].\n               -----------------------------------------*/\n            b2[0] = 2. * (nu + 1.) * b2[1] / x - b2[2];\n        }\n        //L240:\n        if (gotoL250 === false) {\n            em -= 1.;\n            alp2em = em + em + nu;\n            if (alp2em === 0.)\n                alp2em = 1.;\n            sum += b2[0] * alp2em;\n        }\n        //L250:\n        /* ---------------------------------------------------\n           Normalize.  Divide all b[N] by sum.\n           ---------------------------------------------------*/\n        /*\t    if (nu + 1. != 1.) poor test */\n        if (abs(nu) > 1e-15)\n            sum *= (Rf_gamma_cody(nu) * pow(.5 * x, -nu));\n\n        aa = enmten_BESS;\n        if (sum > 1.)\n            aa *= sum;\n        for (n = 1; n <= nb; ++n) {\n            if (abs(b2[n - 1]) < aa)\n                b2[n - 1] = 0.;\n            else\n                b2[n - 1] /= sum;\n        }//for\n    }//if\n    return { x: b2[nb - 1], nb, ncalc };\n}\n\n\n","/* This is a conversion from LIB-R-MATH to Typescript/Javascript\nCopyright (C) 2018  Jacob K.F. Bogers  info@mail.jacob-bogers.com\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { internal_choose, internal_lchoose, lfastchoose, lfastchoose2 } from './choose';\n\nexport default {\n  choose: internal_choose,\n  lchoose: internal_lchoose,\n  lfastchoose,\n  lfastchoose2\n};\n"],"sourceRoot":""}